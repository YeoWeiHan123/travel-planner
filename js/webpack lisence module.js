/*! For license information please see scripts.a24d9fd76230fcae66da.js.LICENSE.txt */
(() => { var __webpack_modules__ = { 67154: e => { function t() { return e.exports = t = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var i = arguments[t]; for (var n in i) Object.prototype.hasOwnProperty.call(i, n) && (e[n] = i[n]) } return e }, e.exports.__esModule = !0, e.exports.default = e.exports, t.apply(this, arguments) } e.exports = t, e.exports.__esModule = !0, e.exports.default = e.exports }, 13490: (e, t, i) => { "use strict"; var n = i(58908); e.exports = function (e, t) { return void 0 === t && (t = !1), function (i, r, a) { if (i) e(i); else if (r.statusCode >= 400 && r.statusCode <= 599) { var s = a; if (t) if (n.TextDecoder) { var o = function (e) { void 0 === e && (e = ""); return e.toLowerCase().split(";").reduce((function (e, t) { var i = t.split("="), n = i[0], r = i[1]; return "charset" === n.trim() ? r.trim() : e }), "utf-8") }(r.headers && r.headers["content-type"]); try { s = new TextDecoder(o).decode(a) } catch (e) { } } else s = String.fromCharCode.apply(null, new Uint8Array(a)); e({ cause: s }) } else e(null, a) } } }, 9603: (e, t, i) => { "use strict"; var n = i(58908), r = i(67154), a = i(27376); o.httpHandler = i(13490); function s(e, t, i) { var n = e; return a(t) ? (i = t, "string" == typeof e && (n = { uri: e })) : n = r({}, t, { uri: e }), n.callback = i, n } function o(e, t, i) { return u(t = s(e, t, i)) } function u(e) { if (void 0 === e.callback) throw new Error("callback argument missing"); var t = !1, i = function (i, n, r) { t || (t = !0, e.callback(i, n, r)) }; function n() { var e = void 0; if (e = l.response ? l.response : l.responseText || function (e) { try { if ("document" === e.responseType) return e.responseXML; var t = e.responseXML && "parsererror" === e.responseXML.documentElement.nodeName; if ("" === e.responseType && !t) return e.responseXML } catch (e) { } return null }(l), g) try { e = JSON.parse(e) } catch (e) { } return e } function r(e) { return clearTimeout(c), e instanceof Error || (e = new Error("" + (e || "Unknown XMLHttpRequest Error"))), e.statusCode = 0, i(e, A) } function a() { if (!u) { var t; clearTimeout(c), t = e.useXDR && void 0 === l.status ? 200 : 1223 === l.status ? 204 : l.status; var r = A, a = null; return 0 !== t ? (r = { body: n(), statusCode: t, method: h, headers: {}, url: d, rawRequest: l }, l.getAllResponseHeaders && (r.headers = function (e) { var t = {}; return e ? (e.trim().split("\n").forEach((function (e) { var i = e.indexOf(":"), n = e.slice(0, i).trim().toLowerCase(), r = e.slice(i + 1).trim(); void 0 === t[n] ? t[n] = r : Array.isArray(t[n]) ? t[n].push(r) : t[n] = [t[n], r] })), t) : t }(l.getAllResponseHeaders()))) : a = new Error("Internal XMLHttpRequest Error"), i(a, r, r.body) } } var s, u, l = e.xhr || null; l || (l = e.cors || e.useXDR ? new o.XDomainRequest : new o.XMLHttpRequest); var c, d = l.url = e.uri || e.url, h = l.method = e.method || "GET", p = e.body || e.data, f = l.headers = e.headers || {}, m = !!e.sync, g = !1, A = { body: void 0, headers: {}, statusCode: 0, method: h, url: d, rawRequest: l }; if ("json" in e && !1 !== e.json && (g = !0, f.accept || f.Accept || (f.Accept = "application/json"), "GET" !== h && "HEAD" !== h && (f["content-type"] || f["Content-Type"] || (f["Content-Type"] = "application/json"), p = JSON.stringify(!0 === e.json ? p : e.json))), l.onreadystatechange = function () { 4 === l.readyState && setTimeout(a, 0) }, l.onload = a, l.onerror = r, l.onprogress = function () { }, l.onabort = function () { u = !0 }, l.ontimeout = r, l.open(h, d, !m, e.username, e.password), m || (l.withCredentials = !!e.withCredentials), !m && e.timeout > 0 && (c = setTimeout((function () { if (!u) { u = !0, l.abort("timeout"); var e = new Error("XMLHttpRequest timeout"); e.code = "ETIMEDOUT", r(e) } }), e.timeout)), l.setRequestHeader) for (s in f) f.hasOwnProperty(s) && l.setRequestHeader(s, f[s]); else if (e.headers && !function (e) { for (var t in e) if (e.hasOwnProperty(t)) return !1; return !0 }(e.headers)) throw new Error("Headers cannot be set on an XDomainRequest object"); return "responseType" in e && (l.responseType = e.responseType), "beforeSend" in e && "function" == typeof e.beforeSend && e.beforeSend(l), l.send(p || null), l } e.exports = o, e.exports.default = o, o.XMLHttpRequest = n.XMLHttpRequest || function () { }, o.XDomainRequest = "withCredentials" in new o.XMLHttpRequest ? o.XMLHttpRequest : n.XDomainRequest, function (e, t) { for (var i = 0; i < e.length; i++)t(e[i]) }(["get", "put", "post", "patch", "head", "delete"], (function (e) { o["delete" === e ? "del" : e] = function (t, i, n) { return (i = s(t, i, n)).method = e.toUpperCase(), u(i) } })) }, 72167: (e, t) => { "use strict"; function i(e, t) { return void 0 === t && (t = Object), t && "function" == typeof t.freeze ? t.freeze(e) : e } var n = i({ HTML: "text/html", isHTML: function (e) { return e === n.HTML }, XML_APPLICATION: "application/xml", XML_TEXT: "text/xml", XML_XHTML_APPLICATION: "application/xhtml+xml", XML_SVG_IMAGE: "image/svg+xml" }), r = i({ HTML: "http://www.w3.org/1999/xhtml", isHTML: function (e) { return e === r.HTML }, SVG: "http://www.w3.org/2000/svg", XML: "http://www.w3.org/XML/1998/namespace", XMLNS: "http://www.w3.org/2000/xmlns/" }); t.freeze = i, t.MIME_TYPE = n, t.NAMESPACE = r }, 86129: (e, t, i) => { var n = i(72167), r = i(41146), a = i(31045), s = i(76925), o = r.DOMImplementation, u = n.NAMESPACE, l = s.ParseError, c = s.XMLReader; function d(e) { this.options = e || { locator: {} } } function h() { this.cdata = !1 } function p(e, t) { t.lineNumber = e.lineNumber, t.columnNumber = e.columnNumber } function f(e) { if (e) return "\n@" + (e.systemId || "") + "#[line:" + e.lineNumber + ",col:" + e.columnNumber + "]" } function m(e, t, i) { return "string" == typeof e ? e.substr(t, i) : e.length >= t + i || t ? new java.lang.String(e, t, i) + "" : e } function g(e, t) { e.currentElement ? e.currentElement.appendChild(t) : e.doc.appendChild(t) } d.prototype.parseFromString = function (e, t) { var i = this.options, n = new c, r = i.domBuilder || new h, s = i.errorHandler, o = i.locator, l = i.xmlns || {}, d = /\/x?html?$/.test(t), p = d ? a.HTML_ENTITIES : a.XML_ENTITIES; return o && r.setDocumentLocator(o), n.errorHandler = function (e, t, i) { if (!e) { if (t instanceof h) return t; e = t } var n = {}, r = e instanceof Function; function a(t) { var a = e[t]; !a && r && (a = 2 == e.length ? function (i) { e(t, i) } : e), n[t] = a && function (e) { a("[xmldom " + t + "]\t" + e + f(i)) } || function () { } } return i = i || {}, a("warning"), a("error"), a("fatalError"), n }(s, r, o), n.domBuilder = i.domBuilder || r, d && (l[""] = u.HTML), l.xml = l.xml || u.XML, e && "string" == typeof e ? n.parse(e, l, p) : n.errorHandler.error("invalid doc source"), r.doc }, h.prototype = { startDocument: function () { this.doc = (new o).createDocument(null, null, null), this.locator && (this.doc.documentURI = this.locator.systemId) }, startElement: function (e, t, i, n) { var r = this.doc, a = r.createElementNS(e, i || t), s = n.length; g(this, a), this.currentElement = a, this.locator && p(this.locator, a); for (var o = 0; o < s; o++) { e = n.getURI(o); var u = n.getValue(o), l = (i = n.getQName(o), r.createAttributeNS(e, i)); this.locator && p(n.getLocator(o), l), l.value = l.nodeValue = u, a.setAttributeNode(l) } }, endElement: function (e, t, i) { var n = this.currentElement; n.tagName; this.currentElement = n.parentNode }, startPrefixMapping: function (e, t) { }, endPrefixMapping: function (e) { }, processingInstruction: function (e, t) { var i = this.doc.createProcessingInstruction(e, t); this.locator && p(this.locator, i), g(this, i) }, ignorableWhitespace: function (e, t, i) { }, characters: function (e, t, i) { if (e = m.apply(this, arguments)) { if (this.cdata) var n = this.doc.createCDATASection(e); else n = this.doc.createTextNode(e); this.currentElement ? this.currentElement.appendChild(n) : /^\s*$/.test(e) && this.doc.appendChild(n), this.locator && p(this.locator, n) } }, skippedEntity: function (e) { }, endDocument: function () { this.doc.normalize() }, setDocumentLocator: function (e) { (this.locator = e) && (e.lineNumber = 0) }, comment: function (e, t, i) { e = m.apply(this, arguments); var n = this.doc.createComment(e); this.locator && p(this.locator, n), g(this, n) }, startCDATA: function () { this.cdata = !0 }, endCDATA: function () { this.cdata = !1 }, startDTD: function (e, t, i) { var n = this.doc.implementation; if (n && n.createDocumentType) { var r = n.createDocumentType(e, t, i); this.locator && p(this.locator, r), g(this, r), this.doc.doctype = r } }, warning: function (e) { console.warn("[xmldom warning]\t" + e, f(this.locator)) }, error: function (e) { console.error("[xmldom error]\t" + e, f(this.locator)) }, fatalError: function (e) { throw new l(e, this.locator) } }, "endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g, (function (e) { h.prototype[e] = function () { return null } })), t.DOMParser = d, r.DOMImplementation, r.XMLSerializer }, 41146: (e, t, i) => { var n = i(72167).NAMESPACE; function r(e) { return "" !== e } function a(e, t) { return e.hasOwnProperty(t) || (e[t] = !0), e } function s(e) { if (!e) return []; var t = function (e) { return e ? e.split(/[\t\n\f\r ]+/).filter(r) : [] }(e); return Object.keys(t.reduce(a, {})) } function o(e, t) { for (var i in e) t[i] = e[i] } function u(e, t) { var i = e.prototype; if (!(i instanceof t)) { function n() { } n.prototype = t.prototype, o(i, n = new n), e.prototype = i = n } i.constructor != e && ("function" != typeof e && console.error("unknown Class:" + e), i.constructor = e) } var l = {}, c = l.ELEMENT_NODE = 1, d = l.ATTRIBUTE_NODE = 2, h = l.TEXT_NODE = 3, p = l.CDATA_SECTION_NODE = 4, f = l.ENTITY_REFERENCE_NODE = 5, m = l.ENTITY_NODE = 6, g = l.PROCESSING_INSTRUCTION_NODE = 7, A = l.COMMENT_NODE = 8, v = l.DOCUMENT_NODE = 9, y = l.DOCUMENT_TYPE_NODE = 10, _ = l.DOCUMENT_FRAGMENT_NODE = 11, b = l.NOTATION_NODE = 12, T = {}, x = {}, S = (T.INDEX_SIZE_ERR = (x[1] = "Index size error", 1), T.DOMSTRING_SIZE_ERR = (x[2] = "DOMString size error", 2), T.HIERARCHY_REQUEST_ERR = (x[3] = "Hierarchy request error", 3)), E = (T.WRONG_DOCUMENT_ERR = (x[4] = "Wrong document", 4), T.INVALID_CHARACTER_ERR = (x[5] = "Invalid character", 5), T.NO_DATA_ALLOWED_ERR = (x[6] = "No data allowed", 6), T.NO_MODIFICATION_ALLOWED_ERR = (x[7] = "No modification allowed", 7), T.NOT_FOUND_ERR = (x[8] = "Not found", 8)), C = (T.NOT_SUPPORTED_ERR = (x[9] = "Not supported", 9), T.INUSE_ATTRIBUTE_ERR = (x[10] = "Attribute in use", 10)); T.INVALID_STATE_ERR = (x[11] = "Invalid state", 11), T.SYNTAX_ERR = (x[12] = "Syntax error", 12), T.INVALID_MODIFICATION_ERR = (x[13] = "Invalid modification", 13), T.NAMESPACE_ERR = (x[14] = "Invalid namespace", 14), T.INVALID_ACCESS_ERR = (x[15] = "Invalid access", 15); function w(e, t) { if (t instanceof Error) var i = t; else i = this, Error.call(this, x[e]), this.message = x[e], Error.captureStackTrace && Error.captureStackTrace(this, w); return i.code = e, t && (this.message = this.message + ": " + t), i } function k() { } function F(e, t) { this._node = e, this._refresh = t, I(this) } function I(e) { var t = e._node._inc || e._node.ownerDocument._inc; if (e._inc != t) { var i = e._refresh(e._node); le(e, "length", i.length), o(i, e), e._inc = t } } function D() { } function P(e, t) { for (var i = e.length; i--;)if (e[i] === t) return i } function L(e, t, i, r) { if (r ? t[P(t, r)] = i : t[t.length++] = i, e) { i.ownerElement = e; var a = e.ownerDocument; a && (r && j(a, e, r), function (e, t, i) { e && e._inc++, i.namespaceURI === n.XMLNS && (t._nsMap[i.prefix ? i.localName : ""] = i.value) }(a, e, i)) } } function O(e, t, i) { var n = P(t, i); if (!(n >= 0)) throw w(E, new Error(e.tagName + "@" + i)); for (var r = t.length - 1; n < r;)t[n] = t[++n]; if (t.length = r, e) { var a = e.ownerDocument; a && (j(a, e, i), i.ownerElement = null) } } function B() { } function R() { } function M(e) { return ("<" == e ? "&lt;" : ">" == e && "&gt;") || "&" == e && "&amp;" || '"' == e && "&quot;" || "&#" + e.charCodeAt() + ";" } function N(e, t) { if (t(e)) return !0; if (e = e.firstChild) do { if (N(e, t)) return !0 } while (e = e.nextSibling) } function U() { } function j(e, t, i, r) { e && e._inc++, i.namespaceURI === n.XMLNS && delete t._nsMap[i.prefix ? i.localName : ""] } function H(e, t, i) { if (e && e._inc) { e._inc++; var n = t.childNodes; if (i) n[n.length++] = i; else { for (var r = t.firstChild, a = 0; r;)n[a++] = r, r = r.nextSibling; n.length = a } } } function V(e, t) { var i = t.previousSibling, n = t.nextSibling; return i ? i.nextSibling = n : e.firstChild = n, n ? n.previousSibling = i : e.lastChild = i, H(e.ownerDocument, e), t } function q(e, t, i) { var n = t.parentNode; if (n && n.removeChild(t), t.nodeType === _) { var r = t.firstChild; if (null == r) return t; var a = t.lastChild } else r = a = t; var s = i ? i.previousSibling : e.lastChild; r.previousSibling = s, a.nextSibling = i, s ? s.nextSibling = r : e.firstChild = r, null == i ? e.lastChild = a : i.previousSibling = a; do { r.parentNode = e } while (r !== a && (r = r.nextSibling)); return H(e.ownerDocument || e, e), t.nodeType == _ && (t.firstChild = t.lastChild = null), t } function W() { this._nsMap = {} } function G() { } function z() { } function Q() { } function X() { } function $() { } function K() { } function Y() { } function Z() { } function J() { } function ee() { } function te() { } function ie() { } function ne(e, t) { var i = [], n = 9 == this.nodeType && this.documentElement || this, r = n.prefix, a = n.namespaceURI; if (a && null == r && null == (r = n.lookupPrefix(a))) var s = [{ namespace: a, prefix: null }]; return se(this, i, e, t, s), i.join("") } function re(e, t, i) { var r = e.prefix || "", a = e.namespaceURI; if (!a) return !1; if ("xml" === r && a === n.XML || a === n.XMLNS) return !1; for (var s = i.length; s--;) { var o = i[s]; if (o.prefix === r) return o.namespace !== a } return !0 } function ae(e, t, i) { e.push(" ", t, '="', i.replace(/[<&"]/g, M), '"') } function se(e, t, i, r, a) { if (a || (a = []), r) { if (!(e = r(e))) return; if ("string" == typeof e) return void t.push(e) } switch (e.nodeType) { case c: var s = e.attributes, o = s.length, u = e.firstChild, l = e.tagName, m = l; if (!(i = n.isHTML(e.namespaceURI) || i) && !e.prefix && e.namespaceURI) { for (var b, T = 0; T < s.length; T++)if ("xmlns" === s.item(T).name) { b = s.item(T).value; break } if (!b) for (var x = a.length - 1; x >= 0; x--) { if ("" === (S = a[x]).prefix && S.namespace === e.namespaceURI) { b = S.namespace; break } } if (b !== e.namespaceURI) for (x = a.length - 1; x >= 0; x--) { var S; if ((S = a[x]).namespace === e.namespaceURI) { S.prefix && (m = S.prefix + ":" + l); break } } } t.push("<", m); for (var E = 0; E < o; E++) { "xmlns" == (C = s.item(E)).prefix ? a.push({ prefix: C.localName, namespace: C.value }) : "xmlns" == C.nodeName && a.push({ prefix: "", namespace: C.value }) } for (E = 0; E < o; E++) { var C, w, k; if (re(C = s.item(E), 0, a)) ae(t, (w = C.prefix || "") ? "xmlns:" + w : "xmlns", k = C.namespaceURI), a.push({ prefix: w, namespace: k }); se(C, t, i, r, a) } if (l === m && re(e, 0, a)) ae(t, (w = e.prefix || "") ? "xmlns:" + w : "xmlns", k = e.namespaceURI), a.push({ prefix: w, namespace: k }); if (u || i && !/^(?:meta|link|img|br|hr|input)$/i.test(l)) { if (t.push(">"), i && /^script$/i.test(l)) for (; u;)u.data ? t.push(u.data) : se(u, t, i, r, a.slice()), u = u.nextSibling; else for (; u;)se(u, t, i, r, a.slice()), u = u.nextSibling; t.push("</", m, ">") } else t.push("/>"); return; case v: case _: for (u = e.firstChild; u;)se(u, t, i, r, a.slice()), u = u.nextSibling; return; case d: return ae(t, e.name, e.value); case h: return t.push(e.data.replace(/[<&]/g, M).replace(/]]>/g, "]]&gt;")); case p: return t.push("<![CDATA[", e.data, "]]>"); case A: return t.push("\x3c!--", e.data, "--\x3e"); case y: var F = e.publicId, I = e.systemId; if (t.push("<!DOCTYPE ", e.name), F) t.push(" PUBLIC ", F), I && "." != I && t.push(" ", I), t.push(">"); else if (I && "." != I) t.push(" SYSTEM ", I, ">"); else { var D = e.internalSubset; D && t.push(" [", D, "]"), t.push(">") } return; case g: return t.push("<?", e.target, " ", e.data, "?>"); case f: return t.push("&", e.nodeName, ";"); default: t.push("??", e.nodeName) } } function oe(e, t, i) { var n; switch (t.nodeType) { case c: (n = t.cloneNode(!1)).ownerDocument = e; case _: break; case d: i = !0 }if (n || (n = t.cloneNode(!1)), n.ownerDocument = e, n.parentNode = null, i) for (var r = t.firstChild; r;)n.appendChild(oe(e, r, i)), r = r.nextSibling; return n } function ue(e, t, i) { var n = new t.constructor; for (var r in t) { var a = t[r]; "object" != typeof a && a != n[r] && (n[r] = a) } switch (t.childNodes && (n.childNodes = new k), n.ownerDocument = e, n.nodeType) { case c: var s = t.attributes, o = n.attributes = new D, u = s.length; o._ownerElement = n; for (var l = 0; l < u; l++)n.setAttributeNode(ue(e, s.item(l), !0)); break; case d: i = !0 }if (i) for (var h = t.firstChild; h;)n.appendChild(ue(e, h, i)), h = h.nextSibling; return n } function le(e, t, i) { e[t] = i } w.prototype = Error.prototype, o(T, w), k.prototype = { length: 0, item: function (e) { return this[e] || null }, toString: function (e, t) { for (var i = [], n = 0; n < this.length; n++)se(this[n], i, e, t); return i.join("") } }, F.prototype.item = function (e) { return I(this), this[e] }, u(F, k), D.prototype = { length: 0, item: k.prototype.item, getNamedItem: function (e) { for (var t = this.length; t--;) { var i = this[t]; if (i.nodeName == e) return i } }, setNamedItem: function (e) { var t = e.ownerElement; if (t && t != this._ownerElement) throw new w(C); var i = this.getNamedItem(e.nodeName); return L(this._ownerElement, this, e, i), i }, setNamedItemNS: function (e) { var t, i = e.ownerElement; if (i && i != this._ownerElement) throw new w(C); return t = this.getNamedItemNS(e.namespaceURI, e.localName), L(this._ownerElement, this, e, t), t }, removeNamedItem: function (e) { var t = this.getNamedItem(e); return O(this._ownerElement, this, t), t }, removeNamedItemNS: function (e, t) { var i = this.getNamedItemNS(e, t); return O(this._ownerElement, this, i), i }, getNamedItemNS: function (e, t) { for (var i = this.length; i--;) { var n = this[i]; if (n.localName == t && n.namespaceURI == e) return n } return null } }, B.prototype = { hasFeature: function (e, t) { return !0 }, createDocument: function (e, t, i) { var n = new U; if (n.implementation = this, n.childNodes = new k, n.doctype = i || null, i && n.appendChild(i), t) { var r = n.createElementNS(e, t); n.appendChild(r) } return n }, createDocumentType: function (e, t, i) { var n = new K; return n.name = e, n.nodeName = e, n.publicId = t || "", n.systemId = i || "", n } }, R.prototype = { firstChild: null, lastChild: null, previousSibling: null, nextSibling: null, attributes: null, parentNode: null, childNodes: null, ownerDocument: null, nodeValue: null, namespaceURI: null, prefix: null, localName: null, insertBefore: function (e, t) { return q(this, e, t) }, replaceChild: function (e, t) { this.insertBefore(e, t), t && this.removeChild(t) }, removeChild: function (e) { return V(this, e) }, appendChild: function (e) { return this.insertBefore(e, null) }, hasChildNodes: function () { return null != this.firstChild }, cloneNode: function (e) { return ue(this.ownerDocument || this, this, e) }, normalize: function () { for (var e = this.firstChild; e;) { var t = e.nextSibling; t && t.nodeType == h && e.nodeType == h ? (this.removeChild(t), e.appendData(t.data)) : (e.normalize(), e = t) } }, isSupported: function (e, t) { return this.ownerDocument.implementation.hasFeature(e, t) }, hasAttributes: function () { return this.attributes.length > 0 }, lookupPrefix: function (e) { for (var t = this; t;) { var i = t._nsMap; if (i) for (var n in i) if (i[n] == e) return n; t = t.nodeType == d ? t.ownerDocument : t.parentNode } return null }, lookupNamespaceURI: function (e) { for (var t = this; t;) { var i = t._nsMap; if (i && e in i) return i[e]; t = t.nodeType == d ? t.ownerDocument : t.parentNode } return null }, isDefaultNamespace: function (e) { return null == this.lookupPrefix(e) } }, o(l, R), o(l, R.prototype), U.prototype = { nodeName: "#document", nodeType: v, doctype: null, documentElement: null, _inc: 1, insertBefore: function (e, t) { if (e.nodeType == _) { for (var i = e.firstChild; i;) { var n = i.nextSibling; this.insertBefore(i, t), i = n } return e } return null == this.documentElement && e.nodeType == c && (this.documentElement = e), q(this, e, t), e.ownerDocument = this, e }, removeChild: function (e) { return this.documentElement == e && (this.documentElement = null), V(this, e) }, importNode: function (e, t) { return oe(this, e, t) }, getElementById: function (e) { var t = null; return N(this.documentElement, (function (i) { if (i.nodeType == c && i.getAttribute("id") == e) return t = i, !0 })), t }, getElementsByClassName: function (e) { var t = s(e); return new F(this, (function (i) { var n = []; return t.length > 0 && N(i.documentElement, (function (r) { if (r !== i && r.nodeType === c) { var a = r.getAttribute("class"); if (a) { var o = e === a; if (!o) { var u = s(a); o = t.every((l = u, function (e) { return l && -1 !== l.indexOf(e) })) } o && n.push(r) } } var l })), n })) }, createElement: function (e) { var t = new W; return t.ownerDocument = this, t.nodeName = e, t.tagName = e, t.localName = e, t.childNodes = new k, (t.attributes = new D)._ownerElement = t, t }, createDocumentFragment: function () { var e = new ee; return e.ownerDocument = this, e.childNodes = new k, e }, createTextNode: function (e) { var t = new Q; return t.ownerDocument = this, t.appendData(e), t }, createComment: function (e) { var t = new X; return t.ownerDocument = this, t.appendData(e), t }, createCDATASection: function (e) { var t = new $; return t.ownerDocument = this, t.appendData(e), t }, createProcessingInstruction: function (e, t) { var i = new te; return i.ownerDocument = this, i.tagName = i.target = e, i.nodeValue = i.data = t, i }, createAttribute: function (e) { var t = new G; return t.ownerDocument = this, t.name = e, t.nodeName = e, t.localName = e, t.specified = !0, t }, createEntityReference: function (e) { var t = new J; return t.ownerDocument = this, t.nodeName = e, t }, createElementNS: function (e, t) { var i = new W, n = t.split(":"), r = i.attributes = new D; return i.childNodes = new k, i.ownerDocument = this, i.nodeName = t, i.tagName = t, i.namespaceURI = e, 2 == n.length ? (i.prefix = n[0], i.localName = n[1]) : i.localName = t, r._ownerElement = i, i }, createAttributeNS: function (e, t) { var i = new G, n = t.split(":"); return i.ownerDocument = this, i.nodeName = t, i.name = t, i.namespaceURI = e, i.specified = !0, 2 == n.length ? (i.prefix = n[0], i.localName = n[1]) : i.localName = t, i } }, u(U, R), W.prototype = { nodeType: c, hasAttribute: function (e) { return null != this.getAttributeNode(e) }, getAttribute: function (e) { var t = this.getAttributeNode(e); return t && t.value || "" }, getAttributeNode: function (e) { return this.attributes.getNamedItem(e) }, setAttribute: function (e, t) { var i = this.ownerDocument.createAttribute(e); i.value = i.nodeValue = "" + t, this.setAttributeNode(i) }, removeAttribute: function (e) { var t = this.getAttributeNode(e); t && this.removeAttributeNode(t) }, appendChild: function (e) { return e.nodeType === _ ? this.insertBefore(e, null) : function (e, t) { var i = t.parentNode; if (i) { var n = e.lastChild; i.removeChild(t), n = e.lastChild } return n = e.lastChild, t.parentNode = e, t.previousSibling = n, t.nextSibling = null, n ? n.nextSibling = t : e.firstChild = t, e.lastChild = t, H(e.ownerDocument, e, t), t }(this, e) }, setAttributeNode: function (e) { return this.attributes.setNamedItem(e) }, setAttributeNodeNS: function (e) { return this.attributes.setNamedItemNS(e) }, removeAttributeNode: function (e) { return this.attributes.removeNamedItem(e.nodeName) }, removeAttributeNS: function (e, t) { var i = this.getAttributeNodeNS(e, t); i && this.removeAttributeNode(i) }, hasAttributeNS: function (e, t) { return null != this.getAttributeNodeNS(e, t) }, getAttributeNS: function (e, t) { var i = this.getAttributeNodeNS(e, t); return i && i.value || "" }, setAttributeNS: function (e, t, i) { var n = this.ownerDocument.createAttributeNS(e, t); n.value = n.nodeValue = "" + i, this.setAttributeNode(n) }, getAttributeNodeNS: function (e, t) { return this.attributes.getNamedItemNS(e, t) }, getElementsByTagName: function (e) { return new F(this, (function (t) { var i = []; return N(t, (function (n) { n === t || n.nodeType != c || "*" !== e && n.tagName != e || i.push(n) })), i })) }, getElementsByTagNameNS: function (e, t) { return new F(this, (function (i) { var n = []; return N(i, (function (r) { r === i || r.nodeType !== c || "*" !== e && r.namespaceURI !== e || "*" !== t && r.localName != t || n.push(r) })), n })) } }, U.prototype.getElementsByTagName = W.prototype.getElementsByTagName, U.prototype.getElementsByTagNameNS = W.prototype.getElementsByTagNameNS, u(W, R), G.prototype.nodeType = d, u(G, R), z.prototype = { data: "", substringData: function (e, t) { return this.data.substring(e, e + t) }, appendData: function (e) { e = this.data + e, this.nodeValue = this.data = e, this.length = e.length }, insertData: function (e, t) { this.replaceData(e, 0, t) }, appendChild: function (e) { throw new Error(x[S]) }, deleteData: function (e, t) { this.replaceData(e, t, "") }, replaceData: function (e, t, i) { i = this.data.substring(0, e) + i + this.data.substring(e + t), this.nodeValue = this.data = i, this.length = i.length } }, u(z, R), Q.prototype = { nodeName: "#text", nodeType: h, splitText: function (e) { var t = this.data, i = t.substring(e); t = t.substring(0, e), this.data = this.nodeValue = t, this.length = t.length; var n = this.ownerDocument.createTextNode(i); return this.parentNode && this.parentNode.insertBefore(n, this.nextSibling), n } }, u(Q, z), X.prototype = { nodeName: "#comment", nodeType: A }, u(X, z), $.prototype = { nodeName: "#cdata-section", nodeType: p }, u($, z), K.prototype.nodeType = y, u(K, R), Y.prototype.nodeType = b, u(Y, R), Z.prototype.nodeType = m, u(Z, R), J.prototype.nodeType = f, u(J, R), ee.prototype.nodeName = "#document-fragment", ee.prototype.nodeType = _, u(ee, R), te.prototype.nodeType = g, u(te, R), ie.prototype.serializeToString = function (e, t, i) { return ne.call(e, t, i) }, R.prototype.toString = ne; try { if (Object.defineProperty) { function ce(e) { switch (e.nodeType) { case c: case _: var t = []; for (e = e.firstChild; e;)7 !== e.nodeType && 8 !== e.nodeType && t.push(ce(e)), e = e.nextSibling; return t.join(""); default: return e.nodeValue } } Object.defineProperty(F.prototype, "length", { get: function () { return I(this), this.$$length } }), Object.defineProperty(R.prototype, "textContent", { get: function () { return ce(this) }, set: function (e) { switch (this.nodeType) { case c: case _: for (; this.firstChild;)this.removeChild(this.firstChild); (e || String(e)) && this.appendChild(this.ownerDocument.createTextNode(e)); break; default: this.data = e, this.value = e, this.nodeValue = e } } }), le = function (e, t, i) { e["$$" + t] = i } } } catch (de) { } t.DocumentType = K, t.DOMException = w, t.DOMImplementation = B, t.Element = W, t.Node = R, t.NodeList = k, t.XMLSerializer = ie }, 31045: (e, t, i) => { var n = i(72167).freeze; t.XML_ENTITIES = n({ amp: "&", apos: "'", gt: ">", lt: "<", quot: '"' }), t.HTML_ENTITIES = n({ lt: "<", gt: ">", amp: "&", quot: '"', apos: "'", Agrave: "À", Aacute: "Á", Acirc: "Â", Atilde: "Ã", Auml: "Ä", Aring: "Å", AElig: "Æ", Ccedil: "Ç", Egrave: "È", Eacute: "É", Ecirc: "Ê", Euml: "Ë", Igrave: "Ì", Iacute: "Í", Icirc: "Î", Iuml: "Ï", ETH: "Ð", Ntilde: "Ñ", Ograve: "Ò", Oacute: "Ó", Ocirc: "Ô", Otilde: "Õ", Ouml: "Ö", Oslash: "Ø", Ugrave: "Ù", Uacute: "Ú", Ucirc: "Û", Uuml: "Ü", Yacute: "Ý", THORN: "Þ", szlig: "ß", agrave: "à", aacute: "á", acirc: "â", atilde: "ã", auml: "ä", aring: "å", aelig: "æ", ccedil: "ç", egrave: "è", eacute: "é", ecirc: "ê", euml: "ë", igrave: "ì", iacute: "í", icirc: "î", iuml: "ï", eth: "ð", ntilde: "ñ", ograve: "ò", oacute: "ó", ocirc: "ô", otilde: "õ", ouml: "ö", oslash: "ø", ugrave: "ù", uacute: "ú", ucirc: "û", uuml: "ü", yacute: "ý", thorn: "þ", yuml: "ÿ", nbsp: " ", iexcl: "¡", cent: "¢", pound: "£", curren: "¤", yen: "¥", brvbar: "¦", sect: "§", uml: "¨", copy: "©", ordf: "ª", laquo: "«", not: "¬", shy: "­­", reg: "®", macr: "¯", deg: "°", plusmn: "±", sup2: "²", sup3: "³", acute: "´", micro: "µ", para: "¶", middot: "·", cedil: "¸", sup1: "¹", ordm: "º", raquo: "»", frac14: "¼", frac12: "½", frac34: "¾", iquest: "¿", times: "×", divide: "÷", forall: "∀", part: "∂", exist: "∃", empty: "∅", nabla: "∇", isin: "∈", notin: "∉", ni: "∋", prod: "∏", sum: "∑", minus: "−", lowast: "∗", radic: "√", prop: "∝", infin: "∞", ang: "∠", and: "∧", or: "∨", cap: "∩", cup: "∪", int: "∫", there4: "∴", sim: "∼", cong: "≅", asymp: "≈", ne: "≠", equiv: "≡", le: "≤", ge: "≥", sub: "⊂", sup: "⊃", nsub: "⊄", sube: "⊆", supe: "⊇", oplus: "⊕", otimes: "⊗", perp: "⊥", sdot: "⋅", Alpha: "Α", Beta: "Β", Gamma: "Γ", Delta: "Δ", Epsilon: "Ε", Zeta: "Ζ", Eta: "Η", Theta: "Θ", Iota: "Ι", Kappa: "Κ", Lambda: "Λ", Mu: "Μ", Nu: "Ν", Xi: "Ξ", Omicron: "Ο", Pi: "Π", Rho: "Ρ", Sigma: "Σ", Tau: "Τ", Upsilon: "Υ", Phi: "Φ", Chi: "Χ", Psi: "Ψ", Omega: "Ω", alpha: "α", beta: "β", gamma: "γ", delta: "δ", epsilon: "ε", zeta: "ζ", eta: "η", theta: "θ", iota: "ι", kappa: "κ", lambda: "λ", mu: "μ", nu: "ν", xi: "ξ", omicron: "ο", pi: "π", rho: "ρ", sigmaf: "ς", sigma: "σ", tau: "τ", upsilon: "υ", phi: "φ", chi: "χ", psi: "ψ", omega: "ω", thetasym: "ϑ", upsih: "ϒ", piv: "ϖ", OElig: "Œ", oelig: "œ", Scaron: "Š", scaron: "š", Yuml: "Ÿ", fnof: "ƒ", circ: "ˆ", tilde: "˜", ensp: " ", emsp: " ", thinsp: " ", zwnj: "‌", zwj: "‍", lrm: "‎", rlm: "‏", ndash: "–", mdash: "—", lsquo: "‘", rsquo: "’", sbquo: "‚", ldquo: "“", rdquo: "”", bdquo: "„", dagger: "†", Dagger: "‡", bull: "•", hellip: "…", permil: "‰", prime: "′", Prime: "″", lsaquo: "‹", rsaquo: "›", oline: "‾", euro: "€", trade: "™", larr: "←", uarr: "↑", rarr: "→", darr: "↓", harr: "↔", crarr: "↵", lceil: "⌈", rceil: "⌉", lfloor: "⌊", rfloor: "⌋", loz: "◊", spades: "♠", clubs: "♣", hearts: "♥", diams: "♦" }), t.entityMap = t.HTML_ENTITIES }, 3969: (e, t, i) => { var n = i(41146); n.DOMImplementation, n.XMLSerializer, t.DOMParser = i(86129).DOMParser }, 76925: (e, t, i) => { var n = i(72167).NAMESPACE, r = /[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/, a = new RegExp("[\\-\\.0-9" + r.source.slice(1, -1) + "\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"), s = new RegExp("^" + r.source + a.source + "*(?::" + r.source + a.source + "*)?$"); function o(e, t) { this.message = e, this.locator = t, Error.captureStackTrace && Error.captureStackTrace(this, o) } function u() { } function l(e, t) { return t.lineNumber = e.lineNumber, t.columnNumber = e.columnNumber, t } function c(e, t, i, r, a, s) { function o(e, t, n) { i.attributeNames.hasOwnProperty(e) && s.fatalError("Attribute " + e + " redefined"), i.addValue(e, t, n) } for (var u, l = ++t, c = 0; ;) { var d = e.charAt(l); switch (d) { case "=": if (1 === c) u = e.slice(t, l), c = 3; else { if (2 !== c) throw new Error("attribute equal must after attrName"); c = 3 } break; case "'": case '"': if (3 === c || 1 === c) { if (1 === c && (s.warning('attribute value must after "="'), u = e.slice(t, l)), t = l + 1, !((l = e.indexOf(d, t)) > 0)) throw new Error("attribute value no end '" + d + "' match"); o(u, h = e.slice(t, l).replace(/&#?\w+;/g, a), t - 1), c = 5 } else { if (4 != c) throw new Error('attribute value must after "="'); o(u, h = e.slice(t, l).replace(/&#?\w+;/g, a), t), s.warning('attribute "' + u + '" missed start quot(' + d + ")!!"), t = l + 1, c = 5 } break; case "/": switch (c) { case 0: i.setTagName(e.slice(t, l)); case 5: case 6: case 7: c = 7, i.closed = !0; case 4: case 1: case 2: break; default: throw new Error("attribute invalid close char('/')") }break; case "": return s.error("unexpected end of input"), 0 == c && i.setTagName(e.slice(t, l)), l; case ">": switch (c) { case 0: i.setTagName(e.slice(t, l)); case 5: case 6: case 7: break; case 4: case 1: "/" === (h = e.slice(t, l)).slice(-1) && (i.closed = !0, h = h.slice(0, -1)); case 2: 2 === c && (h = u), 4 == c ? (s.warning('attribute "' + h + '" missed quot(")!'), o(u, h.replace(/&#?\w+;/g, a), t)) : (n.isHTML(r[""]) && h.match(/^(?:disabled|checked|selected)$/i) || s.warning('attribute "' + h + '" missed value!! "' + h + '" instead!!'), o(h, h, t)); break; case 3: throw new Error("attribute value missed!!") }return l; case "": d = " "; default: if (d <= " ") switch (c) { case 0: i.setTagName(e.slice(t, l)), c = 6; break; case 1: u = e.slice(t, l), c = 2; break; case 4: var h = e.slice(t, l).replace(/&#?\w+;/g, a); s.warning('attribute "' + h + '" missed quot(")!!'), o(u, h, t); case 5: c = 6 } else switch (c) { case 2: i.tagName; n.isHTML(r[""]) && u.match(/^(?:disabled|checked|selected)$/i) || s.warning('attribute "' + u + '" missed value!! "' + u + '" instead2!!'), o(u, u, t), t = l, c = 1; break; case 5: s.warning('attribute space is required"' + u + '"!!'); case 6: c = 1, t = l; break; case 3: c = 4, t = l; break; case 7: throw new Error("elements closed character '/' and '>' must be connected to") } }l++ } } function d(e, t, i) { for (var r = e.tagName, a = null, s = e.length; s--;) { var o = e[s], u = o.qName, l = o.value; if ((p = u.indexOf(":")) > 0) var c = o.prefix = u.slice(0, p), d = u.slice(p + 1), h = "xmlns" === c && d; else d = u, c = null, h = "xmlns" === u && ""; o.localName = d, !1 !== h && (null == a && (a = {}, f(i, i = {})), i[h] = a[h] = l, o.uri = n.XMLNS, t.startPrefixMapping(h, l)) } for (s = e.length; s--;) { (c = (o = e[s]).prefix) && ("xml" === c && (o.uri = n.XML), "xmlns" !== c && (o.uri = i[c || ""])) } var p; (p = r.indexOf(":")) > 0 ? (c = e.prefix = r.slice(0, p), d = e.localName = r.slice(p + 1)) : (c = null, d = e.localName = r); var m = e.uri = i[c || ""]; if (t.startElement(m, d, r, e), !e.closed) return e.currentNSMap = i, e.localNSMap = a, !0; if (t.endElement(m, d, r), a) for (c in a) t.endPrefixMapping(c) } function h(e, t, i, n, r) { if (/^(?:script|textarea)$/i.test(i)) { var a = e.indexOf("</" + i + ">", t), s = e.substring(t + 1, a); if (/[&<]/.test(s)) return /^script$/i.test(i) ? (r.characters(s, 0, s.length), a) : (s = s.replace(/&#?\w+;/g, n), r.characters(s, 0, s.length), a) } return t + 1 } function p(e, t, i, n) { var r = n[i]; return null == r && ((r = e.lastIndexOf("</" + i + ">")) < t && (r = e.lastIndexOf("</" + i)), n[i] = r), r < t } function f(e, t) { for (var i in e) t[i] = e[i] } function m(e, t, i, n) { if ("-" === e.charAt(t + 2)) return "-" === e.charAt(t + 3) ? (r = e.indexOf("--\x3e", t + 4)) > t ? (i.comment(e, t + 4, r - t - 4), r + 3) : (n.error("Unclosed comment"), -1) : -1; if ("CDATA[" == e.substr(t + 3, 6)) { var r = e.indexOf("]]>", t + 9); return i.startCDATA(), i.characters(e, t + 9, r - t - 9), i.endCDATA(), r + 3 } var a = function (e, t) { var i, n = [], r = /'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g; r.lastIndex = t, r.exec(e); for (; i = r.exec(e);)if (n.push(i), i[1]) return n }(e, t), s = a.length; if (s > 1 && /!doctype/i.test(a[0][0])) { var o = a[1][0], u = !1, l = !1; s > 3 && (/^public$/i.test(a[2][0]) ? (u = a[3][0], l = s > 4 && a[4][0]) : /^system$/i.test(a[2][0]) && (l = a[3][0])); var c = a[s - 1]; return i.startDTD(o, u, l), i.endDTD(), c.index + c[0].length } return -1 } function g(e, t, i) { var n = e.indexOf("?>", t); if (n) { var r = e.substring(t, n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/); if (r) { r[0].length; return i.processingInstruction(r[1], r[2]), n + 2 } return -1 } return -1 } function A() { this.attributeNames = {} } o.prototype = new Error, o.prototype.name = o.name, u.prototype = { parse: function (e, t, i) { var r = this.domBuilder; r.startDocument(), f(t, t = {}), function (e, t, i, r, a) { function s(e) { if (e > 65535) { var t = 55296 + ((e -= 65536) >> 10), i = 56320 + (1023 & e); return String.fromCharCode(t, i) } return String.fromCharCode(e) } function u(e) { var t = e.slice(1, -1); return t in i ? i[t] : "#" === t.charAt(0) ? s(parseInt(t.substr(1).replace("x", "0x"))) : (a.error("entity not found:" + e), e) } function f(t) { if (t > E) { var i = e.substring(E, t).replace(/&#?\w+;/g, u); T && v(E), r.characters(i, 0, t - E), E = t } } function v(t, i) { for (; t >= _ && (i = b.exec(e));)y = i.index, _ = y + i[0].length, T.lineNumber++; T.columnNumber = t - y + 1 } var y = 0, _ = 0, b = /.*(?:\r\n?|\n)|.*$/g, T = r.locator, x = [{ currentNSMap: t }], S = {}, E = 0; for (; ;) { try { var C = e.indexOf("<", E); if (C < 0) { if (!e.substr(E).match(/^\s*$/)) { var w = r.doc, k = w.createTextNode(e.substr(E)); w.appendChild(k), r.currentElement = k } return } switch (C > E && f(C), e.charAt(C + 1)) { case "/": var F = e.indexOf(">", C + 3), I = e.substring(C + 2, F).replace(/[ \t\n\r]+$/g, ""), D = x.pop(); F < 0 ? (I = e.substring(C + 2).replace(/[\s<].*/, ""), a.error("end tag name: " + I + " is not complete:" + D.tagName), F = C + 1 + I.length) : I.match(/\s</) && (I = I.replace(/[\s<].*/, ""), a.error("end tag name: " + I + " maybe not complete"), F = C + 1 + I.length); var P = D.localNSMap, L = D.tagName == I; if (L || D.tagName && D.tagName.toLowerCase() == I.toLowerCase()) { if (r.endElement(D.uri, D.localName, I), P) for (var O in P) r.endPrefixMapping(O); L || a.fatalError("end tag name: " + I + " is not match the current start tagName:" + D.tagName) } else x.push(D); F++; break; case "?": T && v(C), F = g(e, C, r); break; case "!": T && v(C), F = m(e, C, r, a); break; default: T && v(C); var B = new A, R = x[x.length - 1].currentNSMap, M = (F = c(e, C, B, R, u, a), B.length); if (!B.closed && p(e, F, B.tagName, S) && (B.closed = !0, i.nbsp || a.warning("unclosed xml attribute")), T && M) { for (var N = l(T, {}), U = 0; U < M; U++) { var j = B[U]; v(j.offset), j.locator = l(T, {}) } r.locator = N, d(B, r, R) && x.push(B), r.locator = T } else d(B, r, R) && x.push(B); n.isHTML(B.uri) && !B.closed ? F = h(e, F, B.tagName, u, r) : F++ } } catch (e) { if (e instanceof o) throw e; a.error("element parse error: " + e), F = -1 } F > E ? E = F : f(Math.max(C, E) + 1) } }(e, t, i, r, this.errorHandler), r.endDocument() } }, A.prototype = { setTagName: function (e) { if (!s.test(e)) throw new Error("invalid tagName:" + e); this.tagName = e }, addValue: function (e, t, i) { if (!s.test(e)) throw new Error("invalid attribute:" + e); this.attributeNames[e] = this.length, this[this.length++] = { qName: e, value: t, offset: i } }, length: 0, getLocalName: function (e) { return this[e].localName }, getLocator: function (e) { return this[e].locator }, getQName: function (e) { return this[e].qName }, getURI: function (e) { return this[e].uri }, getValue: function (e) { return this[e].value } }, t.XMLReader = u, t.ParseError = o }, 37210: (e, t, i) => { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } var r = i(35002), a = r.webm, s = r.mp4, o = function () { return "undefined" != typeof navigator && parseFloat(("" + (/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0, ""])[1]).replace("undefined", "3_2").replace("_", ".").replace("_", "")) < 10 && !window.MSStream }, u = function () { return "wakeLock" in navigator }, l = function () { function e() { var t = this; if (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, e), this.enabled = !1, u()) { this._wakeLock = null; var i = function () { null !== t._wakeLock && "visible" === document.visibilityState && t.enable() }; document.addEventListener("visibilitychange", i), document.addEventListener("fullscreenchange", i) } else o() ? this.noSleepTimer = null : (this.noSleepVideo = document.createElement("video"), this.noSleepVideo.setAttribute("title", "No Sleep"), this.noSleepVideo.setAttribute("playsinline", ""), this._addSourceToVideo(this.noSleepVideo, "webm", a), this._addSourceToVideo(this.noSleepVideo, "mp4", s), this.noSleepVideo.addEventListener("loadedmetadata", (function () { t.noSleepVideo.duration <= 1 ? t.noSleepVideo.setAttribute("loop", "") : t.noSleepVideo.addEventListener("timeupdate", (function () { t.noSleepVideo.currentTime > .5 && (t.noSleepVideo.currentTime = Math.random()) })) }))) } var t, i, r; return t = e, (i = [{ key: "_addSourceToVideo", value: function (e, t, i) { var n = document.createElement("source"); n.src = i, n.type = "video/".concat(t), e.appendChild(n) } }, { key: "isEnabled", get: function () { return this.enabled } }, { key: "enable", value: function () { var e = this; return u() ? navigator.wakeLock.request("screen").then((function (t) { e._wakeLock = t, e.enabled = !0, console.log("Wake Lock active."), e._wakeLock.addEventListener("release", (function () { console.log("Wake Lock released.") })) })).catch((function (t) { throw e.enabled = !1, console.error("".concat(t.name, ", ").concat(t.message)), t })) : o() ? (this.disable(), console.warn("\n        NoSleep enabled for older iOS devices. This can interrupt\n        active or long-running network requests from completing successfully.\n        See https://github.com/richtr/NoSleep.js/issues/15 for more details.\n      "), this.noSleepTimer = window.setInterval((function () { document.hidden || (window.location.href = window.location.href.split("#")[0], window.setTimeout(window.stop, 0)) }), 15e3), this.enabled = !0, Promise.resolve()) : this.noSleepVideo.play().then((function (t) { return e.enabled = !0, t })).catch((function (t) { throw e.enabled = !1, t })) } }, { key: "disable", value: function () { u() ? (this._wakeLock && this._wakeLock.release(), this._wakeLock = null) : o() ? this.noSleepTimer && (console.warn("\n          NoSleep now disabled for older iOS devices.\n        "), window.clearInterval(this.noSleepTimer), this.noSleepTimer = null) : this.noSleepVideo.pause(), this.enabled = !1 } }]) && n(t.prototype, i), r && n(t, r), Object.defineProperty(t, "prototype", { writable: !1 }), e }(); e.exports = l }, 35002: e => { e.exports = { webm: "data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAVkhFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghV17AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU1LjMzLjEwMFdBjUxhdmY1NS4zMy4xMDBzpJBlrrXf3DCDVB8KcgbMpcr+RImIQJBgAAAAAAAWVK5rAQAAAAAAD++uAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDiDgQEj44OEAmJaAOABAAAAAAAABrCBsLqBkK4BAAAAAAAPq9eBAnPFgQKcgQAitZyDdW5khohBX1ZPUkJJU4OBAuEBAAAAAAAAEZ+BArWIQOdwAAAAAABiZIEgY6JPbwIeVgF2b3JiaXMAAAAAAoC7AAAAAAAAgLUBAAAAAAC4AQN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAQAAABUAAABlbmNvZGVyPUxhdmM1NS41Mi4xMDIBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADADwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABcAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAAEPueBAKOFggAAgACjzoEAA4BwBwCdASqwAJAAAEcIhYWIhYSIAgIABhwJ7kPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99YAD+/6tQgKOFggADgAqjhYIAD4AOo4WCACSADqOZgQArADECAAEQEAAYABhYL/QACIBDmAYAAKOFggA6gA6jhYIAT4AOo5mBAFMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAGSADqOFggB6gA6jmYEAewAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAj4AOo5mBAKMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAKSADqOFggC6gA6jmYEAywAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAz4AOo4WCAOSADqOZgQDzADECAAEQEAAYABhYL/QACIBDmAYAAKOFggD6gA6jhYIBD4AOo5iBARsAEQIAARAQFGAAYWC/0AAiAQ5gGACjhYIBJIAOo4WCATqADqOZgQFDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggFPgA6jhYIBZIAOo5mBAWsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAXqADqOFggGPgA6jmYEBkwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIBpIAOo4WCAbqADqOZgQG7ADECAAEQEAAYABhYL/QACIBDmAYAAKOFggHPgA6jmYEB4wAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIB5IAOo4WCAfqADqOZgQILADECAAEQEAAYABhYL/QACIBDmAYAAKOFggIPgA6jhYICJIAOo5mBAjMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAjqADqOFggJPgA6jmYECWwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYICZIAOo4WCAnqADqOZgQKDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggKPgA6jhYICpIAOo5mBAqsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCArqADqOFggLPgA6jmIEC0wARAgABEBAUYABhYL/QACIBDmAYAKOFggLkgA6jhYIC+oAOo5mBAvsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAw+ADqOZgQMjADECAAEQEAAYABhYL/QACIBDmAYAAKOFggMkgA6jhYIDOoAOo5mBA0sAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA0+ADqOFggNkgA6jmYEDcwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIDeoAOo4WCA4+ADqOZgQObADECAAEQEAAYABhYL/QACIBDmAYAAKOFggOkgA6jhYIDuoAOo5mBA8MAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA8+ADqOFggPkgA6jhYID+oAOo4WCBA+ADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghEr8IEK", mp4: "data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw" } }, 97019: function (module, exports, __webpack_require__) { var __WEBPACK_AMD_DEFINE_RESULT__, e, p; function _typeof(e) { return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e }, _typeof(e) } e = "undefined" != typeof window ? window : this, p = function (e) { function p(e) { return function (t) { return e.call(this, t) } } var d = { formErrors: [], version: "2.4", addEvent: function (e, t, i) { e.addEventListener ? e.addEventListener(t, i) : "DOMContentLoaded" === t ? e.attachEvent("onreadystatechange", (function () { "complete" === e.readyState && i.call(this) })) : e.attachEvent("on" + t, p(i)) }, getValue: function (e) { var t; if (e) { if (e.tagName) { if ("radio" === e.type) { var i = e.form.elements; for (t = 0; t < i.length; t++)if (i[t].name === e.name && i[t].checked) return i[t].value; return null } if ("file" === e.type) return e.files || e.value; if ("select" === e.tagName.toLowerCase()) { t = e.selectedIndex, i = e.options; var n = []; if ("select-one" === e.type) return 0 > t ? null : i[t].value; for (t = 0; t < i.length; t++)i[t].selected && n.push(i[t].value); return n } if (e.name && e.name.match(/\[\]$/)) { for (i = e.form.elements[e.name].tagName ? [e] : e.form.elements[e.name], n = [], t = 0; t < i.length; t++)("checkbox" !== i[t].type || i[t].checked) && n.push(i[t].value); return n } return "checkbox" === e.type ? e.checked : "textarea" === e.tagName.toLowerCase() ? e.value.replace("\r", "") : e.value.replace("\r", "").replace(/^\s+|\s+$/g, "") } return e[0] ? d.getValue(e[0]) : null } return null }, getEffectiveValue: function (e, t) { var i = d.getValue(e); return e.getAttribute && i === e.getAttribute("data-nette-empty-value") && (i = ""), t && (i = { value: i }, d.validateControl(e, null, !0, i), i = i.value), i }, validateControl: function (e, t, i, n, r) { e = e.tagName ? e : e[0], t = t || d.parseJSON(e.getAttribute("data-nette-rules")), n = void 0 === n ? { value: d.getEffectiveValue(e) } : n; for (var a = 0, s = t.length; a < s; a++) { var o = t[a], u = o.op.match(/(~)?([^?]+)/), l = o.control ? e.form.elements.namedItem(o.control) : e; if (o.neg = u[1], o.op = u[2], o.condition = !!o.rules, l) if ("optional" === o.op) r = !d.validateRule(e, ":filled", null, n); else if ((!r || o.condition || ":filled" === o.op) && (l = l.tagName ? l : l[0], null !== (u = d.validateRule(l, o.op, o.arg, e === l ? n : void 0)))) if (o.neg && (u = !u), o.condition && u) { if (!d.validateControl(e, o.rules, i, n, ":blank" !== o.op && r)) return !1 } else if (!o.condition && !u && !d.isDisabled(l)) { if (!i) { var c = d.isArray(o.arg) ? o.arg : [o.arg]; t = o.msg.replace(/%(value|\d+)/g, (function (t, i) { return d.getValue("value" === i ? l : e.form.elements.namedItem(c[i].control)) })), d.addError(l, t) } return !1 } } return !("number" === e.type && !e.validity.valid && (i || d.addError(e, "Please enter a valid value."), 1)) }, validateForm: function (e, t) { var i = e.form || e, n = !1; if (d.formErrors = [], i["nette-submittedBy"] && null !== i["nette-submittedBy"].getAttribute("formnovalidate")) { if (!(n = d.parseJSON(i["nette-submittedBy"].getAttribute("data-nette-validation-scope"))).length) return d.showFormErrors(i, []), !0; n = new RegExp("^(" + n.join("-|") + "-)") } var r, a = {}; for (r = 0; r < i.elements.length; r++) { var s = i.elements[r]; if (!s.tagName || s.tagName.toLowerCase() in { input: 1, select: 1, textarea: 1, button: 1 }) { if ("radio" === s.type) { if (a[s.name]) continue; a[s.name] = !0 } if (!(n && !s.name.replace(/]\[|\[|]|$/g, "-").match(n) || d.isDisabled(s) || d.validateControl(s, null, t) || d.formErrors.length)) return !1 } } return n = !d.formErrors.length, d.showFormErrors(i, d.formErrors), n }, isDisabled: function (e) { if ("radio" === e.type) { for (var t = 0, i = e.form.elements; t < i.length; t++)if (i[t].name === e.name && !i[t].disabled) return !1; return !0 } return e.disabled }, addError: function (e, t) { d.formErrors.push({ element: e, message: t }) }, showFormErrors: function (e, t) { for (var i, n = [], r = 0; r < t.length; r++) { var a = t[r].element, s = t[r].message; d.inArray(n, s) || (n.push(s), !i && a.focus && (i = a)) } n.length && (alert(n.join("\n")), i && i.focus()) } }, t = !1; return d.validateRule = function (e, i, n, r) { r = void 0 === r ? { value: d.getEffectiveValue(e, !0) } : r, ":" === i.charAt(0) && (i = i.substr(1)), i = (i = i.replace("::", "_")).replace(/\\/g, ""); var a = d.isArray(n) ? n.slice(0) : [n]; if (!t) { t = !0; for (var s = 0, o = a.length; s < o; s++)if (a[s] && a[s].control) { var u = e.form.elements.namedItem(a[s].control); a[s] = u === e ? r.value : d.getEffectiveValue(u, !0) } t = !1 } return d.validators[i] ? d.validators[i](e, d.isArray(n) ? a : a[0], r.value, r) : null }, d.validators = { filled: function (t, i, n) { return !("number" !== t.type || !t.validity.badInput) || "" !== n && !1 !== n && null !== n && (!d.isArray(n) || !!n.length) && (!e.FileList || !(n instanceof e.FileList) || n.length) }, blank: function (e, t, i) { return !d.validators.filled(e, t, i) }, valid: function (e) { return d.validateControl(e, null, !0) }, equal: function (e, t, i) { function n(e) { return "number" == typeof e || "string" == typeof e ? "" + e : !0 === e ? "1" : "" } if (void 0 === t) return null; i = d.isArray(i) ? i : [i], t = d.isArray(t) ? t : [t], e = 0; var r = i.length; e: for (; e < r; e++) { for (var a = 0, s = t.length; a < s; a++)if (n(i[e]) === n(t[a])) continue e; return !1 } return !0 }, notEqual: function (e, t, i) { return void 0 === t ? null : !d.validators.equal(e, t, i) }, minLength: function (e, t, i) { if ("number" === e.type) { if (e.validity.tooShort) return !1; if (e.validity.badInput) return null } return i.length >= t }, maxLength: function (e, t, i) { if ("number" === e.type) { if (e.validity.tooLong) return !1; if (e.validity.badInput) return null } return i.length <= t }, length: function (e, t, i) { if ("number" === e.type) { if (e.validity.tooShort || e.validity.tooLong) return !1; if (e.validity.badInput) return null } return (null === (t = d.isArray(t) ? t : [t, t])[0] || i.length >= t[0]) && (null === t[1] || i.length <= t[1]) }, email: function (e, t, i) { return /^("([ !#-[\]-~]|\\[ -~])+"|[-a-z0-9!#$%&'*+\/=?^_`{|}~]+(\.[-a-z0-9!#$%&'*+\/=?^_`{|}~]+)*)@([0-9a-z\u00C0-\u02FF\u0370-\u1EFF]([-0-9a-z\u00C0-\u02FF\u0370-\u1EFF]{0,61}[0-9a-z\u00C0-\u02FF\u0370-\u1EFF])?\.)+[a-z\u00C0-\u02FF\u0370-\u1EFF]([-0-9a-z\u00C0-\u02FF\u0370-\u1EFF]{0,17}[a-z\u00C0-\u02FF\u0370-\u1EFF])?$/i.test(i) }, url: function (e, t, i, n) { return /^[a-z\d+.-]+:/.test(i) || (i = "http://" + i), !!/^https?:\/\/((([-_0-9a-z\u00C0-\u02FF\u0370-\u1EFF]+\.)*[0-9a-z\u00C0-\u02FF\u0370-\u1EFF]([-0-9a-z\u00C0-\u02FF\u0370-\u1EFF]{0,61}[0-9a-z\u00C0-\u02FF\u0370-\u1EFF])?\.)?[a-z\u00C0-\u02FF\u0370-\u1EFF]([-0-9a-z\u00C0-\u02FF\u0370-\u1EFF]{0,17}[a-z\u00C0-\u02FF\u0370-\u1EFF])?|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\[[0-9a-f:]{3,39}\])(:\d{1,5})?(\/\S*)?$/i.test(i) && (n.value = i, !0) }, regexp: function (e, t, i) { e = "string" == typeof t && t.match(/^\/(.*)\/([imu]*)$/); try { return e && new RegExp(e[1], e[2].replace("u", "")).test(i) } catch (e) { } }, pattern: function (e, t, i) { try { return "string" == typeof t ? new RegExp("^(?:" + t + ")$").test(i) : null } catch (e) { } }, numeric: function (e, t, i) { return ("number" !== e.type || !e.validity.badInput) && /^[0-9]+$/.test(i) }, integer: function (e, t, i) { return ("number" !== e.type || !e.validity.badInput) && /^-?[0-9]+$/.test(i) }, float: function (e, t, i, n) { return !("number" === e.type && e.validity.badInput || (i = i.replace(/ +/g, "").replace(/,/g, "."), !/^-?[0-9]*\.?[0-9]+$/.test(i) || (n.value = i, 0))) }, min: function (e, t, i) { if ("number" === e.type) { if (e.validity.rangeUnderflow) return !1; if (e.validity.badInput) return null } return null === t || parseFloat(i) >= t }, max: function (e, t, i) { if ("number" === e.type) { if (e.validity.rangeOverflow) return !1; if (e.validity.badInput) return null } return null === t || parseFloat(i) <= t }, range: function (e, t, i) { if ("number" === e.type) { if (e.validity.rangeUnderflow || e.validity.rangeOverflow) return !1; if (e.validity.badInput) return null } return d.isArray(t) ? (null === t[0] || parseFloat(i) >= t[0]) && (null === t[1] || parseFloat(i) <= t[1]) : null }, submitted: function (e) { return e.form["nette-submittedBy"] === e }, fileSize: function (t, i, n) { if (e.FileList) for (t = 0; t < n.length; t++)if (n[t].size > i) return !1; return !0 }, image: function (t, i, n) { if (e.FileList && n instanceof e.FileList) for (t = 0; t < n.length; t++)if ((i = n[t].type) && "image/gif" !== i && "image/png" !== i && "image/jpeg" !== i) return !1; return !0 }, static: function (e, t, i) { return t } }, d.toggleForm = function (e, t) { var i; for (d.toggles = {}, i = 0; i < e.elements.length; i++)e.elements[i].tagName.toLowerCase() in { input: 1, select: 1, textarea: 1, button: 1 } && d.toggleControl(e.elements[i], null, null, !t); for (i in d.toggles) d.toggle(i, d.toggles[i], t) }, d.toggleControl = function (e, t, i, n, r) { t = t || d.parseJSON(e.getAttribute("data-nette-rules")), r = void 0 === r ? { value: d.getEffectiveValue(e) } : r; for (var a, s = !1, o = [], u = function () { d.toggleForm(e.form, e) }, l = 0, c = t.length; l < c; l++) { var h = t[l], p = h.op.match(/(~)?([^?]+)/), f = h.control ? e.form.elements.namedItem(h.control) : e; if (f) { if (a = i, !1 !== i) { if (h.neg = p[1], h.op = p[2], null === (a = d.validateRule(f, h.op, h.arg, e === f ? r : void 0))) continue; h.neg && (a = !a), h.rules || (i = a) } if (h.rules && d.toggleControl(e, h.rules, a, n, r) || h.toggle) { if (s = !0, n) { p = !document.addEventListener; var m = f.tagName ? f.name : f[0].name; f = f.tagName ? f.form.elements : f; for (var g = 0; g < f.length; g++)f[g].name !== m || d.inArray(o, f[g]) || (d.addEvent(f[g], p && f[g].type in { checkbox: 1, radio: 1 } ? "click" : "change", u), o.push(f[g])) } for (var A in h.toggle || []) Object.prototype.hasOwnProperty.call(h.toggle, A) && (d.toggles[A] = d.toggles[A] || (h.toggle[A] ? a : !a)) } } } return s }, d.parseJSON = function (a) { return "{op" === (a || "").substr(0, 3) ? eval("[" + a + "]") : JSON.parse(a || "[]") }, d.toggle = function (e, t, i) { (e = document.getElementById(e)) && (e.style.display = t ? "" : "none") }, d.initForm = function (t) { d.toggleForm(t), t.noValidate || (t.noValidate = !0, d.addEvent(t, "submit", (function (i) { d.validateForm(t) || (i && i.stopPropagation ? (i.stopPropagation(), i.preventDefault()) : e.event && (event.cancelBubble = !0, event.returnValue = !1)) }))) }, d.initOnLoad = function () { d.addEvent(document, "DOMContentLoaded", (function () { for (var e = 0; e < document.forms.length; e++)for (var t = document.forms[e], i = 0; i < t.elements.length; i++)if (t.elements[i].getAttribute("data-nette-rules")) { d.initForm(t); break } d.addEvent(document.body, "click", (function (e) { for (e = e.target || e.srcElement; e;) { if (e.form && e.type in { submit: 1, image: 1 }) { e.form["nette-submittedBy"] = e; break } e = e.parentNode } })) })) }, d.isArray = function (e) { return "[object Array]" === Object.prototype.toString.call(e) }, d.inArray = function (e, t) { if ([].indexOf) return -1 < e.indexOf(t); for (var i = 0; i < e.length; i++)if (e[i] === t) return !0; return !1 }, d.webalize = function (e) { e = e.toLowerCase(); var t, i = ""; for (t = 0; t < e.length; t++) { var n = d.webalizeTable[e.charAt(t)]; i += n || e.charAt(t) } return i.replace(/[^a-z0-9]+/g, "-").replace(/^-|-$/g, "") }, d.webalizeTable = { á: "a", ä: "a", č: "c", ď: "d", é: "e", ě: "e", í: "i", ľ: "l", ň: "n", ó: "o", ô: "o", ř: "r", š: "s", ť: "t", ú: "u", ů: "u", ý: "y", ž: "z" }, d }, e.JSON && (void 0 === (__WEBPACK_AMD_DEFINE_RESULT__ = function () { return p(e) }.call(exports, __webpack_require__, exports, module)) || (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) }, 62918: function (e, t) { var i; (function () { var r = !1, a = function (e) { return e instanceof a ? e : this instanceof a ? void (this.EXIFwrapped = e) : new a(e) }; e.exports && (t = e.exports = a), t.EXIF = a; var s = a.Tags = { 36864: "ExifVersion", 40960: "FlashpixVersion", 40961: "ColorSpace", 40962: "PixelXDimension", 40963: "PixelYDimension", 37121: "ComponentsConfiguration", 37122: "CompressedBitsPerPixel", 37500: "MakerNote", 37510: "UserComment", 40964: "RelatedSoundFile", 36867: "DateTimeOriginal", 36868: "DateTimeDigitized", 37520: "SubsecTime", 37521: "SubsecTimeOriginal", 37522: "SubsecTimeDigitized", 33434: "ExposureTime", 33437: "FNumber", 34850: "ExposureProgram", 34852: "SpectralSensitivity", 34855: "ISOSpeedRatings", 34856: "OECF", 37377: "ShutterSpeedValue", 37378: "ApertureValue", 37379: "BrightnessValue", 37380: "ExposureBias", 37381: "MaxApertureValue", 37382: "SubjectDistance", 37383: "MeteringMode", 37384: "LightSource", 37385: "Flash", 37396: "SubjectArea", 37386: "FocalLength", 41483: "FlashEnergy", 41484: "SpatialFrequencyResponse", 41486: "FocalPlaneXResolution", 41487: "FocalPlaneYResolution", 41488: "FocalPlaneResolutionUnit", 41492: "SubjectLocation", 41493: "ExposureIndex", 41495: "SensingMethod", 41728: "FileSource", 41729: "SceneType", 41730: "CFAPattern", 41985: "CustomRendered", 41986: "ExposureMode", 41987: "WhiteBalance", 41988: "DigitalZoomRation", 41989: "FocalLengthIn35mmFilm", 41990: "SceneCaptureType", 41991: "GainControl", 41992: "Contrast", 41993: "Saturation", 41994: "Sharpness", 41995: "DeviceSettingDescription", 41996: "SubjectDistanceRange", 40965: "InteroperabilityIFDPointer", 42016: "ImageUniqueID" }, o = a.TiffTags = { 256: "ImageWidth", 257: "ImageHeight", 34665: "ExifIFDPointer", 34853: "GPSInfoIFDPointer", 40965: "InteroperabilityIFDPointer", 258: "BitsPerSample", 259: "Compression", 262: "PhotometricInterpretation", 274: "Orientation", 277: "SamplesPerPixel", 284: "PlanarConfiguration", 530: "YCbCrSubSampling", 531: "YCbCrPositioning", 282: "XResolution", 283: "YResolution", 296: "ResolutionUnit", 273: "StripOffsets", 278: "RowsPerStrip", 279: "StripByteCounts", 513: "JPEGInterchangeFormat", 514: "JPEGInterchangeFormatLength", 301: "TransferFunction", 318: "WhitePoint", 319: "PrimaryChromaticities", 529: "YCbCrCoefficients", 532: "ReferenceBlackWhite", 306: "DateTime", 270: "ImageDescription", 271: "Make", 272: "Model", 305: "Software", 315: "Artist", 33432: "Copyright" }, u = a.GPSTags = { 0: "GPSVersionID", 1: "GPSLatitudeRef", 2: "GPSLatitude", 3: "GPSLongitudeRef", 4: "GPSLongitude", 5: "GPSAltitudeRef", 6: "GPSAltitude", 7: "GPSTimeStamp", 8: "GPSSatellites", 9: "GPSStatus", 10: "GPSMeasureMode", 11: "GPSDOP", 12: "GPSSpeedRef", 13: "GPSSpeed", 14: "GPSTrackRef", 15: "GPSTrack", 16: "GPSImgDirectionRef", 17: "GPSImgDirection", 18: "GPSMapDatum", 19: "GPSDestLatitudeRef", 20: "GPSDestLatitude", 21: "GPSDestLongitudeRef", 22: "GPSDestLongitude", 23: "GPSDestBearingRef", 24: "GPSDestBearing", 25: "GPSDestDistanceRef", 26: "GPSDestDistance", 27: "GPSProcessingMethod", 28: "GPSAreaInformation", 29: "GPSDateStamp", 30: "GPSDifferential" }, l = a.IFD1Tags = { 256: "ImageWidth", 257: "ImageHeight", 258: "BitsPerSample", 259: "Compression", 262: "PhotometricInterpretation", 273: "StripOffsets", 274: "Orientation", 277: "SamplesPerPixel", 278: "RowsPerStrip", 279: "StripByteCounts", 282: "XResolution", 283: "YResolution", 284: "PlanarConfiguration", 296: "ResolutionUnit", 513: "JpegIFOffset", 514: "JpegIFByteCount", 529: "YCbCrCoefficients", 530: "YCbCrSubSampling", 531: "YCbCrPositioning", 532: "ReferenceBlackWhite" }, c = a.StringValues = { ExposureProgram: { 0: "Not defined", 1: "Manual", 2: "Normal program", 3: "Aperture priority", 4: "Shutter priority", 5: "Creative program", 6: "Action program", 7: "Portrait mode", 8: "Landscape mode" }, MeteringMode: { 0: "Unknown", 1: "Average", 2: "CenterWeightedAverage", 3: "Spot", 4: "MultiSpot", 5: "Pattern", 6: "Partial", 255: "Other" }, LightSource: { 0: "Unknown", 1: "Daylight", 2: "Fluorescent", 3: "Tungsten (incandescent light)", 4: "Flash", 9: "Fine weather", 10: "Cloudy weather", 11: "Shade", 12: "Daylight fluorescent (D 5700 - 7100K)", 13: "Day white fluorescent (N 4600 - 5400K)", 14: "Cool white fluorescent (W 3900 - 4500K)", 15: "White fluorescent (WW 3200 - 3700K)", 17: "Standard light A", 18: "Standard light B", 19: "Standard light C", 20: "D55", 21: "D65", 22: "D75", 23: "D50", 24: "ISO studio tungsten", 255: "Other" }, Flash: { 0: "Flash did not fire", 1: "Flash fired", 5: "Strobe return light not detected", 7: "Strobe return light detected", 9: "Flash fired, compulsory flash mode", 13: "Flash fired, compulsory flash mode, return light not detected", 15: "Flash fired, compulsory flash mode, return light detected", 16: "Flash did not fire, compulsory flash mode", 24: "Flash did not fire, auto mode", 25: "Flash fired, auto mode", 29: "Flash fired, auto mode, return light not detected", 31: "Flash fired, auto mode, return light detected", 32: "No flash function", 65: "Flash fired, red-eye reduction mode", 69: "Flash fired, red-eye reduction mode, return light not detected", 71: "Flash fired, red-eye reduction mode, return light detected", 73: "Flash fired, compulsory flash mode, red-eye reduction mode", 77: "Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected", 79: "Flash fired, compulsory flash mode, red-eye reduction mode, return light detected", 89: "Flash fired, auto mode, red-eye reduction mode", 93: "Flash fired, auto mode, return light not detected, red-eye reduction mode", 95: "Flash fired, auto mode, return light detected, red-eye reduction mode" }, SensingMethod: { 1: "Not defined", 2: "One-chip color area sensor", 3: "Two-chip color area sensor", 4: "Three-chip color area sensor", 5: "Color sequential area sensor", 7: "Trilinear sensor", 8: "Color sequential linear sensor" }, SceneCaptureType: { 0: "Standard", 1: "Landscape", 2: "Portrait", 3: "Night scene" }, SceneType: { 1: "Directly photographed" }, CustomRendered: { 0: "Normal process", 1: "Custom process" }, WhiteBalance: { 0: "Auto white balance", 1: "Manual white balance" }, GainControl: { 0: "None", 1: "Low gain up", 2: "High gain up", 3: "Low gain down", 4: "High gain down" }, Contrast: { 0: "Normal", 1: "Soft", 2: "Hard" }, Saturation: { 0: "Normal", 1: "Low saturation", 2: "High saturation" }, Sharpness: { 0: "Normal", 1: "Soft", 2: "Hard" }, SubjectDistanceRange: { 0: "Unknown", 1: "Macro", 2: "Close view", 3: "Distant view" }, FileSource: { 3: "DSC" }, Components: { 0: "", 1: "Y", 2: "Cb", 3: "Cr", 4: "R", 5: "G", 6: "B" } }; function d(e) { return !!e.exifdata } function h(e, t) { function i(i) { var n = p(i); e.exifdata = n || {}; var s = function (e) { var t = new DataView(e); r; if (255 != t.getUint8(0) || 216 != t.getUint8(1)) return !1; var i = 2, n = e.byteLength, a = function (e, t) { return 56 === e.getUint8(t) && 66 === e.getUint8(t + 1) && 73 === e.getUint8(t + 2) && 77 === e.getUint8(t + 3) && 4 === e.getUint8(t + 4) && 4 === e.getUint8(t + 5) }; for (; i < n;) { if (a(t, i)) { var s = t.getUint8(i + 7); return s % 2 != 0 && (s += 1), 0 === s && (s = 4), m(e, i + 8 + s, t.getUint16(i + 6 + s)) } i++ } }(i); if (e.iptcdata = s || {}, a.isXmpEnabled) { var o = function (e) { if (!("DOMParser" in self)) return; var t = new DataView(e); r; if (255 != t.getUint8(0) || 216 != t.getUint8(1)) return !1; var i = 2, n = e.byteLength, a = new DOMParser; for (; i < n - 4;) { if ("http" == v(t, i, 4)) { var s = i - 1, o = t.getUint16(i - 2) - 1, u = v(t, s, o), l = u.indexOf("xmpmeta>") + 8, c = (u = u.substring(u.indexOf("<x:xmpmeta"), l)).indexOf("x:xmpmeta") + 10; return u = u.slice(0, c) + 'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" ' + u.slice(c), b(a.parseFromString(u, "text/xml")) } i++ } }(i); e.xmpdata = o || {} } t && t.call(e) } if (e.src) if (/^data\:/i.test(e.src)) i(function (e, t) { t = t || e.match(/^data\:([^\;]+)\;base64,/im)[1] || "", e = e.replace(/^data\:([^\;]+)\;base64,/gim, ""); for (var i = atob(e), n = i.length, r = new ArrayBuffer(n), a = new Uint8Array(r), s = 0; s < n; s++)a[s] = i.charCodeAt(s); return r }(e.src)); else if (/^blob\:/i.test(e.src)) { (s = new FileReader).onload = function (e) { i(e.target.result) }, function (e, t) { var i = new XMLHttpRequest; i.open("GET", e, !0), i.responseType = "blob", i.onload = function (e) { 200 != this.status && 0 !== this.status || t(this.response) }, i.send() }(e.src, (function (e) { s.readAsArrayBuffer(e) })) } else { var n = new XMLHttpRequest; n.onload = function () { if (200 != this.status && 0 !== this.status) throw "Could not load image"; i(n.response), n = null }, n.open("GET", e.src, !0), n.responseType = "arraybuffer", n.send(null) } else if (self.FileReader && (e instanceof self.Blob || e instanceof self.File)) { var s; (s = new FileReader).onload = function (e) { i(e.target.result) }, s.readAsArrayBuffer(e) } } function p(e) { var t = new DataView(e); if (255 != t.getUint8(0) || 216 != t.getUint8(1)) return !1; for (var i = 2, n = e.byteLength; i < n;) { if (255 != t.getUint8(i)) return !1; if (225 == t.getUint8(i + 1)) return y(t, i + 4, t.getUint16(i + 2)); i += 2 + t.getUint16(i + 2) } } var f = { 120: "caption", 110: "credit", 25: "keywords", 55: "dateCreated", 80: "byline", 85: "bylineTitle", 122: "captionWriter", 105: "headline", 116: "copyright", 15: "category" }; function m(e, t, i) { for (var n, r, a, s, o = new DataView(e), u = {}, l = t; l < t + i;)28 === o.getUint8(l) && 2 === o.getUint8(l + 1) && (s = o.getUint8(l + 2)) in f && ((a = o.getInt16(l + 3)) + 5, r = f[s], n = v(o, l + 5, a), u.hasOwnProperty(r) ? u[r] instanceof Array ? u[r].push(n) : u[r] = [u[r], n] : u[r] = n), l++; return u } function g(e, t, i, n, r) { var a, s, o = e.getUint16(i, !r), u = {}; for (s = 0; s < o; s++)a = i + 12 * s + 2, u[n[e.getUint16(a, !r)]] = A(e, a, t, i, r); return u } function A(e, t, i, n, r) { var a, s, o, u, l, c, d = e.getUint16(t + 2, !r), h = e.getUint32(t + 4, !r), p = e.getUint32(t + 8, !r) + i; switch (d) { case 1: case 7: if (1 == h) return e.getUint8(t + 8, !r); for (a = h > 4 ? p : t + 8, s = [], u = 0; u < h; u++)s[u] = e.getUint8(a + u); return s; case 2: return v(e, a = h > 4 ? p : t + 8, h - 1); case 3: if (1 == h) return e.getUint16(t + 8, !r); for (a = h > 2 ? p : t + 8, s = [], u = 0; u < h; u++)s[u] = e.getUint16(a + 2 * u, !r); return s; case 4: if (1 == h) return e.getUint32(t + 8, !r); for (s = [], u = 0; u < h; u++)s[u] = e.getUint32(p + 4 * u, !r); return s; case 5: if (1 == h) return l = e.getUint32(p, !r), c = e.getUint32(p + 4, !r), (o = new Number(l / c)).numerator = l, o.denominator = c, o; for (s = [], u = 0; u < h; u++)l = e.getUint32(p + 8 * u, !r), c = e.getUint32(p + 4 + 8 * u, !r), s[u] = new Number(l / c), s[u].numerator = l, s[u].denominator = c; return s; case 9: if (1 == h) return e.getInt32(t + 8, !r); for (s = [], u = 0; u < h; u++)s[u] = e.getInt32(p + 4 * u, !r); return s; case 10: if (1 == h) return e.getInt32(p, !r) / e.getInt32(p + 4, !r); for (s = [], u = 0; u < h; u++)s[u] = e.getInt32(p + 8 * u, !r) / e.getInt32(p + 4 + 8 * u, !r); return s } } function v(e, t, i) { var r = ""; for (n = t; n < t + i; n++)r += String.fromCharCode(e.getUint8(n)); return r } function y(e, t) { if ("Exif" != v(e, t, 4)) return !1; var i, n, r, a, d, h = t + 6; if (18761 == e.getUint16(h)) i = !1; else { if (19789 != e.getUint16(h)) return !1; i = !0 } if (42 != e.getUint16(h + 2, !i)) return !1; var p = e.getUint32(h + 4, !i); if (p < 8) return !1; if ((n = g(e, h, h + p, o, i)).ExifIFDPointer) for (r in a = g(e, h, h + n.ExifIFDPointer, s, i)) { switch (r) { case "LightSource": case "Flash": case "MeteringMode": case "ExposureProgram": case "SensingMethod": case "SceneCaptureType": case "SceneType": case "CustomRendered": case "WhiteBalance": case "GainControl": case "Contrast": case "Saturation": case "Sharpness": case "SubjectDistanceRange": case "FileSource": a[r] = c[r][a[r]]; break; case "ExifVersion": case "FlashpixVersion": a[r] = String.fromCharCode(a[r][0], a[r][1], a[r][2], a[r][3]); break; case "ComponentsConfiguration": a[r] = c.Components[a[r][0]] + c.Components[a[r][1]] + c.Components[a[r][2]] + c.Components[a[r][3]] }n[r] = a[r] } if (n.GPSInfoIFDPointer) for (r in d = g(e, h, h + n.GPSInfoIFDPointer, u, i)) { if ("GPSVersionID" === r) d[r] = d[r][0] + "." + d[r][1] + "." + d[r][2] + "." + d[r][3]; n[r] = d[r] } return n.thumbnail = function (e, t, i, n) { var r = function (e, t, i) { var n = e.getUint16(t, !i); return e.getUint32(t + 2 + 12 * n, !i) }(e, t + i, n); if (!r) return {}; if (r > e.byteLength) return {}; var a = g(e, t, t + r, l, n); if (a.Compression) switch (a.Compression) { case 6: if (a.JpegIFOffset && a.JpegIFByteCount) { var s = t + a.JpegIFOffset, o = a.JpegIFByteCount; a.blob = new Blob([new Uint8Array(e.buffer, s, o)], { type: "image/jpeg" }) } break; case 1: console.log("Thumbnail image format is TIFF, which is not implemented."); break; default: console.log("Unknown thumbnail image format '%s'", a.Compression) } else 2 == a.PhotometricInterpretation && console.log("Thumbnail image format is RGB, which is not implemented."); return a }(e, h, p, i), n } function _(e) { var t = {}; if (1 == e.nodeType) { if (e.attributes.length > 0) { t["@attributes"] = {}; for (var i = 0; i < e.attributes.length; i++) { var n = e.attributes.item(i); t["@attributes"][n.nodeName] = n.nodeValue } } } else if (3 == e.nodeType) return e.nodeValue; if (e.hasChildNodes()) for (var r = 0; r < e.childNodes.length; r++) { var a = e.childNodes.item(r), s = a.nodeName; if (null == t[s]) t[s] = _(a); else { if (null == t[s].push) { var o = t[s]; t[s] = [], t[s].push(o) } t[s].push(_(a)) } } return t } function b(e) { try { var t = {}; if (e.children.length > 0) for (var i = 0; i < e.children.length; i++) { var n = e.children.item(i), r = n.attributes; for (var a in r) { var s = r[a], o = s.nodeName, u = s.nodeValue; void 0 !== o && (t[o] = u) } var l = n.nodeName; if (void 0 === t[l]) t[l] = _(n); else { if (void 0 === t[l].push) { var c = t[l]; t[l] = [], t[l].push(c) } t[l].push(_(n)) } } else t = e.textContent; return t } catch (e) { console.log(e.message) } } a.enableXmp = function () { a.isXmpEnabled = !0 }, a.disableXmp = function () { a.isXmpEnabled = !1 }, a.getData = function (e, t) { return !((self.Image && e instanceof self.Image || self.HTMLImageElement && e instanceof self.HTMLImageElement) && !e.complete) && (d(e) ? t && t.call(e) : h(e, t), !0) }, a.getTag = function (e, t) { if (d(e)) return e.exifdata[t] }, a.getIptcTag = function (e, t) { if (d(e)) return e.iptcdata[t] }, a.getAllTags = function (e) { if (!d(e)) return {}; var t, i = e.exifdata, n = {}; for (t in i) i.hasOwnProperty(t) && (n[t] = i[t]); return n }, a.getAllIptcTags = function (e) { if (!d(e)) return {}; var t, i = e.iptcdata, n = {}; for (t in i) i.hasOwnProperty(t) && (n[t] = i[t]); return n }, a.pretty = function (e) { if (!d(e)) return ""; var t, i = e.exifdata, n = ""; for (t in i) i.hasOwnProperty(t) && ("object" == typeof i[t] ? i[t] instanceof Number ? n += t + " : " + i[t] + " [" + i[t].numerator + "/" + i[t].denominator + "]\r\n" : n += t + " : [" + i[t].length + " values]\r\n" : n += t + " : " + i[t] + "\r\n"); return n }, a.readFromBinaryFile = function (e) { return p(e) }, void 0 === (i = function () { return a }.apply(t, [])) || (e.exports = i) }).call(this) }, 89144: (e, t, i) => { var n, r = void 0 !== i.g ? i.g : "undefined" != typeof window ? window : {}, a = i(25893); "undefined" != typeof document ? n = document : (n = r["__GLOBAL_DOCUMENT_CACHE@4"]) || (n = r["__GLOBAL_DOCUMENT_CACHE@4"] = a), e.exports = n }, 58908: (e, t, i) => { var n; n = "undefined" != typeof window ? window : void 0 !== i.g ? i.g : "undefined" != typeof self ? self : {}, e.exports = n }, 27376: e => { e.exports = function (e) { if (!e) return !1; var i = t.call(e); return "[object Function]" === i || "function" == typeof e && "[object RegExp]" !== i || "undefined" != typeof window && (e === window.setTimeout || e === window.alert || e === window.confirm || e === window.prompt) }; var t = Object.prototype.toString }, 6512: (e, t, i) => { var n, r, a; r = [i(65311)], n = function (e) { if (void 0 === e) throw new Error("jQuery.textcomplete requires jQuery"); return function (e) { "use strict"; var t = function (e) { console.warn && console.warn(e) }, i = 1; e.fn.textcomplete = function (n, r) { var a = Array.prototype.slice.call(arguments); return this.each((function () { var s = this, o = e(this), u = o.data("textComplete"); if (u || (r || (r = {}), r._oid = i++, u = new e.fn.textcomplete.Completer(this, r), o.data("textComplete", u)), "string" == typeof n) { if (!u) return; a.shift(), u[n].apply(u, a), "destroy" === n && o.removeData("textComplete") } else e.each(n, (function (i) { e.each(["header", "footer", "placement", "maxCount"], (function (e) { i[e] && (u.option[e] = i[e], t(e + "as a strategy param is deprecated. Use option."), delete i[e]) })) })), u.register(e.fn.textcomplete.Strategy.parse(n, { el: s, $el: o })) })) } }(e), function (e) { "use strict"; var t = function (e) { var t, i; return function () { var n = Array.prototype.slice.call(arguments); if (t) i = n; else { t = !0; var r = this; n.unshift((function n() { if (i) { var a = i; i = void 0, a.unshift(n), e.apply(r, a) } else t = !1 })), e.apply(this, n) } } }, i = function (e) { return "[object String]" === Object.prototype.toString.call(e) }, n = 0, r = []; function a(t, i) { if (this.$el = e(t), this.id = "textcomplete" + n++, this.strategies = [], this.views = [], this.option = e.extend({}, a.defaults, i), !(this.$el.is("input[type=text]") || this.$el.is("input[type=search]") || this.$el.is("textarea") || t.isContentEditable || "true" == t.contentEditable)) throw new Error("textcomplete must be called on a Textarea or a ContentEditable."); if (t === t.ownerDocument.activeElement) this.initialize(); else { var s = this; this.$el.one("focus." + this.id, (function () { s.initialize() })), this.option.adapter && "CKEditor" != this.option.adapter || "undefined" == typeof CKEDITOR || !this.$el.is("textarea") || CKEDITOR.on("instanceReady", (function (t) { -1 == e.inArray(t.editor.id, r) && (r.push(t.editor.id), t.editor.on("focus", (function (i) { s.$el = e(t.editor.editable().$), s.option.adapter || (s.option.adapter = e.fn.textcomplete.CKEditor), s.option.ckeditor_instance = t.editor, s.initialize() }))) })) } } a.defaults = { appendTo: "body", className: "", dropdownClassName: "dropdown-menu textcomplete-dropdown", maxCount: 10, zIndex: "100", rightEdgeOffset: 30 }, e.extend(a.prototype, { id: null, option: null, strategies: null, adapter: null, dropdown: null, $el: null, $iframe: null, initialize: function () { var t, i, n = this.$el.get(0); if (this.$el.prop("ownerDocument") !== document && window.frames.length) for (var r = 0; r < window.frames.length; r++)if (this.$el.prop("ownerDocument") === window.frames[r].document) { this.$iframe = e(window.frames[r].frameElement); break } this.dropdown = new e.fn.textcomplete.Dropdown(n, this, this.option), this.option.adapter ? t = this.option.adapter : (i = this.$el.is("textarea") || this.$el.is("input[type=text]") || this.$el.is("input[type=search]") ? "number" == typeof n.selectionEnd ? "Textarea" : "IETextarea" : "ContentEditable", t = e.fn.textcomplete[i]), this.adapter = new t(n, this, this.option) }, destroy: function () { this.$el.off("." + this.id), this.adapter && this.adapter.destroy(), this.dropdown && this.dropdown.destroy(), this.$el = this.adapter = this.dropdown = null }, deactivate: function () { this.dropdown && this.dropdown.deactivate() }, trigger: function (e, t) { this.dropdown || this.initialize(), null != e || (e = this.adapter.getTextFromHeadToCaret()); var i = this._extractSearchQuery(e); if (i.length) { var n = i[1]; if (t && this._term === n && "" !== n) return; this._term = n, this._search.apply(this, i) } else this._term = null, this.dropdown.deactivate() }, fire: function (e) { var t = Array.prototype.slice.call(arguments, 1); return this.$el.trigger(e, t), this }, register: function (e) { Array.prototype.push.apply(this.strategies, e) }, select: function (e, t, i) { this._term = null, this.adapter.select(e, t, i), this.fire("change").fire("textComplete:select", e, t), this.adapter.focus() }, _clearAtNext: !0, _term: null, _extractSearchQuery: function (t) { for (var n = 0; n < this.strategies.length; n++) { var r = this.strategies[n], a = r.context(t); if (a || "" === a) { var s = e.isFunction(r.match) ? r.match(t) : r.match; i(a) && (t = a); var o = t.match(s); if (o) return [r, o[r.index], o] } } return [] }, _search: t((function (e, t, i, n) { var r = this; t.search(i, (function (n, a) { r.dropdown.shown || r.dropdown.activate(), r._clearAtNext && (r.dropdown.clear(), r._clearAtNext = !1), r.dropdown.setPosition(r.adapter.getCaretPosition()), r.dropdown.render(r._zip(n, t, i)), a || (e(), r._clearAtNext = !0) }), n) })), _zip: function (t, i, n) { return e.map(t, (function (e) { return { value: e, strategy: i, term: n } })) } }), e.fn.textcomplete.Completer = a }(e), function (e) { "use strict"; var t = e(window), i = function (e, t) { var i, n, r = t.strategy.idProperty; for (i = 0; i < e.length; i++)if ((n = e[i]).strategy === t.strategy) if (r) { if (n.value[r] === t.value[r]) return !0 } else if (n.value === t.value) return !0; return !1 }, n = {}; e(document).on("click", (function (t) { var i = t.originalEvent && t.originalEvent.keepTextCompleteDropdown; e.each(n, (function (e, t) { e !== i && t.deactivate() })) })); var r = { SKIP_DEFAULT: 0, KEY_UP: 1, KEY_DOWN: 2, KEY_ENTER: 3, KEY_PAGEUP: 4, KEY_PAGEDOWN: 5, KEY_ESCAPE: 6 }; function a(t, i, r) { this.$el = a.createElement(r), this.completer = i, this.id = i.id + "dropdown", this._data = [], this.$inputEl = e(t), this.option = r, r.listPosition && (this.setPosition = r.listPosition), r.height && this.$el.height(r.height); var s = this; e.each(["maxCount", "placement", "footer", "header", "noResultsMessage", "className"], (function (e, t) { null != r[t] && (s[t] = r[t]) })), this._bindEvents(t), n[this.id] = this } e.extend(a, { createElement: function (t) { var i = t.appendTo; return i instanceof e || (i = e(i)), e("<ul></ul>").addClass(t.dropdownClassName).attr("id", "textcomplete-dropdown-" + t._oid).css({ display: "none", left: 0, position: "absolute", zIndex: t.zIndex }).appendTo(i) } }), e.extend(a.prototype, { $el: null, $inputEl: null, completer: null, footer: null, header: null, id: null, maxCount: null, placement: "", shown: !1, data: [], className: "", destroy: function () { this.deactivate(), this.$el.off("." + this.id), this.$inputEl.off("." + this.id), this.clear(), this.$el.remove(), this.$el = this.$inputEl = this.completer = null, delete n[this.id] }, render: function (t) { var i = this._buildContents(t), n = e.map(t, (function (e) { return e.value })); if (t.length) { var r = t[0].strategy; r.id ? this.$el.attr("data-strategy", r.id) : this.$el.removeAttr("data-strategy"), this._renderHeader(n), this._renderFooter(n), i && (this._renderContents(i), this._fitToBottom(), this._fitToRight(), this._activateIndexedItem()), this._setScroll() } else this.noResultsMessage ? this._renderNoResultsMessage(n) : this.shown && this.deactivate() }, setPosition: function (i) { var n = "absolute"; return this.$inputEl.add(this.$inputEl.parents()).each((function () { return "absolute" !== e(this).css("position") && ("fixed" === e(this).css("position") ? (i.top -= t.scrollTop(), i.left -= t.scrollLeft(), n = "fixed", !1) : void 0) })), this.$el.css(this._applyPlacement(i)), this.$el.css({ position: n }), this }, clear: function () { this.$el.html(""), this.data = [], this._index = 0, this._$header = this._$footer = this._$noResultsMessage = null }, activate: function () { return this.shown || (this.clear(), this.$el.show(), this.className && this.$el.addClass(this.className), this.completer.fire("textComplete:show"), this.shown = !0), this }, deactivate: function () { return this.shown && (this.$el.hide(), this.className && this.$el.removeClass(this.className), this.completer.fire("textComplete:hide"), this.shown = !1), this }, isUp: function (e) { return 38 === e.keyCode || e.ctrlKey && 80 === e.keyCode }, isDown: function (e) { return 40 === e.keyCode || e.ctrlKey && 78 === e.keyCode }, isEnter: function (e) { return !(e.ctrlKey || e.altKey || e.metaKey || e.shiftKey) && (13 === e.keyCode || 9 === e.keyCode || !0 === this.option.completeOnSpace && 32 === e.keyCode) }, isPageup: function (e) { return 33 === e.keyCode }, isPagedown: function (e) { return 34 === e.keyCode }, isEscape: function (e) { return 27 === e.keyCode }, _data: null, _index: null, _$header: null, _$noResultsMessage: null, _$footer: null, _bindEvents: function () { this.$el.on("mousedown." + this.id, ".textcomplete-item", e.proxy(this._onClick, this)), this.$el.on("touchstart." + this.id, ".textcomplete-item", e.proxy(this._onClick, this)), this.$el.on("mouseover." + this.id, ".textcomplete-item", e.proxy(this._onMouseover, this)), this.$inputEl.on("keydown." + this.id, e.proxy(this._onKeydown, this)) }, _onClick: function (t) { var i = e(t.target); t.preventDefault(), t.originalEvent.keepTextCompleteDropdown = this.id, i.hasClass("textcomplete-item") || (i = i.closest(".textcomplete-item")); var n = this.data[parseInt(i.data("index"), 10)]; this.completer.select(n.value, n.strategy, t); var r = this; setTimeout((function () { r.deactivate(), "touchstart" === t.type && r.$inputEl.focus() }), 0) }, _onMouseover: function (t) { var i = e(t.target); t.preventDefault(), i.hasClass("textcomplete-item") || (i = i.closest(".textcomplete-item")), this._index = parseInt(i.data("index"), 10), this._activateIndexedItem() }, _onKeydown: function (t) { var i; if (this.shown) switch (e.isFunction(this.option.onKeydown) && (i = this.option.onKeydown(t, r)), null == i && (i = this._defaultKeydown(t)), i) { case r.KEY_UP: t.preventDefault(), this._up(); break; case r.KEY_DOWN: t.preventDefault(), this._down(); break; case r.KEY_ENTER: t.preventDefault(), this._enter(t); break; case r.KEY_PAGEUP: t.preventDefault(), this._pageup(); break; case r.KEY_PAGEDOWN: t.preventDefault(), this._pagedown(); break; case r.KEY_ESCAPE: t.preventDefault(), this.deactivate() } }, _defaultKeydown: function (e) { return this.isUp(e) ? r.KEY_UP : this.isDown(e) ? r.KEY_DOWN : this.isEnter(e) ? r.KEY_ENTER : this.isPageup(e) ? r.KEY_PAGEUP : this.isPagedown(e) ? r.KEY_PAGEDOWN : this.isEscape(e) ? r.KEY_ESCAPE : void 0 }, _up: function () { 0 === this._index ? this._index = this.data.length - 1 : this._index -= 1, this._activateIndexedItem(), this._setScroll() }, _down: function () { this._index === this.data.length - 1 ? this._index = 0 : this._index += 1, this._activateIndexedItem(), this._setScroll() }, _enter: function (e) { var t = this.data[parseInt(this._getActiveElement().data("index"), 10)]; this.completer.select(t.value, t.strategy, e), this.deactivate() }, _pageup: function () { var t = 0, i = this._getActiveElement().position().top - this.$el.innerHeight(); this.$el.children().each((function (n) { if (e(this).position().top + e(this).outerHeight() > i) return t = n, !1 })), this._index = t, this._activateIndexedItem(), this._setScroll() }, _pagedown: function () { var t = this.data.length - 1, i = this._getActiveElement().position().top + this.$el.innerHeight(); this.$el.children().each((function (n) { if (e(this).position().top > i) return t = n, !1 })), this._index = t, this._activateIndexedItem(), this._setScroll() }, _activateIndexedItem: function () { this.$el.find(".textcomplete-item.active").removeClass("active"), this._getActiveElement().addClass("active") }, _getActiveElement: function () { return this.$el.children(".textcomplete-item:nth(" + this._index + ")") }, _setScroll: function () { var e = this._getActiveElement(), t = e.position().top, i = e.outerHeight(), n = this.$el.innerHeight(), r = this.$el.scrollTop(); 0 === this._index || this._index == this.data.length - 1 || t < 0 ? this.$el.scrollTop(t + r) : t + i > n && this.$el.scrollTop(t + i + r - n) }, _buildContents: function (e) { var t, n, r, a = ""; for (n = 0; n < e.length && this.data.length !== this.maxCount; n++)t = e[n], i(this.data, t) || (r = this.data.length, this.data.push(t), a += '<li class="textcomplete-item" data-index="' + r + '"><a>', a += t.strategy.template(t.value, t.term), a += "</a></li>"); return a }, _renderHeader: function (t) { if (this.header) { this._$header || (this._$header = e('<li class="textcomplete-header"></li>').prependTo(this.$el)); var i = e.isFunction(this.header) ? this.header(t) : this.header; this._$header.html(i) } }, _renderFooter: function (t) { if (this.footer) { this._$footer || (this._$footer = e('<li class="textcomplete-footer"></li>').appendTo(this.$el)); var i = e.isFunction(this.footer) ? this.footer(t) : this.footer; this._$footer.html(i) } }, _renderNoResultsMessage: function (t) { if (this.noResultsMessage) { this._$noResultsMessage || (this._$noResultsMessage = e('<li class="textcomplete-no-results-message"></li>').appendTo(this.$el)); var i = e.isFunction(this.noResultsMessage) ? this.noResultsMessage(t) : this.noResultsMessage; this._$noResultsMessage.html(i) } }, _renderContents: function (e) { this._$footer ? this._$footer.before(e) : this.$el.append(e) }, _fitToBottom: function () { var e = t.scrollTop() + t.height(), i = this.$el.height(); this.$el.position().top + i > e && (this.completer.$iframe || this.$el.offset({ top: e - i })) }, _fitToRight: function () { for (var e, i = this.option.rightEdgeOffset, n = this.$el.offset().left, r = this.$el.width(), a = t.width() - i; n + r > a && (this.$el.offset({ left: n - i }), !((e = this.$el.offset().left) >= n));)n = e }, _applyPlacement: function (e) { return -1 !== this.placement.indexOf("top") ? e = { top: "auto", bottom: this.$el.parent().height() - e.top + e.lineHeight, left: e.left } : (e.bottom = "auto", delete e.lineHeight), -1 !== this.placement.indexOf("absleft") ? e.left = 0 : -1 !== this.placement.indexOf("absright") && (e.right = 0, e.left = "auto"), e } }), e.fn.textcomplete.Dropdown = a, e.extend(e.fn.textcomplete, r) }(e), function (e) { "use strict"; var t = function (e) { var t = {}; return function (i, n) { t[i] ? n(t[i]) : e.call(this, i, (function (e) { t[i] = (t[i] || []).concat(e), n.apply(null, arguments) })) } }; function i(i) { e.extend(this, i), this.cache && (this.search = t(this.search)) } i.parse = function (t, n) { return e.map(t, (function (e) { var t = new i(e); return t.el = n.el, t.$el = n.$el, t })) }, e.extend(i.prototype, { match: null, replace: null, search: null, id: null, cache: !1, context: function () { return !0 }, index: 2, template: function (e) { return e }, idProperty: null }), e.fn.textcomplete.Strategy = i }(e), function (e) { "use strict"; var t = Date.now || function () { return (new Date).getTime() }, i = function (e, i) { var n, r, a, s, o, u = function () { var l = t() - s; l < i ? n = setTimeout(u, i - l) : (n = null, o = e.apply(a, r), a = r = null) }; return function () { return a = this, r = arguments, s = t(), n || (n = setTimeout(u, i)), o } }; function n() { } e.extend(n.prototype, { id: null, completer: null, el: null, $el: null, option: null, initialize: function (t, n, r) { this.el = t, this.$el = e(t), this.id = n.id + this.constructor.name, this.completer = n, this.option = r, this.option.debounce && (this._onKeyup = i(this._onKeyup, this.option.debounce)), this._bindEvents() }, destroy: function () { this.$el.off("." + this.id), this.$el = this.el = this.completer = null }, select: function () { throw new Error("Not implemented") }, getCaretPosition: function () { var t = this._getCaretRelativePosition(), i = this.$el.offset(), n = this.option.appendTo; if (n) { n instanceof e || (n = e(n)); var r = n.offsetParent().offset(); i.top -= r.top, i.left -= r.left } return t.top += i.top, t.left += i.left, t }, focus: function () { this.$el.focus() }, _bindEvents: function () { this.$el.on("keyup." + this.id, e.proxy(this._onKeyup, this)) }, _onKeyup: function (e) { this._skipSearch(e) || this.completer.trigger(this.getTextFromHeadToCaret(), !0) }, _skipSearch: function (e) { switch (e.keyCode) { case 9: case 13: case 16: case 17: case 18: case 33: case 34: case 40: case 38: case 27: return !0 }if (e.ctrlKey) switch (e.keyCode) { case 78: case 80: return !0 } } }), e.fn.textcomplete.Adapter = n }(e), function (e) { "use strict"; function t(e, t, i) { this.initialize(e, t, i) } e.extend(t.prototype, e.fn.textcomplete.Adapter.prototype, { select: function (t, i, n) { var r, a = this.getTextFromHeadToCaret(), s = this.el.value.substring(this.el.selectionEnd), o = i.replace(t, n); void 0 !== o && (e.isArray(o) && (s = o[1] + s, o = o[0]), r = e.isFunction(i.match) ? i.match(a) : i.match, a = a.replace(r, o), this.$el.val(a + s), this.el.selectionStart = this.el.selectionEnd = a.length) }, getTextFromHeadToCaret: function () { return this.el.value.substring(0, this.el.selectionEnd) }, _getCaretRelativePosition: function () { var t = e.fn.textcomplete.getCaretCoordinates(this.el, this.el.selectionStart); return { top: t.top + this._calculateLineHeight() - this.$el.scrollTop(), left: t.left - this.$el.scrollLeft(), lineHeight: this._calculateLineHeight() } }, _calculateLineHeight: function () { var e = parseInt(this.$el.css("line-height"), 10); if (isNaN(e)) { var t = this.el.parentNode, i = document.createElement(this.el.nodeName), n = this.el.style; i.setAttribute("style", "margin:0px;padding:0px;font-family:" + n.fontFamily + ";font-size:" + n.fontSize), i.innerHTML = "test", t.appendChild(i), e = i.clientHeight, t.removeChild(i) } return e } }), e.fn.textcomplete.Textarea = t }(e), function (e) { "use strict"; var t = "吶"; function i(i, n, r) { this.initialize(i, n, r), e("<span>" + t + "</span>").css({ position: "absolute", top: -9999, left: -9999 }).insertBefore(i) } e.extend(i.prototype, e.fn.textcomplete.Textarea.prototype, { select: function (t, i, n) { var r, a = this.getTextFromHeadToCaret(), s = this.el.value.substring(a.length), o = i.replace(t, n); if (void 0 !== o) { e.isArray(o) && (s = o[1] + s, o = o[0]), r = e.isFunction(i.match) ? i.match(a) : i.match, a = a.replace(r, o), this.$el.val(a + s), this.el.focus(); var u = this.el.createTextRange(); u.collapse(!0), u.moveEnd("character", a.length), u.moveStart("character", a.length), u.select() } }, getTextFromHeadToCaret: function () { this.el.focus(); var e = document.selection.createRange(); e.moveStart("character", -this.el.value.length); var i = e.text.split(t); return 1 === i.length ? i[0] : i[1] } }), e.fn.textcomplete.IETextarea = i }(e), function (e) { "use strict"; function t(e, t, i) { this.initialize(e, t, i) } e.extend(t.prototype, e.fn.textcomplete.Adapter.prototype, { select: function (t, i, n) { var r = this.getTextFromHeadToCaret(), a = this.el.ownerDocument.getSelection(), s = a.getRangeAt(0), o = s.cloneRange(); o.selectNodeContents(s.startContainer); var u, l = o.toString().substring(s.startOffset), c = i.replace(t, n); if (void 0 !== c) { e.isArray(c) && (l = c[1] + l, c = c[0]), u = e.isFunction(i.match) ? i.match(r) : i.match, r = r.replace(u, c).replace(/ $/, "&nbsp"), s.selectNodeContents(s.startContainer), s.deleteContents(); var d = this.el.ownerDocument.createElement("div"); d.innerHTML = r; var h = this.el.ownerDocument.createElement("div"); h.innerHTML = l; for (var p, f, m = this.el.ownerDocument.createDocumentFragment(); p = d.firstChild;)f = m.appendChild(p); for (; p = h.firstChild;)m.appendChild(p); s.insertNode(m), s.setStartAfter(f), s.collapse(!0), a.removeAllRanges(), a.addRange(s) } }, _getCaretRelativePosition: function () { var t = this.el.ownerDocument.getSelection().getRangeAt(0).cloneRange(), i = t.endContainer.parentNode, n = this.el.ownerDocument.createElement("span"); t.insertNode(n), t.selectNodeContents(n), t.deleteContents(), setTimeout((function () { i.normalize() }), 0); var r = e(n), a = r.offset(); if (a.left -= this.$el.offset().left, a.top += r.height() - this.$el.offset().top, a.lineHeight = r.height(), this.completer.$iframe) { var s = this.completer.$iframe.offset(); a.top += s.top, a.left += s.left, a.top -= e(this.completer.$iframe[0].contentWindow.document).scrollTop() } return r.remove(), a }, getTextFromHeadToCaret: function () { var e = this.el.ownerDocument.getSelection().getRangeAt(0), t = e.cloneRange(); return t.selectNodeContents(e.startContainer), t.toString().substring(0, e.startOffset) } }), e.fn.textcomplete.ContentEditable = t }(e), function (e) { "use strict"; function t(e, t, i) { this.initialize(e, t, i) } e.extend(t.prototype, e.fn.textcomplete.ContentEditable.prototype, { _bindEvents: function () { var t = this; this.option.ckeditor_instance.on("key", (function (e) { var i = e.data; if (t._onKeyup(i), t.completer.dropdown.shown && t._skipSearch(i)) return !1 }), null, null, 1), this.$el.on("keyup." + this.id, e.proxy(this._onKeyup, this)) } }), e.fn.textcomplete.CKEditor = t }(e), function (e) { var t = ["direction", "boxSizing", "width", "height", "overflowX", "overflowY", "borderTopWidth", "borderRightWidth", "borderBottomWidth", "borderLeftWidth", "borderStyle", "paddingTop", "paddingRight", "paddingBottom", "paddingLeft", "fontStyle", "fontVariant", "fontWeight", "fontStretch", "fontSize", "fontSizeAdjust", "lineHeight", "fontFamily", "textAlign", "textTransform", "textIndent", "textDecoration", "letterSpacing", "wordSpacing", "tabSize", "MozTabSize"], i = "undefined" != typeof window, n = i && null != window.mozInnerScreenX; function r(e, r, a) { if (!i) throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser"); var s = a && a.debug || !1; if (s) { var o = document.querySelector("#input-textarea-caret-position-mirror-div"); o && o.parentNode.removeChild(o) } var u = document.createElement("div"); u.id = "input-textarea-caret-position-mirror-div", document.body.appendChild(u); var l = u.style, c = window.getComputedStyle ? getComputedStyle(e) : e.currentStyle; l.whiteSpace = "pre-wrap", "INPUT" !== e.nodeName && (l.wordWrap = "break-word"), l.position = "absolute", s || (l.visibility = "hidden"), t.forEach((function (e) { l[e] = c[e] })), n ? e.scrollHeight > parseInt(c.height) && (l.overflowY = "scroll") : l.overflow = "hidden", u.textContent = e.value.substring(0, r), "INPUT" === e.nodeName && (u.textContent = u.textContent.replace(/\s/g, " ")); var d = document.createElement("span"); d.textContent = e.value.substring(r) || ".", u.appendChild(d); var h = { top: d.offsetTop + parseInt(c.borderTopWidth), left: d.offsetLeft + parseInt(c.borderLeftWidth) }; return s ? d.style.backgroundColor = "#aaa" : document.body.removeChild(u), h } e.fn.textcomplete.getCaretCoordinates = r }(e), e }, void 0 === (a = "function" == typeof n ? n.apply(t, r) : n) || (e.exports = a) }, 27537: (e, t) => { function i(e) { if (e && "object" == typeof e) { var t = e.which || e.keyCode || e.charCode; t && (e = t) } if ("number" == typeof e) return s[e]; var i, a = String(e); return (i = n[a.toLowerCase()]) ? i : (i = r[a.toLowerCase()]) || (1 === a.length ? a.charCodeAt(0) : void 0) } i.isEventKey = function (e, t) { if (e && "object" == typeof e) { var i = e.which || e.keyCode || e.charCode; if (null == i) return !1; if ("string" == typeof t) { var a; if (a = n[t.toLowerCase()]) return a === i; if (a = r[t.toLowerCase()]) return a === i } else if ("number" == typeof t) return t === i; return !1 } }; var n = (t = e.exports = i).code = t.codes = { backspace: 8, tab: 9, enter: 13, shift: 16, ctrl: 17, alt: 18, "pause/break": 19, "caps lock": 20, esc: 27, space: 32, "page up": 33, "page down": 34, end: 35, home: 36, left: 37, up: 38, right: 39, down: 40, insert: 45, delete: 46, command: 91, "left command": 91, "right command": 93, "numpad *": 106, "numpad +": 107, "numpad -": 109, "numpad .": 110, "numpad /": 111, "num lock": 144, "scroll lock": 145, "my computer": 182, "my calculator": 183, ";": 186, "=": 187, ",": 188, "-": 189, ".": 190, "/": 191, "`": 192, "[": 219, "\\": 220, "]": 221, "'": 222 }, r = t.aliases = { windows: 91, "⇧": 16, "⌥": 18, "⌃": 17, "⌘": 91, ctl: 17, control: 17, option: 18, pause: 19, break: 19, caps: 20, return: 13, escape: 27, spc: 32, spacebar: 32, pgup: 33, pgdn: 34, ins: 45, del: 46, cmd: 91 }; for (a = 97; a < 123; a++)n[String.fromCharCode(a)] = a - 32; for (var a = 48; a < 58; a++)n[a - 48] = a; for (a = 1; a < 13; a++)n["f" + a] = a + 111; for (a = 0; a < 10; a++)n["numpad " + a] = a + 96; var s = t.names = t.title = {}; for (a in n) s[n[a]] = a; for (var o in r) n[o] = r[o] }, 84221: (e, t, i) => { var n = i(46894).getUint64; e.exports = function (e) { var t = new DataView(e.buffer, e.byteOffset, e.byteLength), i = { version: e[0], flags: new Uint8Array(e.subarray(1, 4)), references: [], referenceId: t.getUint32(4), timescale: t.getUint32(8) }, r = 12; 0 === i.version ? (i.earliestPresentationTime = t.getUint32(r), i.firstOffset = t.getUint32(r + 4), r += 8) : (i.earliestPresentationTime = n(e.subarray(r)), i.firstOffset = n(e.subarray(r + 8)), r += 16), r += 2; var a = t.getUint16(r); for (r += 2; a > 0; r += 12, a--)i.references.push({ referenceType: (128 & e[r]) >>> 7, referencedSize: 2147483647 & t.getUint32(r), subsegmentDuration: t.getUint32(r + 4), startsWithSap: !!(128 & e[r + 8]), sapType: (112 & e[r + 8]) >>> 4, sapDeltaTime: 268435455 & t.getUint32(r + 8) }); return i } }, 51489: e => { var t, i, n, r, a, s, o, u = 9e4; t = function (e) { return e * u }, i = function (e, t) { return e * t }, n = function (e) { return e / u }, r = function (e, t) { return e / t }, a = function (e, i) { return t(r(e, i)) }, s = function (e, t) { return i(n(e), t) }, o = function (e, t, i) { return n(i ? e : e - t) }, e.exports = { ONE_SECOND_IN_TS: u, secondsToVideoTs: t, secondsToAudioTs: i, videoTsToSeconds: n, audioTsToSeconds: r, audioTsToVideoTs: a, videoTsToAudioTs: s, metadataTsToSeconds: o } }, 46894: e => { var t = Math.pow(2, 32); e.exports = { getUint64: function (e) { var i, n = new DataView(e.buffer, e.byteOffset, e.byteLength); return n.getBigUint64 ? (i = n.getBigUint64(0)) < Number.MAX_SAFE_INTEGER ? Number(i) : i : n.getUint32(0) * t + n.getUint32(4) }, MAX_UINT32: t } }, 75974: e => { e.exports = function (e, t) { var i, n = null; try { i = JSON.parse(e, t) } catch (e) { n = e } return [n, i] } }, 81294: () => { jQuery.trumbowyg.langs.cs = { viewHTML: "Zobrazit HTML", formatting: "Formátování", p: "Odstavec", blockquote: "Citace", code: "Kód", header: "Nadpis", bold: "Tučné", italic: "Kurzíva", strikethrough: "Přeškrtnuté", underline: "Podtržené", strong: "Tučné", em: "Zvýraznit", del: "Smazat", unorderedList: "Netříděný seznam", orderedList: "Tříděný seznam", insertImage: "Vložit obrázek", insertVideo: "Vložit video", link: "Odkaz", createLink: "Vložit odkaz", unlink: "Smazat odkaz", justifyLeft: "Zarovnat doleva", justifyCenter: "Zarovnat na střed", justifyRight: "Zarovnat doprava", justifyFull: "Zarovnat do bloku", horizontalRule: "Vložit vodorovnou čáru", fullscreen: "Režim celé obrazovky", close: "Zavřít", submit: "Potvrdit", reset: "Zrušit", required: "Povinné", description: "Popis", title: "Nadpis", text: "Text" } }, 94951: () => { !function (e) { "use strict"; var t = { emojiList: ["&#x2049", "&#x2122", "&#x2139", "&#x2194", "&#x2195", "&#x2196", "&#x2197", "&#x2198", "&#x2199", "&#x2328", "&#x2600", "&#x2601", "&#x2602", "&#x2603", "&#x2604", "&#x2611", "&#x2614", "&#x2615", "&#x2618", "&#x2620", "&#x2622", "&#x2623", "&#x2626", "&#x2638", "&#x2639", "&#x2640", "&#x2642", "&#x2648", "&#x2649", "&#x2650", "&#x2651", "&#x2652", "&#x2653", "&#x2660", "&#x2663", "&#x2665", "&#x2666", "&#x2668", "&#x2692", "&#x2693", "&#x2694", "&#x2695", "&#x2696", "&#x2697", "&#x2699", "&#x2702", "&#x2705", "&#x2708", "&#x2709", "&#x2712", "&#x2714", "&#x2716", "&#x2721", "&#x2728", "&#x2733", "&#x2734", "&#x2744", "&#x2747", "&#x2753", "&#x2754", "&#x2755", "&#x2757", "&#x2763", "&#x2764", "&#x2795", "&#x2796", "&#x2797", "&#x2934", "&#x2935", "&#x3030", "&#x3297", "&#x3299", "&#x1F9E1", "&#x1F49B", "&#x1F49A", "&#x1F499", "&#x1F49C", "&#x1F5A4", "&#x1F90E", "&#x1F90D", "&#x1F494", "&#x1F495", "&#x1F49E", "&#x1F493", "&#x1F497", "&#x1F496", "&#x1F498", "&#x1F49D", "&#x1F49F", "&#x262E", "&#x271D", "&#x262A", "&#x1F549", "&#x1F52F", "&#x1F54E", "&#x262F", "&#x1F6D0", "&#x26CE", "&#x264A", "&#x264B", "&#x264C", "&#x264D", "&#x264E", "&#x264F", "&#x1F194", "&#x269B", "&#x1F251", "&#x1F4F4", "&#x1F4F3", "&#x1F236", "&#x1F21A", "&#x1F238", "&#x1F23A", "&#x1F237", "&#x1F19A", "&#x1F4AE", "&#x1F250", "&#x1F234", "&#x1F235", "&#x1F239", "&#x1F232", "&#x1F170", "&#x1F171", "&#x1F18E", "&#x1F191", "&#x1F17E", "&#x1F198", "&#x274C", "&#x2B55", "&#x1F6D1", "&#x26D4", "&#x1F4DB", "&#x1F6AB", "&#x1F4AF", "&#x1F4A2", "&#x1F6B7", "&#x1F6AF", "&#x1F6B3", "&#x1F6B1", "&#x1F51E", "&#x1F4F5", "&#x1F6AD", "&#x203C", "&#x1F505", "&#x1F506", "&#x303D", "&#x26A0", "&#x1F6B8", "&#x1F531", "&#x269C", "&#x1F530", "&#x267B", "&#x1F22F", "&#x1F4B9", "&#x274E", "&#x1F310", "&#x1F4A0", "&#x24C2", "&#x1F300", "&#x1F4A4", "&#x1F3E7", "&#x1F6BE", "&#x267F", "&#x1F17F", "&#x1F233", "&#x1F202", "&#x1F6C2", "&#x1F6C3", "&#x1F6C4", "&#x1F6C5", "&#x1F6B9", "&#x1F6BA", "&#x1F6BC", "&#x1F6BB", "&#x1F6AE", "&#x1F3A6", "&#x1F4F6", "&#x1F201", "&#x1F523", "&#x1F524", "&#x1F521", "&#x1F520", "&#x1F196", "&#x1F197", "&#x1F199", "&#x1F192", "&#x1F195", "&#x1F193", "&#x0030", "&#x0031", "&#x0032", "&#x0033", "&#x0034", "&#x0035", "&#x0036", "&#x0037", "&#x0038", "&#x0039", "&#x1F51F", "&#x1F522", "&#x0023", "&#x002A", "&#x23CF", "&#x25B6", "&#x23F8", "&#x23EF", "&#x23F9", "&#x23FA", "&#x23ED", "&#x23EE", "&#x23E9", "&#x23EA", "&#x23EB", "&#x23EC", "&#x25C0", "&#x1F53C", "&#x1F53D", "&#x27A1", "&#x2B05", "&#x2B06", "&#x2B07", "&#x21AA", "&#x21A9", "&#x1F500", "&#x1F501", "&#x1F502", "&#x1F504", "&#x1F503", "&#x1F3B5", "&#x1F3B6", "&#x267E", "&#x1F4B2", "&#x1F4B1", "&#x00A9", "&#x00AE", "&#x27B0", "&#x27BF", "&#x1F51A", "&#x1F519", "&#x1F51B", "&#x1F51D", "&#x1F51C", "&#x1F518", "&#x26AA", "&#x26AB", "&#x1F534", "&#x1F535", "&#x1F7E4", "&#x1F7E3", "&#x1F7E2", "&#x1F7E1", "&#x1F7E0", "&#x1F53A", "&#x1F53B", "&#x1F538", "&#x1F539", "&#x1F536", "&#x1F537", "&#x1F533", "&#x1F532", "&#x25AA", "&#x25AB", "&#x25FE", "&#x25FD", "&#x25FC", "&#x25FB", "&#x2B1B", "&#x2B1C", "&#x1F7E7", "&#x1F7E6", "&#x1F7E5", "&#x1F7EB", "&#x1F7EA", "&#x1F7E9", "&#x1F7E8", "&#x1F508", "&#x1F507", "&#x1F509", "&#x1F50A", "&#x1F514", "&#x1F515", "&#x1F4E3", "&#x1F4E2", "&#x1F5E8", "&#x1F441", "&#x1F4AC", "&#x1F4AD", "&#x1F5EF", "&#x1F0CF", "&#x1F3B4", "&#x1F004", "&#x1F550", "&#x1F551", "&#x1F552", "&#x1F553", "&#x1F554", "&#x1F555", "&#x1F556", "&#x1F557", "&#x1F558", "&#x1F559", "&#x1F55A", "&#x1F55B", "&#x1F55C", "&#x1F55D", "&#x1F55E", "&#x1F55F", "&#x1F560", "&#x1F561", "&#x1F562", "&#x1F563", "&#x1F564", "&#x1F565", "&#x1F566", "&#x1F567", "&#x26BD", "&#x1F3C0", "&#x1F3C8", "&#x26BE", "&#x1F94E", "&#x1F3BE", "&#x1F3D0", "&#x1F3C9", "&#x1F94F", "&#x1F3B1", "&#x1F3D3", "&#x1F3F8", "&#x1F3D2", "&#x1F3D1", "&#x1F94D", "&#x1F3CF", "&#x1F945", "&#x26F3", "&#x1F3F9", "&#x1F3A3", "&#x1F94A", "&#x1F94B", "&#x1F3BD", "&#x1F6F9", "&#x1F6F7", "&#x1FA82", "&#x26F8", "&#x1F94C", "&#x1F3BF", "&#x26F7", "&#x1F3C2", "&#x1F3CB", "&#x1F93C", "&#x1F938", "&#x26F9", "&#x1F93A", "&#x1F93E", "&#x1F3CC", "&#x1F3C7", "&#x1F9D8", "&#x1F3C4", "&#x1F3CA", "&#x1F93D", "&#x1F6A3", "&#x1F9D7", "&#x1F6B5", "&#x1F6B4", "&#x1F3C6", "&#x1F947", "&#x1F948", "&#x1F949", "&#x1F3C5", "&#x1F396", "&#x1F3F5", "&#x1F397", "&#x1F3AB", "&#x1F39F", "&#x1F3AA", "&#x1F939", "&#x1F3AD", "&#x1F3A8", "&#x1F3AC", "&#x1F3A4", "&#x1F3A7", "&#x1F3BC", "&#x1F3B9", "&#x1F941", "&#x1F3B7", "&#x1F3BA", "&#x1FA95", "&#x1F3B8", "&#x1F3BB", "&#x1F3B2", "&#x265F", "&#x1F3AF", "&#x1FA81", "&#x1FA80", "&#x1F3B3", "&#x1F3AE", "&#x1F3B0", "&#x1F9E9", "&#x231A", "&#x1F4F1", "&#x1F4F2", "&#x1F4BB", "&#x1F5A5", "&#x1F5A8", "&#x1F5B1", "&#x1F5B2", "&#x1F579", "&#x1F5DC", "&#x1F4BD", "&#x1F4BE", "&#x1F4BF", "&#x1F4C0", "&#x1F4FC", "&#x1F4F7", "&#x1F4F8", "&#x1F4F9", "&#x1F3A5", "&#x1F4FD", "&#x1F39E", "&#x1F4DE", "&#x260E", "&#x1F4DF", "&#x1F4E0", "&#x1F4FA", "&#x1F4FB", "&#x1F399", "&#x1F39A", "&#x1F39B", "&#x1F9ED", "&#x23F1", "&#x23F2", "&#x23F0", "&#x1F570", "&#x231B", "&#x23F3", "&#x1F4E1", "&#x1F50B", "&#x1F50C", "&#x1F4A1", "&#x1F526", "&#x1F56F", "&#x1F9EF", "&#x1F6E2", "&#x1F4B8", "&#x1F4B5", "&#x1F4B4", "&#x1F4B6", "&#x1F4B7", "&#x1F4B0", "&#x1F4B3", "&#x1F48E", "&#x1F9F0", "&#x1F527", "&#x1F528", "&#x1F6E0", "&#x26CF", "&#x1F529", "&#x1F9F1", "&#x26D3", "&#x1F9F2", "&#x1F52B", "&#x1F4A3", "&#x1F9E8", "&#x1FA93", "&#x1FA92", "&#x1F52A", "&#x1F5E1", "&#x1F6E1", "&#x1F6AC", "&#x26B0", "&#x26B1", "&#x1F3FA", "&#x1FA94", "&#x1F52E", "&#x1F4FF", "&#x1F9FF", "&#x1F488", "&#x1F52D", "&#x1F52C", "&#x1F573", "&#x1F9AF", "&#x1FA7A", "&#x1FA79", "&#x1F48A", "&#x1F489", "&#x1FA78", "&#x1F9EC", "&#x1F9A0", "&#x1F9EB", "&#x1F9EA", "&#x1F321", "&#x1FA91", "&#x1F9F9", "&#x1F9FA", "&#x1F9FB", "&#x1F6BD", "&#x1F6B0", "&#x1F6BF", "&#x1F6C1", "&#x1F6C0", "&#x1F9FC", "&#x1F9FD", "&#x1F9F4", "&#x1F6CE", "&#x1F511", "&#x1F5DD", "&#x1F6AA", "&#x1F6CB", "&#x1F6CF", "&#x1F6CC", "&#x1F9F8", "&#x1F5BC", "&#x1F6CD", "&#x1F6D2", "&#x1F381", "&#x1F388", "&#x1F38F", "&#x1F380", "&#x1F38A", "&#x1F389", "&#x1F38E", "&#x1F3EE", "&#x1F390", "&#x1F9E7", "&#x1F4E9", "&#x1F4E8", "&#x1F4E7", "&#x1F48C", "&#x1F4E5", "&#x1F4E4", "&#x1F4E6", "&#x1F3F7", "&#x1F4EA", "&#x1F4EB", "&#x1F4EC", "&#x1F4ED", "&#x1F4EE", "&#x1F4EF", "&#x1F4DC", "&#x1F4C3", "&#x1F4C4", "&#x1F4D1", "&#x1F9FE", "&#x1F4CA", "&#x1F4C8", "&#x1F4C9", "&#x1F5D2", "&#x1F5D3", "&#x1F4C6", "&#x1F4C5", "&#x1F5D1", "&#x1F4C7", "&#x1F5C3", "&#x1F5F3", "&#x1F5C4", "&#x1F4CB", "&#x1F4C1", "&#x1F4C2", "&#x1F5C2", "&#x1F5DE", "&#x1F4F0", "&#x1F4D3", "&#x1F4D4", "&#x1F4D2", "&#x1F4D5", "&#x1F4D7", "&#x1F4D8", "&#x1F4D9", "&#x1F4DA", "&#x1F4D6", "&#x1F516", "&#x1F9F7", "&#x1F517", "&#x1F4CE", "&#x1F587", "&#x1F4D0", "&#x1F4CF", "&#x1F9EE", "&#x1F4CC", "&#x1F4CD", "&#x1F58A", "&#x1F58B", "&#x1F58C", "&#x1F58D", "&#x1F4DD", "&#x270F", "&#x1F50D", "&#x1F50E", "&#x1F50F", "&#x1F510", "&#x1F512", "&#x1F513", "&#x1F436", "&#x1F431", "&#x1F42D", "&#x1F439", "&#x1F430", "&#x1F98A", "&#x1F43B", "&#x1F43C", "&#x1F428", "&#x1F42F", "&#x1F981", "&#x1F42E", "&#x1F437", "&#x1F43D", "&#x1F438", "&#x1F435", "&#x1F648", "&#x1F649", "&#x1F64A", "&#x1F412", "&#x1F414", "&#x1F427", "&#x1F426", "&#x1F424", "&#x1F423", "&#x1F425", "&#x1F986", "&#x1F985", "&#x1F989", "&#x1F987", "&#x1F43A", "&#x1F417", "&#x1F434", "&#x1F984", "&#x1F41D", "&#x1F41B", "&#x1F98B", "&#x1F40C", "&#x1F41A", "&#x1F41E", "&#x1F41C", "&#x1F99F", "&#x1F997", "&#x1F577", "&#x1F578", "&#x1F982", "&#x1F422", "&#x1F40D", "&#x1F98E", "&#x1F996", "&#x1F995", "&#x1F419", "&#x1F991", "&#x1F990", "&#x1F99E", "&#x1F9AA", "&#x1F980", "&#x1F421", "&#x1F420", "&#x1F41F", "&#x1F42C", "&#x1F433", "&#x1F40B", "&#x1F988", "&#x1F40A", "&#x1F405", "&#x1F406", "&#x1F993", "&#x1F98D", "&#x1F9A7", "&#x1F418", "&#x1F99B", "&#x1F98F", "&#x1F42A", "&#x1F42B", "&#x1F992", "&#x1F998", "&#x1F403", "&#x1F402", "&#x1F404", "&#x1F40E", "&#x1F416", "&#x1F40F", "&#x1F999", "&#x1F411", "&#x1F410", "&#x1F98C", "&#x1F415", "&#x1F9AE", "&#x1F429", "&#x1F408", "&#x1F413", "&#x1F983", "&#x1F99A", "&#x1F99C", "&#x1F9A2", "&#x1F9A9", "&#x1F54A", "&#x1F407", "&#x1F9A5", "&#x1F9A6", "&#x1F9A8", "&#x1F99D", "&#x1F9A1", "&#x1F401", "&#x1F400", "&#x1F43F", "&#x1F994", "&#x1F43E", "&#x1F409", "&#x1F432", "&#x1F335", "&#x1F384", "&#x1F332", "&#x1F333", "&#x1F334", "&#x1F331", "&#x1F33F", "&#x1F340", "&#x1F38D", "&#x1F38B", "&#x1F343", "&#x1F342", "&#x1F341", "&#x1F344", "&#x1F33E", "&#x1F490", "&#x1F337", "&#x1F339", "&#x1F940", "&#x1F33A", "&#x1F338", "&#x1F33C", "&#x1F33B", "&#x1F31E", "&#x1F31D", "&#x1F31B", "&#x1F31C", "&#x1F31A", "&#x1F315", "&#x1F316", "&#x1F317", "&#x1F318", "&#x1F311", "&#x1F312", "&#x1F313", "&#x1F314", "&#x1F319", "&#x1F30E", "&#x1F30D", "&#x1F30F", "&#x1FA90", "&#x1F4AB", "&#x2B50", "&#x1F31F", "&#x26A1", "&#x1F4A5", "&#x1F525", "&#x1F32A", "&#x1F308", "&#x1F324", "&#x26C5", "&#x1F325", "&#x1F326", "&#x1F327", "&#x26C8", "&#x1F329", "&#x1F328", "&#x26C4", "&#x1F32C", "&#x1F4A8", "&#x1F4A7", "&#x1F4A6", "&#x1F30A", "&#x1F32B", "&#x1F34F", "&#x1F34E", "&#x1F350", "&#x1F34A", "&#x1F34B", "&#x1F34C", "&#x1F349", "&#x1F347", "&#x1F353", "&#x1F348", "&#x1F352", "&#x1F351", "&#x1F96D", "&#x1F34D", "&#x1F965", "&#x1F95D", "&#x1F345", "&#x1F346", "&#x1F951", "&#x1F966", "&#x1F96C", "&#x1F952", "&#x1F336", "&#x1F33D", "&#x1F955", "&#x1F9C5", "&#x1F9C4", "&#x1F954", "&#x1F360", "&#x1F950", "&#x1F96F", "&#x1F35E", "&#x1F956", "&#x1F968", "&#x1F9C0", "&#x1F95A", "&#x1F373", "&#x1F95E", "&#x1F9C7", "&#x1F953", "&#x1F969", "&#x1F357", "&#x1F356", "&#x1F32D", "&#x1F354", "&#x1F35F", "&#x1F355", "&#x1F96A", "&#x1F9C6", "&#x1F959", "&#x1F32E", "&#x1F32F", "&#x1F957", "&#x1F958", "&#x1F96B", "&#x1F35D", "&#x1F35C", "&#x1F372", "&#x1F35B", "&#x1F363", "&#x1F371", "&#x1F95F", "&#x1F364", "&#x1F359", "&#x1F35A", "&#x1F358", "&#x1F365", "&#x1F960", "&#x1F96E", "&#x1F362", "&#x1F361", "&#x1F367", "&#x1F368", "&#x1F366", "&#x1F967", "&#x1F9C1", "&#x1F370", "&#x1F382", "&#x1F36E", "&#x1F36D", "&#x1F36C", "&#x1F36B", "&#x1F37F", "&#x1F369", "&#x1F36A", "&#x1F330", "&#x1F95C", "&#x1F36F", "&#x1F9C8", "&#x1F95B", "&#x1F37C", "&#x1F375", "&#x1F9C9", "&#x1F964", "&#x1F9C3", "&#x1F9CA", "&#x1F376", "&#x1F37A", "&#x1F37B", "&#x1F942", "&#x1F377", "&#x1F943", "&#x1F378", "&#x1F379", "&#x1F37E", "&#x1F944", "&#x1F374", "&#x1F37D", "&#x1F963", "&#x1F961", "&#x1F962", "&#x1F9C2", "&#x1F600", "&#x1F603", "&#x1F604", "&#x1F601", "&#x1F606", "&#x1F605", "&#x1F602", "&#x1F923", "&#x263A", "&#x1F60A", "&#x1F607", "&#x1F642", "&#x1F643", "&#x1F609", "&#x1F60C", "&#x1F60D", "&#x1F970", "&#x1F618", "&#x1F617", "&#x1F619", "&#x1F61A", "&#x1F60B", "&#x1F61B", "&#x1F61D", "&#x1F61C", "&#x1F92A", "&#x1F928", "&#x1F9D0", "&#x1F913", "&#x1F60E", "&#x1F929", "&#x1F973", "&#x1F60F", "&#x1F612", "&#x1F61E", "&#x1F614", "&#x1F61F", "&#x1F615", "&#x1F641", "&#x1F623", "&#x1F616", "&#x1F62B", "&#x1F629", "&#x1F97A", "&#x1F622", "&#x1F62D", "&#x1F624", "&#x1F620", "&#x1F621", "&#x1F92C", "&#x1F92F", "&#x1F633", "&#x1F975", "&#x1F976", "&#x1F631", "&#x1F628", "&#x1F630", "&#x1F625", "&#x1F613", "&#x1F917", "&#x1F914", "&#x1F92D", "&#x1F971", "&#x1F92B", "&#x1F925", "&#x1F636", "&#x1F610", "&#x1F611", "&#x1F62C", "&#x1F644", "&#x1F62F", "&#x1F626", "&#x1F627", "&#x1F62E", "&#x1F632", "&#x1F634", "&#x1F924", "&#x1F62A", "&#x1F635", "&#x1F910", "&#x1F974", "&#x1F922", "&#x1F92E", "&#x1F927", "&#x1F637", "&#x1F912", "&#x1F915", "&#x1F911", "&#x1F920", "&#x1F608", "&#x1F47F", "&#x1F479", "&#x1F47A", "&#x1F921", "&#x1F4A9", "&#x1F47B", "&#x1F480", "&#x1F47D", "&#x1F47E", "&#x1F916", "&#x1F383", "&#x1F63A", "&#x1F638", "&#x1F639", "&#x1F63B", "&#x1F63C", "&#x1F63D", "&#x1F640", "&#x1F63F", "&#x1F63E", "&#x1F932", "&#x1F450", "&#x1F64C", "&#x1F44F", "&#x1F91D", "&#x1F44D", "&#x1F44E", "&#x1F44A", "&#x270A", "&#x1F91B", "&#x1F91C", "&#x1F91E", "&#x270C", "&#x1F91F", "&#x1F918", "&#x1F44C", "&#x1F90F", "&#x1F448", "&#x1F449", "&#x1F446", "&#x1F447", "&#x261D", "&#x270B", "&#x1F91A", "&#x1F590", "&#x1F596", "&#x1F44B", "&#x1F919", "&#x1F4AA", "&#x1F9BE", "&#x1F595", "&#x270D", "&#x1F64F", "&#x1F9B6", "&#x1F9B5", "&#x1F9BF", "&#x1F484", "&#x1F48B", "&#x1F444", "&#x1F9B7", "&#x1F9B4", "&#x1F445", "&#x1F442", "&#x1F9BB", "&#x1F443", "&#x1F463", "&#x1F440", "&#x1F9E0", "&#x1F5E3", "&#x1F464", "&#x1F465", "&#x1F476", "&#x1F467", "&#x1F9D2", "&#x1F466", "&#x1F469", "&#x1F9D1", "&#x1F468", "&#x1F471", "&#x1F9D4", "&#x1F475", "&#x1F9D3", "&#x1F474", "&#x1F472", "&#x1F473", "&#x1F9D5", "&#x1F46E", "&#x1F477", "&#x1F482", "&#x1F575", "&#x1F470", "&#x1F935", "&#x1F478", "&#x1F934", "&#x1F9B8", "&#x1F9B9", "&#x1F936", "&#x1F385", "&#x1F9D9", "&#x1F9DD", "&#x1F9DB", "&#x1F9DF", "&#x1F9DE", "&#x1F9DC", "&#x1F9DA", "&#x1F47C", "&#x1F930", "&#x1F931", "&#x1F647", "&#x1F481", "&#x1F645", "&#x1F646", "&#x1F64B", "&#x1F9CF", "&#x1F926", "&#x1F937", "&#x1F64E", "&#x1F64D", "&#x1F487", "&#x1F486", "&#x1F9D6", "&#x1F485", "&#x1F933", "&#x1F483", "&#x1F57A", "&#x1F46F", "&#x1F574", "&#x1F6B6", "&#x1F3C3", "&#x1F9CD", "&#x1F9CE", "&#x1F46B", "&#x1F46D", "&#x1F46C", "&#x1F491", "&#x1F48F", "&#x1F46A", "&#x1F9F6", "&#x1F9F5", "&#x1F9E5", "&#x1F97C", "&#x1F9BA", "&#x1F45A", "&#x1F455", "&#x1F456", "&#x1FA73", "&#x1F454", "&#x1F457", "&#x1F459", "&#x1FA71", "&#x1F458", "&#x1F97B", "&#x1F97F", "&#x1F460", "&#x1F461", "&#x1F462", "&#x1FA70", "&#x1F45E", "&#x1F45F", "&#x1F97E", "&#x1FA72", "&#x1F9E6", "&#x1F9E4", "&#x1F9E3", "&#x1F3A9", "&#x1F9E2", "&#x1F452", "&#x1F393", "&#x26D1", "&#x1F451", "&#x1F48D", "&#x1F45D", "&#x1F45B", "&#x1F45C", "&#x1F4BC", "&#x1F392", "&#x1F9F3", "&#x1F453", "&#x1F576", "&#x1F97D", "&#x1F93F", "&#x1F302", "&#x1F9B1", "&#x1F9B0", "&#x1F9B3", "&#x1F9B2", "&#x1F697", "&#x1F695", "&#x1F699", "&#x1F68C", "&#x1F68E", "&#x1F3CE", "&#x1F693", "&#x1F691", "&#x1F692", "&#x1F690", "&#x1F69A", "&#x1F69B", "&#x1F69C", "&#x1F6FA", "&#x1F6F5", "&#x1F3CD", "&#x1F6F4", "&#x1F6B2", "&#x1F9BC", "&#x1F9BD", "&#x1F6A8", "&#x1F694", "&#x1F68D", "&#x1F698", "&#x1F696", "&#x1F6A1", "&#x1F6A0", "&#x1F69F", "&#x1F683", "&#x1F68B", "&#x1F69E", "&#x1F69D", "&#x1F684", "&#x1F685", "&#x1F688", "&#x1F682", "&#x1F686", "&#x1F687", "&#x1F68A", "&#x1F689", "&#x1F6EB", "&#x1F6EC", "&#x1F6E9", "&#x1F4BA", "&#x1F6F0", "&#x1F680", "&#x1F6F8", "&#x1F681", "&#x1F6F6", "&#x26F5", "&#x1F6A4", "&#x1F6E5", "&#x1F6F3", "&#x26F4", "&#x1F6A2", "&#x26FD", "&#x1F6A7", "&#x1F6A6", "&#x1F6A5", "&#x1F68F", "&#x1F5FA", "&#x1F5FF", "&#x1F5FD", "&#x1F5FC", "&#x1F3F0", "&#x1F3EF", "&#x1F3DF", "&#x1F3A1", "&#x1F3A2", "&#x1F3A0", "&#x26F2", "&#x26F1", "&#x1F3D6", "&#x1F3DD", "&#x1F3DC", "&#x1F30B", "&#x26F0", "&#x1F3D4", "&#x1F5FB", "&#x1F3D5", "&#x26FA", "&#x1F3E0", "&#x1F3E1", "&#x1F3D8", "&#x1F3DA", "&#x1F3D7", "&#x1F3ED", "&#x1F3E2", "&#x1F3EC", "&#x1F3E3", "&#x1F3E4", "&#x1F3E5", "&#x1F3E6", "&#x1F3E8", "&#x1F3EA", "&#x1F3EB", "&#x1F3E9", "&#x1F492", "&#x1F3DB", "&#x26EA", "&#x1F54C", "&#x1F6D5", "&#x1F54D", "&#x1F54B", "&#x26E9", "&#x1F6E4", "&#x1F6E3", "&#x1F5FE", "&#x1F391", "&#x1F3DE", "&#x1F305", "&#x1F304", "&#x1F320", "&#x1F387", "&#x1F386", "&#x1F307", "&#x1F306", "&#x1F3D9", "&#x1F303", "&#x1F30C", "&#x1F309", "&#x1F301", "&#x1F1FF", "&#x1F1FE", "&#x1F1FD", "&#x1F1FC", "&#x1F1FB", "&#x1F1FA", "&#x1F1F9", "&#x1F1F8", "&#x1F1F7", "&#x1F1F6", "&#x1F1F5", "&#x1F1F4", "&#x1F1F3", "&#x1F1F2", "&#x1F1F1", "&#x1F1F0", "&#x1F1EF", "&#x1F1EE", "&#x1F1ED", "&#x1F1EC", "&#x1F1EB", "&#x1F1EA", "&#x1F1E9", "&#x1F1E8", "&#x1F1E7", "&#x1F1E6", "&#x1F3F3", "&#x1F3F4", "&#x1F3C1", "&#x1F6A9", "&#x1F38C", "&#x1F3FB", "&#x1F3FC", "&#x1F3FD", "&#x1F3FE", "&#x1F3FF"] }; function i(t) { var i = []; return e.each(t.o.plugins.emoji.emojiList, (function (n, r) { if (e.isArray(r)) { var a = r[0], s = r[1], o = '<img src="' + s + '" alt="' + a + '">', u = "emoji-" + a.replace(/:/g, ""), l = { hasIcon: !1, text: o, fn: function () { return t.execCmd("insertImage", s, !1, !0), !0 } }; t.addBtnDef(u, l), i.push(u) } else { var c = "emoji-" + r.replace(/:/g, ""), d = { text: r, fn: function () { var e = String.fromCodePoint(r.replace("&#", "0")); return t.execCmd("insertText", e), !0 } }; t.addBtnDef(c, d), i.push(c) } })), i } e.extend(!0, e.trumbowyg, { langs: { en: { emoji: "Add an emoji" }, da: { emoji: "Tilføj et humørikon" }, de: { emoji: "Emoticon einfügen" }, et: { emoji: "Lisa emotikon" }, fr: { emoji: "Ajouter un emoji" }, hu: { emoji: "Emoji beszúrás" }, ja: { emoji: "絵文字の挿入" }, ko: { emoji: "이모지 넣기" }, ru: { emoji: "Вставить emoji" }, tr: { emoji: "Emoji ekle" }, zh_cn: { emoji: "添加表情" } }, plugins: { emoji: { init: function (e) { e.o.plugins.emoji = e.o.plugins.emoji || t; var n = { dropdown: i(e) }; e.addBtnDef("emoji", n) } } } }) }(jQuery) }, 54753: () => { jQuery.trumbowyg = { langs: { en: { viewHTML: "View HTML", undo: "Undo", redo: "Redo", formatting: "Formatting", p: "Paragraph", blockquote: "Quote", code: "Code", header: "Header", bold: "Bold", italic: "Italic", strikethrough: "Strikethrough", underline: "Underline", strong: "Strong", em: "Emphasis", del: "Deleted", superscript: "Superscript", subscript: "Subscript", unorderedList: "Unordered list", orderedList: "Ordered list", insertImage: "Insert Image", link: "Link", createLink: "Insert link", unlink: "Remove link", justifyLeft: "Align Left", justifyCenter: "Align Center", justifyRight: "Align Right", justifyFull: "Align Justify", horizontalRule: "Insert horizontal rule", removeformat: "Remove format", fullscreen: "Fullscreen", close: "Close", submit: "Confirm", reset: "Cancel", required: "Required", description: "Description", title: "Title", text: "Text", target: "Target", width: "Width" } }, plugins: {}, svgPath: null, svgAbsoluteUseHref: !1, hideButtonTexts: null }, Object.defineProperty(jQuery.trumbowyg, "defaultOptions", { value: { lang: "en", fixedBtnPane: !1, fixedFullWidth: !1, autogrow: !1, autogrowOnEnter: !1, imageWidthModalEdit: !1, hideButtonTexts: null, prefix: "trumbowyg-", tagClasses: {}, semantic: !0, semanticKeepAttributes: !1, resetCss: !1, removeformatPasted: !1, tabToIndent: !1, tagsToRemove: [], tagsToKeep: ["hr", "img", "embed", "iframe", "input"], btns: [["viewHTML"], ["undo", "redo"], ["formatting"], ["strong", "em", "del"], ["superscript", "subscript"], ["link"], ["insertImage"], ["justifyLeft", "justifyCenter", "justifyRight", "justifyFull"], ["unorderedList", "orderedList"], ["horizontalRule"], ["removeformat"], ["fullscreen"]], btnsDef: {}, changeActiveDropdownIcon: !1, inlineElementsSelector: "a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u", pasteHandlers: [], plugins: {}, urlProtocol: !1, minimalLinks: !1, defaultLinkTarget: void 0, svgPath: null }, writable: !1, enumerable: !0, configurable: !1 }), function (e, t, i, n) { "use strict"; var r = "tbwconfirm", a = "tbwcancel"; n.fn.trumbowyg = function (e, t) { var i = "trumbowyg"; if (e === Object(e) || !e) return this.each((function () { n(this).data(i) || n(this).data(i, new s(this, e)) })); if (1 === this.length) try { var r = n(this).data(i); switch (e) { case "execCmd": return r.execCmd(t.cmd, t.param, t.forceCss, t.skipTrumbowyg); case "openModal": return r.openModal(t.title, t.content); case "closeModal": return r.closeModal(); case "openModalInsert": return r.openModalInsert(t.title, t.fields, t.callback); case "saveRange": return r.saveRange(); case "getRange": return r.range; case "getRangeText": return r.getRangeText(); case "restoreRange": return r.restoreRange(); case "enable": return r.setDisabled(!1); case "disable": return r.setDisabled(!0); case "toggle": return r.toggle(); case "destroy": return r.destroy(); case "empty": return r.empty(); case "html": return r.html(t) } } catch (e) { } return !1 }; var s = function (r, a) { var s = this, o = "trumbowyg-icons", u = n.trumbowyg; s.doc = r.ownerDocument || i, s.$ta = n(r), s.$c = n(r), null != (a = a || {}).lang || null != u.langs[a.lang] ? s.lang = n.extend(!0, {}, u.langs.en, u.langs[a.lang]) : s.lang = u.langs.en, s.hideButtonTexts = null != u.hideButtonTexts ? u.hideButtonTexts : a.hideButtonTexts; var l = null != u.svgPath ? u.svgPath : a.svgPath; if (s.hasSvg = !1 !== l, !1 !== l && (u.svgAbsoluteUseHref || 0 === n("#trumbowyg-icons", s.doc).length)) { if (null == l) n("script[src]").each((function (e, t) { var i = t.src, n = i.match("trumbowyg(.min)?.js"); null != n && (l = i.substring(0, i.indexOf(n[0])) + "ui/icons.svg") })); if (null == l) console.warn("You must define svgPath: https://goo.gl/CfTY9U"); else if (!u.svgAbsoluteUseHref) { var c = s.doc.createElement("div"); c.id = o, s.doc.body.insertBefore(c, s.doc.body.childNodes[0]), n.ajax({ async: !0, type: "GET", contentType: "application/x-www-form-urlencoded; charset=UTF-8", dataType: "xml", crossDomain: !0, url: l, data: null, beforeSend: null, complete: null, success: function (e) { c.innerHTML = (new XMLSerializer).serializeToString(e.documentElement) } }) } } var d = s.doc.querySelector("base") ? t.location.href.split(/[?#]/)[0] : ""; s.svgPath = u.svgAbsoluteUseHref ? l : d; var h = s.lang.header, p = function () { return (t.chrome || t.Intl && Intl.v8BreakIterator) && "CSS" in t }; s.btnsDef = { viewHTML: { fn: "toggle", class: "trumbowyg-not-disable" }, undo: { isSupported: p, key: "Z" }, redo: { isSupported: p, key: "Y" }, p: { fn: "formatBlock" }, blockquote: { fn: "formatBlock" }, h1: { fn: "formatBlock", title: h + " 1" }, h2: { fn: "formatBlock", title: h + " 2" }, h3: { fn: "formatBlock", title: h + " 3" }, h4: { fn: "formatBlock", title: h + " 4" }, h5: { fn: "formatBlock", title: h + " 5" }, h6: { fn: "formatBlock", title: h + " 6" }, subscript: { tag: "sub" }, superscript: { tag: "sup" }, bold: { key: "B", tag: "b" }, italic: { key: "I", tag: "i" }, underline: { tag: "u" }, strikethrough: { tag: "strike" }, strong: { fn: "bold", key: "B" }, em: { fn: "italic", key: "I" }, del: { fn: "strikethrough" }, createLink: { key: "K", tag: "a" }, unlink: {}, insertImage: {}, justifyLeft: { tag: "left", forceCss: !0 }, justifyCenter: { tag: "center", forceCss: !0 }, justifyRight: { tag: "right", forceCss: !0 }, justifyFull: { tag: "justify", forceCss: !0 }, unorderedList: { fn: "insertUnorderedList", tag: "ul" }, orderedList: { fn: "insertOrderedList", tag: "ol" }, horizontalRule: { fn: "insertHorizontalRule" }, removeformat: {}, fullscreen: { class: "trumbowyg-not-disable" }, close: { fn: "destroy", class: "trumbowyg-not-disable" }, formatting: { dropdown: ["p", "blockquote", "h1", "h2", "h3", "h4"], ico: "p" }, link: { dropdown: ["createLink", "unlink"] } }, s.o = n.extend(!0, {}, u.defaultOptions, a), s.o.hasOwnProperty("imgDblClickHandler") || (s.o.imgDblClickHandler = s.getDefaultImgDblClickHandler()), s.urlPrefix = s.setupUrlPrefix(), s.disabled = s.o.disabled || "TEXTAREA" === r.nodeName && r.disabled, a.btns ? s.o.btns = a.btns : s.o.semantic || (s.o.btns[3] = ["bold", "italic", "underline", "strikethrough"]), n.each(s.o.btnsDef, (function (e, t) { s.addBtnDef(e, t) })), s.eventNamespace = "trumbowyg-event", s.keys = [], s.tagToButton = {}, s.tagHandlers = [], s.pasteHandlers = [].concat(s.o.pasteHandlers), s.isIE = -1 !== e.userAgent.indexOf("MSIE") || -1 !== e.appVersion.indexOf("Trident/"), s.isMac = -1 !== e.platform.toUpperCase().indexOf("MAC"), s.init() }; s.prototype = { DEFAULT_SEMANTIC_MAP: { b: "strong", i: "em", s: "del", strike: "del", div: "p" }, init: function () { var e = this; e.height = e.$ta.height(), e.initPlugins(); try { e.doc.execCommand("enableObjectResizing", !1, !1), e.doc.execCommand("defaultParagraphSeparator", !1, "p") } catch (e) { } e.buildEditor(), e.buildBtnPane(), e.fixedBtnPaneEvents(), e.buildOverlay(), setTimeout((function () { e.disabled && e.setDisabled(!0), e.$c.trigger("tbwinit") })) }, addBtnDef: function (e, t) { this.btnsDef[e] = n.extend(t, this.btnsDef[e] || {}) }, setupUrlPrefix: function () { var e = this.o.urlProtocol; if (e) return "string" != typeof e ? "https://" : e.replace("://", "") + "://" }, buildEditor: function () { var e = this, i = e.o.prefix, r = ""; e.$box = n("<div/>", { class: i + "box " + i + "editor-visible " + i + e.o.lang + " trumbowyg" }), e.isTextarea = e.$ta.is("textarea"), e.isTextarea ? (r = e.$ta.val(), e.$ed = n("<div/>"), e.$box.insertAfter(e.$ta).append(e.$ed, e.$ta)) : (e.$ed = e.$ta, r = e.$ed.html(), e.$ta = n("<textarea/>", { name: e.$ta.attr("id"), height: e.height }).val(r), e.$box.insertAfter(e.$ed).append(e.$ta, e.$ed), e.syncCode()), e.$ta.addClass(i + "textarea").attr("tabindex", -1), e.$ed.addClass(i + "editor").attr({ contenteditable: !0, dir: e.lang._dir || "ltr" }).html(r), e.o.tabindex && e.$ed.attr("tabindex", e.o.tabindex), e.$c.is("[placeholder]") && e.$ed.attr("placeholder", e.$c.attr("placeholder")), e.$c.is("[spellcheck]") && e.$ed.attr("spellcheck", e.$c.attr("spellcheck")), e.o.resetCss && e.$ed.addClass(i + "reset-css"), e.o.autogrow || e.$ta.add(e.$ed).css({ height: e.height }), e.semanticCode(), e.o.autogrowOnEnter && e.$ed.addClass(i + "autogrow-on-enter"); var a, s = !1, o = !1; e.$ed.on("dblclick", "img", e.o.imgDblClickHandler).on("keydown", (function (t) { var i = t.which; if (8 !== i && 13 !== i && 46 !== i || e.toggleSpan(!0), !t.ctrlKey && !t.metaKey || t.altKey) { if (e.o.tabToIndent && "Tab" === t.key) try { return t.shiftKey ? e.execCmd("outdent", !0, null) : e.execCmd("indent", !0, null), !1 } catch (e) { } } else { s = !0; var n = e.keys[String.fromCharCode(t.which).toUpperCase()]; try { return e.execCmd(n.fn, n.param), !1 } catch (e) { } } })).on("compositionstart compositionupdate", (function () { o = !0 })).on("keyup compositionend", (function (t) { if ("compositionend" === t.type) o = !1; else if (o) return; var i = t.which; if (!(i >= 37 && i <= 40)) { if (8 !== i && 13 !== i && 46 !== i || e.toggleSpan(), !t.ctrlKey && !t.metaKey || 89 !== i && 90 !== i) if (s || 17 === i) void 0 === t.which && e.semanticCode(!1, !1, !0); else { var n = !e.isIE || "compositionend" === t.type; e.semanticCode(!1, n && 13 === i), e.$c.trigger("tbwchange") } else e.semanticCode(!1, !0), e.$c.trigger("tbwchange"); setTimeout((function () { s = !1 }), 50) } })).on("mouseup keydown keyup", (function (t) { (!t.ctrlKey && !t.metaKey || t.altKey) && setTimeout((function () { s = !1 }), 50), clearTimeout(a), a = setTimeout((function () { e.updateButtonPaneStatus() }), 50) })).on("focus blur", (function (t) { if ("blur" === t.type && e.clearButtonPaneStatus(), e.$c.trigger("tbw" + t.type), e.o.autogrowOnEnter) { if (e.autogrowOnEnterDontClose) return; "focus" === t.type ? (e.autogrowOnEnterWasFocused = !0, e.autogrowEditorOnEnter()) : e.o.autogrow || (e.$ed.css({ height: e.$ed.css("min-height") }), e.$c.trigger("tbwresize")) } })).on("keyup focus", (function () { e.$ta.val().match(/<.*>/) || e.$ed.html().match(/<.*>/) || setTimeout((function () { var t = e.isIE ? "<p>" : "p"; e.doc.execCommand("formatBlock", !1, t), e.syncCode() }), 0) })).on("cut drop", (function () { setTimeout((function () { e.semanticCode(!1, !0), e.$c.trigger("tbwchange") }), 0) })).on("paste", (function (i) { if (e.o.removeformatPasted) { i.preventDefault(), t.getSelection && t.getSelection().deleteFromDocument && t.getSelection().deleteFromDocument(); try { var r = t.clipboardData.getData("Text"); try { e.doc.selection.createRange().pasteHTML(r) } catch (t) { e.doc.getSelection().getRangeAt(0).insertNode(e.doc.createTextNode(r)) } e.$c.trigger("tbwchange", i) } catch (t) { e.execCmd("insertText", (i.originalEvent || i).clipboardData.getData("text/plain")) } } n.each(e.pasteHandlers, (function (e, t) { t(i) })), setTimeout((function () { e.semanticCode(!1, !0), e.$c.trigger("tbwpaste", i), e.$c.trigger("tbwchange") }), 0) })), e.$ta.on("keyup", (function () { e.$c.trigger("tbwchange") })).on("paste", (function () { setTimeout((function () { e.$c.trigger("tbwchange") }), 0) })), n(e.doc.body).on("keydown." + e.eventNamespace, (function (t) { if (27 === t.which && n("." + i + "modal-box").length >= 1) return e.closeModal(), !1 })) }, autogrowEditorOnEnter: function () { var e = this; e.$ed.removeClass("autogrow-on-enter"); var t = e.$ed[0].clientHeight; e.$ed.height("auto"); var i = e.$ed[0].scrollHeight; e.$ed.addClass("autogrow-on-enter"), t !== i && (e.$ed.height(t), setTimeout((function () { e.$ed.css({ height: i }), e.$c.trigger("tbwresize") }), 0)) }, buildBtnPane: function () { var e = this, t = e.o.prefix, i = e.$btnPane = n("<div/>", { class: t + "button-pane" }); n.each(e.o.btns, (function (r, a) { n.isArray(a) || (a = [a]); var s = n("<div/>", { class: t + "button-group " + (a.indexOf("fullscreen") >= 0 ? t + "right" : "") }); n.each(a, (function (t, i) { try { e.isSupportedBtn(i) && s.append(e.buildBtn(i)) } catch (e) { } })), s.html().trim().length > 0 && i.append(s) })), e.$box.prepend(i) }, buildBtn: function (e) { var t = this, i = t.o.prefix, r = t.btnsDef[e], a = r.dropdown, s = null == r.hasIcon || r.hasIcon, o = t.lang[e] || e, u = n("<button/>", { type: "button", class: i + e + "-button " + (r.class || "") + (s ? "" : " " + i + "textual-button"), html: t.hasSvg && s ? '<svg><use xlink:href="' + t.svgPath + "#" + i + (r.ico || e).replace(/([A-Z]+)/g, "-$1").toLowerCase() + '"/></svg>' : t.hideButtonTexts ? "" : r.text || r.title || t.lang[e] || e, title: (r.title || r.text || o) + (r.key ? " (" + (t.isMac ? "Cmd" : "Ctrl") + " + " + r.key + ")" : ""), tabindex: -1, mousedown: function () { return a && !n("." + e + "-" + i + "dropdown", t.$box).is(":hidden") || n("body", t.doc).trigger("mousedown"), !((t.$btnPane.hasClass(i + "disable") || t.$box.hasClass(i + "disabled")) && !n(this).hasClass(i + "active") && !n(this).hasClass(i + "not-disable")) && (t.execCmd((!a ? r.fn : "dropdown") || e, r.param || e, r.forceCss), !1) } }); if (a) { u.addClass(i + "open-dropdown"); var l = i + "dropdown", c = { class: l + "-" + e + " " + l + " " + i + "fixed-top " + (r.dropdownClass || "") }; c["data-" + l] = e; var d = n("<div/>", c); n.each(a, (function (e, i) { t.btnsDef[i] && t.isSupportedBtn(i) && d.append(t.buildSubBtn(i)) })), t.$box.append(d.hide()) } else r.key && (t.keys[r.key] = { fn: r.fn || e, param: r.param || e }); return a || (t.tagToButton[(r.tag || e).toLowerCase()] = e), u }, buildSubBtn: function (e) { var t = this, i = t.o.prefix, r = t.btnsDef[e], a = null == r.hasIcon || r.hasIcon; return r.key && (t.keys[r.key] = { fn: r.fn || e, param: r.param || e }), t.tagToButton[(r.tag || e).toLowerCase()] = e, n("<button/>", { type: "button", class: i + e + "-dropdown-button " + (r.class || "") + (r.ico ? " " + i + r.ico + "-button" : ""), html: t.hasSvg && a ? '<svg><use xlink:href="' + t.svgPath + "#" + i + (r.ico || e).replace(/([A-Z]+)/g, "-$1").toLowerCase() + '"/></svg>' + (r.text || r.title || t.lang[e] || e) : r.text || r.title || t.lang[e] || e, title: r.key ? "(" + (t.isMac ? "Cmd" : "Ctrl") + " + " + r.key + ")" : null, style: r.style || null, mousedown: function () { return n("body", t.doc).trigger("mousedown"), t.execCmd(r.fn || e, r.param || e, r.forceCss), !1 } }) }, isSupportedBtn: function (e) { try { return this.btnsDef[e].isSupported() } catch (e) { } return !0 }, buildOverlay: function () { var e = this; return e.$overlay = n("<div/>", { class: e.o.prefix + "overlay" }).appendTo(e.$box), e.$overlay }, showOverlay: function () { var e = this; n(t).trigger("scroll"), e.$overlay.fadeIn(200), e.$box.addClass(e.o.prefix + "box-blur") }, hideOverlay: function () { var e = this; e.$overlay.fadeOut(50), e.$box.removeClass(e.o.prefix + "box-blur") }, fixedBtnPaneEvents: function () { var e = this, i = e.o.fixedFullWidth, r = e.$box; e.o.fixedBtnPane && (e.isFixed = !1, n(t).on("scroll." + e.eventNamespace + " resize." + e.eventNamespace, (function () { if (r) { e.syncCode(); var a = n(t).scrollTop(), s = r.offset().top + 1, o = e.$btnPane, u = o.outerHeight() - 2; a - s > 0 && a - s - e.height < 0 ? (e.isFixed || (e.isFixed = !0, o.css({ position: "fixed", top: 0, left: i ? 0 : "auto", zIndex: 7 }), e.$box.css({ paddingTop: o.height() })), o.css({ width: i ? "100%" : r.width() - 1 }), n("." + e.o.prefix + "fixed-top", r).css({ position: i ? "fixed" : "absolute", top: i ? u : u + (a - s), zIndex: 15 })) : e.isFixed && (e.isFixed = !1, o.removeAttr("style"), e.$box.css({ paddingTop: 0 }), n("." + e.o.prefix + "fixed-top", r).css({ position: "absolute", top: u })) } }))) }, setDisabled: function (e) { var t = this, i = t.o.prefix; t.disabled = e, e ? t.$ta.attr("disabled", !0) : t.$ta.removeAttr("disabled"), t.$box.toggleClass(i + "disabled", e), t.$ed.attr("contenteditable", !e) }, destroy: function () { var e = this, i = e.o.prefix; e.isTextarea ? e.$box.after(e.$ta.css({ height: "" }).val(e.html()).removeClass(i + "textarea").show()) : e.$box.after(e.$ed.css({ height: "" }).removeClass(i + "editor").removeAttr("contenteditable").removeAttr("dir").html(e.html()).show()), e.$ed.off("dblclick", "img"), e.destroyPlugins(), e.$box.remove(), e.$c.removeData("trumbowyg"), n("body").removeClass(i + "body-fullscreen"), e.$c.trigger("tbwclose"), n(t).off("scroll." + e.eventNamespace + " resize." + e.eventNamespace), n(e.doc.body).off("keydown." + e.eventNamespace) }, empty: function () { this.$ta.val(""), this.syncCode(!0) }, toggle: function () { var e = this, t = e.o.prefix; e.o.autogrowOnEnter && (e.autogrowOnEnterDontClose = !e.$box.hasClass(t + "editor-hidden")), e.semanticCode(!1, !0), e.$c.trigger("tbwchange"), setTimeout((function () { e.doc.activeElement.blur(), e.$box.toggleClass(t + "editor-hidden " + t + "editor-visible"), e.$btnPane.toggleClass(t + "disable"), n("." + t + "viewHTML-button", e.$btnPane).toggleClass(t + "active"), e.$box.hasClass(t + "editor-visible") ? e.$ta.attr("tabindex", -1) : e.$ta.removeAttr("tabindex"), e.o.autogrowOnEnter && !e.autogrowOnEnterDontClose && e.autogrowEditorOnEnter() }), 0) }, toggleSpan: function (e) { this.$ed.find("span").each((function () { !0 === e ? n(this).attr("data-tbw-flag", !0) : n(this).attr("data-tbw-flag") ? n(this).removeAttr("data-tbw-flag") : n(this).contents().unwrap() })) }, dropdown: function (e) { var i = this, r = n("body", i.doc), a = i.o.prefix, s = n("[data-" + a + "dropdown=" + e + "]", i.$box), o = n("." + a + e + "-button", i.$btnPane), u = s.is(":hidden"); if (r.trigger("mousedown"), u) { var l = o.offset().left; o.addClass(a + "active"), s.css({ position: "absolute", top: o.offset().top - i.$btnPane.offset().top + o.outerHeight(), left: i.o.fixedFullWidth && i.isFixed ? l : l - i.$btnPane.offset().left }).show(), n(t).trigger("scroll"), r.on("mousedown." + i.eventNamespace, (function (e) { s.is(e.target) || (n("." + a + "dropdown", i.$box).hide(), n("." + a + "active", i.$btnPane).removeClass(a + "active"), r.off("mousedown." + i.eventNamespace)) })) } }, html: function (e) { var t = this; return null != e ? (t.$ta.val(e), t.syncCode(!0), t.$c.trigger("tbwchange"), t) : t.$ta.val() }, syncTextarea: function () { var e = this; e.$ta.val(e.$ed.text().trim().length > 0 || e.$ed.find(e.o.tagsToKeep.join(",")).length > 0 ? e.$ed.html() : "") }, syncCode: function (e) { var t = this; if (!e && t.$ed.is(":visible")) t.syncTextarea(); else { var i = n("<div>").html(t.$ta.val()), r = n("<div>").append(i); n(t.o.tagsToRemove.join(","), r).remove(), t.$ed.html(r.contents().html()) } if (t.o.autogrow && (t.height = t.$ed.height(), t.height !== t.$ta.css("height") && (t.$ta.css({ height: t.height }), t.$c.trigger("tbwresize"))), t.o.autogrowOnEnter) { t.$ed.height("auto"); var a = t.autogrowOnEnterWasFocused ? t.$ed[0].scrollHeight : t.$ed.css("min-height"); a !== t.$ta.css("height") && (t.$ed.css({ height: a }), t.$c.trigger("tbwresize")) } }, semanticCode: function (e, t, i) { var r = this; r.saveRange(), r.syncCode(e); var a = !0; if (r.range && r.range.collapsed && (a = !1), r.o.semantic) { if (r.semanticTag("b", r.o.semanticKeepAttributes), r.semanticTag("i", r.o.semanticKeepAttributes), r.semanticTag("s", r.o.semanticKeepAttributes), r.semanticTag("strike", r.o.semanticKeepAttributes), t) { var s = r.o.inlineElementsSelector, o = ":not(" + s + ")"; r.$ed.contents().filter((function () { return 3 === this.nodeType && this.nodeValue.trim().length > 0 })).wrap("<span data-tbw/>"); var u = function (e) { if (0 !== e.length) { var t = e.nextUntil(o).addBack().wrapAll("<p/>").parent(), i = t.nextAll(s).first(); t.next("br").remove(), u(i) } }; u(r.$ed.children(s).first()), r.semanticTag("div", !0), n("[data-tbw]", r.$ed).contents().unwrap(), r.$ed.find("p:empty").remove() } !i && a && r.restoreRange(), r.syncTextarea() } }, semanticTag: function (e, t, i) { var r, a = this, s = e; if (null != this.o.semantic && "object" == typeof this.o.semantic && this.o.semantic.hasOwnProperty(e)) r = this.o.semantic[e]; else { if (!0 !== this.o.semantic || !this.DEFAULT_SEMANTIC_MAP.hasOwnProperty(e)) return; r = this.DEFAULT_SEMANTIC_MAP[e] } i && (e = r, r = s), n(e, this.$ed).each((function () { var e = !1, i = n(this); if (0 === i.contents().length) return !1; a.range && a.range.startContainer.parentNode === this && (e = !0); var s = n("<" + r + "/>"); s.insertBefore(i), t && n.each(i.prop("attributes"), (function () { s.attr(this.name, this.value) })), s.html(i.html()), i.remove(), !0 === e && (a.range.selectNodeContents(s.get(0)), a.range.collapse(!1)) })) }, createLink: function () { for (var e, t, i, r = this, a = r.doc.getSelection(), s = a.getRangeAt(0), o = a.focusNode, u = (new XMLSerializer).serializeToString(s.cloneContents()) || s + ""; ["A", "DIV"].indexOf(o.nodeName) < 0;)o = o.parentNode; if (o && "A" === o.nodeName) { var l = n(o); u = l.text(), e = l.attr("href"), r.o.minimalLinks || (t = l.attr("title"), i = l.attr("target") || r.o.defaultLinkTarget); var c = r.doc.createRange(); c.selectNode(o), a.removeAllRanges(), a.addRange(c) } r.saveRange(); var d = { url: { label: r.lang.linkUrl || "URL", required: !0, value: e }, text: { label: r.lang.text, value: u } }; r.o.minimalLinks || n.extend(d, { title: { label: r.lang.title, value: t }, target: { label: r.lang.target, value: i } }), r.openModalInsert(r.lang.createLink, d, (function (e) { var t = r.prependUrlPrefix(e.url); if (!t.length) return !1; var i = n(['<a href="', t, '">', e.text || e.url, "</a>"].join("")); return e.title && i.attr("title", e.title), (e.target || r.o.defaultLinkTarget) && i.attr("target", e.target || r.o.defaultLinkTarget), r.range.deleteContents(), r.range.insertNode(i[0]), r.syncCode(), r.$c.trigger("tbwchange"), !0 })) }, prependUrlPrefix: function (e) { if (!this.urlPrefix) return e; if (/^([a-z][-+.a-z0-9]*:|\/|#)/i.test(e)) return e; return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e) ? "mailto:" + e : this.urlPrefix + e }, unlink: function () { var e = this, t = e.doc.getSelection(), i = t.focusNode; if (t.isCollapsed) { for (; ["A", "DIV"].indexOf(i.nodeName) < 0;)i = i.parentNode; if (i && "A" === i.nodeName) { var n = e.doc.createRange(); n.selectNode(i), t.removeAllRanges(), t.addRange(n) } } e.execCmd("unlink", void 0, void 0, !0) }, insertImage: function () { var e = this; e.saveRange(); var t = { url: { label: "URL", required: !0 }, alt: { label: e.lang.description, value: e.getRangeText() } }; e.o.imageWidthModalEdit && (t.width = {}), e.openModalInsert(e.lang.insertImage, t, (function (t) { e.execCmd("insertImage", t.url, !1, !0); var i = n('img[src="' + t.url + '"]:not([alt])', e.$box); return i.attr("alt", t.alt), e.o.imageWidthModalEdit && i.attr({ width: t.width }), e.syncCode(), e.$c.trigger("tbwchange"), !0 })) }, fullscreen: function () { var e, i = this, r = i.o.prefix, a = r + "fullscreen", s = a + "-placeholder", o = i.$box.outerHeight(); i.$box.toggleClass(a), (e = i.$box.hasClass(a)) ? i.$box.before(n("<div/>", { class: s }).css({ height: o })) : n("." + s).remove(), n("body").toggleClass(r + "body-fullscreen", e), n(t).trigger("scroll"), i.$c.trigger("tbw" + (e ? "open" : "close") + "fullscreen") }, execCmd: function (e, i, r, a) { var s = this; a = !!a || "", "dropdown" !== e && s.$ed.focus(), "strikethrough" === e && s.o.semantic && s.semanticTag("strike", s.o.semanticKeepAttributes, !0); try { s.doc.execCommand("styleWithCSS", !1, r || !1) } catch (e) { } try { s[e + a](i) } catch (r) { try { e(i) } catch (r) { "insertHorizontalRule" === e ? i = void 0 : "formatBlock" === e && s.isIE && (i = "<" + i + ">"), s.doc.execCommand(e, !1, i), s.syncCode(), s.semanticCode(!1, !0); try { var o = t.getSelection().focusNode; n(t.getSelection().focusNode.parentNode).hasClass("trumbowyg-editor") || (o = t.getSelection().focusNode.parentNode); var u = s.o.tagClasses[i]; u && n(o).addClass(u) } catch (e) { } } "dropdown" !== e && (s.updateButtonPaneStatus(), s.$c.trigger("tbwchange")) } }, openModal: function (e, i, s) { var o = this, u = o.o.prefix; if (s = !1 !== s, n("." + u + "modal-box", o.$box).length > 0) return !1; o.o.autogrowOnEnter && (o.autogrowOnEnterDontClose = !0), o.saveRange(), o.showOverlay(), o.$btnPane.addClass(u + "disable"); var l, c = n("<div/>", { class: u + "modal " + u + "fixed-top" }).css({ top: o.$box.offset().top + o.$btnPane.height(), zIndex: 99999 }).appendTo(n(o.doc.body)); o.$overlay.one("click", (function () { return c.trigger(a), !1 })), l = s ? n("<form/>", { action: "", html: i }).on("submit", (function () { return c.trigger(r), !1 })).on("reset", (function () { return c.trigger(a), !1 })).on("submit reset", (function () { o.o.autogrowOnEnter && (o.autogrowOnEnterDontClose = !1) })) : i; var d = n("<div/>", { class: u + "modal-box", html: l }).css({ top: "-" + o.$btnPane.outerHeight(), opacity: 0, paddingBottom: s ? null : "5%" }).appendTo(c).animate({ top: 0, opacity: 1 }, 100); return e && n("<span/>", { text: e, class: u + "modal-title" }).prependTo(d), s && (n(":input:first", d).focus(), o.buildModalBtn("submit", d), o.buildModalBtn("reset", d), c.height(d.outerHeight() + 10)), n(t).trigger("scroll"), o.$c.trigger("tbwmodalopen"), c }, buildModalBtn: function (e, t) { var i = this.o.prefix; return n("<button/>", { class: i + "modal-button " + i + "modal-" + e, type: e, text: this.lang[e] || e }).appendTo(n("form", t)) }, closeModal: function () { var e = this, t = e.o.prefix; e.$btnPane.removeClass(t + "disable"), e.$overlay.off(); var i = n("." + t + "modal-box", n(e.doc.body)); i.animate({ top: "-" + i.height() }, 100, (function () { i.parent().remove(), e.hideOverlay(), e.$c.trigger("tbwmodalclose") })), e.restoreRange() }, openModalInsert: function (e, t, i) { var s = this, o = s.o.prefix, u = s.lang, l = "", c = o + "form-" + Date.now() + "-"; return n.each(t, (function (e, t) { var i = t.label || e, n = t.name || e, r = t.attributes || {}, a = c + e, s = Object.keys(r).map((function (e) { return e + '="' + r[e] + '"' })).join(" "); "function" == typeof t.type ? (t.name || (t.name = n), l += t.type(t, a, o, u)) : (l += '<div class="' + o + 'input-row"><div class="' + o + 'input-infos"><label for="' + a + '"><span>' + (u[i] ? u[i] : i) + '</span></label></div><div class="' + o + 'input-html"><input id="' + a + '" type="' + (t.type || "text") + '" name="' + n + '" ' + s, l += ("checkbox" === t.type && t.value ? ' checked="checked"' : "") + ' value="' + (t.value || "").replace(/"/g, "&quot;") + '"></div>', l += "</div>") })), s.openModal(e, l).on(r, (function () { var e = n("form", n(this)), a = !0, o = {}; n.each(t, (function (t, i) { var r = i.name || t, u = n(':input[name="' + r + '"]', e); switch (u[0].type.toLowerCase()) { case "checkbox": o[r] = u.is(":checked"); break; case "radio": o[r] = u.filter(":checked").val(); break; default: o[r] = n.trim(u.val()) }i.required && "" === o[r] ? (a = !1, s.addErrorOnModalField(u, s.lang.required)) : i.pattern && !i.pattern.test(o[r]) && (a = !1, s.addErrorOnModalField(u, i.patternError)) })), a && (s.restoreRange(), i(o, t) && (s.syncCode(), s.$c.trigger("tbwchange"), s.closeModal(), n(this).off(r))) })).one(a, (function () { n(this).off(r), s.closeModal() })) }, addErrorOnModalField: function (e, t) { var i = this.o.prefix, r = i + "msg-error", a = e.closest("." + i + "input-row"); e.on("change keyup", (function () { a.removeClass(i + "input-error"), setTimeout((function () { a.find("." + r).remove() }), 150) })), a.addClass(i + "input-error").find("." + i + "input-infos label").append(n("<span/>", { class: r, text: t })) }, getDefaultImgDblClickHandler: function () { var e = this; return function () { var t = n(this), i = t.attr("src"), r = "(Base64)"; 0 === i.indexOf("data:image") && (i = r); var a = { url: { label: "URL", value: i, required: !0 }, alt: { label: e.lang.description, value: t.attr("alt") } }; return e.o.imageWidthModalEdit && (a.width = { value: t.attr("width") ? t.attr("width") : "" }), e.openModalInsert(e.lang.insertImage, a, (function (i) { return i.url !== r && t.attr({ src: i.url }), t.attr({ alt: i.alt }), e.o.imageWidthModalEdit && (parseInt(i.width) > 0 ? t.attr({ width: i.width }) : t.removeAttr("width")), !0 })), !1 } }, saveRange: function () { var e = this, t = e.doc.getSelection(); if (e.range = null, t && t.rangeCount) { var i, n = e.range = t.getRangeAt(0), r = e.doc.createRange(); r.selectNodeContents(e.$ed[0]), r.setEnd(n.startContainer, n.startOffset), i = (r + "").length, e.metaRange = { start: i, end: i + (n + "").length } } }, restoreRange: function () { var e, t = this, i = t.metaRange, n = t.range, r = t.doc.getSelection(); if (n) { if (i && i.start !== i.end) { var a, s = 0, o = [t.$ed[0]], u = !1, l = !1; for (e = t.doc.createRange(); !l && (a = o.pop());)if (3 === a.nodeType) { var c = s + a.length; !u && i.start >= s && i.start <= c && (e.setStart(a, i.start - s), u = !0), u && i.end >= s && i.end <= c && (e.setEnd(a, i.end - s), l = !0), s = c } else for (var d = a.childNodes, h = d.length; h > 0;)h -= 1, o.push(d[h]) } try { r.removeAllRanges() } catch (e) { } r.addRange(e || n) } }, getRangeText: function () { return this.range + "" }, clearButtonPaneStatus: function () { var e = this, t = e.o.prefix, i = t + "active-button " + t + "active", r = t + "original-icon"; n("." + t + "active-button", e.$btnPane).removeClass(i), n("." + r, e.$btnPane).each((function () { n(this).find("svg use").attr("xlink:href", n(this).data(r)) })) }, updateButtonPaneStatus: function () { var e = this, t = e.o.prefix, i = t + "active-button " + t + "active", r = t + "original-icon", a = e.getTagsRecursive(e.doc.getSelection().focusNode); e.clearButtonPaneStatus(), n.each(a, (function (a, s) { var o = e.tagToButton[s.toLowerCase()], u = n("." + t + o + "-button", e.$btnPane); if (u.length > 0) u.addClass(i); else try { var l = (u = n("." + t + "dropdown ." + t + o + "-dropdown-button", e.$box)).find("svg use"), c = u.parent().data(t + "dropdown"), d = n("." + t + c + "-button", e.$box), h = d.find("svg use"); d.addClass(i), e.o.changeActiveDropdownIcon && l.length > 0 && (d.addClass(r).data(r, h.attr("xlink:href")), h.attr("xlink:href", l.attr("xlink:href"))) } catch (e) { } })) }, getTagsRecursive: function (e, t) { var i = this; if (t = t || (e && e.tagName ? [e.tagName] : []), !e || !e.parentNode) return t; var r = (e = e.parentNode).tagName; return "DIV" === r ? t : ("P" === r && "" !== e.style.textAlign && t.push(e.style.textAlign), n.each(i.tagHandlers, (function (n, r) { t = t.concat(r(e, i)) })), t.push(r), i.getTagsRecursive(e, t).filter((function (e) { return null != e }))) }, initPlugins: function () { var e = this; e.loadedPlugins = [], n.each(n.trumbowyg.plugins, (function (t, i) { i.shouldInit && !i.shouldInit(e) || (i.init(e), i.tagHandler && e.tagHandlers.push(i.tagHandler), e.loadedPlugins.push(i)) })) }, destroyPlugins: function () { var e = this; n.each(this.loadedPlugins, (function (t, i) { i.destroy && i.destroy(e) })) } } }(navigator, window, document, jQuery) }, 49945: function (e) { var t, i, n, r, a; t = /^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/, i = /^(?=([^\/?#]*))\1([^]*)$/, n = /(?:\/|^)\.(?=\/)/g, r = /(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g, a = { buildAbsoluteURL: function (e, t, n) { if (n = n || {}, e = e.trim(), !(t = t.trim())) { if (!n.alwaysNormalize) return e; var r = a.parseURL(e); if (!r) throw new Error("Error trying to parse base URL."); return r.path = a.normalizePath(r.path), a.buildURLFromParts(r) } var s = a.parseURL(t); if (!s) throw new Error("Error trying to parse relative URL."); if (s.scheme) return n.alwaysNormalize ? (s.path = a.normalizePath(s.path), a.buildURLFromParts(s)) : t; var o = a.parseURL(e); if (!o) throw new Error("Error trying to parse base URL."); if (!o.netLoc && o.path && "/" !== o.path[0]) { var u = i.exec(o.path); o.netLoc = u[1], o.path = u[2] } o.netLoc && !o.path && (o.path = "/"); var l = { scheme: o.scheme, netLoc: s.netLoc, path: null, params: s.params, query: s.query, fragment: s.fragment }; if (!s.netLoc && (l.netLoc = o.netLoc, "/" !== s.path[0])) if (s.path) { var c = o.path, d = c.substring(0, c.lastIndexOf("/") + 1) + s.path; l.path = a.normalizePath(d) } else l.path = o.path, s.params || (l.params = o.params, s.query || (l.query = o.query)); return null === l.path && (l.path = n.alwaysNormalize ? a.normalizePath(s.path) : s.path), a.buildURLFromParts(l) }, parseURL: function (e) { var i = t.exec(e); return i ? { scheme: i[1] || "", netLoc: i[2] || "", path: i[3] || "", params: i[4] || "", query: i[5] || "", fragment: i[6] || "" } : null }, normalizePath: function (e) { for (e = e.split("").reverse().join("").replace(n, ""); e.length !== (e = e.replace(r, "")).length;); return e.split("").reverse().join("") }, buildURLFromParts: function (e) { return e.scheme + e.netLoc + e.path + e.params + e.query + e.fragment } }, e.exports = a }, 93649: (e, t, i) => { "use strict"; i.r(t), i.d(t, { default: () => sc }); var n = i(58908), r = i.n(n), a = i(89144), s = i.n(a); function o() { return o = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var i = arguments[t]; for (var n in i) Object.prototype.hasOwnProperty.call(i, n) && (e[n] = i[n]) } return e }, o.apply(this, arguments) } var u = i(27537), l = i.n(u); function c(e) { if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return e } function d(e, t) { return d = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e }, d(e, t) } function h(e, t) { e.prototype = Object.create(t.prototype), e.prototype.constructor = e, d(e, t) } var p = i(75974), f = i.n(p), m = i(9603), g = i.n(m), A = i(13407), v = i.n(A); function y() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function () { }))), !0 } catch (e) { return !1 } } function _(e, t, i) { return _ = y() ? Reflect.construct : function (e, t, i) { var n = [null]; n.push.apply(n, t); var r = new (Function.bind.apply(e, n)); return i && d(r, i.prototype), r }, _.apply(null, arguments) } var b = i(49945), T = i.n(b), x = "http://example.com"; const S = function (e, t) { if (/^[a-z]+:/i.test(t)) return t; /^data:/.test(e) && (e = r().location && r().location.href || ""); var i = "function" == typeof r().URL, n = /^\/\//.test(e), a = !r().location && !/\/\//i.test(e); if (i ? e = new (r().URL)(e, r().location || x) : /\/\//i.test(e) || (e = T().buildAbsoluteURL(r().location && r().location.href || "", e)), i) { var s = new URL(t, e); return a ? s.href.slice(x.length) : n ? s.href.slice(s.protocol.length) : s.href } return T().buildAbsoluteURL(e, t) }; var E = function () { function e() { this.listeners = {} } var t = e.prototype; return t.on = function (e, t) { this.listeners[e] || (this.listeners[e] = []), this.listeners[e].push(t) }, t.off = function (e, t) { if (!this.listeners[e]) return !1; var i = this.listeners[e].indexOf(t); return this.listeners[e] = this.listeners[e].slice(0), this.listeners[e].splice(i, 1), i > -1 }, t.trigger = function (e) { var t = this.listeners[e]; if (t) if (2 === arguments.length) for (var i = t.length, n = 0; n < i; ++n)t[n].call(this, arguments[1]); else for (var r = Array.prototype.slice.call(arguments, 1), a = t.length, s = 0; s < a; ++s)t[s].apply(this, r) }, t.dispose = function () { this.listeners = {} }, t.pipe = function (e) { this.on("data", (function (t) { e.push(t) })) }, e }(); function C(e) { for (var t, i = (t = e, r().atob ? r().atob(t) : Buffer.from(t, "base64").toString("binary")), n = new Uint8Array(i.length), a = 0; a < i.length; a++)n[a] = i.charCodeAt(a); return n } var w, k, F, I = function (e) { function t() { var t; return (t = e.call(this) || this).buffer = "", t } return h(t, e), t.prototype.push = function (e) { var t; for (this.buffer += e, t = this.buffer.indexOf("\n"); t > -1; t = this.buffer.indexOf("\n"))this.trigger("data", this.buffer.substring(0, t)), this.buffer = this.buffer.substring(t + 1) }, t }(E), D = String.fromCharCode(9), P = function (e) { var t = /([0-9.]*)?@?([0-9.]*)?/.exec(e || ""), i = {}; return t[1] && (i.length = parseInt(t[1], 10)), t[2] && (i.offset = parseInt(t[2], 10)), i }, L = function (e) { for (var t, i = e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')), n = {}, r = i.length; r--;)"" !== i[r] && ((t = /([^=]*)=(.*)/.exec(i[r]).slice(1))[0] = t[0].replace(/^\s+|\s+$/g, ""), t[1] = t[1].replace(/^\s+|\s+$/g, ""), t[1] = t[1].replace(/^['"](.*)['"]$/g, "$1"), n[t[0]] = t[1]); return n }, O = function (e) { function t() { var t; return (t = e.call(this) || this).customParsers = [], t.tagMappers = [], t } h(t, e); var i = t.prototype; return i.push = function (e) { var t, i, n = this; 0 !== (e = e.trim()).length && ("#" === e[0] ? this.tagMappers.reduce((function (t, i) { var n = i(e); return n === e ? t : t.concat([n]) }), [e]).forEach((function (e) { for (var r = 0; r < n.customParsers.length; r++)if (n.customParsers[r].call(n, e)) return; if (0 === e.indexOf("#EXT")) if (e = e.replace("\r", ""), t = /^#EXTM3U/.exec(e)) n.trigger("data", { type: "tag", tagType: "m3u" }); else { if (t = /^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e)) return i = { type: "tag", tagType: "inf" }, t[1] && (i.duration = parseFloat(t[1])), t[2] && (i.title = t[2]), void n.trigger("data", i); if (t = /^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e)) return i = { type: "tag", tagType: "targetduration" }, t[1] && (i.duration = parseInt(t[1], 10)), void n.trigger("data", i); if (t = /^#EXT-X-VERSION:?([0-9.]*)?/.exec(e)) return i = { type: "tag", tagType: "version" }, t[1] && (i.version = parseInt(t[1], 10)), void n.trigger("data", i); if (t = /^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e)) return i = { type: "tag", tagType: "media-sequence" }, t[1] && (i.number = parseInt(t[1], 10)), void n.trigger("data", i); if (t = /^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e)) return i = { type: "tag", tagType: "discontinuity-sequence" }, t[1] && (i.number = parseInt(t[1], 10)), void n.trigger("data", i); if (t = /^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e)) return i = { type: "tag", tagType: "playlist-type" }, t[1] && (i.playlistType = t[1]), void n.trigger("data", i); if (t = /^#EXT-X-BYTERANGE:?(.*)?$/.exec(e)) return i = o(P(t[1]), { type: "tag", tagType: "byterange" }), void n.trigger("data", i); if (t = /^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e)) return i = { type: "tag", tagType: "allow-cache" }, t[1] && (i.allowed = !/NO/.test(t[1])), void n.trigger("data", i); if (t = /^#EXT-X-MAP:?(.*)$/.exec(e)) { if (i = { type: "tag", tagType: "map" }, t[1]) { var a = L(t[1]); a.URI && (i.uri = a.URI), a.BYTERANGE && (i.byterange = P(a.BYTERANGE)) } n.trigger("data", i) } else if (t = /^#EXT-X-STREAM-INF:?(.*)$/.exec(e)) { if (i = { type: "tag", tagType: "stream-inf" }, t[1]) { if (i.attributes = L(t[1]), i.attributes.RESOLUTION) { var s = i.attributes.RESOLUTION.split("x"), u = {}; s[0] && (u.width = parseInt(s[0], 10)), s[1] && (u.height = parseInt(s[1], 10)), i.attributes.RESOLUTION = u } i.attributes.BANDWIDTH && (i.attributes.BANDWIDTH = parseInt(i.attributes.BANDWIDTH, 10)), i.attributes["PROGRAM-ID"] && (i.attributes["PROGRAM-ID"] = parseInt(i.attributes["PROGRAM-ID"], 10)) } n.trigger("data", i) } else { if (t = /^#EXT-X-MEDIA:?(.*)$/.exec(e)) return i = { type: "tag", tagType: "media" }, t[1] && (i.attributes = L(t[1])), void n.trigger("data", i); if (t = /^#EXT-X-ENDLIST/.exec(e)) n.trigger("data", { type: "tag", tagType: "endlist" }); else if (t = /^#EXT-X-DISCONTINUITY/.exec(e)) n.trigger("data", { type: "tag", tagType: "discontinuity" }); else { if (t = /^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e)) return i = { type: "tag", tagType: "program-date-time" }, t[1] && (i.dateTimeString = t[1], i.dateTimeObject = new Date(t[1])), void n.trigger("data", i); if (t = /^#EXT-X-KEY:?(.*)$/.exec(e)) return i = { type: "tag", tagType: "key" }, t[1] && (i.attributes = L(t[1]), i.attributes.IV && ("0x" === i.attributes.IV.substring(0, 2).toLowerCase() && (i.attributes.IV = i.attributes.IV.substring(2)), i.attributes.IV = i.attributes.IV.match(/.{8}/g), i.attributes.IV[0] = parseInt(i.attributes.IV[0], 16), i.attributes.IV[1] = parseInt(i.attributes.IV[1], 16), i.attributes.IV[2] = parseInt(i.attributes.IV[2], 16), i.attributes.IV[3] = parseInt(i.attributes.IV[3], 16), i.attributes.IV = new Uint32Array(i.attributes.IV))), void n.trigger("data", i); if (t = /^#EXT-X-START:?(.*)$/.exec(e)) return i = { type: "tag", tagType: "start" }, t[1] && (i.attributes = L(t[1]), i.attributes["TIME-OFFSET"] = parseFloat(i.attributes["TIME-OFFSET"]), i.attributes.PRECISE = /YES/.test(i.attributes.PRECISE)), void n.trigger("data", i); if (t = /^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e)) return i = { type: "tag", tagType: "cue-out-cont" }, t[1] ? i.data = t[1] : i.data = "", void n.trigger("data", i); if (t = /^#EXT-X-CUE-OUT:?(.*)?$/.exec(e)) return i = { type: "tag", tagType: "cue-out" }, t[1] ? i.data = t[1] : i.data = "", void n.trigger("data", i); if (t = /^#EXT-X-CUE-IN:?(.*)?$/.exec(e)) return i = { type: "tag", tagType: "cue-in" }, t[1] ? i.data = t[1] : i.data = "", void n.trigger("data", i); if ((t = /^#EXT-X-SKIP:(.*)$/.exec(e)) && t[1]) return (i = { type: "tag", tagType: "skip" }).attributes = L(t[1]), i.attributes.hasOwnProperty("SKIPPED-SEGMENTS") && (i.attributes["SKIPPED-SEGMENTS"] = parseInt(i.attributes["SKIPPED-SEGMENTS"], 10)), i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES") && (i.attributes["RECENTLY-REMOVED-DATERANGES"] = i.attributes["RECENTLY-REMOVED-DATERANGES"].split(D)), void n.trigger("data", i); if ((t = /^#EXT-X-PART:(.*)$/.exec(e)) && t[1]) return (i = { type: "tag", tagType: "part" }).attributes = L(t[1]), ["DURATION"].forEach((function (e) { i.attributes.hasOwnProperty(e) && (i.attributes[e] = parseFloat(i.attributes[e])) })), ["INDEPENDENT", "GAP"].forEach((function (e) { i.attributes.hasOwnProperty(e) && (i.attributes[e] = /YES/.test(i.attributes[e])) })), i.attributes.hasOwnProperty("BYTERANGE") && (i.attributes.byterange = P(i.attributes.BYTERANGE)), void n.trigger("data", i); if ((t = /^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e)) && t[1]) return (i = { type: "tag", tagType: "server-control" }).attributes = L(t[1]), ["CAN-SKIP-UNTIL", "PART-HOLD-BACK", "HOLD-BACK"].forEach((function (e) { i.attributes.hasOwnProperty(e) && (i.attributes[e] = parseFloat(i.attributes[e])) })), ["CAN-SKIP-DATERANGES", "CAN-BLOCK-RELOAD"].forEach((function (e) { i.attributes.hasOwnProperty(e) && (i.attributes[e] = /YES/.test(i.attributes[e])) })), void n.trigger("data", i); if ((t = /^#EXT-X-PART-INF:(.*)$/.exec(e)) && t[1]) return (i = { type: "tag", tagType: "part-inf" }).attributes = L(t[1]), ["PART-TARGET"].forEach((function (e) { i.attributes.hasOwnProperty(e) && (i.attributes[e] = parseFloat(i.attributes[e])) })), void n.trigger("data", i); if ((t = /^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e)) && t[1]) return (i = { type: "tag", tagType: "preload-hint" }).attributes = L(t[1]), ["BYTERANGE-START", "BYTERANGE-LENGTH"].forEach((function (e) { if (i.attributes.hasOwnProperty(e)) { i.attributes[e] = parseInt(i.attributes[e], 10); var t = "BYTERANGE-LENGTH" === e ? "length" : "offset"; i.attributes.byterange = i.attributes.byterange || {}, i.attributes.byterange[t] = i.attributes[e], delete i.attributes[e] } })), void n.trigger("data", i); if ((t = /^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e)) && t[1]) return (i = { type: "tag", tagType: "rendition-report" }).attributes = L(t[1]), ["LAST-MSN", "LAST-PART"].forEach((function (e) { i.attributes.hasOwnProperty(e) && (i.attributes[e] = parseInt(i.attributes[e], 10)) })), void n.trigger("data", i); n.trigger("data", { type: "tag", data: e.slice(4) }) } } } else n.trigger("data", { type: "comment", text: e.slice(1) }) })) : this.trigger("data", { type: "uri", uri: e })) }, i.addParser = function (e) { var t = this, i = e.expression, n = e.customType, r = e.dataParser, a = e.segment; "function" != typeof r && (r = function (e) { return e }), this.customParsers.push((function (e) { if (i.exec(e)) return t.trigger("data", { type: "custom", data: r(e), customType: n, segment: a }), !0 })) }, i.addTagMapper = function (e) { var t = e.expression, i = e.map; this.tagMappers.push((function (e) { return t.test(e) ? i(e) : e })) }, t }(E), B = function (e) { var t = {}; return Object.keys(e).forEach((function (i) { var n; t[(n = i, n.toLowerCase().replace(/-(\w)/g, (function (e) { return e[1].toUpperCase() })))] = e[i] })), t }, R = function (e) { var t = e.serverControl, i = e.targetDuration, n = e.partTargetDuration; if (t) { var r = "#EXT-X-SERVER-CONTROL", a = "holdBack", s = "partHoldBack", o = i && 3 * i, u = n && 2 * n; i && !t.hasOwnProperty(a) && (t[a] = o, this.trigger("info", { message: r + " defaulting HOLD-BACK to targetDuration * 3 (" + o + ")." })), o && t[a] < o && (this.trigger("warn", { message: r + " clamping HOLD-BACK (" + t[a] + ") to targetDuration * 3 (" + o + ")" }), t[a] = o), n && !t.hasOwnProperty(s) && (t[s] = 3 * n, this.trigger("info", { message: r + " defaulting PART-HOLD-BACK to partTargetDuration * 3 (" + t[s] + ")." })), n && t[s] < u && (this.trigger("warn", { message: r + " clamping PART-HOLD-BACK (" + t[s] + ") to partTargetDuration * 2 (" + u + ")." }), t[s] = u) } }, M = function (e) { function t() { var t; (t = e.call(this) || this).lineStream = new I, t.parseStream = new O, t.lineStream.pipe(t.parseStream); var i, n, r = c(t), a = [], s = {}, u = !1, l = function () { }, d = { AUDIO: {}, VIDEO: {}, "CLOSED-CAPTIONS": {}, SUBTITLES: {} }, h = 0; t.manifest = { allowCache: !0, discontinuityStarts: [], segments: [] }; var p = 0, f = 0; return t.on("end", (function () { s.uri || !s.parts && !s.preloadHints || (!s.map && i && (s.map = i), !s.key && n && (s.key = n), s.timeline || "number" != typeof h || (s.timeline = h), t.manifest.preloadSegment = s) })), t.parseStream.on("data", (function (e) { var t, c; ({ tag: function () { ({ version: function () { e.version && (this.manifest.version = e.version) }, "allow-cache": function () { this.manifest.allowCache = e.allowed, "allowed" in e || (this.trigger("info", { message: "defaulting allowCache to YES" }), this.manifest.allowCache = !0) }, byterange: function () { var t = {}; "length" in e && (s.byterange = t, t.length = e.length, "offset" in e || (e.offset = p)), "offset" in e && (s.byterange = t, t.offset = e.offset), p = t.offset + t.length }, endlist: function () { this.manifest.endList = !0 }, inf: function () { "mediaSequence" in this.manifest || (this.manifest.mediaSequence = 0, this.trigger("info", { message: "defaulting media sequence to zero" })), "discontinuitySequence" in this.manifest || (this.manifest.discontinuitySequence = 0, this.trigger("info", { message: "defaulting discontinuity sequence to zero" })), e.duration > 0 && (s.duration = e.duration), 0 === e.duration && (s.duration = .01, this.trigger("info", { message: "updating zero segment duration to a small value" })), this.manifest.segments = a }, key: function () { if (e.attributes) if ("NONE" !== e.attributes.METHOD) if (e.attributes.URI) { if ("com.apple.streamingkeydelivery" === e.attributes.KEYFORMAT) return this.manifest.contentProtection = this.manifest.contentProtection || {}, void (this.manifest.contentProtection["com.apple.fps.1_0"] = { attributes: e.attributes }); if ("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed" === e.attributes.KEYFORMAT) { return -1 === ["SAMPLE-AES", "SAMPLE-AES-CTR", "SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD) ? void this.trigger("warn", { message: "invalid key method provided for Widevine" }) : ("SAMPLE-AES-CENC" === e.attributes.METHOD && this.trigger("warn", { message: "SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead" }), "data:text/plain;base64," !== e.attributes.URI.substring(0, 23) ? void this.trigger("warn", { message: "invalid key URI provided for Widevine" }) : e.attributes.KEYID && "0x" === e.attributes.KEYID.substring(0, 2) ? (this.manifest.contentProtection = this.manifest.contentProtection || {}, void (this.manifest.contentProtection["com.widevine.alpha"] = { attributes: { schemeIdUri: e.attributes.KEYFORMAT, keyId: e.attributes.KEYID.substring(2) }, pssh: C(e.attributes.URI.split(",")[1]) })) : void this.trigger("warn", { message: "invalid key ID provided for Widevine" })) } e.attributes.METHOD || this.trigger("warn", { message: "defaulting key method to AES-128" }), n = { method: e.attributes.METHOD || "AES-128", uri: e.attributes.URI }, void 0 !== e.attributes.IV && (n.iv = e.attributes.IV) } else this.trigger("warn", { message: "ignoring key declaration without URI" }); else n = null; else this.trigger("warn", { message: "ignoring key declaration without attribute list" }) }, "media-sequence": function () { isFinite(e.number) ? this.manifest.mediaSequence = e.number : this.trigger("warn", { message: "ignoring invalid media sequence: " + e.number }) }, "discontinuity-sequence": function () { isFinite(e.number) ? (this.manifest.discontinuitySequence = e.number, h = e.number) : this.trigger("warn", { message: "ignoring invalid discontinuity sequence: " + e.number }) }, "playlist-type": function () { /VOD|EVENT/.test(e.playlistType) ? this.manifest.playlistType = e.playlistType : this.trigger("warn", { message: "ignoring unknown playlist type: " + e.playlist }) }, map: function () { i = {}, e.uri && (i.uri = e.uri), e.byterange && (i.byterange = e.byterange), n && (i.key = n) }, "stream-inf": function () { this.manifest.playlists = a, this.manifest.mediaGroups = this.manifest.mediaGroups || d, e.attributes ? (s.attributes || (s.attributes = {}), o(s.attributes, e.attributes)) : this.trigger("warn", { message: "ignoring empty stream-inf attributes" }) }, media: function () { if (this.manifest.mediaGroups = this.manifest.mediaGroups || d, e.attributes && e.attributes.TYPE && e.attributes["GROUP-ID"] && e.attributes.NAME) { var i = this.manifest.mediaGroups[e.attributes.TYPE]; i[e.attributes["GROUP-ID"]] = i[e.attributes["GROUP-ID"]] || {}, t = i[e.attributes["GROUP-ID"]], (c = { default: /yes/i.test(e.attributes.DEFAULT) }).default ? c.autoselect = !0 : c.autoselect = /yes/i.test(e.attributes.AUTOSELECT), e.attributes.LANGUAGE && (c.language = e.attributes.LANGUAGE), e.attributes.URI && (c.uri = e.attributes.URI), e.attributes["INSTREAM-ID"] && (c.instreamId = e.attributes["INSTREAM-ID"]), e.attributes.CHARACTERISTICS && (c.characteristics = e.attributes.CHARACTERISTICS), e.attributes.FORCED && (c.forced = /yes/i.test(e.attributes.FORCED)), t[e.attributes.NAME] = c } else this.trigger("warn", { message: "ignoring incomplete or missing media group" }) }, discontinuity: function () { h += 1, s.discontinuity = !0, this.manifest.discontinuityStarts.push(a.length) }, "program-date-time": function () { void 0 === this.manifest.dateTimeString && (this.manifest.dateTimeString = e.dateTimeString, this.manifest.dateTimeObject = e.dateTimeObject), s.dateTimeString = e.dateTimeString, s.dateTimeObject = e.dateTimeObject }, targetduration: function () { !isFinite(e.duration) || e.duration < 0 ? this.trigger("warn", { message: "ignoring invalid target duration: " + e.duration }) : (this.manifest.targetDuration = e.duration, R.call(this, this.manifest)) }, start: function () { e.attributes && !isNaN(e.attributes["TIME-OFFSET"]) ? this.manifest.start = { timeOffset: e.attributes["TIME-OFFSET"], precise: e.attributes.PRECISE } : this.trigger("warn", { message: "ignoring start declaration without appropriate attribute list" }) }, "cue-out": function () { s.cueOut = e.data }, "cue-out-cont": function () { s.cueOutCont = e.data }, "cue-in": function () { s.cueIn = e.data }, skip: function () { this.manifest.skip = B(e.attributes), this.warnOnMissingAttributes_("#EXT-X-SKIP", e.attributes, ["SKIPPED-SEGMENTS"]) }, part: function () { var t = this; u = !0; var i = this.manifest.segments.length, n = B(e.attributes); s.parts = s.parts || [], s.parts.push(n), n.byterange && (n.byterange.hasOwnProperty("offset") || (n.byterange.offset = f), f = n.byterange.offset + n.byterange.length); var r = s.parts.length - 1; this.warnOnMissingAttributes_("#EXT-X-PART #" + r + " for segment #" + i, e.attributes, ["URI", "DURATION"]), this.manifest.renditionReports && this.manifest.renditionReports.forEach((function (e, i) { e.hasOwnProperty("lastPart") || t.trigger("warn", { message: "#EXT-X-RENDITION-REPORT #" + i + " lacks required attribute(s): LAST-PART" }) })) }, "server-control": function () { var t = this.manifest.serverControl = B(e.attributes); t.hasOwnProperty("canBlockReload") || (t.canBlockReload = !1, this.trigger("info", { message: "#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false" })), R.call(this, this.manifest), t.canSkipDateranges && !t.hasOwnProperty("canSkipUntil") && this.trigger("warn", { message: "#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set" }) }, "preload-hint": function () { var t = this.manifest.segments.length, i = B(e.attributes), n = i.type && "PART" === i.type; s.preloadHints = s.preloadHints || [], s.preloadHints.push(i), i.byterange && (i.byterange.hasOwnProperty("offset") || (i.byterange.offset = n ? f : 0, n && (f = i.byterange.offset + i.byterange.length))); var r = s.preloadHints.length - 1; if (this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #" + r + " for segment #" + t, e.attributes, ["TYPE", "URI"]), i.type) for (var a = 0; a < s.preloadHints.length - 1; a++) { var o = s.preloadHints[a]; o.type && (o.type === i.type && this.trigger("warn", { message: "#EXT-X-PRELOAD-HINT #" + r + " for segment #" + t + " has the same TYPE " + i.type + " as preload hint #" + a })) } }, "rendition-report": function () { var t = B(e.attributes); this.manifest.renditionReports = this.manifest.renditionReports || [], this.manifest.renditionReports.push(t); var i = this.manifest.renditionReports.length - 1, n = ["LAST-MSN", "URI"]; u && n.push("LAST-PART"), this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #" + i, e.attributes, n) }, "part-inf": function () { this.manifest.partInf = B(e.attributes), this.warnOnMissingAttributes_("#EXT-X-PART-INF", e.attributes, ["PART-TARGET"]), this.manifest.partInf.partTarget && (this.manifest.partTargetDuration = this.manifest.partInf.partTarget), R.call(this, this.manifest) } }[e.tagType] || l).call(r) }, uri: function () { s.uri = e.uri, a.push(s), this.manifest.targetDuration && !("duration" in s) && (this.trigger("warn", { message: "defaulting segment duration to the target duration" }), s.duration = this.manifest.targetDuration), n && (s.key = n), s.timeline = h, i && (s.map = i), f = 0, s = {} }, comment: function () { }, custom: function () { e.segment ? (s.custom = s.custom || {}, s.custom[e.customType] = e.data) : (this.manifest.custom = this.manifest.custom || {}, this.manifest.custom[e.customType] = e.data) } })[e.type].call(r) })), t } h(t, e); var i = t.prototype; return i.warnOnMissingAttributes_ = function (e, t, i) { var n = []; i.forEach((function (e) { t.hasOwnProperty(e) || n.push(e) })), n.length && this.trigger("warn", { message: e + " lacks required attribute(s): " + n.join(", ") }) }, i.push = function (e) { this.lineStream.push(e) }, i.end = function () { this.lineStream.push("\n"), this.trigger("end") }, i.addParser = function (e) { this.parseStream.addParser(e) }, i.addTagMapper = function (e) { this.parseStream.addTagMapper(e) }, t }(E), N = { mp4: /^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/, webm: /^(vp0?[89]|av0?1|opus|vorbis)/, ogg: /^(vp0?[89]|theora|flac|opus|vorbis)/, video: /^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/, audio: /^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/, text: /^(stpp.ttml.im1t)/, muxerVideo: /^(avc0?1)/, muxerAudio: /^(mp4a)/, muxerText: /a^/ }, U = ["video", "audio", "text"], j = ["Video", "Audio", "Text"], H = function (e) { return e ? e.replace(/avc1\.(\d+)\.(\d+)/i, (function (e, t, i) { return "avc1." + ("00" + Number(t).toString(16)).slice(-2) + "00" + ("00" + Number(i).toString(16)).slice(-2) })) : e }, V = function (e) { void 0 === e && (e = ""); var t = e.split(","), i = []; return t.forEach((function (e) { var t; e = e.trim(), U.forEach((function (n) { var r = N[n].exec(e.toLowerCase()); if (r && !(r.length <= 1)) { t = n; var a = e.substring(0, r[1].length), s = e.replace(a, ""); i.push({ type: a, details: s, mediaType: n }) } })), t || i.push({ type: e, details: "", mediaType: "unknown" }) })), i }, q = function (e) { return void 0 === e && (e = ""), N.audio.test(e.trim().toLowerCase()) }, W = function (e) { if (e && "string" == typeof e) { var t, i = e.toLowerCase().split(",").map((function (e) { return H(e.trim()) })), n = "video"; 1 === i.length && q(i[0]) ? n = "audio" : 1 === i.length && (void 0 === (t = i[0]) && (t = ""), N.text.test(t.trim().toLowerCase())) && (n = "application"); var r = "mp4"; return i.every((function (e) { return N.mp4.test(e) })) ? r = "mp4" : i.every((function (e) { return N.webm.test(e) })) ? r = "webm" : i.every((function (e) { return N.ogg.test(e) })) && (r = "ogg"), n + "/" + r + ';codecs="' + e + '"' } }, G = function (e) { return void 0 === e && (e = ""), r().MediaSource && r().MediaSource.isTypeSupported && r().MediaSource.isTypeSupported(W(e)) || !1 }, z = function (e) { return void 0 === e && (e = ""), e.toLowerCase().split(",").every((function (e) { e = e.trim(); for (var t = 0; t < j.length; t++) { if (N["muxer" + j[t]].test(e)) return !0 } return !1 })) }, Q = "mp4a.40.2", X = /^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i, $ = /^application\/dash\+xml/i, K = function (e) { return X.test(e) ? "hls" : $.test(e) ? "dash" : "application/vnd.videojs.vhs+json" === e ? "vhs-json" : null }, Y = i(3969), Z = function (e) { return !!e && "object" == typeof e }, J = function e() { for (var t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; return i.reduce((function (t, i) { return "object" != typeof i || Object.keys(i).forEach((function (n) { Array.isArray(t[n]) && Array.isArray(i[n]) ? t[n] = t[n].concat(i[n]) : Z(t[n]) && Z(i[n]) ? t[n] = e(t[n], i[n]) : t[n] = i[n] })), t }), {}) }, ee = function (e) { return Object.keys(e).map((function (t) { return e[t] })) }, te = function (e) { return e.reduce((function (e, t) { return e.concat(t) }), []) }, ie = function (e) { if (!e.length) return []; for (var t = [], i = 0; i < e.length; i++)t.push(e[i]); return t }, ne = function (e, t) { for (var i = 0; i < e.length; i++)if (t(e[i])) return i; return -1 }, re = "INVALID_NUMBER_OF_PERIOD", ae = "DASH_EMPTY_MANIFEST", se = "DASH_INVALID_XML", oe = "NO_BASE_URL", ue = "SEGMENT_TIME_UNSPECIFIED", le = "UNSUPPORTED_UTC_TIMING_SCHEME", ce = function (e) { var t = e.baseUrl, i = void 0 === t ? "" : t, n = e.source, a = void 0 === n ? "" : n, s = e.range, o = void 0 === s ? "" : s, u = e.indexRange, l = void 0 === u ? "" : u, c = { uri: a, resolvedUri: S(i || "", a) }; if (o || l) { var d, h = (o || l).split("-"), p = r().BigInt ? r().BigInt(h[0]) : parseInt(h[0], 10), f = r().BigInt ? r().BigInt(h[1]) : parseInt(h[1], 10); p < Number.MAX_SAFE_INTEGER && "bigint" == typeof p && (p = Number(p)), f < Number.MAX_SAFE_INTEGER && "bigint" == typeof f && (f = Number(f)), "bigint" == typeof (d = "bigint" == typeof f || "bigint" == typeof p ? r().BigInt(f) - r().BigInt(p) + r().BigInt(1) : f - p + 1) && d < Number.MAX_SAFE_INTEGER && (d = Number(d)), c.byterange = { length: d, offset: p } } return c }, de = function (e) { return e && "number" != typeof e && (e = parseInt(e, 10)), isNaN(e) ? null : e }, he = { static: function (e) { var t = e.duration, i = e.timescale, n = void 0 === i ? 1 : i, r = e.sourceDuration, a = e.periodDuration, s = de(e.endNumber), o = t / n; return "number" == typeof s ? { start: 0, end: s } : "number" == typeof a ? { start: 0, end: a / o } : { start: 0, end: r / o } }, dynamic: function (e) { var t = e.NOW, i = e.clientOffset, n = e.availabilityStartTime, r = e.timescale, a = void 0 === r ? 1 : r, s = e.duration, o = e.periodStart, u = void 0 === o ? 0 : o, l = e.minimumUpdatePeriod, c = void 0 === l ? 0 : l, d = e.timeShiftBufferDepth, h = void 0 === d ? 1 / 0 : d, p = de(e.endNumber), f = (t + i) / 1e3, m = n + u, g = f + c - m, A = Math.ceil(g * a / s), v = Math.floor((f - m - h) * a / s), y = Math.floor((f - m) * a / s); return { start: Math.max(0, v), end: "number" == typeof p ? p : Math.min(A, y) } } }, pe = function (e) { var t = e.type, i = e.duration, n = e.timescale, r = void 0 === n ? 1 : n, a = e.periodDuration, s = e.sourceDuration, o = he[t](e), u = function (e, t) { for (var i = [], n = e; n < t; n++)i.push(n); return i }(o.start, o.end).map(function (e) { return function (t) { var i = e.duration, n = e.timescale, r = void 0 === n ? 1 : n, a = e.periodStart, s = e.startNumber; return { number: (void 0 === s ? 1 : s) + t, duration: i / r, timeline: a, time: t * i } } }(e)); if ("static" === t) { var l = u.length - 1, c = "number" == typeof a ? a : s; u[l].duration = c - i / r * l } return u }, fe = function (e) { var t = e.baseUrl, i = e.initialization, n = void 0 === i ? {} : i, r = e.sourceDuration, a = e.indexRange, s = void 0 === a ? "" : a, o = e.periodStart, u = e.presentationTime, l = e.number, c = void 0 === l ? 0 : l, d = e.duration; if (!t) throw new Error(oe); var h = ce({ baseUrl: t, source: n.sourceURL, range: n.range }), p = ce({ baseUrl: t, source: t, indexRange: s }); if (p.map = h, d) { var f = pe(e); f.length && (p.duration = f[0].duration, p.timeline = f[0].timeline) } else r && (p.duration = r, p.timeline = o); return p.presentationTime = u || o, p.number = c, [p] }, me = function (e, t, i) { var n, a = e.sidx.map ? e.sidx.map : null, s = e.sidx.duration, o = e.timeline || 0, u = e.sidx.byterange, l = u.offset + u.length, c = t.timescale, d = t.references.filter((function (e) { return 1 !== e.referenceType })), h = [], p = e.endList ? "static" : "dynamic", f = e.sidx.timeline, m = f, g = e.mediaSequence || 0; n = "bigint" == typeof t.firstOffset ? r().BigInt(l) + t.firstOffset : l + t.firstOffset; for (var A = 0; A < d.length; A++) { var v = t.references[A], y = v.referencedSize, _ = v.subsegmentDuration, b = void 0; b = "bigint" == typeof n ? n + r().BigInt(y) - r().BigInt(1) : n + y - 1; var T = fe({ baseUrl: i, timescale: c, timeline: o, periodStart: f, presentationTime: m, number: g, duration: _, sourceDuration: s, indexRange: n + "-" + b, type: p })[0]; a && (T.map = a), h.push(T), n += "bigint" == typeof n ? r().BigInt(y) : y, m += _ / c, g++ } return e.segments = h, e }, ge = ["AUDIO", "SUBTITLES"], Ae = function (e) { return (t = e, i = function (e) { return e.timeline }, ee(t.reduce((function (e, t) { return t.forEach((function (t) { e[i(t)] = t })), e }), {}))).sort((function (e, t) { return e.timeline > t.timeline ? 1 : -1 })); var t, i }, ve = function (e) { var t, i, n = []; return t = e, i = function (e, t, i, r) { n = n.concat(e.playlists || []) }, ge.forEach((function (e) { for (var n in t.mediaGroups[e]) for (var r in t.mediaGroups[e][n]) { var a = t.mediaGroups[e][n][r]; i(a, e, n, r) } })), n }, ye = function (e) { var t = e.playlist, i = e.mediaSequence; t.mediaSequence = i, t.segments.forEach((function (e, i) { e.number = t.mediaSequence + i })) }, _e = function (e) { var t = e.oldManifest, i = e.newManifest, n = t.playlists.concat(ve(t)), r = i.playlists.concat(ve(i)); return i.timelineStarts = Ae([t.timelineStarts, i.timelineStarts]), function (e) { var t = e.oldPlaylists, i = e.newPlaylists, n = e.timelineStarts; i.forEach((function (e) { e.discontinuitySequence = ne(n, (function (t) { return t.timeline === e.timeline })); var i = function (e, t) { for (var i = 0; i < e.length; i++)if (e[i].attributes.NAME === t) return e[i]; return null }(t, e.attributes.NAME); if (i && !e.sidx) { var r = e.segments[0], a = ne(i.segments, (function (e) { return Math.abs(e.presentationTime - r.presentationTime) < .016666666666666666 })); if (-1 === a) return ye({ playlist: e, mediaSequence: i.mediaSequence + i.segments.length }), e.segments[0].discontinuity = !0, e.discontinuityStarts.unshift(0), void ((!i.segments.length && e.timeline > i.timeline || i.segments.length && e.timeline > i.segments[i.segments.length - 1].timeline) && e.discontinuitySequence--); i.segments[a].discontinuity && !r.discontinuity && (r.discontinuity = !0, e.discontinuityStarts.unshift(0), e.discontinuitySequence--), ye({ playlist: e, mediaSequence: i.segments[a].number }) } })) }({ oldPlaylists: n, newPlaylists: r, timelineStarts: i.timelineStarts }), i }, be = function (e) { return e && e.uri + "-" + (t = e.byterange, i = "bigint" == typeof t.offset || "bigint" == typeof t.length ? r().BigInt(t.offset) + r().BigInt(t.length) - r().BigInt(1) : t.offset + t.length - 1, t.offset + "-" + i); var t, i }, Te = function (e) { return ee(e.reduce((function (e, t) { var i = t.attributes.id + (t.attributes.lang || ""); if (e[i]) { var n; if (t.segments) t.segments[0] && (t.segments[0].discontinuity = !0), (n = e[i].segments).push.apply(n, t.segments); t.attributes.contentProtection && (e[i].attributes.contentProtection = t.attributes.contentProtection) } else e[i] = t, e[i].attributes.timelineStarts = []; return e[i].attributes.timelineStarts.push({ start: t.attributes.periodStart, timeline: t.attributes.periodStart }), e }), {})).map((function (e) { var t, i; return e.discontinuityStarts = (t = e.segments || [], i = "discontinuity", t.reduce((function (e, t, n) { return t[i] && e.push(n), e }), [])), e })) }, xe = function (e, t) { var i = be(e.sidx), n = i && t[i] && t[i].sidx; return n && me(e, n, e.sidx.resolvedUri), e }, Se = function (e, t) { if (void 0 === t && (t = {}), !Object.keys(t).length) return e; for (var i in e) e[i] = xe(e[i], t); return e }, Ee = function (e) { var t, i = e.attributes, n = e.segments, r = e.sidx, a = e.discontinuityStarts, s = { attributes: (t = { NAME: i.id, AUDIO: "audio", SUBTITLES: "subs", RESOLUTION: { width: i.width, height: i.height }, CODECS: i.codecs, BANDWIDTH: i.bandwidth }, t["PROGRAM-ID"] = 1, t), uri: "", endList: "static" === i.type, timeline: i.periodStart, resolvedUri: "", targetDuration: i.duration, discontinuityStarts: a, timelineStarts: i.timelineStarts, segments: n }; return i.contentProtection && (s.contentProtection = i.contentProtection), r && (s.sidx = r), s }, Ce = function (e) { var t = e.attributes; return "video/mp4" === t.mimeType || "video/webm" === t.mimeType || "video" === t.contentType }, we = function (e) { var t = e.attributes; return "audio/mp4" === t.mimeType || "audio/webm" === t.mimeType || "audio" === t.contentType }, ke = function (e) { var t = e.attributes; return "text/vtt" === t.mimeType || "text" === t.contentType }, Fe = function (e) { return e ? Object.keys(e).reduce((function (t, i) { var n = e[i]; return t.concat(n.playlists) }), []) : [] }, Ie = function (e) { var t, i = e.dashPlaylists, n = e.locations, r = e.sidxMapping, a = void 0 === r ? {} : r, s = e.previousManifest; if (!i.length) return {}; var o = i[0].attributes, u = o.sourceDuration, l = o.type, c = o.suggestedPresentationDelay, d = o.minimumUpdatePeriod, h = Te(i.filter(Ce)).map(Ee), p = Te(i.filter(we)), f = Te(i.filter(ke)), m = i.map((function (e) { return e.attributes.captionServices })).filter(Boolean), g = { allowCache: !0, discontinuityStarts: [], segments: [], endList: !0, mediaGroups: (t = { AUDIO: {}, VIDEO: {} }, t["CLOSED-CAPTIONS"] = {}, t.SUBTITLES = {}, t), uri: "", duration: u, playlists: Se(h, a) }; d >= 0 && (g.minimumUpdatePeriod = 1e3 * d), n && (g.locations = n), "dynamic" === l && (g.suggestedPresentationDelay = c); var A, v, y = 0 === g.playlists.length, _ = p.length ? function (e, t, i) { var n; void 0 === t && (t = {}), void 0 === i && (i = !1); var r = e.reduce((function (e, r) { var a = r.attributes.role && r.attributes.role.value || "", s = r.attributes.lang || "", o = r.attributes.label || "main"; if (s && !r.attributes.label) { var u = a ? " (" + a + ")" : ""; o = "" + r.attributes.lang + u } e[o] || (e[o] = { language: s, autoselect: !0, default: "main" === a, playlists: [], uri: "" }); var l = xe(function (e, t) { var i, n = e.attributes, r = e.segments, a = e.sidx, s = e.mediaSequence, o = e.discontinuitySequence, u = e.discontinuityStarts, l = { attributes: (i = { NAME: n.id, BANDWIDTH: n.bandwidth, CODECS: n.codecs }, i["PROGRAM-ID"] = 1, i), uri: "", endList: "static" === n.type, timeline: n.periodStart, resolvedUri: "", targetDuration: n.duration, discontinuitySequence: o, discontinuityStarts: u, timelineStarts: n.timelineStarts, mediaSequence: s, segments: r }; return n.contentProtection && (l.contentProtection = n.contentProtection), a && (l.sidx = a), t && (l.attributes.AUDIO = "audio", l.attributes.SUBTITLES = "subs"), l }(r, i), t); return e[o].playlists.push(l), void 0 === n && "main" === a && ((n = r).default = !0), e }), {}); return n || (r[Object.keys(r)[0]].default = !0), r }(p, a, y) : null, b = f.length ? function (e, t) { return void 0 === t && (t = {}), e.reduce((function (e, i) { var n = i.attributes.lang || "text"; return e[n] || (e[n] = { language: n, default: !1, autoselect: !1, playlists: [], uri: "" }), e[n].playlists.push(xe(function (e) { var t, i = e.attributes, n = e.segments, r = e.mediaSequence, a = e.discontinuityStarts, s = e.discontinuitySequence; void 0 === n && (n = [{ uri: i.baseUrl, timeline: i.periodStart, resolvedUri: i.baseUrl || "", duration: i.sourceDuration, number: 0 }], i.duration = i.sourceDuration); var o = ((t = { NAME: i.id, BANDWIDTH: i.bandwidth })["PROGRAM-ID"] = 1, t); return i.codecs && (o.CODECS = i.codecs), { attributes: o, uri: "", endList: "static" === i.type, timeline: i.periodStart, resolvedUri: i.baseUrl || "", targetDuration: i.duration, timelineStarts: i.timelineStarts, discontinuityStarts: a, discontinuitySequence: s, mediaSequence: r, segments: n } }(i), t)), e }), {}) }(f, a) : null, T = h.concat(Fe(_), Fe(b)), x = T.map((function (e) { return e.timelineStarts })); return g.timelineStarts = Ae(x), A = T, v = g.timelineStarts, A.forEach((function (e) { e.mediaSequence = 0, e.discontinuitySequence = ne(v, (function (t) { return t.timeline === e.timeline })), e.segments && e.segments.forEach((function (e, t) { e.number = t })) })), _ && (g.mediaGroups.AUDIO.audio = _), b && (g.mediaGroups.SUBTITLES.subs = b), m.length && (g.mediaGroups["CLOSED-CAPTIONS"].cc = m.reduce((function (e, t) { return t ? (t.forEach((function (t) { var i = t.channel, n = t.language; e[n] = { autoselect: !1, default: !1, instreamId: i, language: n }, t.hasOwnProperty("aspectRatio") && (e[n].aspectRatio = t.aspectRatio), t.hasOwnProperty("easyReader") && (e[n].easyReader = t.easyReader), t.hasOwnProperty("3D") && (e[n]["3D"] = t["3D"]) })), e) : e }), {})), s ? _e({ oldManifest: s, newManifest: g }) : g }, De = function (e, t, i) { var n = e.NOW, r = e.clientOffset, a = e.availabilityStartTime, s = e.timescale, o = void 0 === s ? 1 : s, u = e.periodStart, l = void 0 === u ? 0 : u, c = e.minimumUpdatePeriod, d = (n + r) / 1e3 + (void 0 === c ? 0 : c) - (a + l); return Math.ceil((d * o - t) / i) }, Pe = function (e, t) { for (var i = e.type, n = e.minimumUpdatePeriod, r = void 0 === n ? 0 : n, a = e.media, s = void 0 === a ? "" : a, o = e.sourceDuration, u = e.timescale, l = void 0 === u ? 1 : u, c = e.startNumber, d = void 0 === c ? 1 : c, h = e.periodStart, p = [], f = -1, m = 0; m < t.length; m++) { var g = t[m], A = g.d, v = g.r || 0, y = g.t || 0; f < 0 && (f = y), y && y > f && (f = y); var _ = void 0; if (v < 0) { var b = m + 1; _ = b === t.length ? "dynamic" === i && r > 0 && s.indexOf("$Number$") > 0 ? De(e, f, A) : (o * l - f) / A : (t[b].t - f) / A } else _ = v + 1; for (var T = d + p.length + _, x = d + p.length; x < T;)p.push({ number: x, duration: A / l, time: f, timeline: h }), f += A, x++ } return p }, Le = /\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g, Oe = function (e, t) { return e.replace(Le, function (e) { return function (t, i, n, r) { if ("$$" === t) return "$"; if (void 0 === e[i]) return t; var a = "" + e[i]; return "RepresentationID" === i ? a : (r = n ? parseInt(r, 10) : 1, a.length >= r ? a : "" + new Array(r - a.length + 1).join("0") + a) } }(t)) }, Be = function (e, t) { var i = { RepresentationID: e.id, Bandwidth: e.bandwidth || 0 }, n = e.initialization, r = void 0 === n ? { sourceURL: "", range: "" } : n, a = ce({ baseUrl: e.baseUrl, source: Oe(r.sourceURL, i), range: r.range }), s = function (e, t) { return e.duration || t ? e.duration ? pe(e) : Pe(e, t) : [{ number: e.startNumber || 1, duration: e.sourceDuration, time: 0, timeline: e.periodStart }] }(e, t); return s.map((function (t) { i.Number = t.number, i.Time = t.time; var n = Oe(e.media || "", i), r = e.timescale || 1, s = e.presentationTimeOffset || 0, o = e.periodStart + (t.time - s) / r; return { uri: n, timeline: t.timeline, duration: t.duration, resolvedUri: S(e.baseUrl || "", n), map: a, number: t.number, presentationTime: o } })) }, Re = function (e, t) { var i = e.duration, n = e.segmentUrls, r = void 0 === n ? [] : n, a = e.periodStart; if (!i && !t || i && t) throw new Error(ue); var s, o = r.map((function (t) { return function (e, t) { var i = e.baseUrl, n = e.initialization, r = void 0 === n ? {} : n, a = ce({ baseUrl: i, source: r.sourceURL, range: r.range }), s = ce({ baseUrl: i, source: t.media, range: t.mediaRange }); return s.map = a, s }(e, t) })); return i && (s = pe(e)), t && (s = Pe(e, t)), s.map((function (t, i) { if (o[i]) { var n = o[i], r = e.timescale || 1, s = e.presentationTimeOffset || 0; return n.timeline = t.timeline, n.duration = t.duration, n.number = t.number, n.presentationTime = a + (t.time - s) / r, n } })).filter((function (e) { return e })) }, Me = function (e) { var t, i, n = e.attributes, r = e.segmentInfo; r.template ? (i = Be, t = J(n, r.template)) : r.base ? (i = fe, t = J(n, r.base)) : r.list && (i = Re, t = J(n, r.list)); var a = { attributes: n }; if (!i) return a; var s = i(t, r.segmentTimeline); if (t.duration) { var o = t, u = o.duration, l = o.timescale, c = void 0 === l ? 1 : l; t.duration = u / c } else s.length ? t.duration = s.reduce((function (e, t) { return Math.max(e, Math.ceil(t.duration)) }), 0) : t.duration = 0; return a.attributes = t, a.segments = s, r.base && t.indexRange && (a.sidx = s[0], a.segments = []), a }, Ne = function (e, t) { return ie(e.childNodes).filter((function (e) { return e.tagName === t })) }, Ue = function (e) { return e.textContent.trim() }, je = function (e) { var t = /P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e); if (!t) return 0; var i = t.slice(1), n = i[0], r = i[1], a = i[2], s = i[3], o = i[4], u = i[5]; return 31536e3 * parseFloat(n || 0) + 2592e3 * parseFloat(r || 0) + 86400 * parseFloat(a || 0) + 3600 * parseFloat(s || 0) + 60 * parseFloat(o || 0) + parseFloat(u || 0) }, He = { mediaPresentationDuration: function (e) { return je(e) }, availabilityStartTime: function (e) { return /^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t = e) && (t += "Z"), Date.parse(t) / 1e3; var t }, minimumUpdatePeriod: function (e) { return je(e) }, suggestedPresentationDelay: function (e) { return je(e) }, type: function (e) { return e }, timeShiftBufferDepth: function (e) { return je(e) }, start: function (e) { return je(e) }, width: function (e) { return parseInt(e, 10) }, height: function (e) { return parseInt(e, 10) }, bandwidth: function (e) { return parseInt(e, 10) }, startNumber: function (e) { return parseInt(e, 10) }, timescale: function (e) { return parseInt(e, 10) }, presentationTimeOffset: function (e) { return parseInt(e, 10) }, duration: function (e) { var t = parseInt(e, 10); return isNaN(t) ? je(e) : t }, d: function (e) { return parseInt(e, 10) }, t: function (e) { return parseInt(e, 10) }, r: function (e) { return parseInt(e, 10) }, DEFAULT: function (e) { return e } }, Ve = function (e) { return e && e.attributes ? ie(e.attributes).reduce((function (e, t) { var i = He[t.name] || He.DEFAULT; return e[t.name] = i(t.value), e }), {}) : {} }, qe = { "urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b": "org.w3.clearkey", "urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed": "com.widevine.alpha", "urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95": "com.microsoft.playready", "urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb": "com.adobe.primetime" }, We = function (e, t) { return t.length ? te(e.map((function (e) { return t.map((function (t) { return S(e, Ue(t)) })) }))) : e }, Ge = function (e) { var t = Ne(e, "SegmentTemplate")[0], i = Ne(e, "SegmentList")[0], n = i && Ne(i, "SegmentURL").map((function (e) { return J({ tag: "SegmentURL" }, Ve(e)) })), r = Ne(e, "SegmentBase")[0], a = i || t, s = a && Ne(a, "SegmentTimeline")[0], o = i || r || t, u = o && Ne(o, "Initialization")[0], l = t && Ve(t); l && u ? l.initialization = u && Ve(u) : l && l.initialization && (l.initialization = { sourceURL: l.initialization }); var c = { template: l, segmentTimeline: s && Ne(s, "S").map((function (e) { return Ve(e) })), list: i && J(Ve(i), { segmentUrls: n, initialization: Ve(u) }), base: r && J(Ve(r), { initialization: Ve(u) }) }; return Object.keys(c).forEach((function (e) { c[e] || delete c[e] })), c }, ze = function (e, t, i) { return function (n) { var r, a = Ve(n), s = We(t, Ne(n, "BaseURL")), o = Ne(n, "Role")[0], u = { role: Ve(o) }, l = J(e, a, u), c = Ne(n, "Accessibility")[0], d = "urn:scte:dash:cc:cea-608:2015" === (r = Ve(c)).schemeIdUri ? ("string" != typeof r.value ? [] : r.value.split(";")).map((function (e) { var t, i; if (i = e, /^CC\d=/.test(e)) { var n = e.split("="); t = n[0], i = n[1] } else /^CC\d$/.test(e) && (t = e); return { channel: t, language: i } })) : "urn:scte:dash:cc:cea-708:2015" === r.schemeIdUri ? ("string" != typeof r.value ? [] : r.value.split(";")).map((function (e) { var t = { channel: void 0, language: void 0, aspectRatio: 1, easyReader: 0, "3D": 0 }; if (/=/.test(e)) { var i = e.split("="), n = i[0], r = i[1], a = void 0 === r ? "" : r; t.channel = n, t.language = e, a.split(",").forEach((function (e) { var i = e.split(":"), n = i[0], r = i[1]; "lang" === n ? t.language = r : "er" === n ? t.easyReader = Number(r) : "war" === n ? t.aspectRatio = Number(r) : "3D" === n && (t["3D"] = Number(r)) })) } else t.language = e; return t.channel && (t.channel = "SERVICE" + t.channel), t })) : void 0; d && (l = J(l, { captionServices: d })); var h = Ne(n, "Label")[0]; if (h && h.childNodes.length) { var p = h.childNodes[0].nodeValue.trim(); l = J(l, { label: p }) } var f = Ne(n, "ContentProtection").reduce((function (e, t) { var i = Ve(t), n = qe[i.schemeIdUri]; if (n) { e[n] = { attributes: i }; var r = Ne(t, "cenc:pssh")[0]; if (r) { var a = Ue(r), s = a && C(a); e[n].pssh = s } } return e }), {}); Object.keys(f).length && (l = J(l, { contentProtection: f })); var m = Ge(n), g = Ne(n, "Representation"), A = J(i, m); return te(g.map(function (e, t, i) { return function (n) { var r = Ne(n, "BaseURL"), a = We(t, r), s = J(e, Ve(n)), o = Ge(n); return a.map((function (e) { return { segmentInfo: J(i, o), attributes: J(s, { baseUrl: e }) } })) } }(l, s, A))) } }, Qe = function (e, t) { return function (i, n) { var r = We(t, Ne(i.node, "BaseURL")), a = J(e, { periodStart: i.attributes.start }); "number" == typeof i.attributes.duration && (a.periodDuration = i.attributes.duration); var s = Ne(i.node, "AdaptationSet"), o = Ge(i.node); return te(s.map(ze(a, r, o))) } }, Xe = function (e) { if ("" === e) throw new Error(ae); var t, i, n = new Y.DOMParser; try { i = (t = n.parseFromString(e, "application/xml")) && "MPD" === t.documentElement.tagName ? t.documentElement : null } catch (e) { } if (!i || i && i.getElementsByTagName("parsererror").length > 0) throw new Error(se); return i }, $e = function (e, t) { void 0 === t && (t = {}); var i = function (e, t) { void 0 === t && (t = {}); var i = t, n = i.manifestUri, r = void 0 === n ? "" : n, a = i.NOW, s = void 0 === a ? Date.now() : a, o = i.clientOffset, u = void 0 === o ? 0 : o, l = Ne(e, "Period"); if (!l.length) throw new Error(re); var c = Ne(e, "Location"), d = Ve(e), h = We([r], Ne(e, "BaseURL")); d.type = d.type || "static", d.sourceDuration = d.mediaPresentationDuration || 0, d.NOW = s, d.clientOffset = u, c.length && (d.locations = c.map(Ue)); var p = []; return l.forEach((function (e, t) { var i = Ve(e), n = p[t - 1]; i.start = function (e) { var t = e.attributes, i = e.priorPeriodAttributes, n = e.mpdType; return "number" == typeof t.start ? t.start : i && "number" == typeof i.start && "number" == typeof i.duration ? i.start + i.duration : i || "static" !== n ? null : 0 }({ attributes: i, priorPeriodAttributes: n ? n.attributes : null, mpdType: d.type }), p.push({ node: e, attributes: i }) })), { locations: d.locations, representationInfo: te(p.map(Qe(d, h))) } }(Xe(e), t), n = i.representationInfo.map(Me); return Ie({ dashPlaylists: n, locations: i.locations, sidxMapping: t.sidxMapping, previousManifest: t.previousManifest }) }, Ke = function (e) { return function (e) { var t = Ne(e, "UTCTiming")[0]; if (!t) return null; var i = Ve(t); switch (i.schemeIdUri) { case "urn:mpeg:dash:utc:http-head:2014": case "urn:mpeg:dash:utc:http-head:2012": i.method = "HEAD"; break; case "urn:mpeg:dash:utc:http-xsdate:2014": case "urn:mpeg:dash:utc:http-iso:2014": case "urn:mpeg:dash:utc:http-xsdate:2012": case "urn:mpeg:dash:utc:http-iso:2012": i.method = "GET"; break; case "urn:mpeg:dash:utc:direct:2014": case "urn:mpeg:dash:utc:direct:2012": i.method = "DIRECT", i.value = Date.parse(i.value); break; default: throw new Error(le) }return i }(Xe(e)) }, Ye = i(84221), Ze = i.n(Ye), Je = function (e) { return function (e) { return "function" === ArrayBuffer.isView ? ArrayBuffer.isView(e) : e && e.buffer instanceof ArrayBuffer }(e) }, et = function (e) { return e instanceof Uint8Array ? e : (Array.isArray(e) || Je(e) || e instanceof ArrayBuffer || (e = "number" != typeof e || "number" == typeof e && e != e ? 0 : [e]), new Uint8Array(e && e.buffer || e, e && e.byteOffset || 0, e && e.byteLength || 0)) }, tt = r().BigInt || Number, it = [tt("0x1"), tt("0x100"), tt("0x10000"), tt("0x1000000"), tt("0x100000000"), tt("0x10000000000"), tt("0x1000000000000"), tt("0x100000000000000"), tt("0x10000000000000000")], nt = (w = new Uint16Array([65484]), 255 === (k = new Uint8Array(w.buffer, w.byteOffset, w.byteLength))[0] || k[0], function (e, t) { var i = void 0 === t ? {} : t, n = i.signed, r = void 0 !== n && n, a = i.le, s = void 0 !== a && a; e = et(e); var o = s ? "reduce" : "reduceRight", u = (e[o] ? e[o] : Array.prototype[o]).call(e, (function (t, i, n) { var r = s ? n : Math.abs(n + 1 - e.length); return t + tt(i) * it[r] }), tt(0)); if (r) { var l = it[e.length] / tt(2) - tt(1); (u = tt(u)) > l && (u -= l, u -= l, u -= tt(2)) } return Number(u) }), rt = function (e, t) { var i = (void 0 === t ? {} : t).le, n = void 0 !== i && i; ("bigint" != typeof e && "number" != typeof e || "number" == typeof e && e != e) && (e = 0), e = tt(e); for (var r, a = (r = e, Math.ceil(function (e) { return e.toString(2).length }(r) / 8)), s = new Uint8Array(new ArrayBuffer(a)), o = 0; o < a; o++) { var u = n ? o : Math.abs(o + 1 - s.length); s[u] = Number(e / it[o] & tt(255)), e < 0 && (s[u] = Math.abs(~s[u]), s[u] -= 0 === o ? 1 : 2) } return s }, at = function (e, t) { if ("string" != typeof e && e && "function" == typeof e.toString && (e = e.toString()), "string" != typeof e) return new Uint8Array; t || (e = unescape(encodeURIComponent(e))); for (var i = new Uint8Array(e.length), n = 0; n < e.length; n++)i[n] = e.charCodeAt(n); return i }, st = function (e, t, i) { var n = void 0 === i ? {} : i, r = n.offset, a = void 0 === r ? 0 : r, s = n.mask, o = void 0 === s ? [] : s; e = et(e); var u = (t = et(t)).every ? t.every : Array.prototype.every; return t.length && e.length - a >= t.length && u.call(t, (function (t, i) { return t === (o[i] ? o[i] & e[a + i] : e[a + i]) })) }, ot = et([73, 68, 51]), ut = function e(t, i) { return void 0 === i && (i = 0), (t = et(t)).length - i < 10 || !st(t, ot, { offset: i }) ? i : (i += function (e, t) { void 0 === t && (t = 0); var i = (e = et(e))[t + 5], n = e[t + 6] << 21 | e[t + 7] << 14 | e[t + 8] << 7 | e[t + 9]; return (16 & i) >> 4 ? n + 20 : n + 10 }(t, i), e(t, i)) }, lt = (new Uint8Array([79, 112, 117, 115, 72, 101, 97, 100]), function (e) { return "string" == typeof e ? at(e) : e }), ct = function (e) { e = et(e); for (var t = [], i = 0; e.length > i;) { var n = e[i], r = 0, a = 0, s = e[++a]; for (a++; 128 & s;)r = (127 & s) << 7, s = e[a], a++; r += 127 & s; for (var o = 0; o < F.length; o++) { var u = F[o], l = u.id, c = u.parser; if (n === l) { t.push(c(e.subarray(a, a + r))); break } } i += r + a } return t }; F = [{ id: 3, parser: function (e) { var t = { tag: 3, id: e[0] << 8 | e[1], flags: e[2], size: 3, dependsOnEsId: 0, ocrEsId: 0, descriptors: [], url: "" }; if (128 & t.flags && (t.dependsOnEsId = e[t.size] << 8 | e[t.size + 1], t.size += 2), 64 & t.flags) { var i = e[t.size]; t.url = function (e) { if (!e) return ""; e = Array.prototype.slice.call(e); var t = String.fromCharCode.apply(null, et(e)); try { return decodeURIComponent(escape(t)) } catch (e) { } return t }(e.subarray(t.size + 1, t.size + 1 + i)), t.size += i } return 32 & t.flags && (t.ocrEsId = e[t.size] << 8 | e[t.size + 1], t.size += 2), t.descriptors = ct(e.subarray(t.size)) || [], t } }, { id: 4, parser: function (e) { return { tag: 4, oti: e[0], streamType: e[1], bufferSize: e[2] << 16 | e[3] << 8 | e[4], maxBitrate: e[5] << 24 | e[6] << 16 | e[7] << 8 | e[8], avgBitrate: e[9] << 24 | e[10] << 16 | e[11] << 8 | e[12], descriptors: ct(e.subarray(13)) } } }, { id: 5, parser: function (e) { return { tag: 5, bytes: e } } }, { id: 6, parser: function (e) { return { tag: 6, bytes: e } } }]; var dt = function e(t, i, n) { void 0 === n && (n = !1), i = function (e) { return Array.isArray(e) ? e.map((function (e) { return lt(e) })) : [lt(e)] }(i), t = et(t); var r = []; if (!i.length) return r; for (var a = 0; a < t.length;) { var s = (t[a] << 24 | t[a + 1] << 16 | t[a + 2] << 8 | t[a + 3]) >>> 0, o = t.subarray(a + 4, a + 8); if (0 === s) break; var u = a + s; if (u > t.length) { if (n) break; u = t.length } var l = t.subarray(a + 8, u); st(o, i[0]) && (1 === i.length ? r.push(l) : r.push.apply(r, e(l, i.slice(1), n))), a = u } return r }, ht = { EBML: et([26, 69, 223, 163]), DocType: et([66, 130]), Segment: et([24, 83, 128, 103]), SegmentInfo: et([21, 73, 169, 102]), Tracks: et([22, 84, 174, 107]), Track: et([174]), TrackNumber: et([215]), DefaultDuration: et([35, 227, 131]), TrackEntry: et([174]), TrackType: et([131]), FlagDefault: et([136]), CodecID: et([134]), CodecPrivate: et([99, 162]), VideoTrack: et([224]), AudioTrack: et([225]), Cluster: et([31, 67, 182, 117]), Timestamp: et([231]), TimestampScale: et([42, 215, 177]), BlockGroup: et([160]), BlockDuration: et([155]), Block: et([161]), SimpleBlock: et([163]) }, pt = [128, 64, 32, 16, 8, 4, 2, 1], ft = function (e, t, i, n) { void 0 === i && (i = !0), void 0 === n && (n = !1); var r = function (e) { for (var t = 1, i = 0; i < pt.length && !(e & pt[i]); i++)t++; return t }(e[t]), a = e.subarray(t, t + r); return i && ((a = Array.prototype.slice.call(e, t, t + r))[0] ^= pt[r - 1]), { length: r, value: nt(a, { signed: n }), bytes: a } }, mt = function e(t) { return "string" == typeof t ? t.match(/.{1,2}/g).map((function (t) { return e(t) })) : "number" == typeof t ? rt(t) : t }, gt = function e(t, i, n) { if (n >= i.length) return i.length; var r = ft(i, n, !1); if (st(t.bytes, r.bytes)) return n; var a = ft(i, n + r.length); return e(t, i, n + a.length + a.value + r.length) }, At = function e(t, i) { i = function (e) { return Array.isArray(e) ? e.map((function (e) { return mt(e) })) : [mt(e)] }(i), t = et(t); var n = []; if (!i.length) return n; for (var r = 0; r < t.length;) { var a = ft(t, r, !1), s = ft(t, r + a.length), o = r + a.length + s.length; 127 === s.value && (s.value = gt(a, t, o), s.value !== t.length && (s.value -= o)); var u = o + s.value > t.length ? t.length : o + s.value, l = t.subarray(o, u); st(i[0], a.bytes) && (1 === i.length ? n.push(l) : n = n.concat(e(l, i.slice(1)))), r += a.length + s.length + l.length } return n }, vt = et([0, 0, 0, 1]), yt = et([0, 0, 1]), _t = et([0, 0, 3]), bt = function (e) { for (var t = [], i = 1; i < e.length - 2;)st(e.subarray(i, i + 3), _t) && (t.push(i + 2), i++), i++; if (0 === t.length) return e; var n = e.length - t.length, r = new Uint8Array(n), a = 0; for (i = 0; i < n; a++, i++)a === t[0] && (a++, t.shift()), r[i] = e[a]; return r }, Tt = function (e, t, i, n) { void 0 === n && (n = 1 / 0), e = et(e), i = [].concat(i); for (var r, a = 0, s = 0; a < e.length && (s < n || r);) { var o = void 0; if (st(e.subarray(a), vt) ? o = 4 : st(e.subarray(a), yt) && (o = 3), o) { if (s++, r) return bt(e.subarray(r, a)); var u = void 0; "h264" === t ? u = 31 & e[a + o] : "h265" === t && (u = e[a + o] >> 1 & 63), -1 !== i.indexOf(u) && (r = a + o), a += o + ("h264" === t ? 1 : 2) } else a++ } return e.subarray(0, 0) }, xt = { webm: et([119, 101, 98, 109]), matroska: et([109, 97, 116, 114, 111, 115, 107, 97]), flac: et([102, 76, 97, 67]), ogg: et([79, 103, 103, 83]), ac3: et([11, 119]), riff: et([82, 73, 70, 70]), avi: et([65, 86, 73]), wav: et([87, 65, 86, 69]), "3gp": et([102, 116, 121, 112, 51, 103]), mp4: et([102, 116, 121, 112]), fmp4: et([115, 116, 121, 112]), mov: et([102, 116, 121, 112, 113, 116]), moov: et([109, 111, 111, 118]), moof: et([109, 111, 111, 102]) }, St = { aac: function (e) { var t = ut(e); return st(e, [255, 16], { offset: t, mask: [255, 22] }) }, mp3: function (e) { var t = ut(e); return st(e, [255, 2], { offset: t, mask: [255, 6] }) }, webm: function (e) { var t = At(e, [ht.EBML, ht.DocType])[0]; return st(t, xt.webm) }, mkv: function (e) { var t = At(e, [ht.EBML, ht.DocType])[0]; return st(t, xt.matroska) }, mp4: function (e) { return !St["3gp"](e) && !St.mov(e) && (!(!st(e, xt.mp4, { offset: 4 }) && !st(e, xt.fmp4, { offset: 4 })) || (!(!st(e, xt.moof, { offset: 4 }) && !st(e, xt.moov, { offset: 4 })) || void 0)) }, mov: function (e) { return st(e, xt.mov, { offset: 4 }) }, "3gp": function (e) { return st(e, xt["3gp"], { offset: 4 }) }, ac3: function (e) { var t = ut(e); return st(e, xt.ac3, { offset: t }) }, ts: function (e) { if (e.length < 189 && e.length >= 1) return 71 === e[0]; for (var t = 0; t + 188 < e.length && t < 188;) { if (71 === e[t] && 71 === e[t + 188]) return !0; t += 1 } return !1 }, flac: function (e) { var t = ut(e); return st(e, xt.flac, { offset: t }) }, ogg: function (e) { return st(e, xt.ogg) }, avi: function (e) { return st(e, xt.riff) && st(e, xt.avi, { offset: 8 }) }, wav: function (e) { return st(e, xt.riff) && st(e, xt.wav, { offset: 8 }) }, h264: function (e) { return function (e, t, i) { return Tt(e, "h264", t, i) }(e, 7, 3).length }, h265: function (e) { return function (e, t, i) { return Tt(e, "h265", t, i) }(e, [32, 33], 3).length } }, Et = Object.keys(St).filter((function (e) { return "ts" !== e && "h264" !== e && "h265" !== e })).concat(["ts", "h264", "h265"]); Et.forEach((function (e) { var t = St[e]; St[e] = function (e) { return t(et(e)) } })); for (var Ct, wt = St, kt = function (e) { e = et(e); for (var t = 0; t < Et.length; t++) { var i = Et[t]; if (wt[i](e)) return i } return "" }, Ft = i(51489), It = "7.18.1", Dt = {}, Pt = function (e, t) { return Dt[e] = Dt[e] || [], t && (Dt[e] = Dt[e].concat(t)), Dt[e] }, Lt = function (e, t) { var i = Pt(e).indexOf(t); return !(i <= -1) && (Dt[e] = Dt[e].slice(), Dt[e].splice(i, 1), !0) }, Ot = { prefixed: !0 }, Bt = [["requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror", "fullscreen"], ["webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror", "-webkit-full-screen"], ["mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror", "-moz-full-screen"], ["msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError", "-ms-fullscreen"]], Rt = Bt[0], Mt = 0; Mt < Bt.length; Mt++)if (Bt[Mt][1] in s()) { Ct = Bt[Mt]; break } if (Ct) { for (var Nt = 0; Nt < Ct.length; Nt++)Ot[Rt[Nt]] = Ct[Nt]; Ot.prefixed = Ct[0] !== Rt[0] } var Ut = []; var jt = function e(t) { var i, n = "info", a = function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; i("log", n, t) }; return i = function (e, t) { return function (i, n, a) { var s = t.levels[n], o = new RegExp("^(" + s + ")$"); if ("log" !== i && a.unshift(i.toUpperCase() + ":"), a.unshift(e + ":"), Ut) { Ut.push([].concat(a)); var u = Ut.length - 1e3; Ut.splice(0, u > 0 ? u : 0) } if (r().console) { var l = r().console[i]; l || "debug" !== i || (l = r().console.info || r().console.log), l && s && o.test(i) && l[Array.isArray(a) ? "apply" : "call"](r().console, a) } } }(t, a), a.createLogger = function (i) { return e(t + ": " + i) }, a.levels = { all: "debug|log|warn|error", off: "", debug: "debug|log|warn|error", info: "log|warn|error", warn: "warn|error", error: "error", DEFAULT: n }, a.level = function (e) { if ("string" == typeof e) { if (!a.levels.hasOwnProperty(e)) throw new Error('"' + e + '" in not a valid log level'); n = e } return n }, (a.history = function () { return Ut ? [].concat(Ut) : [] }).filter = function (e) { return (Ut || []).filter((function (t) { return new RegExp(".*" + e + ".*").test(t[0]) })) }, a.history.clear = function () { Ut && (Ut.length = 0) }, a.history.disable = function () { null !== Ut && (Ut.length = 0, Ut = null) }, a.history.enable = function () { null === Ut && (Ut = []) }, a.error = function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; return i("error", n, t) }, a.warn = function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; return i("warn", n, t) }, a.debug = function () { for (var e = arguments.length, t = new Array(e), r = 0; r < e; r++)t[r] = arguments[r]; return i("debug", n, t) }, a }("VIDEOJS"), Ht = jt.createLogger, Vt = Object.prototype.toString, qt = function (e) { return zt(e) ? Object.keys(e) : [] }; function Wt(e, t) { qt(e).forEach((function (i) { return t(e[i], i) })) } function Gt(e) { for (var t = arguments.length, i = new Array(t > 1 ? t - 1 : 0), n = 1; n < t; n++)i[n - 1] = arguments[n]; return Object.assign ? o.apply(void 0, [e].concat(i)) : (i.forEach((function (t) { t && Wt(t, (function (t, i) { e[i] = t })) })), e) } function zt(e) { return !!e && "object" == typeof e } function Qt(e) { return zt(e) && "[object Object]" === Vt.call(e) && e.constructor === Object } function Xt(e, t) { if (!e || !t) return ""; if ("function" == typeof r().getComputedStyle) { var i; try { i = r().getComputedStyle(e) } catch (e) { return "" } return i ? i.getPropertyValue(t) || i[t] : "" } return "" } var $t, Kt = r().navigator && r().navigator.userAgent || "", Yt = /AppleWebKit\/([\d.]+)/i.exec(Kt), Zt = Yt ? parseFloat(Yt.pop()) : null, Jt = /iPod/i.test(Kt), ei = ($t = Kt.match(/OS (\d+)_/i)) && $t[1] ? $t[1] : null, ti = /Android/i.test(Kt), ii = function () { var e = Kt.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i); if (!e) return null; var t = e[1] && parseFloat(e[1]), i = e[2] && parseFloat(e[2]); return t && i ? parseFloat(e[1] + "." + e[2]) : t || null }(), ni = ti && ii < 5 && Zt < 537, ri = /Firefox/i.test(Kt), ai = /Edg/i.test(Kt), si = !ai && (/Chrome/i.test(Kt) || /CriOS/i.test(Kt)), oi = function () { var e = Kt.match(/(Chrome|CriOS)\/(\d+)/); return e && e[2] ? parseFloat(e[2]) : null }(), ui = function () { var e = /MSIE\s(\d+)\.\d/.exec(Kt), t = e && parseFloat(e[1]); return !t && /Trident\/7.0/i.test(Kt) && /rv:11.0/.test(Kt) && (t = 11), t }(), li = /Safari/i.test(Kt) && !si && !ti && !ai, ci = /Windows/i.test(Kt), di = Boolean(yi() && ("ontouchstart" in r() || r().navigator.maxTouchPoints || r().DocumentTouch && r().document instanceof r().DocumentTouch)), hi = /iPad/i.test(Kt) || li && di && !/iPhone/i.test(Kt), pi = /iPhone/i.test(Kt) && !hi, fi = pi || hi || Jt, mi = (li || fi) && !si, gi = Object.freeze({ __proto__: null, IS_IPOD: Jt, IOS_VERSION: ei, IS_ANDROID: ti, ANDROID_VERSION: ii, IS_NATIVE_ANDROID: ni, IS_FIREFOX: ri, IS_EDGE: ai, IS_CHROME: si, CHROME_VERSION: oi, IE_VERSION: ui, IS_SAFARI: li, IS_WINDOWS: ci, TOUCH_ENABLED: di, IS_IPAD: hi, IS_IPHONE: pi, IS_IOS: fi, IS_ANY_SAFARI: mi }); function Ai(e) { return "string" == typeof e && Boolean(e.trim()) } function vi(e) { if (e.indexOf(" ") >= 0) throw new Error("class has illegal whitespace characters") } function yi() { return s() === r().document } function _i(e) { return zt(e) && 1 === e.nodeType } function bi() { try { return r().parent !== r().self } catch (e) { return !0 } } function Ti(e) { return function (t, i) { if (!Ai(t)) return s()[e](null); Ai(i) && (i = s().querySelector(i)); var n = _i(i) ? i : s(); return n[e] && n[e](t) } } function xi(e, t, i, n) { void 0 === e && (e = "div"), void 0 === t && (t = {}), void 0 === i && (i = {}); var r = s().createElement(e); return Object.getOwnPropertyNames(t).forEach((function (e) { var i = t[e]; -1 !== e.indexOf("aria-") || "role" === e || "type" === e ? (jt.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set " + e + " to " + i + "."), r.setAttribute(e, i)) : "textContent" === e ? Si(r, i) : r[e] === i && "tabIndex" !== e || (r[e] = i) })), Object.getOwnPropertyNames(i).forEach((function (e) { r.setAttribute(e, i[e]) })), n && qi(r, n), r } function Si(e, t) { return void 0 === e.textContent ? e.innerText = t : e.textContent = t, e } function Ei(e, t) { t.firstChild ? t.insertBefore(e, t.firstChild) : t.appendChild(e) } function Ci(e, t) { return vi(t), e.classList ? e.classList.contains(t) : (i = t, new RegExp("(^|\\s)" + i + "($|\\s)")).test(e.className); var i } function wi(e, t) { return e.classList ? e.classList.add(t) : Ci(e, t) || (e.className = (e.className + " " + t).trim()), e } function ki(e, t) { return e ? (e.classList ? e.classList.remove(t) : (vi(t), e.className = e.className.split(/\s+/).filter((function (e) { return e !== t })).join(" ")), e) : (jt.warn("removeClass was called with an element that doesn't exist"), null) } function Fi(e, t, i) { var n = Ci(e, t); if ("function" == typeof i && (i = i(e, t)), "boolean" != typeof i && (i = !n), i !== n) return i ? wi(e, t) : ki(e, t), e } function Ii(e, t) { Object.getOwnPropertyNames(t).forEach((function (i) { var n = t[i]; null == n || !1 === n ? e.removeAttribute(i) : e.setAttribute(i, !0 === n ? "" : n) })) } function Di(e) { var t = {}, i = ",autoplay,controls,playsinline,loop,muted,default,defaultMuted,"; if (e && e.attributes && e.attributes.length > 0) for (var n = e.attributes, r = n.length - 1; r >= 0; r--) { var a = n[r].name, s = n[r].value; "boolean" != typeof e[a] && -1 === i.indexOf("," + a + ",") || (s = null !== s), t[a] = s } return t } function Pi(e, t) { return e.getAttribute(t) } function Li(e, t, i) { e.setAttribute(t, i) } function Oi(e, t) { e.removeAttribute(t) } function Bi() { s().body.focus(), s().onselectstart = function () { return !1 } } function Ri() { s().onselectstart = function () { return !0 } } function Mi(e) { if (e && e.getBoundingClientRect && e.parentNode) { var t = e.getBoundingClientRect(), i = {}; return ["bottom", "height", "left", "right", "top", "width"].forEach((function (e) { void 0 !== t[e] && (i[e] = t[e]) })), i.height || (i.height = parseFloat(Xt(e, "height"))), i.width || (i.width = parseFloat(Xt(e, "width"))), i } } function Ni(e) { if (!e || e && !e.offsetParent) return { left: 0, top: 0, width: 0, height: 0 }; for (var t = e.offsetWidth, i = e.offsetHeight, n = 0, r = 0; e.offsetParent && e !== s()[Ot.fullscreenElement];)n += e.offsetLeft, r += e.offsetTop, e = e.offsetParent; return { left: n, top: r, width: t, height: i } } function Ui(e, t) { var i = { x: 0, y: 0 }; if (fi) for (var n = e; n && "html" !== n.nodeName.toLowerCase();) { var r = Xt(n, "transform"); if (/^matrix/.test(r)) { var a = r.slice(7, -1).split(/,\s/).map(Number); i.x += a[4], i.y += a[5] } else if (/^matrix3d/.test(r)) { var s = r.slice(9, -1).split(/,\s/).map(Number); i.x += s[12], i.y += s[13] } n = n.parentNode } var o = {}, u = Ni(t.target), l = Ni(e), c = l.width, d = l.height, h = t.offsetY - (l.top - u.top), p = t.offsetX - (l.left - u.left); return t.changedTouches && (p = t.changedTouches[0].pageX - l.left, h = t.changedTouches[0].pageY + l.top, fi && (p -= i.x, h -= i.y)), o.y = 1 - Math.max(0, Math.min(1, h / d)), o.x = Math.max(0, Math.min(1, p / c)), o } function ji(e) { return zt(e) && 3 === e.nodeType } function Hi(e) { for (; e.firstChild;)e.removeChild(e.firstChild); return e } function Vi(e) { return "function" == typeof e && (e = e()), (Array.isArray(e) ? e : [e]).map((function (e) { return "function" == typeof e && (e = e()), _i(e) || ji(e) ? e : "string" == typeof e && /\S/.test(e) ? s().createTextNode(e) : void 0 })).filter((function (e) { return e })) } function qi(e, t) { return Vi(t).forEach((function (t) { return e.appendChild(t) })), e } function Wi(e, t) { return qi(Hi(e), t) } function Gi(e) { return void 0 === e.button && void 0 === e.buttons || (0 === e.button && void 0 === e.buttons || ("mouseup" === e.type && 0 === e.button && 0 === e.buttons || 0 === e.button && 1 === e.buttons)) } var zi, Qi = Ti("querySelector"), Xi = Ti("querySelectorAll"), $i = Object.freeze({ __proto__: null, isReal: yi, isEl: _i, isInFrame: bi, createEl: xi, textContent: Si, prependTo: Ei, hasClass: Ci, addClass: wi, removeClass: ki, toggleClass: Fi, setAttributes: Ii, getAttributes: Di, getAttribute: Pi, setAttribute: Li, removeAttribute: Oi, blockTextSelection: Bi, unblockTextSelection: Ri, getBoundingClientRect: Mi, findPosition: Ni, getPointerPosition: Ui, isTextNode: ji, emptyEl: Hi, normalizeContent: Vi, appendContent: qi, insertContent: Wi, isSingleLeftClick: Gi, $: Qi, $$: Xi }), Ki = !1, Yi = function () { if (!1 !== zi.options.autoSetup) { var e = Array.prototype.slice.call(s().getElementsByTagName("video")), t = Array.prototype.slice.call(s().getElementsByTagName("audio")), i = Array.prototype.slice.call(s().getElementsByTagName("video-js")), n = e.concat(t, i); if (n && n.length > 0) for (var r = 0, a = n.length; r < a; r++) { var o = n[r]; if (!o || !o.getAttribute) { Zi(1); break } void 0 === o.player && null !== o.getAttribute("data-setup") && zi(o) } else Ki || Zi(1) } }; function Zi(e, t) { yi() && (t && (zi = t), r().setTimeout(Yi, e)) } function Ji() { Ki = !0, r().removeEventListener("load", Ji) } yi() && ("complete" === s().readyState ? Ji() : r().addEventListener("load", Ji)); var en, tn = function (e) { var t = s().createElement("style"); return t.className = e, t }, nn = function (e, t) { e.styleSheet ? e.styleSheet.cssText = t : e.textContent = t }, rn = 3; function an() { return rn++ } r().WeakMap || (en = function () { function e() { this.vdata = "vdata" + Math.floor(r().performance && r().performance.now() || Date.now()), this.data = {} } var t = e.prototype; return t.set = function (e, t) { var i = e[this.vdata] || an(); return e[this.vdata] || (e[this.vdata] = i), this.data[i] = t, this }, t.get = function (e) { var t = e[this.vdata]; if (t) return this.data[t]; jt("We have no data for this element", e) }, t.has = function (e) { return e[this.vdata] in this.data }, t.delete = function (e) { var t = e[this.vdata]; t && (delete this.data[t], delete e[this.vdata]) }, e }()); var sn, on = r().WeakMap ? new WeakMap : new en; function un(e, t) { if (on.has(e)) { var i = on.get(e); 0 === i.handlers[t].length && (delete i.handlers[t], e.removeEventListener ? e.removeEventListener(t, i.dispatcher, !1) : e.detachEvent && e.detachEvent("on" + t, i.dispatcher)), Object.getOwnPropertyNames(i.handlers).length <= 0 && (delete i.handlers, delete i.dispatcher, delete i.disabled), 0 === Object.getOwnPropertyNames(i).length && on.delete(e) } } function ln(e, t, i, n) { i.forEach((function (i) { e(t, i, n) })) } function cn(e) { if (e.fixed_) return e; function t() { return !0 } function i() { return !1 } if (!e || !e.isPropagationStopped || !e.isImmediatePropagationStopped) { var n = e || r().event; for (var a in e = {}, n) "layerX" !== a && "layerY" !== a && "keyLocation" !== a && "webkitMovementX" !== a && "webkitMovementY" !== a && ("returnValue" === a && n.preventDefault || (e[a] = n[a])); if (e.target || (e.target = e.srcElement || s()), e.relatedTarget || (e.relatedTarget = e.fromElement === e.target ? e.toElement : e.fromElement), e.preventDefault = function () { n.preventDefault && n.preventDefault(), e.returnValue = !1, n.returnValue = !1, e.defaultPrevented = !0 }, e.defaultPrevented = !1, e.stopPropagation = function () { n.stopPropagation && n.stopPropagation(), e.cancelBubble = !0, n.cancelBubble = !0, e.isPropagationStopped = t }, e.isPropagationStopped = i, e.stopImmediatePropagation = function () { n.stopImmediatePropagation && n.stopImmediatePropagation(), e.isImmediatePropagationStopped = t, e.stopPropagation() }, e.isImmediatePropagationStopped = i, null !== e.clientX && void 0 !== e.clientX) { var o = s().documentElement, u = s().body; e.pageX = e.clientX + (o && o.scrollLeft || u && u.scrollLeft || 0) - (o && o.clientLeft || u && u.clientLeft || 0), e.pageY = e.clientY + (o && o.scrollTop || u && u.scrollTop || 0) - (o && o.clientTop || u && u.clientTop || 0) } e.which = e.charCode || e.keyCode, null !== e.button && void 0 !== e.button && (e.button = 1 & e.button ? 0 : 4 & e.button ? 1 : 2 & e.button ? 2 : 0) } return e.fixed_ = !0, e } var dn = ["touchstart", "touchmove"]; function hn(e, t, i) { if (Array.isArray(t)) return ln(hn, e, t, i); on.has(e) || on.set(e, {}); var n = on.get(e); if (n.handlers || (n.handlers = {}), n.handlers[t] || (n.handlers[t] = []), i.guid || (i.guid = an()), n.handlers[t].push(i), n.dispatcher || (n.disabled = !1, n.dispatcher = function (t, i) { if (!n.disabled) { t = cn(t); var r = n.handlers[t.type]; if (r) for (var a = r.slice(0), s = 0, o = a.length; s < o && !t.isImmediatePropagationStopped(); s++)try { a[s].call(e, t, i) } catch (e) { jt.error(e) } } }), 1 === n.handlers[t].length) if (e.addEventListener) { var a = !1; (function () { if ("boolean" != typeof sn) { sn = !1; try { var e = Object.defineProperty({}, "passive", { get: function () { sn = !0 } }); r().addEventListener("test", null, e), r().removeEventListener("test", null, e) } catch (e) { } } return sn })() && dn.indexOf(t) > -1 && (a = { passive: !0 }), e.addEventListener(t, n.dispatcher, a) } else e.attachEvent && e.attachEvent("on" + t, n.dispatcher) } function pn(e, t, i) { if (on.has(e)) { var n = on.get(e); if (n.handlers) { if (Array.isArray(t)) return ln(pn, e, t, i); var r = function (e, t) { n.handlers[t] = [], un(e, t) }; if (void 0 !== t) { var a = n.handlers[t]; if (a) if (i) { if (i.guid) for (var s = 0; s < a.length; s++)a[s].guid === i.guid && a.splice(s--, 1); un(e, t) } else r(e, t) } else for (var o in n.handlers) Object.prototype.hasOwnProperty.call(n.handlers || {}, o) && r(e, o) } } } function fn(e, t, i) { var n = on.has(e) ? on.get(e) : {}, r = e.parentNode || e.ownerDocument; if ("string" == typeof t ? t = { type: t, target: e } : t.target || (t.target = e), t = cn(t), n.dispatcher && n.dispatcher.call(e, t, i), r && !t.isPropagationStopped() && !0 === t.bubbles) fn.call(null, r, t, i); else if (!r && !t.defaultPrevented && t.target && t.target[t.type]) { on.has(t.target) || on.set(t.target, {}); var a = on.get(t.target); t.target[t.type] && (a.disabled = !0, "function" == typeof t.target[t.type] && t.target[t.type](), a.disabled = !1) } return !t.defaultPrevented } function mn(e, t, i) { if (Array.isArray(t)) return ln(mn, e, t, i); var n = function n() { pn(e, t, n), i.apply(this, arguments) }; n.guid = i.guid = i.guid || an(), hn(e, t, n) } function gn(e, t, i) { var n = function n() { pn(e, t, n), i.apply(this, arguments) }; n.guid = i.guid = i.guid || an(), hn(e, t, n) } var An, vn = Object.freeze({ __proto__: null, fixEvent: cn, on: hn, off: pn, trigger: fn, one: mn, any: gn }), yn = 30, _n = function (e, t, i) { t.guid || (t.guid = an()); var n = t.bind(e); return n.guid = i ? i + "_" + t.guid : t.guid, n }, bn = function (e, t) { var i = r().performance.now(); return function () { var n = r().performance.now(); n - i >= t && (e.apply(void 0, arguments), i = n) } }, Tn = function () { }; Tn.prototype.allowedEvents_ = {}, Tn.prototype.on = function (e, t) { var i = this.addEventListener; this.addEventListener = function () { }, hn(this, e, t), this.addEventListener = i }, Tn.prototype.addEventListener = Tn.prototype.on, Tn.prototype.off = function (e, t) { pn(this, e, t) }, Tn.prototype.removeEventListener = Tn.prototype.off, Tn.prototype.one = function (e, t) { var i = this.addEventListener; this.addEventListener = function () { }, mn(this, e, t), this.addEventListener = i }, Tn.prototype.any = function (e, t) { var i = this.addEventListener; this.addEventListener = function () { }, gn(this, e, t), this.addEventListener = i }, Tn.prototype.trigger = function (e) { var t = e.type || e; "string" == typeof e && (e = { type: t }), e = cn(e), this.allowedEvents_[t] && this["on" + t] && this["on" + t](e), fn(this, e) }, Tn.prototype.dispatchEvent = Tn.prototype.trigger, Tn.prototype.queueTrigger = function (e) { var t = this; An || (An = new Map); var i = e.type || e, n = An.get(this); n || (n = new Map, An.set(this, n)); var a = n.get(i); n.delete(i), r().clearTimeout(a); var s = r().setTimeout((function () { 0 === n.size && (n = null, An.delete(t)), t.trigger(e) }), 0); n.set(i, s) }; var xn = function (e) { return "function" == typeof e.name ? e.name() : "string" == typeof e.name ? e.name : e.name_ ? e.name_ : e.constructor && e.constructor.name ? e.constructor.name : typeof e }, Sn = function (e) { return e instanceof Tn || !!e.eventBusEl_ && ["on", "one", "off", "trigger"].every((function (t) { return "function" == typeof e[t] })) }, En = function (e) { return "string" == typeof e && /\S/.test(e) || Array.isArray(e) && !!e.length }, Cn = function (e, t, i) { if (!e || !e.nodeName && !Sn(e)) throw new Error("Invalid target for " + xn(t) + "#" + i + "; must be a DOM node or evented object.") }, wn = function (e, t, i) { if (!En(e)) throw new Error("Invalid event type for " + xn(t) + "#" + i + "; must be a non-empty string or array.") }, kn = function (e, t, i) { if ("function" != typeof e) throw new Error("Invalid listener for " + xn(t) + "#" + i + "; must be a function.") }, Fn = function (e, t, i) { var n, r, a, s = t.length < 3 || t[0] === e || t[0] === e.eventBusEl_; return s ? (n = e.eventBusEl_, t.length >= 3 && t.shift(), r = t[0], a = t[1]) : (n = t[0], r = t[1], a = t[2]), Cn(n, e, i), wn(r, e, i), kn(a, e, i), { isTargetingSelf: s, target: n, type: r, listener: a = _n(e, a) } }, In = function (e, t, i, n) { Cn(e, e, t), e.nodeName ? vn[t](e, i, n) : e[t](i, n) }, Dn = { on: function () { for (var e = this, t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; var r = Fn(this, i, "on"), a = r.isTargetingSelf, s = r.target, o = r.type, u = r.listener; if (In(s, "on", o, u), !a) { var l = function () { return e.off(s, o, u) }; l.guid = u.guid; var c = function () { return e.off("dispose", l) }; c.guid = u.guid, In(this, "on", "dispose", l), In(s, "on", "dispose", c) } }, one: function () { for (var e = this, t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; var r = Fn(this, i, "one"), a = r.isTargetingSelf, s = r.target, o = r.type, u = r.listener; if (a) In(s, "one", o, u); else { var l = function t() { e.off(s, o, t); for (var i = arguments.length, n = new Array(i), r = 0; r < i; r++)n[r] = arguments[r]; u.apply(null, n) }; l.guid = u.guid, In(s, "one", o, l) } }, any: function () { for (var e = this, t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; var r = Fn(this, i, "any"), a = r.isTargetingSelf, s = r.target, o = r.type, u = r.listener; if (a) In(s, "any", o, u); else { var l = function t() { e.off(s, o, t); for (var i = arguments.length, n = new Array(i), r = 0; r < i; r++)n[r] = arguments[r]; u.apply(null, n) }; l.guid = u.guid, In(s, "any", o, l) } }, off: function (e, t, i) { if (!e || En(e)) pn(this.eventBusEl_, e, t); else { var n = e, r = t; Cn(n, this, "off"), wn(r, this, "off"), kn(i, this, "off"), i = _n(this, i), this.off("dispose", i), n.nodeName ? (pn(n, r, i), pn(n, "dispose", i)) : Sn(n) && (n.off(r, i), n.off("dispose", i)) } }, trigger: function (e, t) { Cn(this.eventBusEl_, this, "trigger"); var i = e && "string" != typeof e ? e.type : e; if (!En(i)) { var n = "Invalid event type for " + xn(this) + "#trigger; must be a non-empty string or object with a type key that has a non-empty value."; if (!e) throw new Error(n); (this.log || jt).error(n) } return fn(this.eventBusEl_, e, t) } }; function Pn(e, t) { void 0 === t && (t = {}); var i = t.eventBusKey; if (i) { if (!e[i].nodeName) throw new Error('The eventBusKey "' + i + '" does not refer to an element.'); e.eventBusEl_ = e[i] } else e.eventBusEl_ = xi("span", { className: "vjs-event-bus" }); return Gt(e, Dn), e.eventedCallbacks && e.eventedCallbacks.forEach((function (e) { e() })), e.on("dispose", (function () { e.off(), [e, e.el_, e.eventBusEl_].forEach((function (e) { e && on.has(e) && on.delete(e) })), r().setTimeout((function () { e.eventBusEl_ = null }), 0) })), e } var Ln = { state: {}, setState: function (e) { var t, i = this; return "function" == typeof e && (e = e()), Wt(e, (function (e, n) { i.state[n] !== e && ((t = t || {})[n] = { from: i.state[n], to: e }), i.state[n] = e })), t && Sn(this) && this.trigger({ changes: t, type: "statechanged" }), t } }; function On(e, t) { return Gt(e, Ln), e.state = Gt({}, e.state, t), "function" == typeof e.handleStateChanged && Sn(e) && e.on("statechanged", e.handleStateChanged), e } var Bn = function (e) { return "string" != typeof e ? e : e.replace(/./, (function (e) { return e.toLowerCase() })) }, Rn = function (e) { return "string" != typeof e ? e : e.replace(/./, (function (e) { return e.toUpperCase() })) }; function Mn() { for (var e = {}, t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; return i.forEach((function (t) { t && Wt(t, (function (t, i) { Qt(t) ? (Qt(e[i]) || (e[i] = {}), e[i] = Mn(e[i], t)) : e[i] = t })) })), e } var Nn = function () { function e() { this.map_ = {} } var t = e.prototype; return t.has = function (e) { return e in this.map_ }, t.delete = function (e) { var t = this.has(e); return delete this.map_[e], t }, t.set = function (e, t) { return this.map_[e] = t, this }, t.forEach = function (e, t) { for (var i in this.map_) e.call(t, this.map_[i], i, this) }, e }(), Un = r().Map ? r().Map : Nn, jn = function () { function e() { this.set_ = {} } var t = e.prototype; return t.has = function (e) { return e in this.set_ }, t.delete = function (e) { var t = this.has(e); return delete this.set_[e], t }, t.add = function (e) { return this.set_[e] = 1, this }, t.forEach = function (e, t) { for (var i in this.set_) e.call(t, i, i, this) }, e }(), Hn = r().Set ? r().Set : jn, Vn = function () { function e(e, t, i) { if (!e && this.play ? this.player_ = e = this : this.player_ = e, this.isDisposed_ = !1, this.parentComponent_ = null, this.options_ = Mn({}, this.options_), t = this.options_ = Mn(this.options_, t), this.id_ = t.id || t.el && t.el.id, !this.id_) { var n = e && e.id && e.id() || "no_player"; this.id_ = n + "_component_" + an() } this.name_ = t.name || null, t.el ? this.el_ = t.el : !1 !== t.createEl && (this.el_ = this.createEl()), !1 !== t.evented && (Pn(this, { eventBusKey: this.el_ ? "el_" : null }), this.handleLanguagechange = this.handleLanguagechange.bind(this), this.on(this.player_, "languagechange", this.handleLanguagechange)), On(this, this.constructor.defaultState), this.children_ = [], this.childIndex_ = {}, this.childNameIndex_ = {}, this.setTimeoutIds_ = new Hn, this.setIntervalIds_ = new Hn, this.rafIds_ = new Hn, this.namedRafs_ = new Un, this.clearingTimersOnDispose_ = !1, !1 !== t.initChildren && this.initChildren(), this.ready(i), !1 !== t.reportTouchActivity && this.enableTouchActivity() } var t = e.prototype; return t.dispose = function () { if (!this.isDisposed_) { if (this.readyQueue_ && (this.readyQueue_.length = 0), this.trigger({ type: "dispose", bubbles: !1 }), this.isDisposed_ = !0, this.children_) for (var e = this.children_.length - 1; e >= 0; e--)this.children_[e].dispose && this.children_[e].dispose(); this.children_ = null, this.childIndex_ = null, this.childNameIndex_ = null, this.parentComponent_ = null, this.el_ && (this.el_.parentNode && this.el_.parentNode.removeChild(this.el_), this.el_ = null), this.player_ = null } }, t.isDisposed = function () { return Boolean(this.isDisposed_) }, t.player = function () { return this.player_ }, t.options = function (e) { return e ? (this.options_ = Mn(this.options_, e), this.options_) : this.options_ }, t.el = function () { return this.el_ }, t.createEl = function (e, t, i) { return xi(e, t, i) }, t.localize = function (e, t, i) { void 0 === i && (i = e); var n = this.player_.language && this.player_.language(), r = this.player_.languages && this.player_.languages(), a = r && r[n], s = n && n.split("-")[0], o = r && r[s], u = i; return a && a[e] ? u = a[e] : o && o[e] && (u = o[e]), t && (u = u.replace(/\{(\d+)\}/g, (function (e, i) { var n = t[i - 1], r = n; return void 0 === n && (r = e), r }))), u }, t.handleLanguagechange = function () { }, t.contentEl = function () { return this.contentEl_ || this.el_ }, t.id = function () { return this.id_ }, t.name = function () { return this.name_ }, t.children = function () { return this.children_ }, t.getChildById = function (e) { return this.childIndex_[e] }, t.getChild = function (e) { if (e) return this.childNameIndex_[e] }, t.getDescendant = function () { for (var e = arguments.length, t = new Array(e), i = 0; i < e; i++)t[i] = arguments[i]; t = t.reduce((function (e, t) { return e.concat(t) }), []); for (var n = this, r = 0; r < t.length; r++)if (!(n = n.getChild(t[r])) || !n.getChild) return; return n }, t.addChild = function (t, i, n) { var r, a; if (void 0 === i && (i = {}), void 0 === n && (n = this.children_.length), "string" == typeof t) { a = Rn(t); var s = i.componentClass || a; i.name = a; var o = e.getComponent(s); if (!o) throw new Error("Component " + s + " does not exist"); if ("function" != typeof o) return null; r = new o(this.player_ || this, i) } else r = t; if (r.parentComponent_ && r.parentComponent_.removeChild(r), this.children_.splice(n, 0, r), r.parentComponent_ = this, "function" == typeof r.id && (this.childIndex_[r.id()] = r), (a = a || r.name && Rn(r.name())) && (this.childNameIndex_[a] = r, this.childNameIndex_[Bn(a)] = r), "function" == typeof r.el && r.el()) { var u = null; this.children_[n + 1] && (this.children_[n + 1].el_ ? u = this.children_[n + 1].el_ : _i(this.children_[n + 1]) && (u = this.children_[n + 1])), this.contentEl().insertBefore(r.el(), u) } return r }, t.removeChild = function (e) { if ("string" == typeof e && (e = this.getChild(e)), e && this.children_) { for (var t = !1, i = this.children_.length - 1; i >= 0; i--)if (this.children_[i] === e) { t = !0, this.children_.splice(i, 1); break } if (t) { e.parentComponent_ = null, this.childIndex_[e.id()] = null, this.childNameIndex_[Rn(e.name())] = null, this.childNameIndex_[Bn(e.name())] = null; var n = e.el(); n && n.parentNode === this.contentEl() && this.contentEl().removeChild(e.el()) } } }, t.initChildren = function () { var t = this, i = this.options_.children; if (i) { var n, r = this.options_, a = e.getComponent("Tech"); (n = Array.isArray(i) ? i : Object.keys(i)).concat(Object.keys(this.options_).filter((function (e) { return !n.some((function (t) { return "string" == typeof t ? e === t : e === t.name })) }))).map((function (e) { var n, r; return "string" == typeof e ? r = i[n = e] || t.options_[n] || {} : (n = e.name, r = e), { name: n, opts: r } })).filter((function (t) { var i = e.getComponent(t.opts.componentClass || Rn(t.name)); return i && !a.isTech(i) })).forEach((function (e) { var i = e.name, n = e.opts; if (void 0 !== r[i] && (n = r[i]), !1 !== n) { !0 === n && (n = {}), n.playerOptions = t.options_.playerOptions; var a = t.addChild(i, n); a && (t[i] = a) } })) } }, t.buildCSSClass = function () { return "" }, t.ready = function (e, t) { if (void 0 === t && (t = !1), e) return this.isReady_ ? void (t ? e.call(this) : this.setTimeout(e, 1)) : (this.readyQueue_ = this.readyQueue_ || [], void this.readyQueue_.push(e)) }, t.triggerReady = function () { this.isReady_ = !0, this.setTimeout((function () { var e = this.readyQueue_; this.readyQueue_ = [], e && e.length > 0 && e.forEach((function (e) { e.call(this) }), this), this.trigger("ready") }), 1) }, t.$ = function (e, t) { return Qi(e, t || this.contentEl()) }, t.$$ = function (e, t) { return Xi(e, t || this.contentEl()) }, t.hasClass = function (e) { return Ci(this.el_, e) }, t.addClass = function (e) { wi(this.el_, e) }, t.removeClass = function (e) { ki(this.el_, e) }, t.toggleClass = function (e, t) { Fi(this.el_, e, t) }, t.show = function () { this.removeClass("vjs-hidden") }, t.hide = function () { this.addClass("vjs-hidden") }, t.lockShowing = function () { this.addClass("vjs-lock-showing") }, t.unlockShowing = function () { this.removeClass("vjs-lock-showing") }, t.getAttribute = function (e) { return Pi(this.el_, e) }, t.setAttribute = function (e, t) { Li(this.el_, e, t) }, t.removeAttribute = function (e) { Oi(this.el_, e) }, t.width = function (e, t) { return this.dimension("width", e, t) }, t.height = function (e, t) { return this.dimension("height", e, t) }, t.dimensions = function (e, t) { this.width(e, !0), this.height(t) }, t.dimension = function (e, t, i) { if (void 0 !== t) return null !== t && t == t || (t = 0), -1 !== ("" + t).indexOf("%") || -1 !== ("" + t).indexOf("px") ? this.el_.style[e] = t : this.el_.style[e] = "auto" === t ? "" : t + "px", void (i || this.trigger("componentresize")); if (!this.el_) return 0; var n = this.el_.style[e], r = n.indexOf("px"); return -1 !== r ? parseInt(n.slice(0, r), 10) : parseInt(this.el_["offset" + Rn(e)], 10) }, t.currentDimension = function (e) { var t = 0; if ("width" !== e && "height" !== e) throw new Error("currentDimension only accepts width or height value"); if (t = Xt(this.el_, e), 0 === (t = parseFloat(t)) || isNaN(t)) { var i = "offset" + Rn(e); t = this.el_[i] } return t }, t.currentDimensions = function () { return { width: this.currentDimension("width"), height: this.currentDimension("height") } }, t.currentWidth = function () { return this.currentDimension("width") }, t.currentHeight = function () { return this.currentDimension("height") }, t.focus = function () { this.el_.focus() }, t.blur = function () { this.el_.blur() }, t.handleKeyDown = function (e) { this.player_ && (l().isEventKey(e, "Tab") || e.stopPropagation(), this.player_.handleKeyDown(e)) }, t.handleKeyPress = function (e) { this.handleKeyDown(e) }, t.emitTapEvents = function () { var e, t = 0, i = null; this.on("touchstart", (function (n) { 1 === n.touches.length && (i = { pageX: n.touches[0].pageX, pageY: n.touches[0].pageY }, t = r().performance.now(), e = !0) })), this.on("touchmove", (function (t) { if (t.touches.length > 1) e = !1; else if (i) { var n = t.touches[0].pageX - i.pageX, r = t.touches[0].pageY - i.pageY; Math.sqrt(n * n + r * r) > 10 && (e = !1) } })); var n = function () { e = !1 }; this.on("touchleave", n), this.on("touchcancel", n), this.on("touchend", (function (n) { (i = null, !0 === e) && (r().performance.now() - t < 200 && (n.preventDefault(), this.trigger("tap"))) })) }, t.enableTouchActivity = function () { if (this.player() && this.player().reportUserActivity) { var e, t = _n(this.player(), this.player().reportUserActivity); this.on("touchstart", (function () { t(), this.clearInterval(e), e = this.setInterval(t, 250) })); var i = function (i) { t(), this.clearInterval(e) }; this.on("touchmove", t), this.on("touchend", i), this.on("touchcancel", i) } }, t.setTimeout = function (e, t) { var i, n = this; return e = _n(this, e), this.clearTimersOnDispose_(), i = r().setTimeout((function () { n.setTimeoutIds_.has(i) && n.setTimeoutIds_.delete(i), e() }), t), this.setTimeoutIds_.add(i), i }, t.clearTimeout = function (e) { return this.setTimeoutIds_.has(e) && (this.setTimeoutIds_.delete(e), r().clearTimeout(e)), e }, t.setInterval = function (e, t) { e = _n(this, e), this.clearTimersOnDispose_(); var i = r().setInterval(e, t); return this.setIntervalIds_.add(i), i }, t.clearInterval = function (e) { return this.setIntervalIds_.has(e) && (this.setIntervalIds_.delete(e), r().clearInterval(e)), e }, t.requestAnimationFrame = function (e) { var t, i = this; return this.supportsRaf_ ? (this.clearTimersOnDispose_(), e = _n(this, e), t = r().requestAnimationFrame((function () { i.rafIds_.has(t) && i.rafIds_.delete(t), e() })), this.rafIds_.add(t), t) : this.setTimeout(e, 1e3 / 60) }, t.requestNamedAnimationFrame = function (e, t) { var i = this; if (!this.namedRafs_.has(e)) { this.clearTimersOnDispose_(), t = _n(this, t); var n = this.requestAnimationFrame((function () { t(), i.namedRafs_.has(e) && i.namedRafs_.delete(e) })); return this.namedRafs_.set(e, n), e } }, t.cancelNamedAnimationFrame = function (e) { this.namedRafs_.has(e) && (this.cancelAnimationFrame(this.namedRafs_.get(e)), this.namedRafs_.delete(e)) }, t.cancelAnimationFrame = function (e) { return this.supportsRaf_ ? (this.rafIds_.has(e) && (this.rafIds_.delete(e), r().cancelAnimationFrame(e)), e) : this.clearTimeout(e) }, t.clearTimersOnDispose_ = function () { var e = this; this.clearingTimersOnDispose_ || (this.clearingTimersOnDispose_ = !0, this.one("dispose", (function () { [["namedRafs_", "cancelNamedAnimationFrame"], ["rafIds_", "cancelAnimationFrame"], ["setTimeoutIds_", "clearTimeout"], ["setIntervalIds_", "clearInterval"]].forEach((function (t) { var i = t[0], n = t[1]; e[i].forEach((function (t, i) { return e[n](i) })) })), e.clearingTimersOnDispose_ = !1 }))) }, e.registerComponent = function (t, i) { if ("string" != typeof t || !t) throw new Error('Illegal component name, "' + t + '"; must be a non-empty string.'); var n, r = e.getComponent("Tech"), a = r && r.isTech(i), s = e === i || e.prototype.isPrototypeOf(i.prototype); if (a || !s) throw n = a ? "techs must be registered using Tech.registerTech()" : "must be a Component subclass", new Error('Illegal component, "' + t + '"; ' + n + "."); t = Rn(t), e.components_ || (e.components_ = {}); var o = e.getComponent("Player"); if ("Player" === t && o && o.players) { var u = o.players, l = Object.keys(u); if (u && l.length > 0 && l.map((function (e) { return u[e] })).every(Boolean)) throw new Error("Can not register Player component after player has been created.") } return e.components_[t] = i, e.components_[Bn(t)] = i, i }, e.getComponent = function (t) { if (t && e.components_) return e.components_[t] }, e }(); function qn(e, t, i, n) { return function (e, t, i) { if ("number" != typeof t || t < 0 || t > i) throw new Error("Failed to execute '" + e + "' on 'TimeRanges': The index provided (" + t + ") is non-numeric or out of bounds (0-" + i + ").") }(e, n, i.length - 1), i[n][t] } function Wn(e) { var t; return t = void 0 === e || 0 === e.length ? { length: 0, start: function () { throw new Error("This TimeRanges object is empty") }, end: function () { throw new Error("This TimeRanges object is empty") } } : { length: e.length, start: qn.bind(null, "start", 0, e), end: qn.bind(null, "end", 1, e) }, r().Symbol && r().Symbol.iterator && (t[r().Symbol.iterator] = function () { return (e || []).values() }), t } function Gn(e, t) { return Array.isArray(e) ? Wn(e) : void 0 === e || void 0 === t ? Wn() : Wn([[e, t]]) } function zn(e, t) { var i, n, r = 0; if (!t) return 0; e && e.length || (e = Gn(0, 0)); for (var a = 0; a < e.length; a++)i = e.start(a), (n = e.end(a)) > t && (n = t), r += n - i; return r / t } function Qn(e) { if (e instanceof Qn) return e; "number" == typeof e ? this.code = e : "string" == typeof e ? this.message = e : zt(e) && ("number" == typeof e.code && (this.code = e.code), Gt(this, e)), this.message || (this.message = Qn.defaultMessages[this.code] || "") } Vn.prototype.supportsRaf_ = "function" == typeof r().requestAnimationFrame && "function" == typeof r().cancelAnimationFrame, Vn.registerComponent("Component", Vn), Qn.prototype.code = 0, Qn.prototype.message = "", Qn.prototype.status = null, Qn.errorTypes = ["MEDIA_ERR_CUSTOM", "MEDIA_ERR_ABORTED", "MEDIA_ERR_NETWORK", "MEDIA_ERR_DECODE", "MEDIA_ERR_SRC_NOT_SUPPORTED", "MEDIA_ERR_ENCRYPTED"], Qn.defaultMessages = { 1: "You aborted the media playback", 2: "A network error caused the media download to fail part-way.", 3: "The media playback was aborted due to a corruption problem or because the media used features your browser did not support.", 4: "The media could not be loaded, either because the server or network failed or because the format is not supported.", 5: "The media is encrypted and we do not have the keys to decrypt it." }; for (var Xn = 0; Xn < Qn.errorTypes.length; Xn++)Qn[Qn.errorTypes[Xn]] = Xn, Qn.prototype[Qn.errorTypes[Xn]] = Xn; function $n(e) { return null != e && "function" == typeof e.then } function Kn(e) { $n(e) && e.then(null, (function (e) { })) } var Yn = function (e) { return ["kind", "label", "language", "id", "inBandMetadataTrackDispatchType", "mode", "src"].reduce((function (t, i, n) { return e[i] && (t[i] = e[i]), t }), { cues: e.cues && Array.prototype.map.call(e.cues, (function (e) { return { startTime: e.startTime, endTime: e.endTime, text: e.text, id: e.id } })) }) }, Zn = function (e) { var t = e.$$("track"), i = Array.prototype.map.call(t, (function (e) { return e.track })); return Array.prototype.map.call(t, (function (e) { var t = Yn(e.track); return e.src && (t.src = e.src), t })).concat(Array.prototype.filter.call(e.textTracks(), (function (e) { return -1 === i.indexOf(e) })).map(Yn)) }, Jn = function (e, t) { return e.forEach((function (e) { var i = t.addRemoteTextTrack(e).track; !e.src && e.cues && e.cues.forEach((function (e) { return i.addCue(e) })) })), t.textTracks() }, er = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).handleKeyDown_ = function (e) { return n.handleKeyDown(e) }, n.close_ = function (e) { return n.close(e) }, n.opened_ = n.hasBeenOpened_ = n.hasBeenFilled_ = !1, n.closeable(!n.options_.uncloseable), n.content(n.options_.content), n.contentEl_ = xi("div", { className: "vjs-modal-dialog-content" }, { role: "document" }), n.descEl_ = xi("p", { className: "vjs-modal-dialog-description vjs-control-text", id: n.el().getAttribute("aria-describedby") }), Si(n.descEl_, n.description()), n.el_.appendChild(n.descEl_), n.el_.appendChild(n.contentEl_), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: this.buildCSSClass(), tabIndex: -1 }, { "aria-describedby": this.id() + "_description", "aria-hidden": "true", "aria-label": this.label(), role: "dialog" }) }, i.dispose = function () { this.contentEl_ = null, this.descEl_ = null, this.previouslyActiveEl_ = null, e.prototype.dispose.call(this) }, i.buildCSSClass = function () { return "vjs-modal-dialog vjs-hidden " + e.prototype.buildCSSClass.call(this) }, i.label = function () { return this.localize(this.options_.label || "Modal Window") }, i.description = function () { var e = this.options_.description || this.localize("This is a modal window."); return this.closeable() && (e += " " + this.localize("This modal can be closed by pressing the Escape key or activating the close button.")), e }, i.open = function () { if (!this.opened_) { var e = this.player(); this.trigger("beforemodalopen"), this.opened_ = !0, (this.options_.fillAlways || !this.hasBeenOpened_ && !this.hasBeenFilled_) && this.fill(), this.wasPlaying_ = !e.paused(), this.options_.pauseOnOpen && this.wasPlaying_ && e.pause(), this.on("keydown", this.handleKeyDown_), this.hadControls_ = e.controls(), e.controls(!1), this.show(), this.conditionalFocus_(), this.el().setAttribute("aria-hidden", "false"), this.trigger("modalopen"), this.hasBeenOpened_ = !0 } }, i.opened = function (e) { return "boolean" == typeof e && this[e ? "open" : "close"](), this.opened_ }, i.close = function () { if (this.opened_) { var e = this.player(); this.trigger("beforemodalclose"), this.opened_ = !1, this.wasPlaying_ && this.options_.pauseOnOpen && e.play(), this.off("keydown", this.handleKeyDown_), this.hadControls_ && e.controls(!0), this.hide(), this.el().setAttribute("aria-hidden", "true"), this.trigger("modalclose"), this.conditionalBlur_(), this.options_.temporary && this.dispose() } }, i.closeable = function (e) { if ("boolean" == typeof e) { var t = this.closeable_ = !!e, i = this.getChild("closeButton"); if (t && !i) { var n = this.contentEl_; this.contentEl_ = this.el_, i = this.addChild("closeButton", { controlText: "Close Modal Dialog" }), this.contentEl_ = n, this.on(i, "close", this.close_) } !t && i && (this.off(i, "close", this.close_), this.removeChild(i), i.dispose()) } return this.closeable_ }, i.fill = function () { this.fillWith(this.content()) }, i.fillWith = function (e) { var t = this.contentEl(), i = t.parentNode, n = t.nextSibling; this.trigger("beforemodalfill"), this.hasBeenFilled_ = !0, i.removeChild(t), this.empty(), Wi(t, e), this.trigger("modalfill"), n ? i.insertBefore(t, n) : i.appendChild(t); var r = this.getChild("closeButton"); r && i.appendChild(r.el_) }, i.empty = function () { this.trigger("beforemodalempty"), Hi(this.contentEl()), this.trigger("modalempty") }, i.content = function (e) { return void 0 !== e && (this.content_ = e), this.content_ }, i.conditionalFocus_ = function () { var e = s().activeElement, t = this.player_.el_; this.previouslyActiveEl_ = null, (t.contains(e) || t === e) && (this.previouslyActiveEl_ = e, this.focus()) }, i.conditionalBlur_ = function () { this.previouslyActiveEl_ && (this.previouslyActiveEl_.focus(), this.previouslyActiveEl_ = null) }, i.handleKeyDown = function (e) { if (e.stopPropagation(), l().isEventKey(e, "Escape") && this.closeable()) return e.preventDefault(), void this.close(); if (l().isEventKey(e, "Tab")) { for (var t, i = this.focusableEls_(), n = this.el_.querySelector(":focus"), r = 0; r < i.length; r++)if (n === i[r]) { t = r; break } s().activeElement === this.el_ && (t = 0), e.shiftKey && 0 === t ? (i[i.length - 1].focus(), e.preventDefault()) : e.shiftKey || t !== i.length - 1 || (i[0].focus(), e.preventDefault()) } }, i.focusableEls_ = function () { var e = this.el_.querySelectorAll("*"); return Array.prototype.filter.call(e, (function (e) { return (e instanceof r().HTMLAnchorElement || e instanceof r().HTMLAreaElement) && e.hasAttribute("href") || (e instanceof r().HTMLInputElement || e instanceof r().HTMLSelectElement || e instanceof r().HTMLTextAreaElement || e instanceof r().HTMLButtonElement) && !e.hasAttribute("disabled") || e instanceof r().HTMLIFrameElement || e instanceof r().HTMLObjectElement || e instanceof r().HTMLEmbedElement || e.hasAttribute("tabindex") && -1 !== e.getAttribute("tabindex") || e.hasAttribute("contenteditable") })) }, t }(Vn); er.prototype.options_ = { pauseOnOpen: !0, temporary: !0 }, Vn.registerComponent("ModalDialog", er); var tr = function (e) { function t(t) { var i; void 0 === t && (t = []), (i = e.call(this) || this).tracks_ = [], Object.defineProperty(c(i), "length", { get: function () { return this.tracks_.length } }); for (var n = 0; n < t.length; n++)i.addTrack(t[n]); return i } h(t, e); var i = t.prototype; return i.addTrack = function (e) { var t = this, i = this.tracks_.length; "" + i in this || Object.defineProperty(this, i, { get: function () { return this.tracks_[i] } }), -1 === this.tracks_.indexOf(e) && (this.tracks_.push(e), this.trigger({ track: e, type: "addtrack", target: this })), e.labelchange_ = function () { t.trigger({ track: e, type: "labelchange", target: t }) }, Sn(e) && e.addEventListener("labelchange", e.labelchange_) }, i.removeTrack = function (e) { for (var t, i = 0, n = this.length; i < n; i++)if (this[i] === e) { (t = this[i]).off && t.off(), this.tracks_.splice(i, 1); break } t && this.trigger({ track: t, type: "removetrack", target: this }) }, i.getTrackById = function (e) { for (var t = null, i = 0, n = this.length; i < n; i++) { var r = this[i]; if (r.id === e) { t = r; break } } return t }, t }(Tn); for (var ir in tr.prototype.allowedEvents_ = { change: "change", addtrack: "addtrack", removetrack: "removetrack", labelchange: "labelchange" }, tr.prototype.allowedEvents_) tr.prototype["on" + ir] = null; var nr = function (e, t) { for (var i = 0; i < e.length; i++)Object.keys(e[i]).length && t.id !== e[i].id && (e[i].enabled = !1) }, rr = function (e) { function t(t) { var i; void 0 === t && (t = []); for (var n = t.length - 1; n >= 0; n--)if (t[n].enabled) { nr(t, t[n]); break } return (i = e.call(this, t) || this).changing_ = !1, i } h(t, e); var i = t.prototype; return i.addTrack = function (t) { var i = this; t.enabled && nr(this, t), e.prototype.addTrack.call(this, t), t.addEventListener && (t.enabledChange_ = function () { i.changing_ || (i.changing_ = !0, nr(i, t), i.changing_ = !1, i.trigger("change")) }, t.addEventListener("enabledchange", t.enabledChange_)) }, i.removeTrack = function (t) { e.prototype.removeTrack.call(this, t), t.removeEventListener && t.enabledChange_ && (t.removeEventListener("enabledchange", t.enabledChange_), t.enabledChange_ = null) }, t }(tr), ar = function (e, t) { for (var i = 0; i < e.length; i++)Object.keys(e[i]).length && t.id !== e[i].id && (e[i].selected = !1) }, sr = function (e) { function t(t) { var i; void 0 === t && (t = []); for (var n = t.length - 1; n >= 0; n--)if (t[n].selected) { ar(t, t[n]); break } return (i = e.call(this, t) || this).changing_ = !1, Object.defineProperty(c(i), "selectedIndex", { get: function () { for (var e = 0; e < this.length; e++)if (this[e].selected) return e; return -1 }, set: function () { } }), i } h(t, e); var i = t.prototype; return i.addTrack = function (t) { var i = this; t.selected && ar(this, t), e.prototype.addTrack.call(this, t), t.addEventListener && (t.selectedChange_ = function () { i.changing_ || (i.changing_ = !0, ar(i, t), i.changing_ = !1, i.trigger("change")) }, t.addEventListener("selectedchange", t.selectedChange_)) }, i.removeTrack = function (t) { e.prototype.removeTrack.call(this, t), t.removeEventListener && t.selectedChange_ && (t.removeEventListener("selectedchange", t.selectedChange_), t.selectedChange_ = null) }, t }(tr), or = function (e) { function t() { return e.apply(this, arguments) || this } h(t, e); var i = t.prototype; return i.addTrack = function (t) { var i = this; e.prototype.addTrack.call(this, t), this.queueChange_ || (this.queueChange_ = function () { return i.queueTrigger("change") }), this.triggerSelectedlanguagechange || (this.triggerSelectedlanguagechange_ = function () { return i.trigger("selectedlanguagechange") }), t.addEventListener("modechange", this.queueChange_); -1 === ["metadata", "chapters"].indexOf(t.kind) && t.addEventListener("modechange", this.triggerSelectedlanguagechange_) }, i.removeTrack = function (t) { e.prototype.removeTrack.call(this, t), t.removeEventListener && (this.queueChange_ && t.removeEventListener("modechange", this.queueChange_), this.selectedlanguagechange_ && t.removeEventListener("modechange", this.triggerSelectedlanguagechange_)) }, t }(tr), ur = function () { function e(e) { void 0 === e && (e = []), this.trackElements_ = [], Object.defineProperty(this, "length", { get: function () { return this.trackElements_.length } }); for (var t = 0, i = e.length; t < i; t++)this.addTrackElement_(e[t]) } var t = e.prototype; return t.addTrackElement_ = function (e) { var t = this.trackElements_.length; "" + t in this || Object.defineProperty(this, t, { get: function () { return this.trackElements_[t] } }), -1 === this.trackElements_.indexOf(e) && this.trackElements_.push(e) }, t.getTrackElementByTrack_ = function (e) { for (var t, i = 0, n = this.trackElements_.length; i < n; i++)if (e === this.trackElements_[i].track) { t = this.trackElements_[i]; break } return t }, t.removeTrackElement_ = function (e) { for (var t = 0, i = this.trackElements_.length; t < i; t++)if (e === this.trackElements_[t]) { this.trackElements_[t].track && "function" == typeof this.trackElements_[t].track.off && this.trackElements_[t].track.off(), "function" == typeof this.trackElements_[t].off && this.trackElements_[t].off(), this.trackElements_.splice(t, 1); break } }, e }(), lr = function () { function e(t) { e.prototype.setCues_.call(this, t), Object.defineProperty(this, "length", { get: function () { return this.length_ } }) } var t = e.prototype; return t.setCues_ = function (e) { var t = this.length || 0, i = 0, n = e.length; this.cues_ = e, this.length_ = e.length; var r = function (e) { "" + e in this || Object.defineProperty(this, "" + e, { get: function () { return this.cues_[e] } }) }; if (t < n) for (i = t; i < n; i++)r.call(this, i) }, t.getCueById = function (e) { for (var t = null, i = 0, n = this.length; i < n; i++) { var r = this[i]; if (r.id === e) { t = r; break } } return t }, e }(), cr = { alternative: "alternative", captions: "captions", main: "main", sign: "sign", subtitles: "subtitles", commentary: "commentary" }, dr = { alternative: "alternative", descriptions: "descriptions", main: "main", "main-desc": "main-desc", translation: "translation", commentary: "commentary" }, hr = { subtitles: "subtitles", captions: "captions", descriptions: "descriptions", chapters: "chapters", metadata: "metadata" }, pr = { disabled: "disabled", hidden: "hidden", showing: "showing" }, fr = function (e) { function t(t) { var i; void 0 === t && (t = {}), i = e.call(this) || this; var n = { id: t.id || "vjs_track_" + an(), kind: t.kind || "", language: t.language || "" }, r = t.label || "", a = function (e) { Object.defineProperty(c(i), e, { get: function () { return n[e] }, set: function () { } }) }; for (var s in n) a(s); return Object.defineProperty(c(i), "label", { get: function () { return r }, set: function (e) { e !== r && (r = e, this.trigger("labelchange")) } }), i } return h(t, e), t }(Tn), mr = function (e) { var t = ["protocol", "hostname", "port", "pathname", "search", "hash", "host"], i = s().createElement("a"); i.href = e; for (var n = {}, a = 0; a < t.length; a++)n[t[a]] = i[t[a]]; return "http:" === n.protocol && (n.host = n.host.replace(/:80$/, "")), "https:" === n.protocol && (n.host = n.host.replace(/:443$/, "")), n.protocol || (n.protocol = r().location.protocol), n.host || (n.host = r().location.host), n }, gr = function (e) { if (!e.match(/^https?:\/\//)) { var t = s().createElement("a"); t.href = e, e = t.href } return e }, Ar = function (e) { if ("string" == typeof e) { var t = /^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e); if (t) return t.pop().toLowerCase() } return "" }, vr = function (e, t) { void 0 === t && (t = r().location); var i = mr(e); return (":" === i.protocol ? t.protocol : i.protocol) + i.host !== t.protocol + t.host }, yr = Object.freeze({ __proto__: null, parseUrl: mr, getAbsoluteURL: gr, getFileExtension: Ar, isCrossOrigin: vr }), _r = function (e, t) { var i = new (r().WebVTT.Parser)(r(), r().vttjs, r().WebVTT.StringDecoder()), n = []; i.oncue = function (e) { t.addCue(e) }, i.onparsingerror = function (e) { n.push(e) }, i.onflush = function () { t.trigger({ type: "loadeddata", target: t }) }, i.parse(e), n.length > 0 && (r().console && r().console.groupCollapsed && r().console.groupCollapsed("Text Track parsing errors for " + t.src), n.forEach((function (e) { return jt.error(e) })), r().console && r().console.groupEnd && r().console.groupEnd()), i.flush() }, br = function (e, t) { var i = { uri: e }, n = vr(e); n && (i.cors = n); var a = "use-credentials" === t.tech_.crossOrigin(); a && (i.withCredentials = a), g()(i, _n(this, (function (e, i, n) { if (e) return jt.error(e, i); t.loaded_ = !0, "function" != typeof r().WebVTT ? t.tech_ && t.tech_.any(["vttjsloaded", "vttjserror"], (function (e) { if ("vttjserror" !== e.type) return _r(n, t); jt.error("vttjs failed to load, stopping trying to process " + t.src) })) : _r(n, t) }))) }, Tr = function (e) { function t(t) { var i; if (void 0 === t && (t = {}), !t.tech) throw new Error("A tech was not provided."); var n = Mn(t, { kind: hr[t.kind] || "subtitles", language: t.language || t.srclang || "" }), r = pr[n.mode] || "disabled", a = n.default; "metadata" !== n.kind && "chapters" !== n.kind || (r = "hidden"), (i = e.call(this, n) || this).tech_ = n.tech, i.cues_ = [], i.activeCues_ = [], i.preload_ = !1 !== i.tech_.preloadTextTracks; var s = new lr(i.cues_), o = new lr(i.activeCues_), u = !1, l = _n(c(i), (function () { this.tech_.isReady_ && !this.tech_.isDisposed() && (this.activeCues = this.activeCues, u && (this.trigger("cuechange"), u = !1)) })); return i.tech_.one("dispose", (function () { i.tech_.off("timeupdate", l) })), "disabled" !== r && i.tech_.on("timeupdate", l), Object.defineProperties(c(i), { default: { get: function () { return a }, set: function () { } }, mode: { get: function () { return r }, set: function (e) { pr[e] && r !== e && (r = e, this.preload_ || "disabled" === r || 0 !== this.cues.length || br(this.src, this), this.tech_.off("timeupdate", l), "disabled" !== r && this.tech_.on("timeupdate", l), this.trigger("modechange")) } }, cues: { get: function () { return this.loaded_ ? s : null }, set: function () { } }, activeCues: { get: function () { if (!this.loaded_) return null; if (0 === this.cues.length) return o; for (var e = this.tech_.currentTime(), t = [], i = 0, n = this.cues.length; i < n; i++) { var r = this.cues[i]; (r.startTime <= e && r.endTime >= e || r.startTime === r.endTime && r.startTime <= e && r.startTime + .5 >= e) && t.push(r) } if (u = !1, t.length !== this.activeCues_.length) u = !0; else for (var a = 0; a < t.length; a++)-1 === this.activeCues_.indexOf(t[a]) && (u = !0); return this.activeCues_ = t, o.setCues_(this.activeCues_), o }, set: function () { } } }), n.src ? (i.src = n.src, i.preload_ || (i.loaded_ = !0), (i.preload_ || "subtitles" !== n.kind && "captions" !== n.kind) && br(i.src, c(i))) : i.loaded_ = !0, i } h(t, e); var i = t.prototype; return i.addCue = function (e) { var t = e; if (r().vttjs && !(e instanceof r().vttjs.VTTCue)) { for (var i in t = new (r().vttjs.VTTCue)(e.startTime, e.endTime, e.text), e) i in t || (t[i] = e[i]); t.id = e.id, t.originalCue_ = e } for (var n = this.tech_.textTracks(), a = 0; a < n.length; a++)n[a] !== this && n[a].removeCue(t); this.cues_.push(t), this.cues.setCues_(this.cues_) }, i.removeCue = function (e) { for (var t = this.cues_.length; t--;) { var i = this.cues_[t]; if (i === e || i.originalCue_ && i.originalCue_ === e) { this.cues_.splice(t, 1), this.cues.setCues_(this.cues_); break } } }, t }(fr); Tr.prototype.allowedEvents_ = { cuechange: "cuechange" }; var xr = function (e) { function t(t) { var i; void 0 === t && (t = {}); var n = Mn(t, { kind: dr[t.kind] || "" }); i = e.call(this, n) || this; var r = !1; return Object.defineProperty(c(i), "enabled", { get: function () { return r }, set: function (e) { "boolean" == typeof e && e !== r && (r = e, this.trigger("enabledchange")) } }), n.enabled && (i.enabled = n.enabled), i.loaded_ = !0, i } return h(t, e), t }(fr), Sr = function (e) { function t(t) { var i; void 0 === t && (t = {}); var n = Mn(t, { kind: cr[t.kind] || "" }); i = e.call(this, n) || this; var r = !1; return Object.defineProperty(c(i), "selected", { get: function () { return r }, set: function (e) { "boolean" == typeof e && e !== r && (r = e, this.trigger("selectedchange")) } }), n.selected && (i.selected = n.selected), i } return h(t, e), t }(fr), Er = function (e) { function t(t) { var i, n; void 0 === t && (t = {}), i = e.call(this) || this; var r = new Tr(t); return i.kind = r.kind, i.src = r.src, i.srclang = r.language, i.label = r.label, i.default = r.default, Object.defineProperties(c(i), { readyState: { get: function () { return n } }, track: { get: function () { return r } } }), n = 0, r.addEventListener("loadeddata", (function () { n = 2, i.trigger({ type: "load", target: c(i) }) })), i } return h(t, e), t }(Tn); Er.prototype.allowedEvents_ = { load: "load" }, Er.NONE = 0, Er.LOADING = 1, Er.LOADED = 2, Er.ERROR = 3; var Cr = { audio: { ListClass: rr, TrackClass: xr, capitalName: "Audio" }, video: { ListClass: sr, TrackClass: Sr, capitalName: "Video" }, text: { ListClass: or, TrackClass: Tr, capitalName: "Text" } }; Object.keys(Cr).forEach((function (e) { Cr[e].getterName = e + "Tracks", Cr[e].privateName = e + "Tracks_" })); var wr = { remoteText: { ListClass: or, TrackClass: Tr, capitalName: "RemoteText", getterName: "remoteTextTracks", privateName: "remoteTextTracks_" }, remoteTextEl: { ListClass: ur, TrackClass: Er, capitalName: "RemoteTextTrackEls", getterName: "remoteTextTrackEls", privateName: "remoteTextTrackEls_" } }, kr = o({}, Cr, wr); wr.names = Object.keys(wr), Cr.names = Object.keys(Cr), kr.names = [].concat(wr.names).concat(Cr.names); var Fr = function (e) { function t(t, i) { var n; return void 0 === t && (t = {}), void 0 === i && (i = function () { }), t.reportTouchActivity = !1, (n = e.call(this, null, t, i) || this).onDurationChange_ = function (e) { return n.onDurationChange(e) }, n.trackProgress_ = function (e) { return n.trackProgress(e) }, n.trackCurrentTime_ = function (e) { return n.trackCurrentTime(e) }, n.stopTrackingCurrentTime_ = function (e) { return n.stopTrackingCurrentTime(e) }, n.disposeSourceHandler_ = function (e) { return n.disposeSourceHandler(e) }, n.hasStarted_ = !1, n.on("playing", (function () { this.hasStarted_ = !0 })), n.on("loadstart", (function () { this.hasStarted_ = !1 })), kr.names.forEach((function (e) { var i = kr[e]; t && t[i.getterName] && (n[i.privateName] = t[i.getterName]) })), n.featuresProgressEvents || n.manualProgressOn(), n.featuresTimeupdateEvents || n.manualTimeUpdatesOn(), ["Text", "Audio", "Video"].forEach((function (e) { !1 === t["native" + e + "Tracks"] && (n["featuresNative" + e + "Tracks"] = !1) })), !1 === t.nativeCaptions || !1 === t.nativeTextTracks ? n.featuresNativeTextTracks = !1 : !0 !== t.nativeCaptions && !0 !== t.nativeTextTracks || (n.featuresNativeTextTracks = !0), n.featuresNativeTextTracks || n.emulateTextTracks(), n.preloadTextTracks = !1 !== t.preloadTextTracks, n.autoRemoteTextTracks_ = new kr.text.ListClass, n.initTrackListeners(), t.nativeControlsForTouch || n.emitTapEvents(), n.constructor && (n.name_ = n.constructor.name || "Unknown Tech"), n } h(t, e); var i = t.prototype; return i.triggerSourceset = function (e) { var t = this; this.isReady_ || this.one("ready", (function () { return t.setTimeout((function () { return t.triggerSourceset(e) }), 1) })), this.trigger({ src: e, type: "sourceset" }) }, i.manualProgressOn = function () { this.on("durationchange", this.onDurationChange_), this.manualProgress = !0, this.one("ready", this.trackProgress_) }, i.manualProgressOff = function () { this.manualProgress = !1, this.stopTrackingProgress(), this.off("durationchange", this.onDurationChange_) }, i.trackProgress = function (e) { this.stopTrackingProgress(), this.progressInterval = this.setInterval(_n(this, (function () { var e = this.bufferedPercent(); this.bufferedPercent_ !== e && this.trigger("progress"), this.bufferedPercent_ = e, 1 === e && this.stopTrackingProgress() })), 500) }, i.onDurationChange = function (e) { this.duration_ = this.duration() }, i.buffered = function () { return Gn(0, 0) }, i.bufferedPercent = function () { return zn(this.buffered(), this.duration_) }, i.stopTrackingProgress = function () { this.clearInterval(this.progressInterval) }, i.manualTimeUpdatesOn = function () { this.manualTimeUpdates = !0, this.on("play", this.trackCurrentTime_), this.on("pause", this.stopTrackingCurrentTime_) }, i.manualTimeUpdatesOff = function () { this.manualTimeUpdates = !1, this.stopTrackingCurrentTime(), this.off("play", this.trackCurrentTime_), this.off("pause", this.stopTrackingCurrentTime_) }, i.trackCurrentTime = function () { this.currentTimeInterval && this.stopTrackingCurrentTime(), this.currentTimeInterval = this.setInterval((function () { this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }), 250) }, i.stopTrackingCurrentTime = function () { this.clearInterval(this.currentTimeInterval), this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, i.dispose = function () { this.clearTracks(Cr.names), this.manualProgress && this.manualProgressOff(), this.manualTimeUpdates && this.manualTimeUpdatesOff(), e.prototype.dispose.call(this) }, i.clearTracks = function (e) { var t = this; (e = [].concat(e)).forEach((function (e) { for (var i = t[e + "Tracks"]() || [], n = i.length; n--;) { var r = i[n]; "text" === e && t.removeRemoteTextTrack(r), i.removeTrack(r) } })) }, i.cleanupAutoTextTracks = function () { for (var e = this.autoRemoteTextTracks_ || [], t = e.length; t--;) { var i = e[t]; this.removeRemoteTextTrack(i) } }, i.reset = function () { }, i.crossOrigin = function () { }, i.setCrossOrigin = function () { }, i.error = function (e) { return void 0 !== e && (this.error_ = new Qn(e), this.trigger("error")), this.error_ }, i.played = function () { return this.hasStarted_ ? Gn(0, 0) : Gn() }, i.play = function () { }, i.setScrubbing = function () { }, i.scrubbing = function () { }, i.setCurrentTime = function () { this.manualTimeUpdates && this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, i.initTrackListeners = function () { var e = this; Cr.names.forEach((function (t) { var i = Cr[t], n = function () { e.trigger(t + "trackchange") }, r = e[i.getterName](); r.addEventListener("removetrack", n), r.addEventListener("addtrack", n), e.on("dispose", (function () { r.removeEventListener("removetrack", n), r.removeEventListener("addtrack", n) })) })) }, i.addWebVttScript_ = function () { var e = this; if (!r().WebVTT) if (s().body.contains(this.el())) { if (!this.options_["vtt.js"] && Qt(v()) && Object.keys(v()).length > 0) return void this.trigger("vttjsloaded"); var t = s().createElement("script"); t.src = this.options_["vtt.js"] || "https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js", t.onload = function () { e.trigger("vttjsloaded") }, t.onerror = function () { e.trigger("vttjserror") }, this.on("dispose", (function () { t.onload = null, t.onerror = null })), r().WebVTT = !0, this.el().parentNode.appendChild(t) } else this.ready(this.addWebVttScript_) }, i.emulateTextTracks = function () { var e = this, t = this.textTracks(), i = this.remoteTextTracks(), n = function (e) { return t.addTrack(e.track) }, r = function (e) { return t.removeTrack(e.track) }; i.on("addtrack", n), i.on("removetrack", r), this.addWebVttScript_(); var a = function () { return e.trigger("texttrackchange") }, s = function () { a(); for (var e = 0; e < t.length; e++) { var i = t[e]; i.removeEventListener("cuechange", a), "showing" === i.mode && i.addEventListener("cuechange", a) } }; s(), t.addEventListener("change", s), t.addEventListener("addtrack", s), t.addEventListener("removetrack", s), this.on("dispose", (function () { i.off("addtrack", n), i.off("removetrack", r), t.removeEventListener("change", s), t.removeEventListener("addtrack", s), t.removeEventListener("removetrack", s); for (var e = 0; e < t.length; e++) { t[e].removeEventListener("cuechange", a) } })) }, i.addTextTrack = function (e, t, i) { if (!e) throw new Error("TextTrack kind is required but was not provided"); return function (e, t, i, n, r) { void 0 === r && (r = {}); var a = e.textTracks(); r.kind = t, i && (r.label = i), n && (r.language = n), r.tech = e; var s = new kr.text.TrackClass(r); return a.addTrack(s), s }(this, e, t, i) }, i.createRemoteTextTrack = function (e) { var t = Mn(e, { tech: this }); return new wr.remoteTextEl.TrackClass(t) }, i.addRemoteTextTrack = function (e, t) { var i = this; void 0 === e && (e = {}); var n = this.createRemoteTextTrack(e); return !0 !== t && !1 !== t && (jt.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'), t = !0), this.remoteTextTrackEls().addTrackElement_(n), this.remoteTextTracks().addTrack(n.track), !0 !== t && this.ready((function () { return i.autoRemoteTextTracks_.addTrack(n.track) })), n }, i.removeRemoteTextTrack = function (e) { var t = this.remoteTextTrackEls().getTrackElementByTrack_(e); this.remoteTextTrackEls().removeTrackElement_(t), this.remoteTextTracks().removeTrack(e), this.autoRemoteTextTracks_.removeTrack(e) }, i.getVideoPlaybackQuality = function () { return {} }, i.requestPictureInPicture = function () { var e = this.options_.Promise || r().Promise; if (e) return e.reject() }, i.disablePictureInPicture = function () { return !0 }, i.setDisablePictureInPicture = function () { }, i.setPoster = function () { }, i.playsinline = function () { }, i.setPlaysinline = function () { }, i.overrideNativeAudioTracks = function () { }, i.overrideNativeVideoTracks = function () { }, i.canPlayType = function () { return "" }, t.canPlayType = function () { return "" }, t.canPlaySource = function (e, i) { return t.canPlayType(e.type) }, t.isTech = function (e) { return e.prototype instanceof t || e instanceof t || e === t }, t.registerTech = function (e, i) { if (t.techs_ || (t.techs_ = {}), !t.isTech(i)) throw new Error("Tech " + e + " must be a Tech"); if (!t.canPlayType) throw new Error("Techs must have a static canPlayType method on them"); if (!t.canPlaySource) throw new Error("Techs must have a static canPlaySource method on them"); return e = Rn(e), t.techs_[e] = i, t.techs_[Bn(e)] = i, "Tech" !== e && t.defaultTechOrder_.push(e), i }, t.getTech = function (e) { if (e) return t.techs_ && t.techs_[e] ? t.techs_[e] : (e = Rn(e), r() && r().videojs && r().videojs[e] ? (jt.warn("The " + e + " tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"), r().videojs[e]) : void 0) }, t }(Vn); kr.names.forEach((function (e) { var t = kr[e]; Fr.prototype[t.getterName] = function () { return this[t.privateName] = this[t.privateName] || new t.ListClass, this[t.privateName] } })), Fr.prototype.featuresVolumeControl = !0, Fr.prototype.featuresMuteControl = !0, Fr.prototype.featuresFullscreenResize = !1, Fr.prototype.featuresPlaybackRate = !1, Fr.prototype.featuresProgressEvents = !1, Fr.prototype.featuresSourceset = !1, Fr.prototype.featuresTimeupdateEvents = !1, Fr.prototype.featuresNativeTextTracks = !1, Fr.withSourceHandlers = function (e) { e.registerSourceHandler = function (t, i) { var n = e.sourceHandlers; n || (n = e.sourceHandlers = []), void 0 === i && (i = n.length), n.splice(i, 0, t) }, e.canPlayType = function (t) { for (var i, n = e.sourceHandlers || [], r = 0; r < n.length; r++)if (i = n[r].canPlayType(t)) return i; return "" }, e.selectSourceHandler = function (t, i) { for (var n = e.sourceHandlers || [], r = 0; r < n.length; r++)if (n[r].canHandleSource(t, i)) return n[r]; return null }, e.canPlaySource = function (t, i) { var n = e.selectSourceHandler(t, i); return n ? n.canHandleSource(t, i) : "" };["seekable", "seeking", "duration"].forEach((function (e) { var t = this[e]; "function" == typeof t && (this[e] = function () { return this.sourceHandler_ && this.sourceHandler_[e] ? this.sourceHandler_[e].apply(this.sourceHandler_, arguments) : t.apply(this, arguments) }) }), e.prototype), e.prototype.setSource = function (t) { var i = e.selectSourceHandler(t, this.options_); i || (e.nativeSourceHandler ? i = e.nativeSourceHandler : jt.error("No source handler found for the current source.")), this.disposeSourceHandler(), this.off("dispose", this.disposeSourceHandler_), i !== e.nativeSourceHandler && (this.currentSource_ = t), this.sourceHandler_ = i.handleSource(t, this, this.options_), this.one("dispose", this.disposeSourceHandler_) }, e.prototype.disposeSourceHandler = function () { this.currentSource_ && (this.clearTracks(["audio", "video"]), this.currentSource_ = null), this.cleanupAutoTextTracks(), this.sourceHandler_ && (this.sourceHandler_.dispose && this.sourceHandler_.dispose(), this.sourceHandler_ = null) } }, Vn.registerComponent("Tech", Fr), Fr.registerTech("Tech", Fr), Fr.defaultTechOrder_ = []; var Ir = {}, Dr = {}, Pr = {}; function Lr(e, t, i) { e.setTimeout((function () { return Ur(t, Ir[t.type], i, e) }), 1) } function Or(e, t, i, n) { void 0 === n && (n = null); var r = "call" + Rn(i), a = e.reduce(Nr(r), n), s = a === Pr, o = s ? null : t[i](a); return function (e, t, i, n) { for (var r = e.length - 1; r >= 0; r--) { var a = e[r]; a[t] && a[t](n, i) } }(e, i, o, s), o } var Br = { buffered: 1, currentTime: 1, duration: 1, muted: 1, played: 1, paused: 1, seekable: 1, volume: 1, ended: 1 }, Rr = { setCurrentTime: 1, setMuted: 1, setVolume: 1 }, Mr = { play: 1, pause: 1 }; function Nr(e) { return function (t, i) { return t === Pr ? Pr : i[e] ? i[e](t) : t } } function Ur(e, t, i, n, r, a) { void 0 === e && (e = {}), void 0 === t && (t = []), void 0 === r && (r = []), void 0 === a && (a = !1); var s = t, o = s[0], u = s.slice(1); if ("string" == typeof o) Ur(e, Ir[o], i, n, r, a); else if (o) { var l = function (e, t) { var i = Dr[e.id()], n = null; if (null == i) return n = t(e), Dr[e.id()] = [[t, n]], n; for (var r = 0; r < i.length; r++) { var a = i[r], s = a[0], o = a[1]; s === t && (n = o) } return null === n && (n = t(e), i.push([t, n])), n }(n, o); if (!l.setSource) return r.push(l), Ur(e, u, i, n, r, a); l.setSource(Gt({}, e), (function (t, s) { if (t) return Ur(e, u, i, n, r, a); r.push(l), Ur(s, e.type === s.type ? u : Ir[s.type], i, n, r, a) })) } else u.length ? Ur(e, u, i, n, r, a) : a ? i(e, r) : Ur(e, Ir["*"], i, n, r, !0) } var jr = { opus: "video/ogg", ogv: "video/ogg", mp4: "video/mp4", mov: "video/mp4", m4v: "video/mp4", mkv: "video/x-matroska", m4a: "audio/mp4", mp3: "audio/mpeg", aac: "audio/aac", caf: "audio/x-caf", flac: "audio/flac", oga: "audio/ogg", wav: "audio/wav", m3u8: "application/x-mpegURL", jpg: "image/jpeg", jpeg: "image/jpeg", gif: "image/gif", png: "image/png", svg: "image/svg+xml", webp: "image/webp" }, Hr = function (e) { void 0 === e && (e = ""); var t = Ar(e); return jr[t.toLowerCase()] || "" }, Vr = function e(t) { if (Array.isArray(t)) { var i = []; t.forEach((function (t) { t = e(t), Array.isArray(t) ? i = i.concat(t) : zt(t) && i.push(t) })), t = i } else t = "string" == typeof t && t.trim() ? [qr({ src: t })] : zt(t) && "string" == typeof t.src && t.src && t.src.trim() ? [qr(t)] : []; return t }; function qr(e) { if (!e.type) { var t = Hr(e.src); t && (e.type = t) } return e } var Wr = function (e) { function t(t, i, n) { var r, a = Mn({ createEl: !1 }, i); if (r = e.call(this, t, a, n) || this, i.playerOptions.sources && 0 !== i.playerOptions.sources.length) t.src(i.playerOptions.sources); else for (var s = 0, o = i.playerOptions.techOrder; s < o.length; s++) { var u = Rn(o[s]), l = Fr.getTech(u); if (u || (l = Vn.getComponent(u)), l && l.isSupported()) { t.loadTech_(u); break } } return r } return h(t, e), t }(Vn); Vn.registerComponent("MediaLoader", Wr); var Gr = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).handleMouseOver_ = function (e) { return n.handleMouseOver(e) }, n.handleMouseOut_ = function (e) { return n.handleMouseOut(e) }, n.handleClick_ = function (e) { return n.handleClick(e) }, n.handleKeyDown_ = function (e) { return n.handleKeyDown(e) }, n.emitTapEvents(), n.enable(), n } h(t, e); var i = t.prototype; return i.createEl = function (e, t, i) { void 0 === e && (e = "div"), void 0 === t && (t = {}), void 0 === i && (i = {}), t = Gt({ className: this.buildCSSClass(), tabIndex: 0 }, t), "button" === e && jt.error("Creating a ClickableComponent with an HTML element of " + e + " is not supported; use a Button instead."), i = Gt({ role: "button" }, i), this.tabIndex_ = t.tabIndex; var n = xi(e, t, i); return n.appendChild(xi("span", { className: "vjs-icon-placeholder" }, { "aria-hidden": !0 })), this.createControlTextEl(n), n }, i.dispose = function () { this.controlTextEl_ = null, e.prototype.dispose.call(this) }, i.createControlTextEl = function (e) { return this.controlTextEl_ = xi("span", { className: "vjs-control-text" }, { "aria-live": "polite" }), e && e.appendChild(this.controlTextEl_), this.controlText(this.controlText_, e), this.controlTextEl_ }, i.controlText = function (e, t) { if (void 0 === t && (t = this.el()), void 0 === e) return this.controlText_ || "Need Text"; var i = this.localize(e); this.controlText_ = e, Si(this.controlTextEl_, i), this.nonIconControl || this.player_.options_.noUITitleAttributes || t.setAttribute("title", i) }, i.buildCSSClass = function () { return "vjs-control vjs-button " + e.prototype.buildCSSClass.call(this) }, i.enable = function () { this.enabled_ || (this.enabled_ = !0, this.removeClass("vjs-disabled"), this.el_.setAttribute("aria-disabled", "false"), void 0 !== this.tabIndex_ && this.el_.setAttribute("tabIndex", this.tabIndex_), this.on(["tap", "click"], this.handleClick_), this.on("keydown", this.handleKeyDown_)) }, i.disable = function () { this.enabled_ = !1, this.addClass("vjs-disabled"), this.el_.setAttribute("aria-disabled", "true"), void 0 !== this.tabIndex_ && this.el_.removeAttribute("tabIndex"), this.off("mouseover", this.handleMouseOver_), this.off("mouseout", this.handleMouseOut_), this.off(["tap", "click"], this.handleClick_), this.off("keydown", this.handleKeyDown_) }, i.handleLanguagechange = function () { this.controlText(this.controlText_) }, i.handleClick = function (e) { this.options_.clickHandler && this.options_.clickHandler.call(this, arguments) }, i.handleKeyDown = function (t) { l().isEventKey(t, "Space") || l().isEventKey(t, "Enter") ? (t.preventDefault(), t.stopPropagation(), this.trigger("click")) : e.prototype.handleKeyDown.call(this, t) }, t }(Vn); Vn.registerComponent("ClickableComponent", Gr); var zr = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update(), n.update_ = function (e) { return n.update(e) }, t.on("posterchange", n.update_), n } h(t, e); var i = t.prototype; return i.dispose = function () { this.player().off("posterchange", this.update_), e.prototype.dispose.call(this) }, i.createEl = function () { return xi("div", { className: "vjs-poster", tabIndex: -1 }) }, i.update = function (e) { var t = this.player().poster(); this.setSrc(t), t ? this.show() : this.hide() }, i.setSrc = function (e) { var t = ""; e && (t = 'url("' + e + '")'), this.el_.style.backgroundImage = t }, i.handleClick = function (e) { if (this.player_.controls()) { var t = this.player_.usingPlugin("eme") && this.player_.eme.sessions && this.player_.eme.sessions.length > 0; !this.player_.tech(!0) || (ui || ai) && t || this.player_.tech(!0).focus(), this.player_.paused() ? Kn(this.player_.play()) : this.player_.pause() } }, t }(Gr); Vn.registerComponent("PosterImage", zr); var Qr = { monospace: "monospace", sansSerif: "sans-serif", serif: "serif", monospaceSansSerif: '"Andale Mono", "Lucida Console", monospace', monospaceSerif: '"Courier New", monospace', proportionalSansSerif: "sans-serif", proportionalSerif: "serif", casual: '"Comic Sans MS", Impact, fantasy', script: '"Monotype Corsiva", cursive', smallcaps: '"Andale Mono", "Lucida Console", monospace, sans-serif' }; function Xr(e, t) { var i; if (4 === e.length) i = e[1] + e[1] + e[2] + e[2] + e[3] + e[3]; else { if (7 !== e.length) throw new Error("Invalid color code provided, " + e + "; must be formatted as e.g. #f0e or #f604e2."); i = e.slice(1) } return "rgba(" + parseInt(i.slice(0, 2), 16) + "," + parseInt(i.slice(2, 4), 16) + "," + parseInt(i.slice(4, 6), 16) + "," + t + ")" } function $r(e, t, i) { try { e.style[t] = i } catch (e) { return } } var Kr = function (e) { function t(t, i, n) { var a; a = e.call(this, t, i, n) || this; var s = function (e) { return a.updateDisplay(e) }; return t.on("loadstart", (function (e) { return a.toggleDisplay(e) })), t.on("texttrackchange", s), t.on("loadedmetadata", (function (e) { return a.preselectTrack(e) })), t.ready(_n(c(a), (function () { if (t.tech_ && t.tech_.featuresNativeTextTracks) this.hide(); else { t.on("fullscreenchange", s), t.on("playerresize", s), r().addEventListener("orientationchange", s), t.on("dispose", (function () { return r().removeEventListener("orientationchange", s) })); for (var e = this.options_.playerOptions.tracks || [], i = 0; i < e.length; i++)this.player_.addRemoteTextTrack(e[i], !0); this.preselectTrack() } }))), a } h(t, e); var i = t.prototype; return i.preselectTrack = function () { for (var e, t, i, n = { captions: 1, subtitles: 1 }, r = this.player_.textTracks(), a = this.player_.cache_.selectedLanguage, s = 0; s < r.length; s++) { var o = r[s]; a && a.enabled && a.language && a.language === o.language && o.kind in n ? o.kind === a.kind ? i = o : i || (i = o) : a && !a.enabled ? (i = null, e = null, t = null) : o.default && ("descriptions" !== o.kind || e ? o.kind in n && !t && (t = o) : e = o) } i ? i.mode = "showing" : t ? t.mode = "showing" : e && (e.mode = "showing") }, i.toggleDisplay = function () { this.player_.tech_ && this.player_.tech_.featuresNativeTextTracks ? this.hide() : this.show() }, i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-text-track-display" }, { translate: "yes", "aria-live": "off", "aria-atomic": "true" }) }, i.clearDisplay = function () { "function" == typeof r().WebVTT && r().WebVTT.processCues(r(), [], this.el_) }, i.updateDisplay = function () { var e = this.player_.textTracks(), t = this.options_.allowMultipleShowingTracks; if (this.clearDisplay(), t) { for (var i = [], n = 0; n < e.length; ++n) { var r = e[n]; "showing" === r.mode && i.push(r) } this.updateForTrack(i) } else { for (var a = null, s = null, o = e.length; o--;) { var u = e[o]; "showing" === u.mode && ("descriptions" === u.kind ? a = u : s = u) } s ? ("off" !== this.getAttribute("aria-live") && this.setAttribute("aria-live", "off"), this.updateForTrack(s)) : a && ("assertive" !== this.getAttribute("aria-live") && this.setAttribute("aria-live", "assertive"), this.updateForTrack(a)) } }, i.updateDisplayState = function (e) { for (var t = this.player_.textTrackSettings.getValues(), i = e.activeCues, n = i.length; n--;) { var a = i[n]; if (a) { var s = a.displayState; if (t.color && (s.firstChild.style.color = t.color), t.textOpacity && $r(s.firstChild, "color", Xr(t.color || "#fff", t.textOpacity)), t.backgroundColor && (s.firstChild.style.backgroundColor = t.backgroundColor), t.backgroundOpacity && $r(s.firstChild, "backgroundColor", Xr(t.backgroundColor || "#000", t.backgroundOpacity)), t.windowColor && (t.windowOpacity ? $r(s, "backgroundColor", Xr(t.windowColor, t.windowOpacity)) : s.style.backgroundColor = t.windowColor), t.edgeStyle && ("dropshadow" === t.edgeStyle ? s.firstChild.style.textShadow = "2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222" : "raised" === t.edgeStyle ? s.firstChild.style.textShadow = "1px 1px #222, 2px 2px #222, 3px 3px #222" : "depressed" === t.edgeStyle ? s.firstChild.style.textShadow = "1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222" : "uniform" === t.edgeStyle && (s.firstChild.style.textShadow = "0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")), t.fontPercent && 1 !== t.fontPercent) { var o = r().parseFloat(s.style.fontSize); s.style.fontSize = o * t.fontPercent + "px", s.style.height = "auto", s.style.top = "auto" } t.fontFamily && "default" !== t.fontFamily && ("small-caps" === t.fontFamily ? s.firstChild.style.fontVariant = "small-caps" : s.firstChild.style.fontFamily = Qr[t.fontFamily]) } } }, i.updateForTrack = function (e) { if (Array.isArray(e) || (e = [e]), "function" == typeof r().WebVTT && !e.every((function (e) { return !e.activeCues }))) { for (var t = [], i = 0; i < e.length; ++i)for (var n = e[i], a = 0; a < n.activeCues.length; ++a)t.push(n.activeCues[a]); r().WebVTT.processCues(r(), t, this.el_); for (var s = 0; s < e.length; ++s) { for (var o = e[s], u = 0; u < o.activeCues.length; ++u) { var l = o.activeCues[u].displayState; wi(l, "vjs-text-track-cue"), wi(l, "vjs-text-track-cue-" + (o.language ? o.language : s)), o.language && Li(l, "lang", o.language) } this.player_.textTrackSettings && this.updateDisplayState(o) } } }, t }(Vn); Vn.registerComponent("TextTrackDisplay", Kr); var Yr = function (e) { function t() { return e.apply(this, arguments) || this } return h(t, e), t.prototype.createEl = function () { var t = this.player_.isAudio(), i = this.localize(t ? "Audio Player" : "Video Player"), n = xi("span", { className: "vjs-control-text", textContent: this.localize("{1} is loading.", [i]) }), r = e.prototype.createEl.call(this, "div", { className: "vjs-loading-spinner", dir: "ltr" }); return r.appendChild(n), r }, t }(Vn); Vn.registerComponent("LoadingSpinner", Yr); var Zr = function (e) { function t() { return e.apply(this, arguments) || this } h(t, e); var i = t.prototype; return i.createEl = function (e, t, i) { void 0 === t && (t = {}), void 0 === i && (i = {}); var n = xi("button", t = Gt({ className: this.buildCSSClass() }, t), i = Gt({ type: "button" }, i)); return n.appendChild(xi("span", { className: "vjs-icon-placeholder" }, { "aria-hidden": !0 })), this.createControlTextEl(n), n }, i.addChild = function (e, t) { void 0 === t && (t = {}); var i = this.constructor.name; return jt.warn("Adding an actionable (user controllable) child to a Button (" + i + ") is not supported; use a ClickableComponent instead."), Vn.prototype.addChild.call(this, e, t) }, i.enable = function () { e.prototype.enable.call(this), this.el_.removeAttribute("disabled") }, i.disable = function () { e.prototype.disable.call(this), this.el_.setAttribute("disabled", "disabled") }, i.handleKeyDown = function (t) { l().isEventKey(t, "Space") || l().isEventKey(t, "Enter") ? t.stopPropagation() : e.prototype.handleKeyDown.call(this, t) }, t }(Gr); Vn.registerComponent("Button", Zr); var Jr = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).mouseused_ = !1, n.on("mousedown", (function (e) { return n.handleMouseDown(e) })), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-big-play-button" }, i.handleClick = function (e) { var t = this.player_.play(); if (this.mouseused_ && e.clientX && e.clientY) { var i = this.player_.usingPlugin("eme") && this.player_.eme.sessions && this.player_.eme.sessions.length > 0; return Kn(t), void (!this.player_.tech(!0) || (ui || ai) && i || this.player_.tech(!0).focus()) } var n = this.player_.getChild("controlBar"), r = n && n.getChild("playToggle"); if (r) { var a = function () { return r.focus() }; $n(t) ? t.then(a, (function () { })) : this.setTimeout(a, 1) } else this.player_.tech(!0).focus() }, i.handleKeyDown = function (t) { this.mouseused_ = !1, e.prototype.handleKeyDown.call(this, t) }, i.handleMouseDown = function (e) { this.mouseused_ = !0 }, t }(Zr); Jr.prototype.controlText_ = "Play Video", Vn.registerComponent("BigPlayButton", Jr); var ea = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).controlText(i && i.controlText || n.localize("Close")), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-close-button " + e.prototype.buildCSSClass.call(this) }, i.handleClick = function (e) { this.trigger({ type: "close", bubbles: !1 }) }, i.handleKeyDown = function (t) { l().isEventKey(t, "Esc") ? (t.preventDefault(), t.stopPropagation(), this.trigger("click")) : e.prototype.handleKeyDown.call(this, t) }, t }(Zr); Vn.registerComponent("CloseButton", ea); var ta = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), n = e.call(this, t, i) || this, i.replay = void 0 === i.replay || i.replay, n.on(t, "play", (function (e) { return n.handlePlay(e) })), n.on(t, "pause", (function (e) { return n.handlePause(e) })), i.replay && n.on(t, "ended", (function (e) { return n.handleEnded(e) })), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-play-control " + e.prototype.buildCSSClass.call(this) }, i.handleClick = function (e) { this.player_.paused() ? Kn(this.player_.play()) : this.player_.pause() }, i.handleSeeked = function (e) { this.removeClass("vjs-ended"), this.player_.paused() ? this.handlePause(e) : this.handlePlay(e) }, i.handlePlay = function (e) { this.removeClass("vjs-ended"), this.removeClass("vjs-paused"), this.addClass("vjs-playing"), this.controlText("Pause") }, i.handlePause = function (e) { this.removeClass("vjs-playing"), this.addClass("vjs-paused"), this.controlText("Play") }, i.handleEnded = function (e) { var t = this; this.removeClass("vjs-playing"), this.addClass("vjs-ended"), this.controlText("Replay"), this.one(this.player_, "seeked", (function (e) { return t.handleSeeked(e) })) }, t }(Zr); ta.prototype.controlText_ = "Play", Vn.registerComponent("PlayToggle", ta); var ia = function (e, t) { e = e < 0 ? 0 : e; var i = Math.floor(e % 60), n = Math.floor(e / 60 % 60), r = Math.floor(e / 3600), a = Math.floor(t / 60 % 60), s = Math.floor(t / 3600); return (isNaN(e) || e === 1 / 0) && (r = n = i = "-"), (r = r > 0 || s > 0 ? r + ":" : "") + (n = ((r || a >= 10) && n < 10 ? "0" + n : n) + ":") + (i = i < 10 ? "0" + i : i) }, na = ia; function ra(e, t) { return void 0 === t && (t = e), na(e, t) } var aa = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, ["timeupdate", "ended"], (function (e) { return n.updateContent(e) })), n.updateTextNode_(), n } h(t, e); var i = t.prototype; return i.createEl = function () { var t = this.buildCSSClass(), i = e.prototype.createEl.call(this, "div", { className: t + " vjs-time-control vjs-control" }), n = xi("span", { className: "vjs-control-text", textContent: this.localize(this.labelText_) + " " }, { role: "presentation" }); return i.appendChild(n), this.contentEl_ = xi("span", { className: t + "-display" }, { "aria-live": "off", role: "presentation" }), i.appendChild(this.contentEl_), i }, i.dispose = function () { this.contentEl_ = null, this.textNode_ = null, e.prototype.dispose.call(this) }, i.updateTextNode_ = function (e) { var t = this; void 0 === e && (e = 0), e = ra(e), this.formattedTime_ !== e && (this.formattedTime_ = e, this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_", (function () { if (t.contentEl_) { var e = t.textNode_; e && t.contentEl_.firstChild !== e && (e = null, jt.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")), t.textNode_ = s().createTextNode(t.formattedTime_), t.textNode_ && (e ? t.contentEl_.replaceChild(t.textNode_, e) : t.contentEl_.appendChild(t.textNode_)) } }))) }, i.updateContent = function (e) { }, t }(Vn); aa.prototype.labelText_ = "Time", aa.prototype.controlText_ = "Time", Vn.registerComponent("TimeDisplay", aa); var sa = function (e) { function t() { return e.apply(this, arguments) || this } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-current-time" }, i.updateContent = function (e) { var t; t = this.player_.ended() ? this.player_.duration() : this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime(), this.updateTextNode_(t) }, t }(aa); sa.prototype.labelText_ = "Current Time", sa.prototype.controlText_ = "Current Time", Vn.registerComponent("CurrentTimeDisplay", sa); var oa = function (e) { function t(t, i) { var n, r = function (e) { return n.updateContent(e) }; return (n = e.call(this, t, i) || this).on(t, "durationchange", r), n.on(t, "loadstart", r), n.on(t, "loadedmetadata", r), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-duration" }, i.updateContent = function (e) { var t = this.player_.duration(); this.updateTextNode_(t) }, t }(aa); oa.prototype.labelText_ = "Duration", oa.prototype.controlText_ = "Duration", Vn.registerComponent("DurationDisplay", oa); var ua = function (e) { function t() { return e.apply(this, arguments) || this } return h(t, e), t.prototype.createEl = function () { var t = e.prototype.createEl.call(this, "div", { className: "vjs-time-control vjs-time-divider" }, { "aria-hidden": !0 }), i = e.prototype.createEl.call(this, "div"), n = e.prototype.createEl.call(this, "span", { textContent: "/" }); return i.appendChild(n), t.appendChild(i), t }, t }(Vn); Vn.registerComponent("TimeDivider", ua); var la = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, "durationchange", (function (e) { return n.updateContent(e) })), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-remaining-time" }, i.createEl = function () { var t = e.prototype.createEl.call(this); return !1 !== this.options_.displayNegative && t.insertBefore(xi("span", {}, { "aria-hidden": !0 }, "-"), this.contentEl_), t }, i.updateContent = function (e) { var t; "number" == typeof this.player_.duration() && (t = this.player_.ended() ? 0 : this.player_.remainingTimeDisplay ? this.player_.remainingTimeDisplay() : this.player_.remainingTime(), this.updateTextNode_(t)) }, t }(aa); la.prototype.labelText_ = "Remaining Time", la.prototype.controlText_ = "Remaining Time", Vn.registerComponent("RemainingTimeDisplay", la); var ca = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).updateShowing(), n.on(n.player(), "durationchange", (function (e) { return n.updateShowing(e) })), n } h(t, e); var i = t.prototype; return i.createEl = function () { var t = e.prototype.createEl.call(this, "div", { className: "vjs-live-control vjs-control" }); return this.contentEl_ = xi("div", { className: "vjs-live-display" }, { "aria-live": "off" }), this.contentEl_.appendChild(xi("span", { className: "vjs-control-text", textContent: this.localize("Stream Type") + " " })), this.contentEl_.appendChild(s().createTextNode(this.localize("LIVE"))), t.appendChild(this.contentEl_), t }, i.dispose = function () { this.contentEl_ = null, e.prototype.dispose.call(this) }, i.updateShowing = function (e) { this.player().duration() === 1 / 0 ? this.show() : this.hide() }, t }(Vn); Vn.registerComponent("LiveDisplay", ca); var da = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).updateLiveEdgeStatus(), n.player_.liveTracker && (n.updateLiveEdgeStatusHandler_ = function (e) { return n.updateLiveEdgeStatus(e) }, n.on(n.player_.liveTracker, "liveedgechange", n.updateLiveEdgeStatusHandler_)), n } h(t, e); var i = t.prototype; return i.createEl = function () { var t = e.prototype.createEl.call(this, "button", { className: "vjs-seek-to-live-control vjs-control" }); return this.textEl_ = xi("span", { className: "vjs-seek-to-live-text", textContent: this.localize("LIVE") }, { "aria-hidden": "true" }), t.appendChild(this.textEl_), t }, i.updateLiveEdgeStatus = function () { !this.player_.liveTracker || this.player_.liveTracker.atLiveEdge() ? (this.setAttribute("aria-disabled", !0), this.addClass("vjs-at-live-edge"), this.controlText("Seek to live, currently playing live")) : (this.setAttribute("aria-disabled", !1), this.removeClass("vjs-at-live-edge"), this.controlText("Seek to live, currently behind live")) }, i.handleClick = function () { this.player_.liveTracker.seekToLiveEdge() }, i.dispose = function () { this.player_.liveTracker && this.off(this.player_.liveTracker, "liveedgechange", this.updateLiveEdgeStatusHandler_), this.textEl_ = null, e.prototype.dispose.call(this) }, t }(Zr); da.prototype.controlText_ = "Seek to live, currently playing live", Vn.registerComponent("SeekToLive", da); var ha = function (e, t, i) { return e = Number(e), Math.min(i, Math.max(t, isNaN(e) ? t : e)) }, pa = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).handleMouseDown_ = function (e) { return n.handleMouseDown(e) }, n.handleMouseUp_ = function (e) { return n.handleMouseUp(e) }, n.handleKeyDown_ = function (e) { return n.handleKeyDown(e) }, n.handleClick_ = function (e) { return n.handleClick(e) }, n.handleMouseMove_ = function (e) { return n.handleMouseMove(e) }, n.update_ = function (e) { return n.update(e) }, n.bar = n.getChild(n.options_.barName), n.vertical(!!n.options_.vertical), n.enable(), n } h(t, e); var i = t.prototype; return i.enabled = function () { return this.enabled_ }, i.enable = function () { this.enabled() || (this.on("mousedown", this.handleMouseDown_), this.on("touchstart", this.handleMouseDown_), this.on("keydown", this.handleKeyDown_), this.on("click", this.handleClick_), this.on(this.player_, "controlsvisible", this.update), this.playerEvent && this.on(this.player_, this.playerEvent, this.update), this.removeClass("disabled"), this.setAttribute("tabindex", 0), this.enabled_ = !0) }, i.disable = function () { if (this.enabled()) { var e = this.bar.el_.ownerDocument; this.off("mousedown", this.handleMouseDown_), this.off("touchstart", this.handleMouseDown_), this.off("keydown", this.handleKeyDown_), this.off("click", this.handleClick_), this.off(this.player_, "controlsvisible", this.update_), this.off(e, "mousemove", this.handleMouseMove_), this.off(e, "mouseup", this.handleMouseUp_), this.off(e, "touchmove", this.handleMouseMove_), this.off(e, "touchend", this.handleMouseUp_), this.removeAttribute("tabindex"), this.addClass("disabled"), this.playerEvent && this.off(this.player_, this.playerEvent, this.update), this.enabled_ = !1 } }, i.createEl = function (t, i, n) { return void 0 === i && (i = {}), void 0 === n && (n = {}), i.className = i.className + " vjs-slider", i = Gt({ tabIndex: 0 }, i), n = Gt({ role: "slider", "aria-valuenow": 0, "aria-valuemin": 0, "aria-valuemax": 100, tabIndex: 0 }, n), e.prototype.createEl.call(this, t, i, n) }, i.handleMouseDown = function (e) { var t = this.bar.el_.ownerDocument; "mousedown" === e.type && e.preventDefault(), "touchstart" !== e.type || si || e.preventDefault(), Bi(), this.addClass("vjs-sliding"), this.trigger("slideractive"), this.on(t, "mousemove", this.handleMouseMove_), this.on(t, "mouseup", this.handleMouseUp_), this.on(t, "touchmove", this.handleMouseMove_), this.on(t, "touchend", this.handleMouseUp_), this.handleMouseMove(e, !0) }, i.handleMouseMove = function (e) { }, i.handleMouseUp = function () { var e = this.bar.el_.ownerDocument; Ri(), this.removeClass("vjs-sliding"), this.trigger("sliderinactive"), this.off(e, "mousemove", this.handleMouseMove_), this.off(e, "mouseup", this.handleMouseUp_), this.off(e, "touchmove", this.handleMouseMove_), this.off(e, "touchend", this.handleMouseUp_), this.update() }, i.update = function () { var e = this; if (this.el_ && this.bar) { var t = this.getProgress(); return t === this.progress_ || (this.progress_ = t, this.requestNamedAnimationFrame("Slider#update", (function () { var i = e.vertical() ? "height" : "width"; e.bar.el().style[i] = (100 * t).toFixed(2) + "%" }))), t } }, i.getProgress = function () { return Number(ha(this.getPercent(), 0, 1).toFixed(4)) }, i.calculateDistance = function (e) { var t = Ui(this.el_, e); return this.vertical() ? t.y : t.x }, i.handleKeyDown = function (t) { l().isEventKey(t, "Left") || l().isEventKey(t, "Down") ? (t.preventDefault(), t.stopPropagation(), this.stepBack()) : l().isEventKey(t, "Right") || l().isEventKey(t, "Up") ? (t.preventDefault(), t.stopPropagation(), this.stepForward()) : e.prototype.handleKeyDown.call(this, t) }, i.handleClick = function (e) { e.stopPropagation(), e.preventDefault() }, i.vertical = function (e) { if (void 0 === e) return this.vertical_ || !1; this.vertical_ = !!e, this.vertical_ ? this.addClass("vjs-slider-vertical") : this.addClass("vjs-slider-horizontal") }, t }(Vn); Vn.registerComponent("Slider", pa); var fa = function (e, t) { return ha(e / t * 100, 0, 100).toFixed(2) + "%" }, ma = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).partEls_ = [], n.on(t, "progress", (function (e) { return n.update(e) })), n } h(t, e); var i = t.prototype; return i.createEl = function () { var t = e.prototype.createEl.call(this, "div", { className: "vjs-load-progress" }), i = xi("span", { className: "vjs-control-text" }), n = xi("span", { textContent: this.localize("Loaded") }), r = s().createTextNode(": "); return this.percentageEl_ = xi("span", { className: "vjs-control-text-loaded-percentage", textContent: "0%" }), t.appendChild(i), i.appendChild(n), i.appendChild(r), i.appendChild(this.percentageEl_), t }, i.dispose = function () { this.partEls_ = null, this.percentageEl_ = null, e.prototype.dispose.call(this) }, i.update = function (e) { var t = this; this.requestNamedAnimationFrame("LoadProgressBar#update", (function () { var e = t.player_.liveTracker, i = t.player_.buffered(), n = e && e.isLive() ? e.seekableEnd() : t.player_.duration(), r = t.player_.bufferedEnd(), a = t.partEls_, s = fa(r, n); t.percent_ !== s && (t.el_.style.width = s, Si(t.percentageEl_, s), t.percent_ = s); for (var o = 0; o < i.length; o++) { var u = i.start(o), l = i.end(o), c = a[o]; c || (c = t.el_.appendChild(xi()), a[o] = c), c.dataset.start === u && c.dataset.end === l || (c.dataset.start = u, c.dataset.end = l, c.style.left = fa(u, r), c.style.width = fa(l - u, r)) } for (var d = a.length; d > i.length; d--)t.el_.removeChild(a[d - 1]); a.length = i.length })) }, t }(Vn); Vn.registerComponent("LoadProgressBar", ma); var ga = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update = bn(_n(c(n), n.update), yn), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-time-tooltip" }, { "aria-hidden": "true" }) }, i.update = function (e, t, i) { var n = Ni(this.el_), r = Mi(this.player_.el()), a = e.width * t; if (r && n) { var s = e.left - r.left + a, o = e.width - a + (r.right - e.right), u = n.width / 2; s < u ? u += u - s : o < u && (u = o), u < 0 ? u = 0 : u > n.width && (u = n.width), u = Math.round(u), this.el_.style.right = "-" + u + "px", this.write(i) } }, i.write = function (e) { Si(this.el_, e) }, i.updateTime = function (e, t, i, n) { var r = this; this.requestNamedAnimationFrame("TimeTooltip#updateTime", (function () { var a, s = r.player_.duration(); if (r.player_.liveTracker && r.player_.liveTracker.isLive()) { var o = r.player_.liveTracker.liveWindow(), u = o - t * o; a = (u < 1 ? "" : "-") + ra(u, o) } else a = ra(i, s); r.update(e, t, a), n && n() })) }, t }(Vn); Vn.registerComponent("TimeTooltip", ga); var Aa = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update = bn(_n(c(n), n.update), yn), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-play-progress vjs-slider-bar" }, { "aria-hidden": "true" }) }, i.update = function (e, t) { var i = this.getChild("timeTooltip"); if (i) { var n = this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime(); i.updateTime(e, t, n) } }, t }(Vn); Aa.prototype.options_ = { children: [] }, fi || ti || Aa.prototype.options_.children.push("timeTooltip"), Vn.registerComponent("PlayProgressBar", Aa); var va = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update = bn(_n(c(n), n.update), yn), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-mouse-display" }) }, i.update = function (e, t) { var i = this, n = t * this.player_.duration(); this.getChild("timeTooltip").updateTime(e, t, n, (function () { i.el_.style.left = e.width * t + "px" })) }, t }(Vn); va.prototype.options_ = { children: ["timeTooltip"] }, Vn.registerComponent("MouseTimeDisplay", va); var ya = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).setEventHandlers_(), n } h(t, e); var i = t.prototype; return i.setEventHandlers_ = function () { var e = this; this.update_ = _n(this, this.update), this.update = bn(this.update_, yn), this.on(this.player_, ["ended", "durationchange", "timeupdate"], this.update), this.player_.liveTracker && this.on(this.player_.liveTracker, "liveedgechange", this.update), this.updateInterval = null, this.enableIntervalHandler_ = function (t) { return e.enableInterval_(t) }, this.disableIntervalHandler_ = function (t) { return e.disableInterval_(t) }, this.on(this.player_, ["playing"], this.enableIntervalHandler_), this.on(this.player_, ["ended", "pause", "waiting"], this.disableIntervalHandler_), "hidden" in s() && "visibilityState" in s() && this.on(s(), "visibilitychange", this.toggleVisibility_) }, i.toggleVisibility_ = function (e) { "hidden" === s().visibilityState ? (this.cancelNamedAnimationFrame("SeekBar#update"), this.cancelNamedAnimationFrame("Slider#update"), this.disableInterval_(e)) : (this.player_.ended() || this.player_.paused() || this.enableInterval_(), this.update()) }, i.enableInterval_ = function () { this.updateInterval || (this.updateInterval = this.setInterval(this.update, yn)) }, i.disableInterval_ = function (e) { this.player_.liveTracker && this.player_.liveTracker.isLive() && e && "ended" !== e.type || this.updateInterval && (this.clearInterval(this.updateInterval), this.updateInterval = null) }, i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-progress-holder" }, { "aria-label": this.localize("Progress Bar") }) }, i.update = function (t) { var i = this; if ("hidden" !== s().visibilityState) { var n = e.prototype.update.call(this); return this.requestNamedAnimationFrame("SeekBar#update", (function () { var e = i.player_.ended() ? i.player_.duration() : i.getCurrentTime_(), t = i.player_.liveTracker, r = i.player_.duration(); t && t.isLive() && (r = i.player_.liveTracker.liveCurrentTime()), i.percent_ !== n && (i.el_.setAttribute("aria-valuenow", (100 * n).toFixed(2)), i.percent_ = n), i.currentTime_ === e && i.duration_ === r || (i.el_.setAttribute("aria-valuetext", i.localize("progress bar timing: currentTime={1} duration={2}", [ra(e, r), ra(r, r)], "{1} of {2}")), i.currentTime_ = e, i.duration_ = r), i.bar && i.bar.update(Mi(i.el()), i.getProgress()) })), n } }, i.userSeek_ = function (e) { this.player_.liveTracker && this.player_.liveTracker.isLive() && this.player_.liveTracker.nextSeekedFromUser(), this.player_.currentTime(e) }, i.getCurrentTime_ = function () { return this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime() }, i.getPercent = function () { var e, t = this.getCurrentTime_(), i = this.player_.liveTracker; return i && i.isLive() ? (e = (t - i.seekableStart()) / i.liveWindow(), i.atLiveEdge() && (e = 1)) : e = t / this.player_.duration(), e }, i.handleMouseDown = function (t) { Gi(t) && (t.stopPropagation(), this.videoWasPlaying = !this.player_.paused(), this.player_.pause(), e.prototype.handleMouseDown.call(this, t)) }, i.handleMouseMove = function (e, t) { if (void 0 === t && (t = !1), Gi(e)) { var i; t || this.player_.scrubbing() || this.player_.scrubbing(!0); var n = this.calculateDistance(e), r = this.player_.liveTracker; if (r && r.isLive()) { if (n >= .99) return void r.seekToLiveEdge(); var a = r.seekableStart(), s = r.liveCurrentTime(); if ((i = a + n * r.liveWindow()) >= s && (i = s), i <= a && (i = a + .1), i === 1 / 0) return } else (i = n * this.player_.duration()) === this.player_.duration() && (i -= .1); this.userSeek_(i) } }, i.enable = function () { e.prototype.enable.call(this); var t = this.getChild("mouseTimeDisplay"); t && t.show() }, i.disable = function () { e.prototype.disable.call(this); var t = this.getChild("mouseTimeDisplay"); t && t.hide() }, i.handleMouseUp = function (t) { e.prototype.handleMouseUp.call(this, t), t && t.stopPropagation(), this.player_.scrubbing(!1), this.player_.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }), this.videoWasPlaying ? Kn(this.player_.play()) : this.update_() }, i.stepForward = function () { this.userSeek_(this.player_.currentTime() + 5) }, i.stepBack = function () { this.userSeek_(this.player_.currentTime() - 5) }, i.handleAction = function (e) { this.player_.paused() ? this.player_.play() : this.player_.pause() }, i.handleKeyDown = function (t) { var i = this.player_.liveTracker; if (l().isEventKey(t, "Space") || l().isEventKey(t, "Enter")) t.preventDefault(), t.stopPropagation(), this.handleAction(t); else if (l().isEventKey(t, "Home")) t.preventDefault(), t.stopPropagation(), this.userSeek_(0); else if (l().isEventKey(t, "End")) t.preventDefault(), t.stopPropagation(), i && i.isLive() ? this.userSeek_(i.liveCurrentTime()) : this.userSeek_(this.player_.duration()); else if (/^[0-9]$/.test(l()(t))) { t.preventDefault(), t.stopPropagation(); var n = 10 * (l().codes[l()(t)] - l().codes[0]) / 100; i && i.isLive() ? this.userSeek_(i.seekableStart() + i.liveWindow() * n) : this.userSeek_(this.player_.duration() * n) } else l().isEventKey(t, "PgDn") ? (t.preventDefault(), t.stopPropagation(), this.userSeek_(this.player_.currentTime() - 60)) : l().isEventKey(t, "PgUp") ? (t.preventDefault(), t.stopPropagation(), this.userSeek_(this.player_.currentTime() + 60)) : e.prototype.handleKeyDown.call(this, t) }, i.dispose = function () { this.disableInterval_(), this.off(this.player_, ["ended", "durationchange", "timeupdate"], this.update), this.player_.liveTracker && this.off(this.player_.liveTracker, "liveedgechange", this.update), this.off(this.player_, ["playing"], this.enableIntervalHandler_), this.off(this.player_, ["ended", "pause", "waiting"], this.disableIntervalHandler_), "hidden" in s() && "visibilityState" in s() && this.off(s(), "visibilitychange", this.toggleVisibility_), e.prototype.dispose.call(this) }, t }(pa); ya.prototype.options_ = { children: ["loadProgressBar", "playProgressBar"], barName: "playProgressBar" }, fi || ti || ya.prototype.options_.children.splice(1, 0, "mouseTimeDisplay"), Vn.registerComponent("SeekBar", ya); var _a = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).handleMouseMove = bn(_n(c(n), n.handleMouseMove), yn), n.throttledHandleMouseSeek = bn(_n(c(n), n.handleMouseSeek), yn), n.handleMouseUpHandler_ = function (e) { return n.handleMouseUp(e) }, n.handleMouseDownHandler_ = function (e) { return n.handleMouseDown(e) }, n.enable(), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-progress-control vjs-control" }) }, i.handleMouseMove = function (e) { var t = this.getChild("seekBar"); if (t) { var i = t.getChild("playProgressBar"), n = t.getChild("mouseTimeDisplay"); if (i || n) { var r = t.el(), a = Ni(r), s = Ui(r, e).x; s = ha(s, 0, 1), n && n.update(a, s), i && i.update(a, t.getProgress()) } } }, i.handleMouseSeek = function (e) { var t = this.getChild("seekBar"); t && t.handleMouseMove(e) }, i.enabled = function () { return this.enabled_ }, i.disable = function () { if (this.children().forEach((function (e) { return e.disable && e.disable() })), this.enabled() && (this.off(["mousedown", "touchstart"], this.handleMouseDownHandler_), this.off(this.el_, "mousemove", this.handleMouseMove), this.removeListenersAddedOnMousedownAndTouchstart(), this.addClass("disabled"), this.enabled_ = !1, this.player_.scrubbing())) { var e = this.getChild("seekBar"); this.player_.scrubbing(!1), e.videoWasPlaying && Kn(this.player_.play()) } }, i.enable = function () { this.children().forEach((function (e) { return e.enable && e.enable() })), this.enabled() || (this.on(["mousedown", "touchstart"], this.handleMouseDownHandler_), this.on(this.el_, "mousemove", this.handleMouseMove), this.removeClass("disabled"), this.enabled_ = !0) }, i.removeListenersAddedOnMousedownAndTouchstart = function () { var e = this.el_.ownerDocument; this.off(e, "mousemove", this.throttledHandleMouseSeek), this.off(e, "touchmove", this.throttledHandleMouseSeek), this.off(e, "mouseup", this.handleMouseUpHandler_), this.off(e, "touchend", this.handleMouseUpHandler_) }, i.handleMouseDown = function (e) { var t = this.el_.ownerDocument, i = this.getChild("seekBar"); i && i.handleMouseDown(e), this.on(t, "mousemove", this.throttledHandleMouseSeek), this.on(t, "touchmove", this.throttledHandleMouseSeek), this.on(t, "mouseup", this.handleMouseUpHandler_), this.on(t, "touchend", this.handleMouseUpHandler_) }, i.handleMouseUp = function (e) { var t = this.getChild("seekBar"); t && t.handleMouseUp(e), this.removeListenersAddedOnMousedownAndTouchstart() }, t }(Vn); _a.prototype.options_ = { children: ["seekBar"] }, Vn.registerComponent("ProgressControl", _a); var ba = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, ["enterpictureinpicture", "leavepictureinpicture"], (function (e) { return n.handlePictureInPictureChange(e) })), n.on(t, ["disablepictureinpicturechanged", "loadedmetadata"], (function (e) { return n.handlePictureInPictureEnabledChange(e) })), n.disable(), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-picture-in-picture-control " + e.prototype.buildCSSClass.call(this) }, i.handlePictureInPictureEnabledChange = function () { s().pictureInPictureEnabled && !1 === this.player_.disablePictureInPicture() ? this.enable() : this.disable() }, i.handlePictureInPictureChange = function (e) { this.player_.isInPictureInPicture() ? this.controlText("Exit Picture-in-Picture") : this.controlText("Picture-in-Picture"), this.handlePictureInPictureEnabledChange() }, i.handleClick = function (e) { this.player_.isInPictureInPicture() ? this.player_.exitPictureInPicture() : this.player_.requestPictureInPicture() }, t }(Zr); ba.prototype.controlText_ = "Picture-in-Picture", Vn.registerComponent("PictureInPictureToggle", ba); var Ta = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, "fullscreenchange", (function (e) { return n.handleFullscreenChange(e) })), !1 === s()[t.fsApi_.fullscreenEnabled] && n.disable(), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-fullscreen-control " + e.prototype.buildCSSClass.call(this) }, i.handleFullscreenChange = function (e) { this.player_.isFullscreen() ? this.controlText("Non-Fullscreen") : this.controlText("Fullscreen") }, i.handleClick = function (e) { this.player_.isFullscreen() ? this.player_.exitFullscreen() : this.player_.requestFullscreen() }, t }(Zr); Ta.prototype.controlText_ = "Fullscreen", Vn.registerComponent("FullscreenToggle", Ta); var xa = function (e) { function t() { return e.apply(this, arguments) || this } return h(t, e), t.prototype.createEl = function () { var t = e.prototype.createEl.call(this, "div", { className: "vjs-volume-level" }); return t.appendChild(e.prototype.createEl.call(this, "span", { className: "vjs-control-text" })), t }, t }(Vn); Vn.registerComponent("VolumeLevel", xa); var Sa = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update = bn(_n(c(n), n.update), yn), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-volume-tooltip" }, { "aria-hidden": "true" }) }, i.update = function (e, t, i, n) { if (!i) { var r = Mi(this.el_), a = Mi(this.player_.el()), s = e.width * t; if (!a || !r) return; var o = e.left - a.left + s, u = e.width - s + (a.right - e.right), l = r.width / 2; o < l ? l += l - o : u < l && (l = u), l < 0 ? l = 0 : l > r.width && (l = r.width), this.el_.style.right = "-" + l + "px" } this.write(n + "%") }, i.write = function (e) { Si(this.el_, e) }, i.updateVolume = function (e, t, i, n, r) { var a = this; this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume", (function () { a.update(e, t, i, n.toFixed(0)), r && r() })) }, t }(Vn); Vn.registerComponent("VolumeLevelTooltip", Sa); var Ea = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).update = bn(_n(c(n), n.update), yn), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-mouse-display" }) }, i.update = function (e, t, i) { var n = this, r = 100 * t; this.getChild("volumeLevelTooltip").updateVolume(e, t, i, r, (function () { i ? n.el_.style.bottom = e.height * t + "px" : n.el_.style.left = e.width * t + "px" })) }, t }(Vn); Ea.prototype.options_ = { children: ["volumeLevelTooltip"] }, Vn.registerComponent("MouseVolumeLevelDisplay", Ea); var Ca = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on("slideractive", (function (e) { return n.updateLastVolume_(e) })), n.on(t, "volumechange", (function (e) { return n.updateARIAAttributes(e) })), t.ready((function () { return n.updateARIAAttributes() })), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-volume-bar vjs-slider-bar" }, { "aria-label": this.localize("Volume Level"), "aria-live": "polite" }) }, i.handleMouseDown = function (t) { Gi(t) && e.prototype.handleMouseDown.call(this, t) }, i.handleMouseMove = function (e) { var t = this.getChild("mouseVolumeLevelDisplay"); if (t) { var i = this.el(), n = Mi(i), r = this.vertical(), a = Ui(i, e); a = r ? a.y : a.x, a = ha(a, 0, 1), t.update(n, a, r) } Gi(e) && (this.checkMuted(), this.player_.volume(this.calculateDistance(e))) }, i.checkMuted = function () { this.player_.muted() && this.player_.muted(!1) }, i.getPercent = function () { return this.player_.muted() ? 0 : this.player_.volume() }, i.stepForward = function () { this.checkMuted(), this.player_.volume(this.player_.volume() + .1) }, i.stepBack = function () { this.checkMuted(), this.player_.volume(this.player_.volume() - .1) }, i.updateARIAAttributes = function (e) { var t = this.player_.muted() ? 0 : this.volumeAsPercentage_(); this.el_.setAttribute("aria-valuenow", t), this.el_.setAttribute("aria-valuetext", t + "%") }, i.volumeAsPercentage_ = function () { return Math.round(100 * this.player_.volume()) }, i.updateLastVolume_ = function () { var e = this, t = this.player_.volume(); this.one("sliderinactive", (function () { 0 === e.player_.volume() && e.player_.lastVolume_(t) })) }, t }(pa); Ca.prototype.options_ = { children: ["volumeLevel"], barName: "volumeLevel" }, fi || ti || Ca.prototype.options_.children.splice(0, 0, "mouseVolumeLevelDisplay"), Ca.prototype.playerEvent = "volumechange", Vn.registerComponent("VolumeBar", Ca); var wa = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), i.vertical = i.vertical || !1, (void 0 === i.volumeBar || Qt(i.volumeBar)) && (i.volumeBar = i.volumeBar || {}, i.volumeBar.vertical = i.vertical), function (e, t) { t.tech_ && !t.tech_.featuresVolumeControl && e.addClass("vjs-hidden"), e.on(t, "loadstart", (function () { t.tech_.featuresVolumeControl ? e.removeClass("vjs-hidden") : e.addClass("vjs-hidden") })) }(c(n = e.call(this, t, i) || this), t), n.throttledHandleMouseMove = bn(_n(c(n), n.handleMouseMove), yn), n.handleMouseUpHandler_ = function (e) { return n.handleMouseUp(e) }, n.on("mousedown", (function (e) { return n.handleMouseDown(e) })), n.on("touchstart", (function (e) { return n.handleMouseDown(e) })), n.on("mousemove", (function (e) { return n.handleMouseMove(e) })), n.on(n.volumeBar, ["focus", "slideractive"], (function () { n.volumeBar.addClass("vjs-slider-active"), n.addClass("vjs-slider-active"), n.trigger("slideractive") })), n.on(n.volumeBar, ["blur", "sliderinactive"], (function () { n.volumeBar.removeClass("vjs-slider-active"), n.removeClass("vjs-slider-active"), n.trigger("sliderinactive") })), n } h(t, e); var i = t.prototype; return i.createEl = function () { var t = "vjs-volume-horizontal"; return this.options_.vertical && (t = "vjs-volume-vertical"), e.prototype.createEl.call(this, "div", { className: "vjs-volume-control vjs-control " + t }) }, i.handleMouseDown = function (e) { var t = this.el_.ownerDocument; this.on(t, "mousemove", this.throttledHandleMouseMove), this.on(t, "touchmove", this.throttledHandleMouseMove), this.on(t, "mouseup", this.handleMouseUpHandler_), this.on(t, "touchend", this.handleMouseUpHandler_) }, i.handleMouseUp = function (e) { var t = this.el_.ownerDocument; this.off(t, "mousemove", this.throttledHandleMouseMove), this.off(t, "touchmove", this.throttledHandleMouseMove), this.off(t, "mouseup", this.handleMouseUpHandler_), this.off(t, "touchend", this.handleMouseUpHandler_) }, i.handleMouseMove = function (e) { this.volumeBar.handleMouseMove(e) }, t }(Vn); wa.prototype.options_ = { children: ["volumeBar"] }, Vn.registerComponent("VolumeControl", wa); var ka = function (e) { function t(t, i) { var n; return function (e, t) { t.tech_ && !t.tech_.featuresMuteControl && e.addClass("vjs-hidden"), e.on(t, "loadstart", (function () { t.tech_.featuresMuteControl ? e.removeClass("vjs-hidden") : e.addClass("vjs-hidden") })) }(c(n = e.call(this, t, i) || this), t), n.on(t, ["loadstart", "volumechange"], (function (e) { return n.update(e) })), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-mute-control " + e.prototype.buildCSSClass.call(this) }, i.handleClick = function (e) { var t = this.player_.volume(), i = this.player_.lastVolume_(); if (0 === t) { var n = i < .1 ? .1 : i; this.player_.volume(n), this.player_.muted(!1) } else this.player_.muted(!this.player_.muted()) }, i.update = function (e) { this.updateIcon_(), this.updateControlText_() }, i.updateIcon_ = function () { var e = this.player_.volume(), t = 3; fi && this.player_.tech_ && this.player_.tech_.el_ && this.player_.muted(this.player_.tech_.el_.muted), 0 === e || this.player_.muted() ? t = 0 : e < .33 ? t = 1 : e < .67 && (t = 2); for (var i = 0; i < 4; i++)ki(this.el_, "vjs-vol-" + i); wi(this.el_, "vjs-vol-" + t) }, i.updateControlText_ = function () { var e = this.player_.muted() || 0 === this.player_.volume() ? "Unmute" : "Mute"; this.controlText() !== e && this.controlText(e) }, t }(Zr); ka.prototype.controlText_ = "Mute", Vn.registerComponent("MuteToggle", ka); var Fa = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), void 0 !== i.inline ? i.inline = i.inline : i.inline = !0, (void 0 === i.volumeControl || Qt(i.volumeControl)) && (i.volumeControl = i.volumeControl || {}, i.volumeControl.vertical = !i.inline), (n = e.call(this, t, i) || this).handleKeyPressHandler_ = function (e) { return n.handleKeyPress(e) }, n.on(t, ["loadstart"], (function (e) { return n.volumePanelState_(e) })), n.on(n.muteToggle, "keyup", (function (e) { return n.handleKeyPress(e) })), n.on(n.volumeControl, "keyup", (function (e) { return n.handleVolumeControlKeyUp(e) })), n.on("keydown", (function (e) { return n.handleKeyPress(e) })), n.on("mouseover", (function (e) { return n.handleMouseOver(e) })), n.on("mouseout", (function (e) { return n.handleMouseOut(e) })), n.on(n.volumeControl, ["slideractive"], n.sliderActive_), n.on(n.volumeControl, ["sliderinactive"], n.sliderInactive_), n } h(t, e); var i = t.prototype; return i.sliderActive_ = function () { this.addClass("vjs-slider-active") }, i.sliderInactive_ = function () { this.removeClass("vjs-slider-active") }, i.volumePanelState_ = function () { this.volumeControl.hasClass("vjs-hidden") && this.muteToggle.hasClass("vjs-hidden") && this.addClass("vjs-hidden"), this.volumeControl.hasClass("vjs-hidden") && !this.muteToggle.hasClass("vjs-hidden") && this.addClass("vjs-mute-toggle-only") }, i.createEl = function () { var t = "vjs-volume-panel-horizontal"; return this.options_.inline || (t = "vjs-volume-panel-vertical"), e.prototype.createEl.call(this, "div", { className: "vjs-volume-panel vjs-control " + t }) }, i.dispose = function () { this.handleMouseOut(), e.prototype.dispose.call(this) }, i.handleVolumeControlKeyUp = function (e) { l().isEventKey(e, "Esc") && this.muteToggle.focus() }, i.handleMouseOver = function (e) { this.addClass("vjs-hover"), hn(s(), "keyup", this.handleKeyPressHandler_) }, i.handleMouseOut = function (e) { this.removeClass("vjs-hover"), pn(s(), "keyup", this.handleKeyPressHandler_) }, i.handleKeyPress = function (e) { l().isEventKey(e, "Esc") && this.handleMouseOut() }, t }(Vn); Fa.prototype.options_ = { children: ["muteToggle", "volumeControl"] }, Vn.registerComponent("VolumePanel", Fa); var Ia = function (e) { function t(t, i) { var n; return n = e.call(this, t, i) || this, i && (n.menuButton_ = i.menuButton), n.focusedChild_ = -1, n.on("keydown", (function (e) { return n.handleKeyDown(e) })), n.boundHandleBlur_ = function (e) { return n.handleBlur(e) }, n.boundHandleTapClick_ = function (e) { return n.handleTapClick(e) }, n } h(t, e); var i = t.prototype; return i.addEventListenerForItem = function (e) { e instanceof Vn && (this.on(e, "blur", this.boundHandleBlur_), this.on(e, ["tap", "click"], this.boundHandleTapClick_)) }, i.removeEventListenerForItem = function (e) { e instanceof Vn && (this.off(e, "blur", this.boundHandleBlur_), this.off(e, ["tap", "click"], this.boundHandleTapClick_)) }, i.removeChild = function (t) { "string" == typeof t && (t = this.getChild(t)), this.removeEventListenerForItem(t), e.prototype.removeChild.call(this, t) }, i.addItem = function (e) { var t = this.addChild(e); t && this.addEventListenerForItem(t) }, i.createEl = function () { var t = this.options_.contentElType || "ul"; this.contentEl_ = xi(t, { className: "vjs-menu-content" }), this.contentEl_.setAttribute("role", "menu"); var i = e.prototype.createEl.call(this, "div", { append: this.contentEl_, className: "vjs-menu" }); return i.appendChild(this.contentEl_), hn(i, "click", (function (e) { e.preventDefault(), e.stopImmediatePropagation() })), i }, i.dispose = function () { this.contentEl_ = null, this.boundHandleBlur_ = null, this.boundHandleTapClick_ = null, e.prototype.dispose.call(this) }, i.handleBlur = function (e) { var t = e.relatedTarget || s().activeElement; if (!this.children().some((function (e) { return e.el() === t }))) { var i = this.menuButton_; i && i.buttonPressed_ && t !== i.el().firstChild && i.unpressButton() } }, i.handleTapClick = function (e) { if (this.menuButton_) { this.menuButton_.unpressButton(); var t = this.children(); if (!Array.isArray(t)) return; var i = t.filter((function (t) { return t.el() === e.target }))[0]; if (!i) return; "CaptionSettingsMenuItem" !== i.name() && this.menuButton_.focus() } }, i.handleKeyDown = function (e) { l().isEventKey(e, "Left") || l().isEventKey(e, "Down") ? (e.preventDefault(), e.stopPropagation(), this.stepForward()) : (l().isEventKey(e, "Right") || l().isEventKey(e, "Up")) && (e.preventDefault(), e.stopPropagation(), this.stepBack()) }, i.stepForward = function () { var e = 0; void 0 !== this.focusedChild_ && (e = this.focusedChild_ + 1), this.focus(e) }, i.stepBack = function () { var e = 0; void 0 !== this.focusedChild_ && (e = this.focusedChild_ - 1), this.focus(e) }, i.focus = function (e) { void 0 === e && (e = 0); var t = this.children().slice(); t.length && t[0].hasClass("vjs-menu-title") && t.shift(), t.length > 0 && (e < 0 ? e = 0 : e >= t.length && (e = t.length - 1), this.focusedChild_ = e, t[e].el_.focus()) }, t }(Vn); Vn.registerComponent("Menu", Ia); var Da = function (e) { function t(t, i) { var n; void 0 === i && (i = {}), (n = e.call(this, t, i) || this).menuButton_ = new Zr(t, i), n.menuButton_.controlText(n.controlText_), n.menuButton_.el_.setAttribute("aria-haspopup", "true"); var r = Zr.prototype.buildCSSClass(); n.menuButton_.el_.className = n.buildCSSClass() + " " + r, n.menuButton_.removeClass("vjs-control"), n.addChild(n.menuButton_), n.update(), n.enabled_ = !0; var a = function (e) { return n.handleClick(e) }; return n.handleMenuKeyUp_ = function (e) { return n.handleMenuKeyUp(e) }, n.on(n.menuButton_, "tap", a), n.on(n.menuButton_, "click", a), n.on(n.menuButton_, "keydown", (function (e) { return n.handleKeyDown(e) })), n.on(n.menuButton_, "mouseenter", (function () { n.addClass("vjs-hover"), n.menu.show(), hn(s(), "keyup", n.handleMenuKeyUp_) })), n.on("mouseleave", (function (e) { return n.handleMouseLeave(e) })), n.on("keydown", (function (e) { return n.handleSubmenuKeyDown(e) })), n } h(t, e); var i = t.prototype; return i.update = function () { var e = this.createMenu(); this.menu && (this.menu.dispose(), this.removeChild(this.menu)), this.menu = e, this.addChild(e), this.buttonPressed_ = !1, this.menuButton_.el_.setAttribute("aria-expanded", "false"), this.items && this.items.length <= this.hideThreshold_ ? this.hide() : this.show() }, i.createMenu = function () { var e = new Ia(this.player_, { menuButton: this }); if (this.hideThreshold_ = 0, this.options_.title) { var t = xi("li", { className: "vjs-menu-title", textContent: Rn(this.options_.title), tabIndex: -1 }), i = new Vn(this.player_, { el: t }); e.addItem(i) } if (this.items = this.createItems(), this.items) for (var n = 0; n < this.items.length; n++)e.addItem(this.items[n]); return e }, i.createItems = function () { }, i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: this.buildWrapperCSSClass() }, {}) }, i.buildWrapperCSSClass = function () { var t = "vjs-menu-button"; return !0 === this.options_.inline ? t += "-inline" : t += "-popup", "vjs-menu-button " + t + " " + Zr.prototype.buildCSSClass() + " " + e.prototype.buildCSSClass.call(this) }, i.buildCSSClass = function () { var t = "vjs-menu-button"; return !0 === this.options_.inline ? t += "-inline" : t += "-popup", "vjs-menu-button " + t + " " + e.prototype.buildCSSClass.call(this) }, i.controlText = function (e, t) { return void 0 === t && (t = this.menuButton_.el()), this.menuButton_.controlText(e, t) }, i.dispose = function () { this.handleMouseLeave(), e.prototype.dispose.call(this) }, i.handleClick = function (e) { this.buttonPressed_ ? this.unpressButton() : this.pressButton() }, i.handleMouseLeave = function (e) { this.removeClass("vjs-hover"), pn(s(), "keyup", this.handleMenuKeyUp_) }, i.focus = function () { this.menuButton_.focus() }, i.blur = function () { this.menuButton_.blur() }, i.handleKeyDown = function (e) { l().isEventKey(e, "Esc") || l().isEventKey(e, "Tab") ? (this.buttonPressed_ && this.unpressButton(), l().isEventKey(e, "Tab") || (e.preventDefault(), this.menuButton_.focus())) : (l().isEventKey(e, "Up") || l().isEventKey(e, "Down")) && (this.buttonPressed_ || (e.preventDefault(), this.pressButton())) }, i.handleMenuKeyUp = function (e) { (l().isEventKey(e, "Esc") || l().isEventKey(e, "Tab")) && this.removeClass("vjs-hover") }, i.handleSubmenuKeyPress = function (e) { this.handleSubmenuKeyDown(e) }, i.handleSubmenuKeyDown = function (e) { (l().isEventKey(e, "Esc") || l().isEventKey(e, "Tab")) && (this.buttonPressed_ && this.unpressButton(), l().isEventKey(e, "Tab") || (e.preventDefault(), this.menuButton_.focus())) }, i.pressButton = function () { if (this.enabled_) { if (this.buttonPressed_ = !0, this.menu.show(), this.menu.lockShowing(), this.menuButton_.el_.setAttribute("aria-expanded", "true"), fi && bi()) return; this.menu.focus() } }, i.unpressButton = function () { this.enabled_ && (this.buttonPressed_ = !1, this.menu.unlockShowing(), this.menu.hide(), this.menuButton_.el_.setAttribute("aria-expanded", "false")) }, i.disable = function () { this.unpressButton(), this.enabled_ = !1, this.addClass("vjs-disabled"), this.menuButton_.disable() }, i.enable = function () { this.enabled_ = !0, this.removeClass("vjs-disabled"), this.menuButton_.enable() }, t }(Vn); Vn.registerComponent("MenuButton", Da); var Pa = function (e) { function t(t, i) { var n, r = i.tracks; if ((n = e.call(this, t, i) || this).items.length <= 1 && n.hide(), !r) return c(n); var a = _n(c(n), n.update); return r.addEventListener("removetrack", a), r.addEventListener("addtrack", a), r.addEventListener("labelchange", a), n.player_.on("ready", a), n.player_.on("dispose", (function () { r.removeEventListener("removetrack", a), r.removeEventListener("addtrack", a), r.removeEventListener("labelchange", a) })), n } return h(t, e), t }(Da); Vn.registerComponent("TrackButton", Pa); var La = ["Tab", "Esc", "Up", "Down", "Right", "Left"], Oa = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).selectable = i.selectable, n.isSelected_ = i.selected || !1, n.multiSelectable = i.multiSelectable, n.selected(n.isSelected_), n.selectable ? n.multiSelectable ? n.el_.setAttribute("role", "menuitemcheckbox") : n.el_.setAttribute("role", "menuitemradio") : n.el_.setAttribute("role", "menuitem"), n } h(t, e); var i = t.prototype; return i.createEl = function (t, i, n) { this.nonIconControl = !0; var r = e.prototype.createEl.call(this, "li", Gt({ className: "vjs-menu-item", tabIndex: -1 }, i), n); return r.replaceChild(xi("span", { className: "vjs-menu-item-text", textContent: this.localize(this.options_.label) }), r.querySelector(".vjs-icon-placeholder")), r }, i.handleKeyDown = function (t) { La.some((function (e) { return l().isEventKey(t, e) })) || e.prototype.handleKeyDown.call(this, t) }, i.handleClick = function (e) { this.selected(!0) }, i.selected = function (e) { this.selectable && (e ? (this.addClass("vjs-selected"), this.el_.setAttribute("aria-checked", "true"), this.controlText(", selected"), this.isSelected_ = !0) : (this.removeClass("vjs-selected"), this.el_.setAttribute("aria-checked", "false"), this.controlText(""), this.isSelected_ = !1)) }, t }(Gr); Vn.registerComponent("MenuItem", Oa); var Ba = function (e) { function t(t, i) { var n, a = i.track, o = t.textTracks(); i.label = a.label || a.language || "Unknown", i.selected = "showing" === a.mode, (n = e.call(this, t, i) || this).track = a, n.kinds = (i.kinds || [i.kind || n.track.kind]).filter(Boolean); var u, l = function () { for (var e = arguments.length, t = new Array(e), i = 0; i < e; i++)t[i] = arguments[i]; n.handleTracksChange.apply(c(n), t) }, d = function () { for (var e = arguments.length, t = new Array(e), i = 0; i < e; i++)t[i] = arguments[i]; n.handleSelectedLanguageChange.apply(c(n), t) }; (t.on(["loadstart", "texttrackchange"], l), o.addEventListener("change", l), o.addEventListener("selectedlanguagechange", d), n.on("dispose", (function () { t.off(["loadstart", "texttrackchange"], l), o.removeEventListener("change", l), o.removeEventListener("selectedlanguagechange", d) })), void 0 === o.onchange) && n.on(["tap", "click"], (function () { if ("object" != typeof r().Event) try { u = new (r().Event)("change") } catch (e) { } u || (u = s().createEvent("Event")).initEvent("change", !0, !0), o.dispatchEvent(u) })); return n.handleTracksChange(), n } h(t, e); var i = t.prototype; return i.handleClick = function (t) { var i = this.track, n = this.player_.textTracks(); if (e.prototype.handleClick.call(this, t), n) for (var r = 0; r < n.length; r++) { var a = n[r]; -1 !== this.kinds.indexOf(a.kind) && (a === i ? "showing" !== a.mode && (a.mode = "showing") : "disabled" !== a.mode && (a.mode = "disabled")) } }, i.handleTracksChange = function (e) { var t = "showing" === this.track.mode; t !== this.isSelected_ && this.selected(t) }, i.handleSelectedLanguageChange = function (e) { if ("showing" === this.track.mode) { var t = this.player_.cache_.selectedLanguage; if (t && t.enabled && t.language === this.track.language && t.kind !== this.track.kind) return; this.player_.cache_.selectedLanguage = { enabled: !0, language: this.track.language, kind: this.track.kind } } }, i.dispose = function () { this.track = null, e.prototype.dispose.call(this) }, t }(Oa); Vn.registerComponent("TextTrackMenuItem", Ba); var Ra = function (e) { function t(t, i) { return i.track = { player: t, kind: i.kind, kinds: i.kinds, default: !1, mode: "disabled" }, i.kinds || (i.kinds = [i.kind]), i.label ? i.track.label = i.label : i.track.label = i.kinds.join(" and ") + " off", i.selectable = !0, i.multiSelectable = !1, e.call(this, t, i) || this } h(t, e); var i = t.prototype; return i.handleTracksChange = function (e) { for (var t = this.player().textTracks(), i = !0, n = 0, r = t.length; n < r; n++) { var a = t[n]; if (this.options_.kinds.indexOf(a.kind) > -1 && "showing" === a.mode) { i = !1; break } } i !== this.isSelected_ && this.selected(i) }, i.handleSelectedLanguageChange = function (e) { for (var t = this.player().textTracks(), i = !0, n = 0, r = t.length; n < r; n++) { var a = t[n]; if (["captions", "descriptions", "subtitles"].indexOf(a.kind) > -1 && "showing" === a.mode) { i = !1; break } } i && (this.player_.cache_.selectedLanguage = { enabled: !1 }) }, t }(Ba); Vn.registerComponent("OffTextTrackMenuItem", Ra); var Ma = function (e) { function t(t, i) { return void 0 === i && (i = {}), i.tracks = t.textTracks(), e.call(this, t, i) || this } return h(t, e), t.prototype.createItems = function (e, t) { var i; void 0 === e && (e = []), void 0 === t && (t = Ba), this.label_ && (i = this.label_ + " off"), e.push(new Ra(this.player_, { kinds: this.kinds_, kind: this.kind_, label: i })), this.hideThreshold_ += 1; var n = this.player_.textTracks(); Array.isArray(this.kinds_) || (this.kinds_ = [this.kind_]); for (var r = 0; r < n.length; r++) { var a = n[r]; if (this.kinds_.indexOf(a.kind) > -1) { var s = new t(this.player_, { track: a, kinds: this.kinds_, kind: this.kind_, selectable: !0, multiSelectable: !1 }); s.addClass("vjs-" + a.kind + "-menu-item"), e.push(s) } } return e }, t }(Pa); Vn.registerComponent("TextTrackButton", Ma); var Na = function (e) { function t(t, i) { var n, r = i.track, a = i.cue, s = t.currentTime(); return i.selectable = !0, i.multiSelectable = !1, i.label = a.text, i.selected = a.startTime <= s && s < a.endTime, (n = e.call(this, t, i) || this).track = r, n.cue = a, r.addEventListener("cuechange", _n(c(n), n.update)), n } h(t, e); var i = t.prototype; return i.handleClick = function (t) { e.prototype.handleClick.call(this), this.player_.currentTime(this.cue.startTime), this.update(this.cue.startTime) }, i.update = function (e) { var t = this.cue, i = this.player_.currentTime(); this.selected(t.startTime <= i && i < t.endTime) }, t }(Oa); Vn.registerComponent("ChaptersTrackMenuItem", Na); var Ua = function (e) { function t(t, i, n) { return e.call(this, t, i, n) || this } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-chapters-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-chapters-button " + e.prototype.buildWrapperCSSClass.call(this) }, i.update = function (t) { this.track_ && (!t || "addtrack" !== t.type && "removetrack" !== t.type) || this.setTrack(this.findChaptersTrack()), e.prototype.update.call(this) }, i.setTrack = function (e) { if (this.track_ !== e) { if (this.updateHandler_ || (this.updateHandler_ = this.update.bind(this)), this.track_) { var t = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_); t && t.removeEventListener("load", this.updateHandler_), this.track_ = null } if (this.track_ = e, this.track_) { this.track_.mode = "hidden"; var i = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_); i && i.addEventListener("load", this.updateHandler_) } } }, i.findChaptersTrack = function () { for (var e = this.player_.textTracks() || [], t = e.length - 1; t >= 0; t--) { var i = e[t]; if (i.kind === this.kind_) return i } }, i.getMenuCaption = function () { return this.track_ && this.track_.label ? this.track_.label : this.localize(Rn(this.kind_)) }, i.createMenu = function () { return this.options_.title = this.getMenuCaption(), e.prototype.createMenu.call(this) }, i.createItems = function () { var e = []; if (!this.track_) return e; var t = this.track_.cues; if (!t) return e; for (var i = 0, n = t.length; i < n; i++) { var r = t[i], a = new Na(this.player_, { track: this.track_, cue: r }); e.push(a) } return e }, t }(Ma); Ua.prototype.kind_ = "chapters", Ua.prototype.controlText_ = "Chapters", Vn.registerComponent("ChaptersButton", Ua); var ja = function (e) { function t(t, i, n) { var r; r = e.call(this, t, i, n) || this; var a = t.textTracks(), s = _n(c(r), r.handleTracksChange); return a.addEventListener("change", s), r.on("dispose", (function () { a.removeEventListener("change", s) })), r } h(t, e); var i = t.prototype; return i.handleTracksChange = function (e) { for (var t = this.player().textTracks(), i = !1, n = 0, r = t.length; n < r; n++) { var a = t[n]; if (a.kind !== this.kind_ && "showing" === a.mode) { i = !0; break } } i ? this.disable() : this.enable() }, i.buildCSSClass = function () { return "vjs-descriptions-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-descriptions-button " + e.prototype.buildWrapperCSSClass.call(this) }, t }(Ma); ja.prototype.kind_ = "descriptions", ja.prototype.controlText_ = "Descriptions", Vn.registerComponent("DescriptionsButton", ja); var Ha = function (e) { function t(t, i, n) { return e.call(this, t, i, n) || this } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-subtitles-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-subtitles-button " + e.prototype.buildWrapperCSSClass.call(this) }, t }(Ma); Ha.prototype.kind_ = "subtitles", Ha.prototype.controlText_ = "Subtitles", Vn.registerComponent("SubtitlesButton", Ha); var Va = function (e) { function t(t, i) { var n; return i.track = { player: t, kind: i.kind, label: i.kind + " settings", selectable: !1, default: !1, mode: "disabled" }, i.selectable = !1, i.name = "CaptionSettingsMenuItem", (n = e.call(this, t, i) || this).addClass("vjs-texttrack-settings"), n.controlText(", opens " + i.kind + " settings dialog"), n } return h(t, e), t.prototype.handleClick = function (e) { this.player().getChild("textTrackSettings").open() }, t }(Ba); Vn.registerComponent("CaptionSettingsMenuItem", Va); var qa = function (e) { function t(t, i, n) { return e.call(this, t, i, n) || this } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-captions-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-captions-button " + e.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function () { var t = []; return this.player().tech_ && this.player().tech_.featuresNativeTextTracks || !this.player().getChild("textTrackSettings") || (t.push(new Va(this.player_, { kind: this.kind_ })), this.hideThreshold_ += 1), e.prototype.createItems.call(this, t) }, t }(Ma); qa.prototype.kind_ = "captions", qa.prototype.controlText_ = "Captions", Vn.registerComponent("CaptionsButton", qa); var Wa = function (e) { function t() { return e.apply(this, arguments) || this } return h(t, e), t.prototype.createEl = function (t, i, n) { var r = e.prototype.createEl.call(this, t, i, n), a = r.querySelector(".vjs-menu-item-text"); return "captions" === this.options_.track.kind && (a.appendChild(xi("span", { className: "vjs-icon-placeholder" }, { "aria-hidden": !0 })), a.appendChild(xi("span", { className: "vjs-control-text", textContent: " " + this.localize("Captions") }))), r }, t }(Ba); Vn.registerComponent("SubsCapsMenuItem", Wa); var Ga = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), (n = e.call(this, t, i) || this).label_ = "subtitles", ["en", "en-us", "en-ca", "fr-ca"].indexOf(n.player_.language_) > -1 && (n.label_ = "captions"), n.menuButton_.controlText(Rn(n.label_)), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-subs-caps-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-subs-caps-button " + e.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function () { var t = []; return this.player().tech_ && this.player().tech_.featuresNativeTextTracks || !this.player().getChild("textTrackSettings") || (t.push(new Va(this.player_, { kind: this.label_ })), this.hideThreshold_ += 1), t = e.prototype.createItems.call(this, t, Wa) }, t }(Ma); Ga.prototype.kinds_ = ["captions", "subtitles"], Ga.prototype.controlText_ = "Subtitles", Vn.registerComponent("SubsCapsButton", Ga); var za = function (e) { function t(t, i) { var n, r = i.track, a = t.audioTracks(); i.label = r.label || r.language || "Unknown", i.selected = r.enabled, (n = e.call(this, t, i) || this).track = r, n.addClass("vjs-" + r.kind + "-menu-item"); var s = function () { for (var e = arguments.length, t = new Array(e), i = 0; i < e; i++)t[i] = arguments[i]; n.handleTracksChange.apply(c(n), t) }; return a.addEventListener("change", s), n.on("dispose", (function () { a.removeEventListener("change", s) })), n } h(t, e); var i = t.prototype; return i.createEl = function (t, i, n) { var r = e.prototype.createEl.call(this, t, i, n), a = r.querySelector(".vjs-menu-item-text"); return "main-desc" === this.options_.track.kind && (a.appendChild(xi("span", { className: "vjs-icon-placeholder" }, { "aria-hidden": !0 })), a.appendChild(xi("span", { className: "vjs-control-text", textContent: " " + this.localize("Descriptions") }))), r }, i.handleClick = function (t) { if (e.prototype.handleClick.call(this, t), this.track.enabled = !0, this.player_.tech_.featuresNativeAudioTracks) for (var i = this.player_.audioTracks(), n = 0; n < i.length; n++) { var r = i[n]; r !== this.track && (r.enabled = r === this.track) } }, i.handleTracksChange = function (e) { this.selected(this.track.enabled) }, t }(Oa); Vn.registerComponent("AudioTrackMenuItem", za); var Qa = function (e) { function t(t, i) { return void 0 === i && (i = {}), i.tracks = t.audioTracks(), e.call(this, t, i) || this } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-audio-button " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-audio-button " + e.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function (e) { void 0 === e && (e = []), this.hideThreshold_ = 1; for (var t = this.player_.audioTracks(), i = 0; i < t.length; i++) { var n = t[i]; e.push(new za(this.player_, { track: n, selectable: !0, multiSelectable: !1 })) } return e }, t }(Pa); Qa.prototype.controlText_ = "Audio Track", Vn.registerComponent("AudioTrackButton", Qa); var Xa = function (e) { function t(t, i) { var n, r = i.rate, a = parseFloat(r, 10); return i.label = r, i.selected = a === t.playbackRate(), i.selectable = !0, i.multiSelectable = !1, (n = e.call(this, t, i) || this).label = r, n.rate = a, n.on(t, "ratechange", (function (e) { return n.update(e) })), n } h(t, e); var i = t.prototype; return i.handleClick = function (t) { e.prototype.handleClick.call(this), this.player().playbackRate(this.rate) }, i.update = function (e) { this.selected(this.player().playbackRate() === this.rate) }, t }(Oa); Xa.prototype.contentElType = "button", Vn.registerComponent("PlaybackRateMenuItem", Xa); var $a = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).menuButton_.el_.setAttribute("aria-describedby", n.labelElId_), n.updateVisibility(), n.updateLabel(), n.on(t, "loadstart", (function (e) { return n.updateVisibility(e) })), n.on(t, "ratechange", (function (e) { return n.updateLabel(e) })), n.on(t, "playbackrateschange", (function (e) { return n.handlePlaybackRateschange(e) })), n } h(t, e); var i = t.prototype; return i.createEl = function () { var t = e.prototype.createEl.call(this); return this.labelElId_ = "vjs-playback-rate-value-label-" + this.id_, this.labelEl_ = xi("div", { className: "vjs-playback-rate-value", id: this.labelElId_, textContent: "1x" }), t.appendChild(this.labelEl_), t }, i.dispose = function () { this.labelEl_ = null, e.prototype.dispose.call(this) }, i.buildCSSClass = function () { return "vjs-playback-rate " + e.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-playback-rate " + e.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function () { for (var e = this.playbackRates(), t = [], i = e.length - 1; i >= 0; i--)t.push(new Xa(this.player(), { rate: e[i] + "x" })); return t }, i.updateARIAAttributes = function () { this.el().setAttribute("aria-valuenow", this.player().playbackRate()) }, i.handleClick = function (e) { var t = this.player().playbackRate(), i = this.playbackRates(), n = (i.indexOf(t) + 1) % i.length; this.player().playbackRate(i[n]) }, i.handlePlaybackRateschange = function (e) { this.update() }, i.playbackRates = function () { var e = this.player(); return e.playbackRates && e.playbackRates() || [] }, i.playbackRateSupported = function () { return this.player().tech_ && this.player().tech_.featuresPlaybackRate && this.playbackRates() && this.playbackRates().length > 0 }, i.updateVisibility = function (e) { this.playbackRateSupported() ? this.removeClass("vjs-hidden") : this.addClass("vjs-hidden") }, i.updateLabel = function (e) { this.playbackRateSupported() && (this.labelEl_.textContent = this.player().playbackRate() + "x") }, t }(Da); $a.prototype.controlText_ = "Playback Rate", Vn.registerComponent("PlaybackRateMenuButton", $a); var Ka = function (e) { function t() { return e.apply(this, arguments) || this } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-spacer " + e.prototype.buildCSSClass.call(this) }, i.createEl = function (t, i, n) { return void 0 === t && (t = "div"), void 0 === i && (i = {}), void 0 === n && (n = {}), i.className || (i.className = this.buildCSSClass()), e.prototype.createEl.call(this, t, i, n) }, t }(Vn); Vn.registerComponent("Spacer", Ka); var Ya = function (e) { function t() { return e.apply(this, arguments) || this } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-custom-control-spacer " + e.prototype.buildCSSClass.call(this) }, i.createEl = function () { return e.prototype.createEl.call(this, "div", { className: this.buildCSSClass(), textContent: " " }) }, t }(Ka); Vn.registerComponent("CustomControlSpacer", Ya); var Za = function (e) { function t() { return e.apply(this, arguments) || this } return h(t, e), t.prototype.createEl = function () { return e.prototype.createEl.call(this, "div", { className: "vjs-control-bar", dir: "ltr" }) }, t }(Vn); Za.prototype.options_ = { children: ["playToggle", "volumePanel", "currentTimeDisplay", "timeDivider", "durationDisplay", "progressControl", "liveDisplay", "seekToLive", "remainingTimeDisplay", "customControlSpacer", "playbackRateMenuButton", "chaptersButton", "descriptionsButton", "subsCapsButton", "audioTrackButton", "fullscreenToggle"] }, "exitPictureInPicture" in s() && Za.prototype.options_.children.splice(Za.prototype.options_.children.length - 1, 0, "pictureInPictureToggle"), Vn.registerComponent("ControlBar", Za); var Ja = function (e) { function t(t, i) { var n; return (n = e.call(this, t, i) || this).on(t, "error", (function (e) { return n.open(e) })), n } h(t, e); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-error-display " + e.prototype.buildCSSClass.call(this) }, i.content = function () { var e = this.player().error(); return e ? this.localize(e.message) : "" }, t }(er); Ja.prototype.options_ = o({}, er.prototype.options_, { pauseOnOpen: !1, fillAlways: !0, temporary: !1, uncloseable: !0 }), Vn.registerComponent("ErrorDisplay", Ja); var es = "vjs-text-track-settings", ts = ["#000", "Black"], is = ["#00F", "Blue"], ns = ["#0FF", "Cyan"], rs = ["#0F0", "Green"], as = ["#F0F", "Magenta"], ss = ["#F00", "Red"], os = ["#FFF", "White"], us = ["#FF0", "Yellow"], ls = ["1", "Opaque"], cs = ["0.5", "Semi-Transparent"], ds = ["0", "Transparent"], hs = { backgroundColor: { selector: ".vjs-bg-color > select", id: "captions-background-color-%s", label: "Color", options: [ts, os, ss, rs, is, us, as, ns] }, backgroundOpacity: { selector: ".vjs-bg-opacity > select", id: "captions-background-opacity-%s", label: "Transparency", options: [ls, cs, ds] }, color: { selector: ".vjs-fg-color > select", id: "captions-foreground-color-%s", label: "Color", options: [os, ts, ss, rs, is, us, as, ns] }, edgeStyle: { selector: ".vjs-edge-style > select", id: "%s", label: "Text Edge Style", options: [["none", "None"], ["raised", "Raised"], ["depressed", "Depressed"], ["uniform", "Uniform"], ["dropshadow", "Dropshadow"]] }, fontFamily: { selector: ".vjs-font-family > select", id: "captions-font-family-%s", label: "Font Family", options: [["proportionalSansSerif", "Proportional Sans-Serif"], ["monospaceSansSerif", "Monospace Sans-Serif"], ["proportionalSerif", "Proportional Serif"], ["monospaceSerif", "Monospace Serif"], ["casual", "Casual"], ["script", "Script"], ["small-caps", "Small Caps"]] }, fontPercent: { selector: ".vjs-font-percent > select", id: "captions-font-size-%s", label: "Font Size", options: [["0.50", "50%"], ["0.75", "75%"], ["1.00", "100%"], ["1.25", "125%"], ["1.50", "150%"], ["1.75", "175%"], ["2.00", "200%"], ["3.00", "300%"], ["4.00", "400%"]], default: 2, parser: function (e) { return "1.00" === e ? null : Number(e) } }, textOpacity: { selector: ".vjs-text-opacity > select", id: "captions-foreground-opacity-%s", label: "Transparency", options: [ls, cs] }, windowColor: { selector: ".vjs-window-color > select", id: "captions-window-color-%s", label: "Color" }, windowOpacity: { selector: ".vjs-window-opacity > select", id: "captions-window-opacity-%s", label: "Transparency", options: [ds, cs, ls] } }; function ps(e, t) { if (t && (e = t(e)), e && "none" !== e) return e } hs.windowColor.options = hs.backgroundColor.options; var fs = function (e) { function t(t, i) { var n; return i.temporary = !1, (n = e.call(this, t, i) || this).updateDisplay = n.updateDisplay.bind(c(n)), n.fill(), n.hasBeenOpened_ = n.hasBeenFilled_ = !0, n.endDialog = xi("p", { className: "vjs-control-text", textContent: n.localize("End of dialog window.") }), n.el().appendChild(n.endDialog), n.setDefaults(), void 0 === i.persistTextTrackSettings && (n.options_.persistTextTrackSettings = n.options_.playerOptions.persistTextTrackSettings), n.on(n.$(".vjs-done-button"), "click", (function () { n.saveSettings(), n.close() })), n.on(n.$(".vjs-default-button"), "click", (function () { n.setDefaults(), n.updateDisplay() })), Wt(hs, (function (e) { n.on(n.$(e.selector), "change", n.updateDisplay) })), n.options_.persistTextTrackSettings && n.restoreSettings(), n } h(t, e); var i = t.prototype; return i.dispose = function () { this.endDialog = null, e.prototype.dispose.call(this) }, i.createElSelect_ = function (e, t, i) { var n = this; void 0 === t && (t = ""), void 0 === i && (i = "label"); var r = hs[e], a = r.id.replace("%s", this.id_), s = [t, a].join(" ").trim(); return ["<" + i + ' id="' + a + '" class="' + ("label" === i ? "vjs-label" : "") + '">', this.localize(r.label), "</" + i + ">", '<select aria-labelledby="' + s + '">'].concat(r.options.map((function (e) { var t = a + "-" + e[1].replace(/\W+/g, ""); return ['<option id="' + t + '" value="' + e[0] + '" ', 'aria-labelledby="' + s + " " + t + '">', n.localize(e[1]), "</option>"].join("") }))).concat("</select>").join("") }, i.createElFgColor_ = function () { var e = "captions-text-legend-" + this.id_; return ['<fieldset class="vjs-fg-color vjs-track-setting">', '<legend id="' + e + '">', this.localize("Text"), "</legend>", this.createElSelect_("color", e), '<span class="vjs-text-opacity vjs-opacity">', this.createElSelect_("textOpacity", e), "</span>", "</fieldset>"].join("") }, i.createElBgColor_ = function () { var e = "captions-background-" + this.id_; return ['<fieldset class="vjs-bg-color vjs-track-setting">', '<legend id="' + e + '">', this.localize("Background"), "</legend>", this.createElSelect_("backgroundColor", e), '<span class="vjs-bg-opacity vjs-opacity">', this.createElSelect_("backgroundOpacity", e), "</span>", "</fieldset>"].join("") }, i.createElWinColor_ = function () { var e = "captions-window-" + this.id_; return ['<fieldset class="vjs-window-color vjs-track-setting">', '<legend id="' + e + '">', this.localize("Window"), "</legend>", this.createElSelect_("windowColor", e), '<span class="vjs-window-opacity vjs-opacity">', this.createElSelect_("windowOpacity", e), "</span>", "</fieldset>"].join("") }, i.createElColors_ = function () { return xi("div", { className: "vjs-track-settings-colors", innerHTML: [this.createElFgColor_(), this.createElBgColor_(), this.createElWinColor_()].join("") }) }, i.createElFont_ = function () { return xi("div", { className: "vjs-track-settings-font", innerHTML: ['<fieldset class="vjs-font-percent vjs-track-setting">', this.createElSelect_("fontPercent", "", "legend"), "</fieldset>", '<fieldset class="vjs-edge-style vjs-track-setting">', this.createElSelect_("edgeStyle", "", "legend"), "</fieldset>", '<fieldset class="vjs-font-family vjs-track-setting">', this.createElSelect_("fontFamily", "", "legend"), "</fieldset>"].join("") }) }, i.createElControls_ = function () { var e = this.localize("restore all settings to the default values"); return xi("div", { className: "vjs-track-settings-controls", innerHTML: ['<button type="button" class="vjs-default-button" title="' + e + '">', this.localize("Reset"), '<span class="vjs-control-text"> ' + e + "</span>", "</button>", '<button type="button" class="vjs-done-button">' + this.localize("Done") + "</button>"].join("") }) }, i.content = function () { return [this.createElColors_(), this.createElFont_(), this.createElControls_()] }, i.label = function () { return this.localize("Caption Settings Dialog") }, i.description = function () { return this.localize("Beginning of dialog window. Escape will cancel and close the window.") }, i.buildCSSClass = function () { return e.prototype.buildCSSClass.call(this) + " vjs-text-track-settings" }, i.getValues = function () { var e, t, i, n = this; return t = function (e, t, i) { var r, a, s = (r = n.$(t.selector), a = t.parser, ps(r.options[r.options.selectedIndex].value, a)); return void 0 !== s && (e[i] = s), e }, void 0 === (i = {}) && (i = 0), qt(e = hs).reduce((function (i, n) { return t(i, e[n], n) }), i) }, i.setValues = function (e) { var t = this; Wt(hs, (function (i, n) { !function (e, t, i) { if (t) for (var n = 0; n < e.options.length; n++)if (ps(e.options[n].value, i) === t) { e.selectedIndex = n; break } }(t.$(i.selector), e[n], i.parser) })) }, i.setDefaults = function () { var e = this; Wt(hs, (function (t) { var i = t.hasOwnProperty("default") ? t.default : 0; e.$(t.selector).selectedIndex = i })) }, i.restoreSettings = function () { var e; try { e = JSON.parse(r().localStorage.getItem(es)) } catch (e) { jt.warn(e) } e && this.setValues(e) }, i.saveSettings = function () { if (this.options_.persistTextTrackSettings) { var e = this.getValues(); try { Object.keys(e).length ? r().localStorage.setItem(es, JSON.stringify(e)) : r().localStorage.removeItem(es) } catch (e) { jt.warn(e) } } }, i.updateDisplay = function () { var e = this.player_.getChild("textTrackDisplay"); e && e.updateDisplay() }, i.conditionalBlur_ = function () { this.previouslyActiveEl_ = null; var e = this.player_.controlBar, t = e && e.subsCapsButton, i = e && e.captionsButton; t ? t.focus() : i && i.focus() }, t }(er); Vn.registerComponent("TextTrackSettings", fs); var ms = function (e) { function t(t, i) { var n, a = i.ResizeObserver || r().ResizeObserver; null === i.ResizeObserver && (a = !1); var s = Mn({ createEl: !a, reportTouchActivity: !1 }, i); return (n = e.call(this, t, s) || this).ResizeObserver = i.ResizeObserver || r().ResizeObserver, n.loadListener_ = null, n.resizeObserver_ = null, n.debouncedHandler_ = function (e, t, i, n) { var a; void 0 === n && (n = r()); var s = function () { var r = this, s = arguments, o = function () { a = null, o = null, i || e.apply(r, s) }; !a && i && e.apply(r, s), n.clearTimeout(a), a = n.setTimeout(o, t) }; return s.cancel = function () { n.clearTimeout(a), a = null }, s }((function () { n.resizeHandler() }), 100, !1, c(n)), a ? (n.resizeObserver_ = new n.ResizeObserver(n.debouncedHandler_), n.resizeObserver_.observe(t.el())) : (n.loadListener_ = function () { if (n.el_ && n.el_.contentWindow) { var e = n.debouncedHandler_, t = n.unloadListener_ = function () { pn(this, "resize", e), pn(this, "unload", t), t = null }; hn(n.el_.contentWindow, "unload", t), hn(n.el_.contentWindow, "resize", e) } }, n.one("load", n.loadListener_)), n } h(t, e); var i = t.prototype; return i.createEl = function () { return e.prototype.createEl.call(this, "iframe", { className: "vjs-resize-manager", tabIndex: -1 }, { "aria-hidden": "true" }) }, i.resizeHandler = function () { this.player_ && this.player_.trigger && this.player_.trigger("playerresize") }, i.dispose = function () { this.debouncedHandler_ && this.debouncedHandler_.cancel(), this.resizeObserver_ && (this.player_.el() && this.resizeObserver_.unobserve(this.player_.el()), this.resizeObserver_.disconnect()), this.loadListener_ && this.off("load", this.loadListener_), this.el_ && this.el_.contentWindow && this.unloadListener_ && this.unloadListener_.call(this.el_.contentWindow), this.ResizeObserver = null, this.resizeObserver = null, this.debouncedHandler_ = null, this.loadListener_ = null, e.prototype.dispose.call(this) }, t }(Vn); Vn.registerComponent("ResizeManager", ms); var gs = { trackingThreshold: 20, liveTolerance: 15 }, As = function (e) { function t(t, i) { var n, r = Mn(gs, i, { createEl: !1 }); return (n = e.call(this, t, r) || this).handleVisibilityChange_ = function (e) { return n.handleVisibilityChange(e) }, n.trackLiveHandler_ = function () { return n.trackLive_() }, n.handlePlay_ = function (e) { return n.handlePlay(e) }, n.handleFirstTimeupdate_ = function (e) { return n.handleFirstTimeupdate(e) }, n.handleSeeked_ = function (e) { return n.handleSeeked(e) }, n.seekToLiveEdge_ = function (e) { return n.seekToLiveEdge(e) }, n.reset_(), n.on(n.player_, "durationchange", (function (e) { return n.handleDurationchange(e) })), n.on(n.player_, "canplay", (function () { return n.toggleTracking() })), ui && "hidden" in s() && "visibilityState" in s() && n.on(s(), "visibilitychange", n.handleVisibilityChange_), n } h(t, e); var i = t.prototype; return i.handleVisibilityChange = function () { this.player_.duration() === 1 / 0 && (s().hidden ? this.stopTracking() : this.startTracking()) }, i.trackLive_ = function () { var e = this.player_.seekable(); if (e && e.length) { var t = Number(r().performance.now().toFixed(4)), i = -1 === this.lastTime_ ? 0 : (t - this.lastTime_) / 1e3; this.lastTime_ = t, this.pastSeekEnd_ = this.pastSeekEnd() + i; var n = this.liveCurrentTime(), a = this.player_.currentTime(), s = this.player_.paused() || this.seekedBehindLive_ || Math.abs(n - a) > this.options_.liveTolerance; this.timeupdateSeen_ && n !== 1 / 0 || (s = !1), s !== this.behindLiveEdge_ && (this.behindLiveEdge_ = s, this.trigger("liveedgechange")) } }, i.handleDurationchange = function () { this.toggleTracking() }, i.toggleTracking = function () { this.player_.duration() === 1 / 0 && this.liveWindow() >= this.options_.trackingThreshold ? (this.player_.options_.liveui && this.player_.addClass("vjs-liveui"), this.startTracking()) : (this.player_.removeClass("vjs-liveui"), this.stopTracking()) }, i.startTracking = function () { this.isTracking() || (this.timeupdateSeen_ || (this.timeupdateSeen_ = this.player_.hasStarted()), this.trackingInterval_ = this.setInterval(this.trackLiveHandler_, yn), this.trackLive_(), this.on(this.player_, ["play", "pause"], this.trackLiveHandler_), this.timeupdateSeen_ ? this.on(this.player_, "seeked", this.handleSeeked_) : (this.one(this.player_, "play", this.handlePlay_), this.one(this.player_, "timeupdate", this.handleFirstTimeupdate_))) }, i.handleFirstTimeupdate = function () { this.timeupdateSeen_ = !0, this.on(this.player_, "seeked", this.handleSeeked_) }, i.handleSeeked = function () { var e = Math.abs(this.liveCurrentTime() - this.player_.currentTime()); this.seekedBehindLive_ = this.nextSeekedFromUser_ && e > 2, this.nextSeekedFromUser_ = !1, this.trackLive_() }, i.handlePlay = function () { this.one(this.player_, "timeupdate", this.seekToLiveEdge_) }, i.reset_ = function () { this.lastTime_ = -1, this.pastSeekEnd_ = 0, this.lastSeekEnd_ = -1, this.behindLiveEdge_ = !0, this.timeupdateSeen_ = !1, this.seekedBehindLive_ = !1, this.nextSeekedFromUser_ = !1, this.clearInterval(this.trackingInterval_), this.trackingInterval_ = null, this.off(this.player_, ["play", "pause"], this.trackLiveHandler_), this.off(this.player_, "seeked", this.handleSeeked_), this.off(this.player_, "play", this.handlePlay_), this.off(this.player_, "timeupdate", this.handleFirstTimeupdate_), this.off(this.player_, "timeupdate", this.seekToLiveEdge_) }, i.nextSeekedFromUser = function () { this.nextSeekedFromUser_ = !0 }, i.stopTracking = function () { this.isTracking() && (this.reset_(), this.trigger("liveedgechange")) }, i.seekableEnd = function () { for (var e = this.player_.seekable(), t = [], i = e ? e.length : 0; i--;)t.push(e.end(i)); return t.length ? t.sort()[t.length - 1] : 1 / 0 }, i.seekableStart = function () { for (var e = this.player_.seekable(), t = [], i = e ? e.length : 0; i--;)t.push(e.start(i)); return t.length ? t.sort()[0] : 0 }, i.liveWindow = function () { var e = this.liveCurrentTime(); return e === 1 / 0 ? 0 : e - this.seekableStart() }, i.isLive = function () { return this.isTracking() }, i.atLiveEdge = function () { return !this.behindLiveEdge() }, i.liveCurrentTime = function () { return this.pastSeekEnd() + this.seekableEnd() }, i.pastSeekEnd = function () { var e = this.seekableEnd(); return -1 !== this.lastSeekEnd_ && e !== this.lastSeekEnd_ && (this.pastSeekEnd_ = 0), this.lastSeekEnd_ = e, this.pastSeekEnd_ }, i.behindLiveEdge = function () { return this.behindLiveEdge_ }, i.isTracking = function () { return "number" == typeof this.trackingInterval_ }, i.seekToLiveEdge = function () { this.seekedBehindLive_ = !1, this.atLiveEdge() || (this.nextSeekedFromUser_ = !1, this.player_.currentTime(this.liveCurrentTime())) }, i.dispose = function () { this.off(s(), "visibilitychange", this.handleVisibilityChange_), this.stopTracking(), e.prototype.dispose.call(this) }, t }(Vn); Vn.registerComponent("LiveTracker", As); var vs, ys = function (e) { var t = e.el(); if (t.hasAttribute("src")) return e.triggerSourceset(t.src), !0; var i = e.$$("source"), n = [], r = ""; if (!i.length) return !1; for (var a = 0; a < i.length; a++) { var s = i[a].src; s && -1 === n.indexOf(s) && n.push(s) } return !!n.length && (1 === n.length && (r = n[0]), e.triggerSourceset(r), !0) }, _s = Object.defineProperty({}, "innerHTML", { get: function () { return this.cloneNode(!0).innerHTML }, set: function (e) { var t = s().createElement(this.nodeName.toLowerCase()); t.innerHTML = e; for (var i = s().createDocumentFragment(); t.childNodes.length;)i.appendChild(t.childNodes[0]); return this.innerText = "", r().Element.prototype.appendChild.call(this, i), this.innerHTML } }), bs = function (e, t) { for (var i = {}, n = 0; n < e.length && !((i = Object.getOwnPropertyDescriptor(e[n], t)) && i.set && i.get); n++); return i.enumerable = !0, i.configurable = !0, i }, Ts = function (e) { var t = e.el(); if (!t.resetSourceWatch_) { var i = {}, n = function (e) { return bs([e.el(), r().HTMLMediaElement.prototype, r().Element.prototype, _s], "innerHTML") }(e), a = function (i) { return function () { for (var n = arguments.length, r = new Array(n), a = 0; a < n; a++)r[a] = arguments[a]; var s = i.apply(t, r); return ys(e), s } };["append", "appendChild", "insertAdjacentHTML"].forEach((function (e) { t[e] && (i[e] = t[e], t[e] = a(i[e])) })), Object.defineProperty(t, "innerHTML", Mn(n, { set: a(n.set) })), t.resetSourceWatch_ = function () { t.resetSourceWatch_ = null, Object.keys(i).forEach((function (e) { t[e] = i[e] })), Object.defineProperty(t, "innerHTML", n) }, e.one("sourceset", t.resetSourceWatch_) } }, xs = Object.defineProperty({}, "src", { get: function () { return this.hasAttribute("src") ? gr(r().Element.prototype.getAttribute.call(this, "src")) : "" }, set: function (e) { return r().Element.prototype.setAttribute.call(this, "src", e), e } }), Ss = function (e) { if (e.featuresSourceset) { var t = e.el(); if (!t.resetSourceset_) { var i = function (e) { return bs([e.el(), r().HTMLMediaElement.prototype, xs], "src") }(e), n = t.setAttribute, a = t.load; Object.defineProperty(t, "src", Mn(i, { set: function (n) { var r = i.set.call(t, n); return e.triggerSourceset(t.src), r } })), t.setAttribute = function (i, r) { var a = n.call(t, i, r); return /src/i.test(i) && e.triggerSourceset(t.src), a }, t.load = function () { var i = a.call(t); return ys(e) || (e.triggerSourceset(""), Ts(e)), i }, t.currentSrc ? e.triggerSourceset(t.currentSrc) : ys(e) || Ts(e), t.resetSourceset_ = function () { t.resetSourceset_ = null, t.load = a, t.setAttribute = n, Object.defineProperty(t, "src", i), t.resetSourceWatch_ && t.resetSourceWatch_() } } } }, Es = function (e, t, i, n) { void 0 === n && (n = !0); var r = function (i) { return Object.defineProperty(e, t, { value: i, enumerable: !0, writable: !0 }) }, a = { configurable: !0, enumerable: !0, get: function () { var e = i(); return r(e), e } }; return n && (a.set = r), Object.defineProperty(e, t, a) }, Cs = function (e) { function t(t, i) { var n; n = e.call(this, t, i) || this; var r = t.source, a = !1; if (r && (n.el_.currentSrc !== r.src || t.tag && 3 === t.tag.initNetworkState_) ? n.setSource(r) : n.handleLateInit_(n.el_), t.enableSourceset && n.setupSourcesetHandling_(), n.isScrubbing_ = !1, n.el_.hasChildNodes()) { for (var s = n.el_.childNodes, o = s.length, u = []; o--;) { var l = s[o]; "track" === l.nodeName.toLowerCase() && (n.featuresNativeTextTracks ? (n.remoteTextTrackEls().addTrackElement_(l), n.remoteTextTracks().addTrack(l.track), n.textTracks().addTrack(l.track), a || n.el_.hasAttribute("crossorigin") || !vr(l.src) || (a = !0)) : u.push(l)) } for (var c = 0; c < u.length; c++)n.el_.removeChild(u[c]) } return n.proxyNativeTracks_(), n.featuresNativeTextTracks && a && jt.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."), n.restoreMetadataTracksInIOSNativePlayer_(), (di || pi || ni) && !0 === t.nativeControlsForTouch && n.setControls(!0), n.proxyWebkitFullscreen_(), n.triggerReady(), n } h(t, e); var i = t.prototype; return i.dispose = function () { this.el_ && this.el_.resetSourceset_ && this.el_.resetSourceset_(), t.disposeMediaElement(this.el_), this.options_ = null, e.prototype.dispose.call(this) }, i.setupSourcesetHandling_ = function () { Ss(this) }, i.restoreMetadataTracksInIOSNativePlayer_ = function () { var e, t = this.textTracks(), i = function () { e = []; for (var i = 0; i < t.length; i++) { var n = t[i]; "metadata" === n.kind && e.push({ track: n, storedMode: n.mode }) } }; i(), t.addEventListener("change", i), this.on("dispose", (function () { return t.removeEventListener("change", i) })); var n = function i() { for (var n = 0; n < e.length; n++) { var r = e[n]; "disabled" === r.track.mode && r.track.mode !== r.storedMode && (r.track.mode = r.storedMode) } t.removeEventListener("change", i) }; this.on("webkitbeginfullscreen", (function () { t.removeEventListener("change", i), t.removeEventListener("change", n), t.addEventListener("change", n) })), this.on("webkitendfullscreen", (function () { t.removeEventListener("change", i), t.addEventListener("change", i), t.removeEventListener("change", n) })) }, i.overrideNative_ = function (e, t) { var i = this; if (t === this["featuresNative" + e + "Tracks"]) { var n = e.toLowerCase(); this[n + "TracksListeners_"] && Object.keys(this[n + "TracksListeners_"]).forEach((function (e) { i.el()[n + "Tracks"].removeEventListener(e, i[n + "TracksListeners_"][e]) })), this["featuresNative" + e + "Tracks"] = !t, this[n + "TracksListeners_"] = null, this.proxyNativeTracksForType_(n) } }, i.overrideNativeAudioTracks = function (e) { this.overrideNative_("Audio", e) }, i.overrideNativeVideoTracks = function (e) { this.overrideNative_("Video", e) }, i.proxyNativeTracksForType_ = function (e) { var t = this, i = Cr[e], n = this.el()[i.getterName], r = this[i.getterName](); if (this["featuresNative" + i.capitalName + "Tracks"] && n && n.addEventListener) { var a = { change: function (i) { var n = { type: "change", target: r, currentTarget: r, srcElement: r }; r.trigger(n), "text" === e && t[wr.remoteText.getterName]().trigger(n) }, addtrack: function (e) { r.addTrack(e.track) }, removetrack: function (e) { r.removeTrack(e.track) } }, s = function () { for (var e = [], t = 0; t < r.length; t++) { for (var i = !1, a = 0; a < n.length; a++)if (n[a] === r[t]) { i = !0; break } i || e.push(r[t]) } for (; e.length;)r.removeTrack(e.shift()) }; this[i.getterName + "Listeners_"] = a, Object.keys(a).forEach((function (e) { var i = a[e]; n.addEventListener(e, i), t.on("dispose", (function (t) { return n.removeEventListener(e, i) })) })), this.on("loadstart", s), this.on("dispose", (function (e) { return t.off("loadstart", s) })) } }, i.proxyNativeTracks_ = function () { var e = this; Cr.names.forEach((function (t) { e.proxyNativeTracksForType_(t) })) }, i.createEl = function () { var e = this.options_.tag; if (!e || !this.options_.playerElIngest && !this.movingMediaElementInDOM) { if (e) { var i = e.cloneNode(!0); e.parentNode && e.parentNode.insertBefore(i, e), t.disposeMediaElement(e), e = i } else { e = s().createElement("video"); var n = Mn({}, this.options_.tag && Di(this.options_.tag)); di && !0 === this.options_.nativeControlsForTouch || delete n.controls, Ii(e, Gt(n, { id: this.options_.techId, class: "vjs-tech" })) } e.playerId = this.options_.playerId } void 0 !== this.options_.preload && Li(e, "preload", this.options_.preload), void 0 !== this.options_.disablePictureInPicture && (e.disablePictureInPicture = this.options_.disablePictureInPicture); for (var r = ["loop", "muted", "playsinline", "autoplay"], a = 0; a < r.length; a++) { var o = r[a], u = this.options_[o]; void 0 !== u && (u ? Li(e, o, o) : Oi(e, o), e[o] = u) } return e }, i.handleLateInit_ = function (e) { if (0 !== e.networkState && 3 !== e.networkState) { if (0 === e.readyState) { var t = !1, i = function () { t = !0 }; this.on("loadstart", i); var n = function () { t || this.trigger("loadstart") }; return this.on("loadedmetadata", n), void this.ready((function () { this.off("loadstart", i), this.off("loadedmetadata", n), t || this.trigger("loadstart") })) } var r = ["loadstart"]; r.push("loadedmetadata"), e.readyState >= 2 && r.push("loadeddata"), e.readyState >= 3 && r.push("canplay"), e.readyState >= 4 && r.push("canplaythrough"), this.ready((function () { r.forEach((function (e) { this.trigger(e) }), this) })) } }, i.setScrubbing = function (e) { this.isScrubbing_ = e }, i.scrubbing = function () { return this.isScrubbing_ }, i.setCurrentTime = function (e) { try { this.isScrubbing_ && this.el_.fastSeek && mi ? this.el_.fastSeek(e) : this.el_.currentTime = e } catch (e) { jt(e, "Video is not ready. (Video.js)") } }, i.duration = function () { var e = this; if (this.el_.duration === 1 / 0 && ti && si && 0 === this.el_.currentTime) { return this.on("timeupdate", (function t() { e.el_.currentTime > 0 && (e.el_.duration === 1 / 0 && e.trigger("durationchange"), e.off("timeupdate", t)) })), NaN } return this.el_.duration || NaN }, i.width = function () { return this.el_.offsetWidth }, i.height = function () { return this.el_.offsetHeight }, i.proxyWebkitFullscreen_ = function () { var e = this; if ("webkitDisplayingFullscreen" in this.el_) { var t = function () { this.trigger("fullscreenchange", { isFullscreen: !1 }), this.el_.controls && !this.options_.nativeControlsForTouch && this.controls() && (this.el_.controls = !1) }, i = function () { "webkitPresentationMode" in this.el_ && "picture-in-picture" !== this.el_.webkitPresentationMode && (this.one("webkitendfullscreen", t), this.trigger("fullscreenchange", { isFullscreen: !0, nativeIOSFullscreen: !0 })) }; this.on("webkitbeginfullscreen", i), this.on("dispose", (function () { e.off("webkitbeginfullscreen", i), e.off("webkitendfullscreen", t) })) } }, i.supportsFullScreen = function () { if ("function" == typeof this.el_.webkitEnterFullScreen) { var e = r().navigator && r().navigator.userAgent || ""; if (/Android/.test(e) || !/Chrome|Mac OS X 10.5/.test(e)) return !0 } return !1 }, i.enterFullScreen = function () { var e = this.el_; if (e.paused && e.networkState <= e.HAVE_METADATA) Kn(this.el_.play()), this.setTimeout((function () { e.pause(); try { e.webkitEnterFullScreen() } catch (e) { this.trigger("fullscreenerror", e) } }), 0); else try { e.webkitEnterFullScreen() } catch (e) { this.trigger("fullscreenerror", e) } }, i.exitFullScreen = function () { this.el_.webkitDisplayingFullscreen ? this.el_.webkitExitFullScreen() : this.trigger("fullscreenerror", new Error("The video is not fullscreen")) }, i.requestPictureInPicture = function () { return this.el_.requestPictureInPicture() }, i.src = function (e) { if (void 0 === e) return this.el_.src; this.setSrc(e) }, i.reset = function () { t.resetMediaElement(this.el_) }, i.currentSrc = function () { return this.currentSource_ ? this.currentSource_.src : this.el_.currentSrc }, i.setControls = function (e) { this.el_.controls = !!e }, i.addTextTrack = function (t, i, n) { return this.featuresNativeTextTracks ? this.el_.addTextTrack(t, i, n) : e.prototype.addTextTrack.call(this, t, i, n) }, i.createRemoteTextTrack = function (t) { if (!this.featuresNativeTextTracks) return e.prototype.createRemoteTextTrack.call(this, t); var i = s().createElement("track"); return t.kind && (i.kind = t.kind), t.label && (i.label = t.label), (t.language || t.srclang) && (i.srclang = t.language || t.srclang), t.default && (i.default = t.default), t.id && (i.id = t.id), t.src && (i.src = t.src), i }, i.addRemoteTextTrack = function (t, i) { var n = e.prototype.addRemoteTextTrack.call(this, t, i); return this.featuresNativeTextTracks && this.el().appendChild(n), n }, i.removeRemoteTextTrack = function (t) { if (e.prototype.removeRemoteTextTrack.call(this, t), this.featuresNativeTextTracks) for (var i = this.$$("track"), n = i.length; n--;)t !== i[n] && t !== i[n].track || this.el().removeChild(i[n]) }, i.getVideoPlaybackQuality = function () { if ("function" == typeof this.el().getVideoPlaybackQuality) return this.el().getVideoPlaybackQuality(); var e = {}; return void 0 !== this.el().webkitDroppedFrameCount && void 0 !== this.el().webkitDecodedFrameCount && (e.droppedVideoFrames = this.el().webkitDroppedFrameCount, e.totalVideoFrames = this.el().webkitDecodedFrameCount), r().performance && "function" == typeof r().performance.now ? e.creationTime = r().performance.now() : r().performance && r().performance.timing && "number" == typeof r().performance.timing.navigationStart && (e.creationTime = r().Date.now() - r().performance.timing.navigationStart), e }, t }(Fr); Es(Cs, "TEST_VID", (function () { if (yi()) { var e = s().createElement("video"), t = s().createElement("track"); return t.kind = "captions", t.srclang = "en", t.label = "English", e.appendChild(t), e } })), Cs.isSupported = function () { try { Cs.TEST_VID.volume = .5 } catch (e) { return !1 } return !(!Cs.TEST_VID || !Cs.TEST_VID.canPlayType) }, Cs.canPlayType = function (e) { return Cs.TEST_VID.canPlayType(e) }, Cs.canPlaySource = function (e, t) { return Cs.canPlayType(e.type) }, Cs.canControlVolume = function () { try { var e = Cs.TEST_VID.volume; Cs.TEST_VID.volume = e / 2 + .1; var t = e !== Cs.TEST_VID.volume; return t && fi ? (r().setTimeout((function () { Cs && Cs.prototype && (Cs.prototype.featuresVolumeControl = e !== Cs.TEST_VID.volume) })), !1) : t } catch (e) { return !1 } }, Cs.canMuteVolume = function () { try { var e = Cs.TEST_VID.muted; return Cs.TEST_VID.muted = !e, Cs.TEST_VID.muted ? Li(Cs.TEST_VID, "muted", "muted") : Oi(Cs.TEST_VID, "muted"), e !== Cs.TEST_VID.muted } catch (e) { return !1 } }, Cs.canControlPlaybackRate = function () { if (ti && si && oi < 58) return !1; try { var e = Cs.TEST_VID.playbackRate; return Cs.TEST_VID.playbackRate = e / 2 + .1, e !== Cs.TEST_VID.playbackRate } catch (e) { return !1 } }, Cs.canOverrideAttributes = function () { try { var e = function () { }; Object.defineProperty(s().createElement("video"), "src", { get: e, set: e }), Object.defineProperty(s().createElement("audio"), "src", { get: e, set: e }), Object.defineProperty(s().createElement("video"), "innerHTML", { get: e, set: e }), Object.defineProperty(s().createElement("audio"), "innerHTML", { get: e, set: e }) } catch (e) { return !1 } return !0 }, Cs.supportsNativeTextTracks = function () { return mi || fi && si }, Cs.supportsNativeVideoTracks = function () { return !(!Cs.TEST_VID || !Cs.TEST_VID.videoTracks) }, Cs.supportsNativeAudioTracks = function () { return !(!Cs.TEST_VID || !Cs.TEST_VID.audioTracks) }, Cs.Events = ["loadstart", "suspend", "abort", "error", "emptied", "stalled", "loadedmetadata", "loadeddata", "canplay", "canplaythrough", "playing", "waiting", "seeking", "seeked", "ended", "durationchange", "timeupdate", "progress", "play", "pause", "ratechange", "resize", "volumechange"], [["featuresMuteControl", "canMuteVolume"], ["featuresPlaybackRate", "canControlPlaybackRate"], ["featuresSourceset", "canOverrideAttributes"], ["featuresNativeTextTracks", "supportsNativeTextTracks"], ["featuresNativeVideoTracks", "supportsNativeVideoTracks"], ["featuresNativeAudioTracks", "supportsNativeAudioTracks"]].forEach((function (e) { var t = e[0], i = e[1]; Es(Cs.prototype, t, (function () { return Cs[i]() }), !0) })), Cs.prototype.featuresVolumeControl = Cs.canControlVolume(), Cs.prototype.movingMediaElementInDOM = !fi, Cs.prototype.featuresFullscreenResize = !0, Cs.prototype.featuresProgressEvents = !0, Cs.prototype.featuresTimeupdateEvents = !0, Cs.patchCanPlayType = function () { ii >= 4 && !ri && !si && (vs = Cs.TEST_VID && Cs.TEST_VID.constructor.prototype.canPlayType, Cs.TEST_VID.constructor.prototype.canPlayType = function (e) { return e && /^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(e) ? "maybe" : vs.call(this, e) }) }, Cs.unpatchCanPlayType = function () { var e = Cs.TEST_VID.constructor.prototype.canPlayType; return vs && (Cs.TEST_VID.constructor.prototype.canPlayType = vs), e }, Cs.patchCanPlayType(), Cs.disposeMediaElement = function (e) { if (e) { for (e.parentNode && e.parentNode.removeChild(e); e.hasChildNodes();)e.removeChild(e.firstChild); e.removeAttribute("src"), "function" == typeof e.load && function () { try { e.load() } catch (e) { } }() } }, Cs.resetMediaElement = function (e) { if (e) { for (var t = e.querySelectorAll("source"), i = t.length; i--;)e.removeChild(t[i]); e.removeAttribute("src"), "function" == typeof e.load && function () { try { e.load() } catch (e) { } }() } }, ["muted", "defaultMuted", "autoplay", "controls", "loop", "playsinline"].forEach((function (e) { Cs.prototype[e] = function () { return this.el_[e] || this.el_.hasAttribute(e) } })), ["muted", "defaultMuted", "autoplay", "loop", "playsinline"].forEach((function (e) { Cs.prototype["set" + Rn(e)] = function (t) { this.el_[e] = t, t ? this.el_.setAttribute(e, e) : this.el_.removeAttribute(e) } })), ["paused", "currentTime", "buffered", "volume", "poster", "preload", "error", "seeking", "seekable", "ended", "playbackRate", "defaultPlaybackRate", "disablePictureInPicture", "played", "networkState", "readyState", "videoWidth", "videoHeight", "crossOrigin"].forEach((function (e) { Cs.prototype[e] = function () { return this.el_[e] } })), ["volume", "src", "poster", "preload", "playbackRate", "defaultPlaybackRate", "disablePictureInPicture", "crossOrigin"].forEach((function (e) { Cs.prototype["set" + Rn(e)] = function (t) { this.el_[e] = t } })), ["pause", "load", "play"].forEach((function (e) { Cs.prototype[e] = function () { return this.el_[e]() } })), Fr.withSourceHandlers(Cs), Cs.nativeSourceHandler = {}, Cs.nativeSourceHandler.canPlayType = function (e) { try { return Cs.TEST_VID.canPlayType(e) } catch (e) { return "" } }, Cs.nativeSourceHandler.canHandleSource = function (e, t) { if (e.type) return Cs.nativeSourceHandler.canPlayType(e.type); if (e.src) { var i = Ar(e.src); return Cs.nativeSourceHandler.canPlayType("video/" + i) } return "" }, Cs.nativeSourceHandler.handleSource = function (e, t, i) { t.setSrc(e.src) }, Cs.nativeSourceHandler.dispose = function () { }, Cs.registerSourceHandler(Cs.nativeSourceHandler), Fr.registerTech("Html5", Cs); var ws = ["progress", "abort", "suspend", "emptied", "stalled", "loadedmetadata", "loadeddata", "timeupdate", "resize", "volumechange", "texttrackchange"], ks = { canplay: "CanPlay", canplaythrough: "CanPlayThrough", playing: "Playing", seeked: "Seeked" }, Fs = ["tiny", "xsmall", "small", "medium", "large", "xlarge", "huge"], Is = {}; Fs.forEach((function (e) { var t = "x" === e.charAt(0) ? "x-" + e.substring(1) : e; Is[e] = "vjs-layout-" + t })); var Ds = { tiny: 210, xsmall: 320, small: 425, medium: 768, large: 1440, xlarge: 2560, huge: 1 / 0 }, Ps = function (e) { function t(i, n, r) { var a; if (i.id = i.id || n.id || "vjs_video_" + an(), (n = Gt(t.getTagSettings(i), n)).initChildren = !1, n.createEl = !1, n.evented = !1, n.reportTouchActivity = !1, !n.language) if ("function" == typeof i.closest) { var o = i.closest("[lang]"); o && o.getAttribute && (n.language = o.getAttribute("lang")) } else for (var u = i; u && 1 === u.nodeType;) { if (Di(u).hasOwnProperty("lang")) { n.language = u.getAttribute("lang"); break } u = u.parentNode } if ((a = e.call(this, null, n, r) || this).boundDocumentFullscreenChange_ = function (e) { return a.documentFullscreenChange_(e) }, a.boundFullWindowOnEscKey_ = function (e) { return a.fullWindowOnEscKey(e) }, a.boundUpdateStyleEl_ = function (e) { return a.updateStyleEl_(e) }, a.boundApplyInitTime_ = function (e) { return a.applyInitTime_(e) }, a.boundUpdateCurrentBreakpoint_ = function (e) { return a.updateCurrentBreakpoint_(e) }, a.boundHandleTechClick_ = function (e) { return a.handleTechClick_(e) }, a.boundHandleTechDoubleClick_ = function (e) { return a.handleTechDoubleClick_(e) }, a.boundHandleTechTouchStart_ = function (e) { return a.handleTechTouchStart_(e) }, a.boundHandleTechTouchMove_ = function (e) { return a.handleTechTouchMove_(e) }, a.boundHandleTechTouchEnd_ = function (e) { return a.handleTechTouchEnd_(e) }, a.boundHandleTechTap_ = function (e) { return a.handleTechTap_(e) }, a.isFullscreen_ = !1, a.log = Ht(a.id_), a.fsApi_ = Ot, a.isPosterFromTech_ = !1, a.queuedCallbacks_ = [], a.isReady_ = !1, a.hasStarted_ = !1, a.userActive_ = !1, a.debugEnabled_ = !1, !a.options_ || !a.options_.techOrder || !a.options_.techOrder.length) throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?"); if (a.tag = i, a.tagAttributes = i && Di(i), a.language(a.options_.language), n.languages) { var l = {}; Object.getOwnPropertyNames(n.languages).forEach((function (e) { l[e.toLowerCase()] = n.languages[e] })), a.languages_ = l } else a.languages_ = t.prototype.options_.languages; a.resetCache_(), a.poster_ = n.poster || "", a.controls_ = !!n.controls, i.controls = !1, i.removeAttribute("controls"), a.changingSrc_ = !1, a.playCallbacks_ = [], a.playTerminatedQueue_ = [], i.hasAttribute("autoplay") ? a.autoplay(!0) : a.autoplay(a.options_.autoplay), n.plugins && Object.keys(n.plugins).forEach((function (e) { if ("function" != typeof a[e]) throw new Error('plugin "' + e + '" does not exist') })), a.scrubbing_ = !1, a.el_ = a.createEl(), Pn(c(a), { eventBusKey: "el_" }), a.fsApi_.requestFullscreen && (hn(s(), a.fsApi_.fullscreenchange, a.boundDocumentFullscreenChange_), a.on(a.fsApi_.fullscreenchange, a.boundDocumentFullscreenChange_)), a.fluid_ && a.on(["playerreset", "resize"], a.boundUpdateStyleEl_); var d = Mn(a.options_); n.plugins && Object.keys(n.plugins).forEach((function (e) { a[e](n.plugins[e]) })), n.debug && a.debug(!0), a.options_.playerOptions = d, a.middleware_ = [], a.playbackRates(n.playbackRates), a.initChildren(), a.isAudio("audio" === i.nodeName.toLowerCase()), a.controls() ? a.addClass("vjs-controls-enabled") : a.addClass("vjs-controls-disabled"), a.el_.setAttribute("role", "region"), a.isAudio() ? a.el_.setAttribute("aria-label", a.localize("Audio Player")) : a.el_.setAttribute("aria-label", a.localize("Video Player")), a.isAudio() && a.addClass("vjs-audio"), a.flexNotSupported_() && a.addClass("vjs-no-flex"), di && a.addClass("vjs-touch-enabled"), fi || a.addClass("vjs-workinghover"), t.players[a.id_] = c(a); var h = It.split(".")[0]; return a.addClass("vjs-v" + h), a.userActive(!0), a.reportUserActivity(), a.one("play", (function (e) { return a.listenForUserActivity_(e) })), a.on("stageclick", (function (e) { return a.handleStageClick_(e) })), a.on("keydown", (function (e) { return a.handleKeyDown(e) })), a.on("languagechange", (function (e) { return a.handleLanguagechange(e) })), a.breakpoints(a.options_.breakpoints), a.responsive(a.options_.responsive), a } h(t, e); var i = t.prototype; return i.dispose = function () { var i = this; this.trigger("dispose"), this.off("dispose"), pn(s(), this.fsApi_.fullscreenchange, this.boundDocumentFullscreenChange_), pn(s(), "keydown", this.boundFullWindowOnEscKey_), this.styleEl_ && this.styleEl_.parentNode && (this.styleEl_.parentNode.removeChild(this.styleEl_), this.styleEl_ = null), t.players[this.id_] = null, this.tag && this.tag.player && (this.tag.player = null), this.el_ && this.el_.player && (this.el_.player = null), this.tech_ && (this.tech_.dispose(), this.isPosterFromTech_ = !1, this.poster_ = ""), this.playerElIngest_ && (this.playerElIngest_ = null), this.tag && (this.tag = null), Dr[this.id()] = null, kr.names.forEach((function (e) { var t = kr[e], n = i[t.getterName](); n && n.off && n.off() })), e.prototype.dispose.call(this) }, i.createEl = function () { var t, i = this.tag, n = this.playerElIngest_ = i.parentNode && i.parentNode.hasAttribute && i.parentNode.hasAttribute("data-vjs-player"), a = "video-js" === this.tag.tagName.toLowerCase(); n ? t = this.el_ = i.parentNode : a || (t = this.el_ = e.prototype.createEl.call(this, "div")); var o = Di(i); if (a) { for (t = this.el_ = i, i = this.tag = s().createElement("video"); t.children.length;)i.appendChild(t.firstChild); Ci(t, "video-js") || wi(t, "video-js"), t.appendChild(i), n = this.playerElIngest_ = t, Object.keys(t).forEach((function (e) { try { i[e] = t[e] } catch (e) { } })) } if (i.setAttribute("tabindex", "-1"), o.tabindex = "-1", (ui || si && ci) && (i.setAttribute("role", "application"), o.role = "application"), i.removeAttribute("width"), i.removeAttribute("height"), "width" in o && delete o.width, "height" in o && delete o.height, Object.getOwnPropertyNames(o).forEach((function (e) { a && "class" === e || t.setAttribute(e, o[e]), a && i.setAttribute(e, o[e]) })), i.playerId = i.id, i.id += "_html5_api", i.className = "vjs-tech", i.player = t.player = this, this.addClass("vjs-paused"), !0 !== r().VIDEOJS_NO_DYNAMIC_STYLE) { this.styleEl_ = tn("vjs-styles-dimensions"); var u = Qi(".vjs-styles-defaults"), l = Qi("head"); l.insertBefore(this.styleEl_, u ? u.nextSibling : l.firstChild) } this.fill_ = !1, this.fluid_ = !1, this.width(this.options_.width), this.height(this.options_.height), this.fill(this.options_.fill), this.fluid(this.options_.fluid), this.aspectRatio(this.options_.aspectRatio), this.crossOrigin(this.options_.crossOrigin || this.options_.crossorigin); for (var c = i.getElementsByTagName("a"), d = 0; d < c.length; d++) { var h = c.item(d); wi(h, "vjs-hidden"), h.setAttribute("hidden", "hidden") } return i.initNetworkState_ = i.networkState, i.parentNode && !n && i.parentNode.insertBefore(t, i), Ei(i, t), this.children_.unshift(i), this.el_.setAttribute("lang", this.language_), this.el_.setAttribute("translate", "no"), this.el_ = t, t }, i.crossOrigin = function (e) { if (!e) return this.techGet_("crossOrigin"); "anonymous" === e || "use-credentials" === e ? this.techCall_("setCrossOrigin", e) : jt.warn('crossOrigin must be "anonymous" or "use-credentials", given "' + e + '"') }, i.width = function (e) { return this.dimension("width", e) }, i.height = function (e) { return this.dimension("height", e) }, i.dimension = function (e, t) { var i = e + "_"; if (void 0 === t) return this[i] || 0; if ("" === t || "auto" === t) return this[i] = void 0, void this.updateStyleEl_(); var n = parseFloat(t); isNaN(n) ? jt.error('Improper value "' + t + '" supplied for for ' + e) : (this[i] = n, this.updateStyleEl_()) }, i.fluid = function (e) { var t, i, n = this; if (void 0 === e) return !!this.fluid_; this.fluid_ = !!e, Sn(this) && this.off(["playerreset", "resize"], this.boundUpdateStyleEl_), e ? (this.addClass("vjs-fluid"), this.fill(!1), i = function () { n.on(["playerreset", "resize"], n.boundUpdateStyleEl_) }, Sn(t = this) ? i() : (t.eventedCallbacks || (t.eventedCallbacks = []), t.eventedCallbacks.push(i))) : this.removeClass("vjs-fluid"), this.updateStyleEl_() }, i.fill = function (e) { if (void 0 === e) return !!this.fill_; this.fill_ = !!e, e ? (this.addClass("vjs-fill"), this.fluid(!1)) : this.removeClass("vjs-fill") }, i.aspectRatio = function (e) { if (void 0 === e) return this.aspectRatio_; if (!/^\d+\:\d+$/.test(e)) throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9."); this.aspectRatio_ = e, this.fluid(!0), this.updateStyleEl_() }, i.updateStyleEl_ = function () { if (!0 !== r().VIDEOJS_NO_DYNAMIC_STYLE) { var e, t, i, n = (void 0 !== this.aspectRatio_ && "auto" !== this.aspectRatio_ ? this.aspectRatio_ : this.videoWidth() > 0 ? this.videoWidth() + ":" + this.videoHeight() : "16:9").split(":"), a = n[1] / n[0]; e = void 0 !== this.width_ ? this.width_ : void 0 !== this.height_ ? this.height_ / a : this.videoWidth() || 300, t = void 0 !== this.height_ ? this.height_ : e * a, i = /^[^a-zA-Z]/.test(this.id()) ? "dimensions-" + this.id() : this.id() + "-dimensions", this.addClass(i), nn(this.styleEl_, "\n      ." + i + " {\n        width: " + e + "px;\n        height: " + t + "px;\n      }\n\n      ." + i + ".vjs-fluid {\n        padding-top: " + 100 * a + "%;\n      }\n    ") } else { var s = "number" == typeof this.width_ ? this.width_ : this.options_.width, o = "number" == typeof this.height_ ? this.height_ : this.options_.height, u = this.tech_ && this.tech_.el(); u && (s >= 0 && (u.width = s), o >= 0 && (u.height = o)) } }, i.loadTech_ = function (e, t) { var i = this; this.tech_ && this.unloadTech_(); var n = Rn(e), r = e.charAt(0).toLowerCase() + e.slice(1); "Html5" !== n && this.tag && (Fr.getTech("Html5").disposeMediaElement(this.tag), this.tag.player = null, this.tag = null), this.techName_ = n, this.isReady_ = !1; var a = this.autoplay(); ("string" == typeof this.autoplay() || !0 === this.autoplay() && this.options_.normalizeAutoplay) && (a = !1); var s = { source: t, autoplay: a, nativeControlsForTouch: this.options_.nativeControlsForTouch, playerId: this.id(), techId: this.id() + "_" + r + "_api", playsinline: this.options_.playsinline, preload: this.options_.preload, loop: this.options_.loop, disablePictureInPicture: this.options_.disablePictureInPicture, muted: this.options_.muted, poster: this.poster(), language: this.language(), playerElIngest: this.playerElIngest_ || !1, "vtt.js": this.options_["vtt.js"], canOverridePoster: !!this.options_.techCanOverridePoster, enableSourceset: this.options_.enableSourceset, Promise: this.options_.Promise }; kr.names.forEach((function (e) { var t = kr[e]; s[t.getterName] = i[t.privateName] })), Gt(s, this.options_[n]), Gt(s, this.options_[r]), Gt(s, this.options_[e.toLowerCase()]), this.tag && (s.tag = this.tag), t && t.src === this.cache_.src && this.cache_.currentTime > 0 && (s.startTime = this.cache_.currentTime); var o = Fr.getTech(e); if (!o) throw new Error("No Tech named '" + n + "' exists! '" + n + "' should be registered using videojs.registerTech()'"); this.tech_ = new o(s), this.tech_.ready(_n(this, this.handleTechReady_), !0), Jn(this.textTracksJson_ || [], this.tech_), ws.forEach((function (e) { i.on(i.tech_, e, (function (t) { return i["handleTech" + Rn(e) + "_"](t) })) })), Object.keys(ks).forEach((function (e) { i.on(i.tech_, e, (function (t) { 0 === i.tech_.playbackRate() && i.tech_.seeking() ? i.queuedCallbacks_.push({ callback: i["handleTech" + ks[e] + "_"].bind(i), event: t }) : i["handleTech" + ks[e] + "_"](t) })) })), this.on(this.tech_, "loadstart", (function (e) { return i.handleTechLoadStart_(e) })), this.on(this.tech_, "sourceset", (function (e) { return i.handleTechSourceset_(e) })), this.on(this.tech_, "waiting", (function (e) { return i.handleTechWaiting_(e) })), this.on(this.tech_, "ended", (function (e) { return i.handleTechEnded_(e) })), this.on(this.tech_, "seeking", (function (e) { return i.handleTechSeeking_(e) })), this.on(this.tech_, "play", (function (e) { return i.handleTechPlay_(e) })), this.on(this.tech_, "firstplay", (function (e) { return i.handleTechFirstPlay_(e) })), this.on(this.tech_, "pause", (function (e) { return i.handleTechPause_(e) })), this.on(this.tech_, "durationchange", (function (e) { return i.handleTechDurationChange_(e) })), this.on(this.tech_, "fullscreenchange", (function (e, t) { return i.handleTechFullscreenChange_(e, t) })), this.on(this.tech_, "fullscreenerror", (function (e, t) { return i.handleTechFullscreenError_(e, t) })), this.on(this.tech_, "enterpictureinpicture", (function (e) { return i.handleTechEnterPictureInPicture_(e) })), this.on(this.tech_, "leavepictureinpicture", (function (e) { return i.handleTechLeavePictureInPicture_(e) })), this.on(this.tech_, "error", (function (e) { return i.handleTechError_(e) })), this.on(this.tech_, "posterchange", (function (e) { return i.handleTechPosterChange_(e) })), this.on(this.tech_, "textdata", (function (e) { return i.handleTechTextData_(e) })), this.on(this.tech_, "ratechange", (function (e) { return i.handleTechRateChange_(e) })), this.on(this.tech_, "loadedmetadata", this.boundUpdateStyleEl_), this.usingNativeControls(this.techGet_("controls")), this.controls() && !this.usingNativeControls() && this.addTechControlsListeners_(), this.tech_.el().parentNode === this.el() || "Html5" === n && this.tag || Ei(this.tech_.el(), this.el()), this.tag && (this.tag.player = null, this.tag = null) }, i.unloadTech_ = function () { var e = this; kr.names.forEach((function (t) { var i = kr[t]; e[i.privateName] = e[i.getterName]() })), this.textTracksJson_ = Zn(this.tech_), this.isReady_ = !1, this.tech_.dispose(), this.tech_ = !1, this.isPosterFromTech_ && (this.poster_ = "", this.trigger("posterchange")), this.isPosterFromTech_ = !1 }, i.tech = function (e) { return void 0 === e && jt.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"), this.tech_ }, i.addTechControlsListeners_ = function () { this.removeTechControlsListeners_(), this.on(this.tech_, "click", this.boundHandleTechClick_), this.on(this.tech_, "dblclick", this.boundHandleTechDoubleClick_), this.on(this.tech_, "touchstart", this.boundHandleTechTouchStart_), this.on(this.tech_, "touchmove", this.boundHandleTechTouchMove_), this.on(this.tech_, "touchend", this.boundHandleTechTouchEnd_), this.on(this.tech_, "tap", this.boundHandleTechTap_) }, i.removeTechControlsListeners_ = function () { this.off(this.tech_, "tap", this.boundHandleTechTap_), this.off(this.tech_, "touchstart", this.boundHandleTechTouchStart_), this.off(this.tech_, "touchmove", this.boundHandleTechTouchMove_), this.off(this.tech_, "touchend", this.boundHandleTechTouchEnd_), this.off(this.tech_, "click", this.boundHandleTechClick_), this.off(this.tech_, "dblclick", this.boundHandleTechDoubleClick_) }, i.handleTechReady_ = function () { this.triggerReady(), this.cache_.volume && this.techCall_("setVolume", this.cache_.volume), this.handleTechPosterChange_(), this.handleTechDurationChange_() }, i.handleTechLoadStart_ = function () { this.removeClass("vjs-ended"), this.removeClass("vjs-seeking"), this.error(null), this.handleTechDurationChange_(), this.paused() ? (this.hasStarted(!1), this.trigger("loadstart")) : (this.trigger("loadstart"), this.trigger("firstplay")), this.manualAutoplay_(!0 === this.autoplay() && this.options_.normalizeAutoplay ? "play" : this.autoplay()) }, i.manualAutoplay_ = function (e) { var t = this; if (this.tech_ && "string" == typeof e) { var i, n = function () { var e = t.muted(); t.muted(!0); var i = function () { t.muted(e) }; t.playTerminatedQueue_.push(i); var n = t.play(); if ($n(n)) return n.catch((function (e) { throw i(), new Error("Rejection at manualAutoplay. Restoring muted value. " + (e || "")) })) }; if ("any" !== e || this.muted() ? i = "muted" !== e || this.muted() ? this.play() : n() : $n(i = this.play()) && (i = i.catch(n)), $n(i)) return i.then((function () { t.trigger({ type: "autoplay-success", autoplay: e }) })).catch((function () { t.trigger({ type: "autoplay-failure", autoplay: e }) })) } }, i.updateSourceCaches_ = function (e) { void 0 === e && (e = ""); var t = e, i = ""; "string" != typeof t && (t = e.src, i = e.type), this.cache_.source = this.cache_.source || {}, this.cache_.sources = this.cache_.sources || [], t && !i && (i = function (e, t) { if (!t) return ""; if (e.cache_.source.src === t && e.cache_.source.type) return e.cache_.source.type; var i = e.cache_.sources.filter((function (e) { return e.src === t })); if (i.length) return i[0].type; for (var n = e.$$("source"), r = 0; r < n.length; r++) { var a = n[r]; if (a.type && a.src && a.src === t) return a.type } return Hr(t) }(this, t)), this.cache_.source = Mn({}, e, { src: t, type: i }); for (var n = this.cache_.sources.filter((function (e) { return e.src && e.src === t })), r = [], a = this.$$("source"), s = [], o = 0; o < a.length; o++) { var u = Di(a[o]); r.push(u), u.src && u.src === t && s.push(u.src) } s.length && !n.length ? this.cache_.sources = r : n.length || (this.cache_.sources = [this.cache_.source]), this.cache_.src = t }, i.handleTechSourceset_ = function (e) { var t = this; if (!this.changingSrc_) { var i = function (e) { return t.updateSourceCaches_(e) }, n = this.currentSource().src, r = e.src; n && !/^blob:/.test(n) && /^blob:/.test(r) && (!this.lastSource_ || this.lastSource_.tech !== r && this.lastSource_.player !== n) && (i = function () { }), i(r), e.src || this.tech_.any(["sourceset", "loadstart"], (function (e) { if ("sourceset" !== e.type) { var i = t.techGet("currentSrc"); t.lastSource_.tech = i, t.updateSourceCaches_(i) } })) } this.lastSource_ = { player: this.currentSource().src, tech: e.src }, this.trigger({ src: e.src, type: "sourceset" }) }, i.hasStarted = function (e) { if (void 0 === e) return this.hasStarted_; e !== this.hasStarted_ && (this.hasStarted_ = e, this.hasStarted_ ? (this.addClass("vjs-has-started"), this.trigger("firstplay")) : this.removeClass("vjs-has-started")) }, i.handleTechPlay_ = function () { this.removeClass("vjs-ended"), this.removeClass("vjs-paused"), this.addClass("vjs-playing"), this.hasStarted(!0), this.trigger("play") }, i.handleTechRateChange_ = function () { this.tech_.playbackRate() > 0 && 0 === this.cache_.lastPlaybackRate && (this.queuedCallbacks_.forEach((function (e) { return e.callback(e.event) })), this.queuedCallbacks_ = []), this.cache_.lastPlaybackRate = this.tech_.playbackRate(), this.trigger("ratechange") }, i.handleTechWaiting_ = function () { var e = this; this.addClass("vjs-waiting"), this.trigger("waiting"); var t = this.currentTime(); this.on("timeupdate", (function i() { t !== e.currentTime() && (e.removeClass("vjs-waiting"), e.off("timeupdate", i)) })) }, i.handleTechCanPlay_ = function () { this.removeClass("vjs-waiting"), this.trigger("canplay") }, i.handleTechCanPlayThrough_ = function () { this.removeClass("vjs-waiting"), this.trigger("canplaythrough") }, i.handleTechPlaying_ = function () { this.removeClass("vjs-waiting"), this.trigger("playing") }, i.handleTechSeeking_ = function () { this.addClass("vjs-seeking"), this.trigger("seeking") }, i.handleTechSeeked_ = function () { this.removeClass("vjs-seeking"), this.removeClass("vjs-ended"), this.trigger("seeked") }, i.handleTechFirstPlay_ = function () { this.options_.starttime && (jt.warn("Passing the `starttime` option to the player will be deprecated in 6.0"), this.currentTime(this.options_.starttime)), this.addClass("vjs-has-started"), this.trigger("firstplay") }, i.handleTechPause_ = function () { this.removeClass("vjs-playing"), this.addClass("vjs-paused"), this.trigger("pause") }, i.handleTechEnded_ = function () { this.addClass("vjs-ended"), this.removeClass("vjs-waiting"), this.options_.loop ? (this.currentTime(0), this.play()) : this.paused() || this.pause(), this.trigger("ended") }, i.handleTechDurationChange_ = function () { this.duration(this.techGet_("duration")) }, i.handleTechClick_ = function (e) { this.controls_ && (void 0 !== this.options_ && void 0 !== this.options_.userActions && void 0 !== this.options_.userActions.click && !1 === this.options_.userActions.click || (void 0 !== this.options_ && void 0 !== this.options_.userActions && "function" == typeof this.options_.userActions.click ? this.options_.userActions.click.call(this, e) : this.paused() ? Kn(this.play()) : this.pause())) }, i.handleTechDoubleClick_ = function (e) { this.controls_ && (Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"), (function (t) { return t.contains(e.target) })) || void 0 !== this.options_ && void 0 !== this.options_.userActions && void 0 !== this.options_.userActions.doubleClick && !1 === this.options_.userActions.doubleClick || (void 0 !== this.options_ && void 0 !== this.options_.userActions && "function" == typeof this.options_.userActions.doubleClick ? this.options_.userActions.doubleClick.call(this, e) : this.isFullscreen() ? this.exitFullscreen() : this.requestFullscreen())) }, i.handleTechTap_ = function () { this.userActive(!this.userActive()) }, i.handleTechTouchStart_ = function () { this.userWasActive = this.userActive() }, i.handleTechTouchMove_ = function () { this.userWasActive && this.reportUserActivity() }, i.handleTechTouchEnd_ = function (e) { e.cancelable && e.preventDefault() }, i.handleStageClick_ = function () { this.reportUserActivity() }, i.toggleFullscreenClass_ = function () { this.isFullscreen() ? this.addClass("vjs-fullscreen") : this.removeClass("vjs-fullscreen") }, i.documentFullscreenChange_ = function (e) { var t = e.target.player; if (!t || t === this) { var i = this.el(), n = s()[this.fsApi_.fullscreenElement] === i; !n && i.matches ? n = i.matches(":" + this.fsApi_.fullscreen) : !n && i.msMatchesSelector && (n = i.msMatchesSelector(":" + this.fsApi_.fullscreen)), this.isFullscreen(n) } }, i.handleTechFullscreenChange_ = function (e, t) { var i = this; t && (t.nativeIOSFullscreen && (this.addClass("vjs-ios-native-fs"), this.tech_.one("webkitendfullscreen", (function () { i.removeClass("vjs-ios-native-fs") }))), this.isFullscreen(t.isFullscreen)) }, i.handleTechFullscreenError_ = function (e, t) { this.trigger("fullscreenerror", t) }, i.togglePictureInPictureClass_ = function () { this.isInPictureInPicture() ? this.addClass("vjs-picture-in-picture") : this.removeClass("vjs-picture-in-picture") }, i.handleTechEnterPictureInPicture_ = function (e) { this.isInPictureInPicture(!0) }, i.handleTechLeavePictureInPicture_ = function (e) { this.isInPictureInPicture(!1) }, i.handleTechError_ = function () { var e = this.tech_.error(); this.error(e) }, i.handleTechTextData_ = function () { var e = null; arguments.length > 1 && (e = arguments[1]), this.trigger("textdata", e) }, i.getCache = function () { return this.cache_ }, i.resetCache_ = function () { this.cache_ = { currentTime: 0, initTime: 0, inactivityTimeout: this.options_.inactivityTimeout, duration: NaN, lastVolume: 1, lastPlaybackRate: this.defaultPlaybackRate(), media: null, src: "", source: {}, sources: [], playbackRates: [], volume: 1 } }, i.techCall_ = function (e, t) { this.ready((function () { if (e in Rr) return function (e, t, i, n) { return t[i](e.reduce(Nr(i), n)) }(this.middleware_, this.tech_, e, t); if (e in Mr) return Or(this.middleware_, this.tech_, e, t); try { this.tech_ && this.tech_[e](t) } catch (e) { throw jt(e), e } }), !0) }, i.techGet_ = function (e) { if (this.tech_ && this.tech_.isReady_) { if (e in Br) return function (e, t, i) { return e.reduceRight(Nr(i), t[i]()) }(this.middleware_, this.tech_, e); if (e in Mr) return Or(this.middleware_, this.tech_, e); try { return this.tech_[e]() } catch (t) { if (void 0 === this.tech_[e]) throw jt("Video.js: " + e + " method not defined for " + this.techName_ + " playback technology.", t), t; if ("TypeError" === t.name) throw jt("Video.js: " + e + " unavailable on " + this.techName_ + " playback technology element.", t), this.tech_.isReady_ = !1, t; throw jt(t), t } } }, i.play = function () { var e = this, t = this.options_.Promise || r().Promise; return t ? new t((function (t) { e.play_(t) })) : this.play_() }, i.play_ = function (e) { var t = this; void 0 === e && (e = Kn), this.playCallbacks_.push(e); var i = Boolean(!this.changingSrc_ && (this.src() || this.currentSrc())); if (this.waitToPlay_ && (this.off(["ready", "loadstart"], this.waitToPlay_), this.waitToPlay_ = null), !this.isReady_ || !i) return this.waitToPlay_ = function (e) { t.play_() }, this.one(["ready", "loadstart"], this.waitToPlay_), void (i || !mi && !fi || this.load()); var n = this.techGet_("play"); null === n ? this.runPlayTerminatedQueue_() : this.runPlayCallbacks_(n) }, i.runPlayTerminatedQueue_ = function () { var e = this.playTerminatedQueue_.slice(0); this.playTerminatedQueue_ = [], e.forEach((function (e) { e() })) }, i.runPlayCallbacks_ = function (e) { var t = this.playCallbacks_.slice(0); this.playCallbacks_ = [], this.playTerminatedQueue_ = [], t.forEach((function (t) { t(e) })) }, i.pause = function () { this.techCall_("pause") }, i.paused = function () { return !1 !== this.techGet_("paused") }, i.played = function () { return this.techGet_("played") || Gn(0, 0) }, i.scrubbing = function (e) { if (void 0 === e) return this.scrubbing_; this.scrubbing_ = !!e, this.techCall_("setScrubbing", this.scrubbing_), e ? this.addClass("vjs-scrubbing") : this.removeClass("vjs-scrubbing") }, i.currentTime = function (e) { return void 0 !== e ? (e < 0 && (e = 0), this.isReady_ && !this.changingSrc_ && this.tech_ && this.tech_.isReady_ ? (this.techCall_("setCurrentTime", e), void (this.cache_.initTime = 0)) : (this.cache_.initTime = e, this.off("canplay", this.boundApplyInitTime_), void this.one("canplay", this.boundApplyInitTime_))) : (this.cache_.currentTime = this.techGet_("currentTime") || 0, this.cache_.currentTime) }, i.applyInitTime_ = function () { this.currentTime(this.cache_.initTime) }, i.duration = function (e) { if (void 0 === e) return void 0 !== this.cache_.duration ? this.cache_.duration : NaN; (e = parseFloat(e)) < 0 && (e = 1 / 0), e !== this.cache_.duration && (this.cache_.duration = e, e === 1 / 0 ? this.addClass("vjs-live") : this.removeClass("vjs-live"), isNaN(e) || this.trigger("durationchange")) }, i.remainingTime = function () { return this.duration() - this.currentTime() }, i.remainingTimeDisplay = function () { return Math.floor(this.duration()) - Math.floor(this.currentTime()) }, i.buffered = function () { var e = this.techGet_("buffered"); return e && e.length || (e = Gn(0, 0)), e }, i.bufferedPercent = function () { return zn(this.buffered(), this.duration()) }, i.bufferedEnd = function () { var e = this.buffered(), t = this.duration(), i = e.end(e.length - 1); return i > t && (i = t), i }, i.volume = function (e) { var t; return void 0 !== e ? (t = Math.max(0, Math.min(1, parseFloat(e))), this.cache_.volume = t, this.techCall_("setVolume", t), void (t > 0 && this.lastVolume_(t))) : (t = parseFloat(this.techGet_("volume")), isNaN(t) ? 1 : t) }, i.muted = function (e) { if (void 0 === e) return this.techGet_("muted") || !1; this.techCall_("setMuted", e) }, i.defaultMuted = function (e) { return void 0 !== e ? this.techCall_("setDefaultMuted", e) : this.techGet_("defaultMuted") || !1 }, i.lastVolume_ = function (e) { if (void 0 === e || 0 === e) return this.cache_.lastVolume; this.cache_.lastVolume = e }, i.supportsFullScreen = function () { return this.techGet_("supportsFullScreen") || !1 }, i.isFullscreen = function (e) { if (void 0 !== e) { var t = this.isFullscreen_; return this.isFullscreen_ = Boolean(e), this.isFullscreen_ !== t && this.fsApi_.prefixed && this.trigger("fullscreenchange"), void this.toggleFullscreenClass_() } return this.isFullscreen_ }, i.requestFullscreen = function (e) { var t = this.options_.Promise || r().Promise; if (t) { var i = this; return new t((function (t, n) { function r() { i.off("fullscreenerror", s), i.off("fullscreenchange", a) } function a() { r(), t() } function s(e, t) { r(), n(t) } i.one("fullscreenchange", a), i.one("fullscreenerror", s); var o = i.requestFullscreenHelper_(e); o && (o.then(r, r), o.then(t, n)) })) } return this.requestFullscreenHelper_() }, i.requestFullscreenHelper_ = function (e) { var t, i = this; if (this.fsApi_.prefixed || (t = this.options_.fullscreen && this.options_.fullscreen.options || {}, void 0 !== e && (t = e)), this.fsApi_.requestFullscreen) { var n = this.el_[this.fsApi_.requestFullscreen](t); return n && n.then((function () { return i.isFullscreen(!0) }), (function () { return i.isFullscreen(!1) })), n } this.tech_.supportsFullScreen() && !0 == !this.options_.preferFullWindow ? this.techCall_("enterFullScreen") : this.enterFullWindow() }, i.exitFullscreen = function () { var e = this.options_.Promise || r().Promise; if (e) { var t = this; return new e((function (e, i) { function n() { t.off("fullscreenerror", a), t.off("fullscreenchange", r) } function r() { n(), e() } function a(e, t) { n(), i(t) } t.one("fullscreenchange", r), t.one("fullscreenerror", a); var s = t.exitFullscreenHelper_(); s && (s.then(n, n), s.then(e, i)) })) } return this.exitFullscreenHelper_() }, i.exitFullscreenHelper_ = function () { var e = this; if (this.fsApi_.requestFullscreen) { var t = s()[this.fsApi_.exitFullscreen](); return t && Kn(t.then((function () { return e.isFullscreen(!1) }))), t } this.tech_.supportsFullScreen() && !0 == !this.options_.preferFullWindow ? this.techCall_("exitFullScreen") : this.exitFullWindow() }, i.enterFullWindow = function () { this.isFullscreen(!0), this.isFullWindow = !0, this.docOrigOverflow = s().documentElement.style.overflow, hn(s(), "keydown", this.boundFullWindowOnEscKey_), s().documentElement.style.overflow = "hidden", wi(s().body, "vjs-full-window"), this.trigger("enterFullWindow") }, i.fullWindowOnEscKey = function (e) { l().isEventKey(e, "Esc") && !0 === this.isFullscreen() && (this.isFullWindow ? this.exitFullWindow() : this.exitFullscreen()) }, i.exitFullWindow = function () { this.isFullscreen(!1), this.isFullWindow = !1, pn(s(), "keydown", this.boundFullWindowOnEscKey_), s().documentElement.style.overflow = this.docOrigOverflow, ki(s().body, "vjs-full-window"), this.trigger("exitFullWindow") }, i.disablePictureInPicture = function (e) { if (void 0 === e) return this.techGet_("disablePictureInPicture"); this.techCall_("setDisablePictureInPicture", e), this.options_.disablePictureInPicture = e, this.trigger("disablepictureinpicturechanged") }, i.isInPictureInPicture = function (e) { return void 0 !== e ? (this.isInPictureInPicture_ = !!e, void this.togglePictureInPictureClass_()) : !!this.isInPictureInPicture_ }, i.requestPictureInPicture = function () { if ("pictureInPictureEnabled" in s() && !1 === this.disablePictureInPicture()) return this.techGet_("requestPictureInPicture") }, i.exitPictureInPicture = function () { if ("pictureInPictureEnabled" in s()) return s().exitPictureInPicture() }, i.handleKeyDown = function (e) { var t = this.options_.userActions; if (t && t.hotkeys) { (function (e) { var t = e.tagName.toLowerCase(); if (e.isContentEditable) return !0; if ("input" === t) return -1 === ["button", "checkbox", "hidden", "radio", "reset", "submit"].indexOf(e.type); return -1 !== ["textarea"].indexOf(t) })(this.el_.ownerDocument.activeElement) || ("function" == typeof t.hotkeys ? t.hotkeys.call(this, e) : this.handleHotkeys(e)) } }, i.handleHotkeys = function (e) { var t = this.options_.userActions ? this.options_.userActions.hotkeys : {}, i = t.fullscreenKey, n = void 0 === i ? function (e) { return l().isEventKey(e, "f") } : i, r = t.muteKey, a = void 0 === r ? function (e) { return l().isEventKey(e, "m") } : r, o = t.playPauseKey, u = void 0 === o ? function (e) { return l().isEventKey(e, "k") || l().isEventKey(e, "Space") } : o; if (n.call(this, e)) { e.preventDefault(), e.stopPropagation(); var c = Vn.getComponent("FullscreenToggle"); !1 !== s()[this.fsApi_.fullscreenEnabled] && c.prototype.handleClick.call(this, e) } else if (a.call(this, e)) { e.preventDefault(), e.stopPropagation(), Vn.getComponent("MuteToggle").prototype.handleClick.call(this, e) } else if (u.call(this, e)) { e.preventDefault(), e.stopPropagation(), Vn.getComponent("PlayToggle").prototype.handleClick.call(this, e) } }, i.canPlayType = function (e) { for (var t, i = 0, n = this.options_.techOrder; i < n.length; i++) { var r = n[i], a = Fr.getTech(r); if (a || (a = Vn.getComponent(r)), a) { if (a.isSupported() && (t = a.canPlayType(e))) return t } else jt.error('The "' + r + '" tech is undefined. Skipped browser support check for that tech.') } return "" }, i.selectSource = function (e) { var t, i, n = this, r = this.options_.techOrder.map((function (e) { return [e, Fr.getTech(e)] })).filter((function (e) { var t = e[0], i = e[1]; return i ? i.isSupported() : (jt.error('The "' + t + '" tech is undefined. Skipped browser support check for that tech.'), !1) })), a = function (e, t, i) { var n; return e.some((function (e) { return t.some((function (t) { if (n = i(e, t)) return !0 })) })), n }, s = function (e, t) { var i = e[0]; if (e[1].canPlaySource(t, n.options_[i.toLowerCase()])) return { source: t, tech: i } }; return t = this.options_.sourceOrder ? a(e, r, (i = s, function (e, t) { return i(t, e) })) : a(r, e, s), t || !1 }, i.handleSrc_ = function (e, t) { var i = this; if (void 0 === e) return this.cache_.src || ""; this.resetRetryOnError_ && this.resetRetryOnError_(); var n = Vr(e); if (n.length) { if (this.changingSrc_ = !0, t || (this.cache_.sources = n), this.updateSourceCaches_(n[0]), Lr(this, n[0], (function (e, r) { var a, s; if (i.middleware_ = r, t || (i.cache_.sources = n), i.updateSourceCaches_(e), i.src_(e)) return n.length > 1 ? i.handleSrc_(n.slice(1)) : (i.changingSrc_ = !1, i.setTimeout((function () { this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) }) }), 0), void i.triggerReady()); a = r, s = i.tech_, a.forEach((function (e) { return e.setTech && e.setTech(s) })) })), this.options_.retryOnError && n.length > 1) { var r = function () { i.error(null), i.handleSrc_(n.slice(1), !0) }, a = function () { i.off("error", r) }; this.one("error", r), this.one("playing", a), this.resetRetryOnError_ = function () { i.off("error", r), i.off("playing", a) } } } else this.setTimeout((function () { this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) }) }), 0) }, i.src = function (e) { return this.handleSrc_(e, !1) }, i.src_ = function (e) { var t, i, n = this, r = this.selectSource([e]); return !r || (t = r.tech, i = this.techName_, Rn(t) !== Rn(i) ? (this.changingSrc_ = !0, this.loadTech_(r.tech, r.source), this.tech_.ready((function () { n.changingSrc_ = !1 })), !1) : (this.ready((function () { this.tech_.constructor.prototype.hasOwnProperty("setSource") ? this.techCall_("setSource", e) : this.techCall_("src", e.src), this.changingSrc_ = !1 }), !0), !1)) }, i.load = function () { this.techCall_("load") }, i.reset = function () { var e = this, t = this.options_.Promise || r().Promise; this.paused() || !t ? this.doReset_() : Kn(this.play().then((function () { return e.doReset_() }))) }, i.doReset_ = function () { this.tech_ && this.tech_.clearTracks("text"), this.resetCache_(), this.poster(""), this.loadTech_(this.options_.techOrder[0], null), this.techCall_("reset"), this.resetControlBarUI_(), Sn(this) && this.trigger("playerreset") }, i.resetControlBarUI_ = function () { this.resetProgressBar_(), this.resetPlaybackRate_(), this.resetVolumeBar_() }, i.resetProgressBar_ = function () { this.currentTime(0); var e = this.controlBar, t = e.durationDisplay, i = e.remainingTimeDisplay; t && t.updateContent(), i && i.updateContent() }, i.resetPlaybackRate_ = function () { this.playbackRate(this.defaultPlaybackRate()), this.handleTechRateChange_() }, i.resetVolumeBar_ = function () { this.volume(1), this.trigger("volumechange") }, i.currentSources = function () { var e = this.currentSource(), t = []; return 0 !== Object.keys(e).length && t.push(e), this.cache_.sources || t }, i.currentSource = function () { return this.cache_.source || {} }, i.currentSrc = function () { return this.currentSource() && this.currentSource().src || "" }, i.currentType = function () { return this.currentSource() && this.currentSource().type || "" }, i.preload = function (e) { return void 0 !== e ? (this.techCall_("setPreload", e), void (this.options_.preload = e)) : this.techGet_("preload") }, i.autoplay = function (e) { if (void 0 === e) return this.options_.autoplay || !1; var t; "string" == typeof e && /(any|play|muted)/.test(e) || !0 === e && this.options_.normalizeAutoplay ? (this.options_.autoplay = e, this.manualAutoplay_("string" == typeof e ? e : "play"), t = !1) : this.options_.autoplay = !!e, t = void 0 === t ? this.options_.autoplay : t, this.tech_ && this.techCall_("setAutoplay", t) }, i.playsinline = function (e) { return void 0 !== e ? (this.techCall_("setPlaysinline", e), this.options_.playsinline = e, this) : this.techGet_("playsinline") }, i.loop = function (e) { return void 0 !== e ? (this.techCall_("setLoop", e), void (this.options_.loop = e)) : this.techGet_("loop") }, i.poster = function (e) { if (void 0 === e) return this.poster_; e || (e = ""), e !== this.poster_ && (this.poster_ = e, this.techCall_("setPoster", e), this.isPosterFromTech_ = !1, this.trigger("posterchange")) }, i.handleTechPosterChange_ = function () { if ((!this.poster_ || this.options_.techCanOverridePoster) && this.tech_ && this.tech_.poster) { var e = this.tech_.poster() || ""; e !== this.poster_ && (this.poster_ = e, this.isPosterFromTech_ = !0, this.trigger("posterchange")) } }, i.controls = function (e) { if (void 0 === e) return !!this.controls_; e = !!e, this.controls_ !== e && (this.controls_ = e, this.usingNativeControls() && this.techCall_("setControls", e), this.controls_ ? (this.removeClass("vjs-controls-disabled"), this.addClass("vjs-controls-enabled"), this.trigger("controlsenabled"), this.usingNativeControls() || this.addTechControlsListeners_()) : (this.removeClass("vjs-controls-enabled"), this.addClass("vjs-controls-disabled"), this.trigger("controlsdisabled"), this.usingNativeControls() || this.removeTechControlsListeners_())) }, i.usingNativeControls = function (e) { if (void 0 === e) return !!this.usingNativeControls_; e = !!e, this.usingNativeControls_ !== e && (this.usingNativeControls_ = e, this.usingNativeControls_ ? (this.addClass("vjs-using-native-controls"), this.trigger("usingnativecontrols")) : (this.removeClass("vjs-using-native-controls"), this.trigger("usingcustomcontrols"))) }, i.error = function (e) { var t = this; if (void 0 === e) return this.error_ || null; if (Pt("beforeerror").forEach((function (i) { var n = i(t, e); zt(n) && !Array.isArray(n) || "string" == typeof n || "number" == typeof n || null === n ? e = n : t.log.error("please return a value that MediaError expects in beforeerror hooks") })), this.options_.suppressNotSupportedError && e && 4 === e.code) { var i = function () { this.error(e) }; return this.options_.suppressNotSupportedError = !1, this.any(["click", "touchstart"], i), void this.one("loadstart", (function () { this.off(["click", "touchstart"], i) })) } if (null === e) return this.error_ = e, this.removeClass("vjs-error"), void (this.errorDisplay && this.errorDisplay.close()); this.error_ = new Qn(e), this.addClass("vjs-error"), jt.error("(CODE:" + this.error_.code + " " + Qn.errorTypes[this.error_.code] + ")", this.error_.message, this.error_), this.trigger("error"), Pt("error").forEach((function (e) { return e(t, t.error_) })) }, i.reportUserActivity = function (e) { this.userActivity_ = !0 }, i.userActive = function (e) { if (void 0 === e) return this.userActive_; if ((e = !!e) !== this.userActive_) { if (this.userActive_ = e, this.userActive_) return this.userActivity_ = !0, this.removeClass("vjs-user-inactive"), this.addClass("vjs-user-active"), void this.trigger("useractive"); this.tech_ && this.tech_.one("mousemove", (function (e) { e.stopPropagation(), e.preventDefault() })), this.userActivity_ = !1, this.removeClass("vjs-user-active"), this.addClass("vjs-user-inactive"), this.trigger("userinactive") } }, i.listenForUserActivity_ = function () { var e, t, i, n = _n(this, this.reportUserActivity), r = function (t) { n(), this.clearInterval(e) }; this.on("mousedown", (function () { n(), this.clearInterval(e), e = this.setInterval(n, 250) })), this.on("mousemove", (function (e) { e.screenX === t && e.screenY === i || (t = e.screenX, i = e.screenY, n()) })), this.on("mouseup", r), this.on("mouseleave", r); var a, s = this.getChild("controlBar"); !s || fi || ti || (s.on("mouseenter", (function (e) { 0 !== this.player().options_.inactivityTimeout && (this.player().cache_.inactivityTimeout = this.player().options_.inactivityTimeout), this.player().options_.inactivityTimeout = 0 })), s.on("mouseleave", (function (e) { this.player().options_.inactivityTimeout = this.player().cache_.inactivityTimeout }))), this.on("keydown", n), this.on("keyup", n), this.setInterval((function () { if (this.userActivity_) { this.userActivity_ = !1, this.userActive(!0), this.clearTimeout(a); var e = this.options_.inactivityTimeout; e <= 0 || (a = this.setTimeout((function () { this.userActivity_ || this.userActive(!1) }), e)) } }), 250) }, i.playbackRate = function (e) { if (void 0 === e) return this.tech_ && this.tech_.featuresPlaybackRate ? this.cache_.lastPlaybackRate || this.techGet_("playbackRate") : 1; this.techCall_("setPlaybackRate", e) }, i.defaultPlaybackRate = function (e) { return void 0 !== e ? this.techCall_("setDefaultPlaybackRate", e) : this.tech_ && this.tech_.featuresPlaybackRate ? this.techGet_("defaultPlaybackRate") : 1 }, i.isAudio = function (e) { if (void 0 === e) return !!this.isAudio_; this.isAudio_ = !!e }, i.addTextTrack = function (e, t, i) { if (this.tech_) return this.tech_.addTextTrack(e, t, i) }, i.addRemoteTextTrack = function (e, t) { if (this.tech_) return this.tech_.addRemoteTextTrack(e, t) }, i.removeRemoteTextTrack = function (e) { void 0 === e && (e = {}); var t = e.track; if (t || (t = e), this.tech_) return this.tech_.removeRemoteTextTrack(t) }, i.getVideoPlaybackQuality = function () { return this.techGet_("getVideoPlaybackQuality") }, i.videoWidth = function () { return this.tech_ && this.tech_.videoWidth && this.tech_.videoWidth() || 0 }, i.videoHeight = function () { return this.tech_ && this.tech_.videoHeight && this.tech_.videoHeight() || 0 }, i.language = function (e) { if (void 0 === e) return this.language_; this.language_ !== String(e).toLowerCase() && (this.language_ = String(e).toLowerCase(), Sn(this) && this.trigger("languagechange")) }, i.languages = function () { return Mn(t.prototype.options_.languages, this.languages_) }, i.toJSON = function () { var e = Mn(this.options_), t = e.tracks; e.tracks = []; for (var i = 0; i < t.length; i++) { var n = t[i]; (n = Mn(n)).player = void 0, e.tracks[i] = n } return e }, i.createModal = function (e, t) { var i = this; (t = t || {}).content = e || ""; var n = new er(this, t); return this.addChild(n), n.on("dispose", (function () { i.removeChild(n) })), n.open(), n }, i.updateCurrentBreakpoint_ = function () { if (this.responsive()) for (var e = this.currentBreakpoint(), t = this.currentWidth(), i = 0; i < Fs.length; i++) { var n = Fs[i]; if (t <= this.breakpoints_[n]) { if (e === n) return; e && this.removeClass(Is[e]), this.addClass(Is[n]), this.breakpoint_ = n; break } } }, i.removeCurrentBreakpoint_ = function () { var e = this.currentBreakpointClass(); this.breakpoint_ = "", e && this.removeClass(e) }, i.breakpoints = function (e) { return void 0 === e || (this.breakpoint_ = "", this.breakpoints_ = Gt({}, Ds, e), this.updateCurrentBreakpoint_()), Gt(this.breakpoints_) }, i.responsive = function (e) { return void 0 === e ? this.responsive_ : (e = Boolean(e)) !== this.responsive_ ? (this.responsive_ = e, e ? (this.on("playerresize", this.boundUpdateCurrentBreakpoint_), this.updateCurrentBreakpoint_()) : (this.off("playerresize", this.boundUpdateCurrentBreakpoint_), this.removeCurrentBreakpoint_()), e) : void 0 }, i.currentBreakpoint = function () { return this.breakpoint_ }, i.currentBreakpointClass = function () { return Is[this.breakpoint_] || "" }, i.loadMedia = function (e, t) { var i = this; if (e && "object" == typeof e) { this.reset(), this.cache_.media = Mn(e); var n = this.cache_.media, r = n.artwork, a = n.poster, s = n.src, o = n.textTracks; !r && a && (this.cache_.media.artwork = [{ src: a, type: Hr(a) }]), s && this.src(s), a && this.poster(a), Array.isArray(o) && o.forEach((function (e) { return i.addRemoteTextTrack(e, !1) })), this.ready(t) } }, i.getMedia = function () { if (!this.cache_.media) { var e = this.poster(), t = { src: this.currentSources(), textTracks: Array.prototype.map.call(this.remoteTextTracks(), (function (e) { return { kind: e.kind, label: e.label, language: e.language, src: e.src } })) }; return e && (t.poster = e, t.artwork = [{ src: t.poster, type: Hr(t.poster) }]), t } return Mn(this.cache_.media) }, t.getTagSettings = function (e) { var t = { sources: [], tracks: [] }, i = Di(e), n = i["data-setup"]; if (Ci(e, "vjs-fill") && (i.fill = !0), Ci(e, "vjs-fluid") && (i.fluid = !0), null !== n) { var r = f()(n || "{}"), a = r[0], s = r[1]; a && jt.error(a), Gt(i, s) } if (Gt(t, i), e.hasChildNodes()) for (var o = e.childNodes, u = 0, l = o.length; u < l; u++) { var c = o[u], d = c.nodeName.toLowerCase(); "source" === d ? t.sources.push(Di(c)) : "track" === d && t.tracks.push(Di(c)) } return t }, i.flexNotSupported_ = function () { var e = s().createElement("i"); return !("flexBasis" in e.style || "webkitFlexBasis" in e.style || "mozFlexBasis" in e.style || "msFlexBasis" in e.style || "msFlexOrder" in e.style) }, i.debug = function (e) { if (void 0 === e) return this.debugEnabled_; e ? (this.trigger("debugon"), this.previousLogLevel_ = this.log.level, this.log.level("debug"), this.debugEnabled_ = !0) : (this.trigger("debugoff"), this.log.level(this.previousLogLevel_), this.previousLogLevel_ = void 0, this.debugEnabled_ = !1) }, i.playbackRates = function (e) { if (void 0 === e) return this.cache_.playbackRates; Array.isArray(e) && e.every((function (e) { return "number" == typeof e })) && (this.cache_.playbackRates = e, this.trigger("playbackrateschange")) }, t }(Vn); kr.names.forEach((function (e) { var t = kr[e]; Ps.prototype[t.getterName] = function () { return this.tech_ ? this.tech_[t.getterName]() : (this[t.privateName] = this[t.privateName] || new t.ListClass, this[t.privateName]) } })), Ps.prototype.crossorigin = Ps.prototype.crossOrigin, Ps.players = {}; var Ls = r().navigator; Ps.prototype.options_ = { techOrder: Fr.defaultTechOrder_, html5: {}, inactivityTimeout: 2e3, playbackRates: [], liveui: !1, children: ["mediaLoader", "posterImage", "textTrackDisplay", "loadingSpinner", "bigPlayButton", "liveTracker", "controlBar", "errorDisplay", "textTrackSettings", "resizeManager"], language: Ls && (Ls.languages && Ls.languages[0] || Ls.userLanguage || Ls.language) || "en", languages: {}, notSupportedMessage: "No compatible source was found for this media.", normalizeAutoplay: !1, fullscreen: { options: { navigationUI: "hide" } }, breakpoints: {}, responsive: !1 }, ["ended", "seeking", "seekable", "networkState", "readyState"].forEach((function (e) { Ps.prototype[e] = function () { return this.techGet_(e) } })), ws.forEach((function (e) { Ps.prototype["handleTech" + Rn(e) + "_"] = function () { return this.trigger(e) } })), Vn.registerComponent("Player", Ps); var Os = "plugin", Bs = {}, Rs = function (e) { return Bs.hasOwnProperty(e) }, Ms = function (e) { return Rs(e) ? Bs[e] : void 0 }, Ns = function (e, t) { e.activePlugins_ = e.activePlugins_ || {}, e.activePlugins_[t] = !0 }, Us = function (e, t, i) { var n = (i ? "before" : "") + "pluginsetup"; e.trigger(n, t), e.trigger(n + ":" + t.name, t) }, js = function (e, t) { return t.prototype.name = e, function () { Us(this, { name: e, plugin: t, instance: null }, !0); for (var i = arguments.length, n = new Array(i), r = 0; r < i; r++)n[r] = arguments[r]; var a = _(t, [this].concat(n)); return this[e] = function () { return a }, Us(this, a.getEventHash()), a } }, Hs = function () { function e(t) { if (this.constructor === e) throw new Error("Plugin must be sub-classed; not directly instantiated."); this.player = t, this.log || (this.log = this.player.log.createLogger(this.name)), Pn(this), delete this.trigger, On(this, this.constructor.defaultState), Ns(t, this.name), this.dispose = this.dispose.bind(this), t.on("dispose", this.dispose) } var t = e.prototype; return t.version = function () { return this.constructor.VERSION }, t.getEventHash = function (e) { return void 0 === e && (e = {}), e.name = this.name, e.plugin = this.constructor, e.instance = this, e }, t.trigger = function (e, t) { return void 0 === t && (t = {}), fn(this.eventBusEl_, e, this.getEventHash(t)) }, t.handleStateChanged = function (e) { }, t.dispose = function () { var e = this.name, t = this.player; this.trigger("dispose"), this.off(), t.off("dispose", this.dispose), t.activePlugins_[e] = !1, this.player = this.state = null, t[e] = js(e, Bs[e]) }, e.isBasic = function (t) { var i = "string" == typeof t ? Ms(t) : t; return "function" == typeof i && !e.prototype.isPrototypeOf(i.prototype) }, e.registerPlugin = function (t, i) { if ("string" != typeof t) throw new Error('Illegal plugin name, "' + t + '", must be a string, was ' + typeof t + "."); if (Rs(t)) jt.warn('A plugin named "' + t + '" already exists. You may want to avoid re-registering plugins!'); else if (Ps.prototype.hasOwnProperty(t)) throw new Error('Illegal plugin name, "' + t + '", cannot share a name with an existing player method!'); if ("function" != typeof i) throw new Error('Illegal plugin for "' + t + '", must be a function, was ' + typeof i + "."); return Bs[t] = i, t !== Os && (e.isBasic(i) ? Ps.prototype[t] = function (e, t) { var i = function () { Us(this, { name: e, plugin: t, instance: null }, !0); var i = t.apply(this, arguments); return Ns(this, e), Us(this, { name: e, plugin: t, instance: i }), i }; return Object.keys(t).forEach((function (e) { i[e] = t[e] })), i }(t, i) : Ps.prototype[t] = js(t, i)), i }, e.deregisterPlugin = function (e) { if (e === Os) throw new Error("Cannot de-register base plugin."); Rs(e) && (delete Bs[e], delete Ps.prototype[e]) }, e.getPlugins = function (e) { var t; return void 0 === e && (e = Object.keys(Bs)), e.forEach((function (e) { var i = Ms(e); i && ((t = t || {})[e] = i) })), t }, e.getPluginVersion = function (e) { var t = Ms(e); return t && t.VERSION || "" }, e }(); Hs.getPlugin = Ms, Hs.BASE_PLUGIN_NAME = Os, Hs.registerPlugin(Os, Hs), Ps.prototype.usingPlugin = function (e) { return !!this.activePlugins_ && !0 === this.activePlugins_[e] }, Ps.prototype.hasPlugin = function (e) { return !!Rs(e) }; var Vs = function (e) { return 0 === e.indexOf("#") ? e.slice(1) : e }; function qs(e, t, i) { var n = qs.getPlayer(e); if (n) return t && jt.warn('Player "' + e + '" is already initialised. Options will not be applied.'), i && n.ready(i), n; var r = "string" == typeof e ? Qi("#" + Vs(e)) : e; if (!_i(r)) throw new TypeError("The element or ID supplied is not valid. (videojs)"); r.ownerDocument.defaultView && r.ownerDocument.body.contains(r) || jt.warn("The element supplied is not included in the DOM"), t = t || {}, Pt("beforesetup").forEach((function (e) { var i = e(r, Mn(t)); zt(i) && !Array.isArray(i) ? t = Mn(t, i) : jt.error("please return an object in beforesetup hooks") })); var a = Vn.getComponent("Player"); return n = new a(r, t, i), Pt("setup").forEach((function (e) { return e(n) })), n } if (qs.hooks_ = Dt, qs.hooks = Pt, qs.hook = function (e, t) { Pt(e, t) }, qs.hookOnce = function (e, t) { Pt(e, [].concat(t).map((function (t) { return function i() { return Lt(e, i), t.apply(void 0, arguments) } }))) }, qs.removeHook = Lt, !0 !== r().VIDEOJS_NO_DYNAMIC_STYLE && yi()) { var Ws = Qi(".vjs-styles-defaults"); if (!Ws) { Ws = tn("vjs-styles-defaults"); var Gs = Qi("head"); Gs && Gs.insertBefore(Ws, Gs.firstChild), nn(Ws, "\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ") } } Zi(1, qs), qs.VERSION = It, qs.options = Ps.prototype.options_, qs.getPlayers = function () { return Ps.players }, qs.getPlayer = function (e) { var t, i = Ps.players; if ("string" == typeof e) { var n = Vs(e), r = i[n]; if (r) return r; t = Qi("#" + n) } else t = e; if (_i(t)) { var a = t, s = a.player, o = a.playerId; if (s || i[o]) return s || i[o] } }, qs.getAllPlayers = function () { return Object.keys(Ps.players).map((function (e) { return Ps.players[e] })).filter(Boolean) }, qs.players = Ps.players, qs.getComponent = Vn.getComponent, qs.registerComponent = function (e, t) { Fr.isTech(t) && jt.warn("The " + e + " tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"), Vn.registerComponent.call(Vn, e, t) }, qs.getTech = Fr.getTech, qs.registerTech = Fr.registerTech, qs.use = function (e, t) { Ir[e] = Ir[e] || [], Ir[e].push(t) }, Object.defineProperty(qs, "middleware", { value: {}, writeable: !1, enumerable: !0 }), Object.defineProperty(qs.middleware, "TERMINATOR", { value: Pr, writeable: !1, enumerable: !0 }), qs.browser = gi, qs.TOUCH_ENABLED = di, qs.extend = function (e, t) { void 0 === t && (t = {}); var i = function () { e.apply(this, arguments) }, n = {}; for (var r in "object" == typeof t ? (t.constructor !== Object.prototype.constructor && (i = t.constructor), n = t) : "function" == typeof t && (i = t), function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function"); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), Object.defineProperty(e, "prototype", { writable: !1 }), t && d(e, t) }(i, e), e && (i.super_ = e), n) n.hasOwnProperty(r) && (i.prototype[r] = n[r]); return i }, qs.mergeOptions = Mn, qs.bind = _n, qs.registerPlugin = Hs.registerPlugin, qs.deregisterPlugin = Hs.deregisterPlugin, qs.plugin = function (e, t) { return jt.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"), Hs.registerPlugin(e, t) }, qs.getPlugins = Hs.getPlugins, qs.getPlugin = Hs.getPlugin, qs.getPluginVersion = Hs.getPluginVersion, qs.addLanguage = function (e, t) { var i; return e = ("" + e).toLowerCase(), qs.options.languages = Mn(qs.options.languages, ((i = {})[e] = t, i)), qs.options.languages[e] }, qs.log = jt, qs.createLogger = Ht, qs.createTimeRange = qs.createTimeRanges = Gn, qs.formatTime = ra, qs.setFormatTime = function (e) { na = e }, qs.resetFormatTime = function () { na = ia }, qs.parseUrl = mr, qs.isCrossOrigin = vr, qs.EventTarget = Tn, qs.on = hn, qs.one = mn, qs.off = pn, qs.trigger = fn, qs.xhr = g(), qs.TextTrack = Tr, qs.AudioTrack = xr, qs.VideoTrack = Sr, ["isEl", "isTextNode", "createEl", "hasClass", "addClass", "removeClass", "toggleClass", "setAttributes", "getAttributes", "emptyEl", "appendContent", "insertContent"].forEach((function (e) { qs[e] = function () { return jt.warn("videojs." + e + "() is deprecated; use videojs.dom." + e + "() instead"), $i[e].apply(null, arguments) } })), qs.computedStyle = Xt, qs.dom = $i, qs.url = yr, qs.defineLazyProperty = Es, qs.addLanguage("en", { "Non-Fullscreen": "Exit Fullscreen" }); var zs = S, Qs = function (e, t, i) { return e && i && i.responseURL && t !== i.responseURL ? i.responseURL : t }, Xs = function (e) { return qs.log.debug ? qs.log.debug.bind(qs, "VHS:", e + " >") : function () { } }, $s = 1 / 30, Ks = .1, Ys = function (e, t) { var i, n = []; if (e && e.length) for (i = 0; i < e.length; i++)t(e.start(i), e.end(i)) && n.push([e.start(i), e.end(i)]); return qs.createTimeRanges(n) }, Zs = function (e, t) { return Ys(e, (function (e, i) { return e - Ks <= t && i + Ks >= t })) }, Js = function (e, t) { return Ys(e, (function (e) { return e - $s >= t })) }, eo = function (e) { var t = []; if (!e || !e.length) return ""; for (var i = 0; i < e.length; i++)t.push(e.start(i) + " => " + e.end(i)); return t.join(", ") }, to = function (e) { for (var t = [], i = 0; i < e.length; i++)t.push({ start: e.start(i), end: e.end(i) }); return t }, io = function (e) { if (e && e.length && e.end) return e.end(e.length - 1) }, no = function (e, t) { var i = 0; if (!e || !e.length) return i; for (var n = 0; n < e.length; n++) { var r = e.start(n), a = e.end(n); t > a || (i += t > r && t <= a ? a - t : a - r) } return i }, ro = qs.createTimeRange, ao = function (e, t) { if (!t.preload) return t.duration; var i = 0; return (t.parts || []).forEach((function (e) { i += e.duration })), (t.preloadHints || []).forEach((function (t) { "PART" === t.type && (i += e.partTargetDuration) })), i }, so = function (e) { return (e.segments || []).reduce((function (e, t, i) { return t.parts ? t.parts.forEach((function (n, r) { e.push({ duration: n.duration, segmentIndex: i, partIndex: r, part: n, segment: t }) })) : e.push({ duration: t.duration, segmentIndex: i, partIndex: null, segment: t, part: null }), e }), []) }, oo = function (e) { var t = e.segments && e.segments.length && e.segments[e.segments.length - 1]; return t && t.parts || [] }, uo = function (e) { var t = e.preloadSegment; if (t) { var i = t.parts, n = (t.preloadHints || []).reduce((function (e, t) { return e + ("PART" === t.type ? 1 : 0) }), 0); return n += i && i.length ? i.length : 0 } }, lo = function (e, t) { if (t.endList) return 0; if (e && e.suggestedPresentationDelay) return e.suggestedPresentationDelay; var i = oo(t).length > 0; return i && t.serverControl && t.serverControl.partHoldBack ? t.serverControl.partHoldBack : i && t.partTargetDuration ? 3 * t.partTargetDuration : t.serverControl && t.serverControl.holdBack ? t.serverControl.holdBack : t.targetDuration ? 3 * t.targetDuration : 0 }, co = function (e, t, i) { if (void 0 === t && (t = e.mediaSequence + e.segments.length), t < e.mediaSequence) return 0; var n = function (e, t) { var i = 0, n = t - e.mediaSequence, r = e.segments[n]; if (r) { if (void 0 !== r.start) return { result: r.start, precise: !0 }; if (void 0 !== r.end) return { result: r.end - r.duration, precise: !0 } } for (; n--;) { if (void 0 !== (r = e.segments[n]).end) return { result: i + r.end, precise: !0 }; if (i += ao(e, r), void 0 !== r.start) return { result: i + r.start, precise: !0 } } return { result: i, precise: !1 } }(e, t); if (n.precise) return n.result; var r = function (e, t) { for (var i, n = 0, r = t - e.mediaSequence; r < e.segments.length; r++) { if (void 0 !== (i = e.segments[r]).start) return { result: i.start - n, precise: !0 }; if (n += ao(e, i), void 0 !== i.end) return { result: i.end - n, precise: !0 } } return { result: -1, precise: !1 } }(e, t); return r.precise ? r.result : n.result + i }, ho = function (e, t, i) { if (!e) return 0; if ("number" != typeof i && (i = 0), void 0 === t) { if (e.totalDuration) return e.totalDuration; if (!e.endList) return r()[1 / 0] } return co(e, t, i) }, po = function (e) { var t = e.defaultDuration, i = e.durationList, n = e.startIndex, r = e.endIndex, a = 0; if (n > r) { var s = [r, n]; n = s[0], r = s[1] } if (n < 0) { for (var o = n; o < Math.min(0, r); o++)a += t; n = 0 } for (var u = n; u < r; u++)a += i[u].duration; return a }, fo = function (e, t, i, n) { if (!e || !e.segments) return null; if (e.endList) return ho(e); if (null === t) return null; t = t || 0; var r = co(e, e.mediaSequence + e.segments.length, t); return i && (r -= n = "number" == typeof n ? n : lo(null, e)), Math.max(0, r) }, mo = function (e) { return e.excludeUntil && e.excludeUntil > Date.now() }, go = function (e) { return e.excludeUntil && e.excludeUntil === 1 / 0 }, Ao = function (e) { var t = mo(e); return !e.disabled && !t }, vo = function (e, t) { return t.attributes && t.attributes[e] }, yo = function (e, t) { if (1 === e.playlists.length) return !0; var i = t.attributes.BANDWIDTH || Number.MAX_VALUE; return 0 === e.playlists.filter((function (e) { return !!Ao(e) && (e.attributes.BANDWIDTH || 0) < i })).length }, _o = function (e, t) { return !(!e && !t || !e && t || e && !t) && (e === t || (!(!e.id || !t.id || e.id !== t.id) || (!(!e.resolvedUri || !t.resolvedUri || e.resolvedUri !== t.resolvedUri) || !(!e.uri || !t.uri || e.uri !== t.uri)))) }, bo = function (e, t) { var i = e && e.mediaGroups && e.mediaGroups.AUDIO || {}, n = !1; for (var r in i) { for (var a in i[r]) if (n = t(i[r][a])) break; if (n) break } return !!n }, To = function (e) { if (!e || !e.playlists || !e.playlists.length) return bo(e, (function (e) { return e.playlists && e.playlists.length || e.uri })); for (var t = function (t) { var i = e.playlists[t], n = i.attributes && i.attributes.CODECS; return n && n.split(",").every((function (e) { return q(e) })) || bo(e, (function (e) { return _o(i, e) })) ? "continue" : { v: !1 } }, i = 0; i < e.playlists.length; i++) { var n = t(i); if ("continue" !== n && "object" == typeof n) return n.v } return !0 }, xo = { liveEdgeDelay: lo, duration: ho, seekable: function (e, t, i) { var n = t || 0, r = fo(e, t, !0, i); return null === r ? ro() : ro(n, r) }, getMediaInfoForTime: function (e) { for (var t = e.playlist, i = e.currentTime, n = e.startingSegmentIndex, r = e.startingPartIndex, a = e.startTime, s = e.experimentalExactManifestTimings, o = i - a, u = so(t), l = 0, c = 0; c < u.length; c++) { var d = u[c]; if (n === d.segmentIndex && ("number" != typeof r || "number" != typeof d.partIndex || r === d.partIndex)) { l = c; break } } if (o < 0) { if (l > 0) for (var h = l - 1; h >= 0; h--) { var p = u[h]; if (o += p.duration, s) { if (o < 0) continue } else if (o + $s <= 0) continue; return { partIndex: p.partIndex, segmentIndex: p.segmentIndex, startTime: a - po({ defaultDuration: t.targetDuration, durationList: u, startIndex: l, endIndex: h }) } } return { partIndex: u[0] && u[0].partIndex || null, segmentIndex: u[0] && u[0].segmentIndex || 0, startTime: i } } if (l < 0) { for (var f = l; f < 0; f++)if ((o -= t.targetDuration) < 0) return { partIndex: u[0] && u[0].partIndex || null, segmentIndex: u[0] && u[0].segmentIndex || 0, startTime: i }; l = 0 } for (var m = l; m < u.length; m++) { var g = u[m]; if (o -= g.duration, s) { if (o > 0) continue } else if (o - $s >= 0) continue; return { partIndex: g.partIndex, segmentIndex: g.segmentIndex, startTime: a + po({ defaultDuration: t.targetDuration, durationList: u, startIndex: l, endIndex: m }) } } return { segmentIndex: u[u.length - 1].segmentIndex, partIndex: u[u.length - 1].partIndex, startTime: i } }, isEnabled: Ao, isDisabled: function (e) { return e.disabled }, isBlacklisted: mo, isIncompatible: go, playlistEnd: fo, isAes: function (e) { for (var t = 0; t < e.segments.length; t++)if (e.segments[t].key) return !0; return !1 }, hasAttribute: vo, estimateSegmentRequestTime: function (e, t, i, n) { return void 0 === n && (n = 0), vo("BANDWIDTH", i) ? (e * i.attributes.BANDWIDTH - 8 * n) / t : NaN }, isLowestEnabledRendition: yo, isAudioOnly: To, playlistMatch: _o, segmentDurationWithParts: ao }, So = qs.log, Eo = function (e, t) { return e + "-" + t }, Co = function (e, t) { e.mediaGroups && ["AUDIO", "SUBTITLES"].forEach((function (i) { if (e.mediaGroups[i]) for (var n in e.mediaGroups[i]) for (var r in e.mediaGroups[i][n]) { var a = e.mediaGroups[i][n][r]; t(a, i, n, r) } })) }, wo = function (e) { var t = e.playlist, i = e.uri, n = e.id; t.id = n, t.playlistErrors_ = 0, i && (t.uri = i), t.attributes = t.attributes || {} }, ko = function (e, t) { e.uri = t; for (var i = 0; i < e.playlists.length; i++)if (!e.playlists[i].uri) { var n = "placeholder-uri-" + i; e.playlists[i].uri = n } var r = To(e); Co(e, (function (t, i, n, a) { var s = "placeholder-uri-" + i + "-" + n + "-" + a; if (!t.playlists || !t.playlists.length) { if (r && "AUDIO" === i && !t.uri) for (var u = 0; u < e.playlists.length; u++) { var l = e.playlists[u]; if (l.attributes && l.attributes.AUDIO && l.attributes.AUDIO === n) return } t.playlists = [o({}, t)] } t.playlists.forEach((function (t, i) { var n = Eo(i, s); t.uri ? t.resolvedUri = t.resolvedUri || zs(e.uri, t.uri) : (t.uri = 0 === i ? s : n, t.resolvedUri = t.uri), t.id = t.id || n, t.attributes = t.attributes || {}, e.playlists[t.id] = t, e.playlists[t.uri] = t })) })), function (e) { for (var t = e.playlists.length; t--;) { var i = e.playlists[t]; wo({ playlist: i, id: Eo(t, i.uri) }), i.resolvedUri = zs(e.uri, i.uri), e.playlists[i.id] = i, e.playlists[i.uri] = i, i.attributes.BANDWIDTH || So.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.") } }(e), function (e) { Co(e, (function (t) { t.uri && (t.resolvedUri = zs(e.uri, t.uri)) })) }(e) }, Fo = qs.mergeOptions, Io = qs.EventTarget, Do = function (e, t) { if (!e) return t; var i = Fo(e, t); if (e.preloadHints && !t.preloadHints && delete i.preloadHints, e.parts && !t.parts) delete i.parts; else if (e.parts && t.parts) for (var n = 0; n < t.parts.length; n++)e.parts && e.parts[n] && (i.parts[n] = Fo(e.parts[n], t.parts[n])); return !e.skipped && t.skipped && (i.skipped = !1), e.preload && !t.preload && (i.preload = !1), i }, Po = function (e, t) { !e.resolvedUri && e.uri && (e.resolvedUri = zs(t, e.uri)), e.key && !e.key.resolvedUri && (e.key.resolvedUri = zs(t, e.key.uri)), e.map && !e.map.resolvedUri && (e.map.resolvedUri = zs(t, e.map.uri)), e.map && e.map.key && !e.map.key.resolvedUri && (e.map.key.resolvedUri = zs(t, e.map.key.uri)), e.parts && e.parts.length && e.parts.forEach((function (e) { e.resolvedUri || (e.resolvedUri = zs(t, e.uri)) })), e.preloadHints && e.preloadHints.length && e.preloadHints.forEach((function (e) { e.resolvedUri || (e.resolvedUri = zs(t, e.uri)) })) }, Lo = function (e) { var t = e.segments || [], i = e.preloadSegment; if (i && i.parts && i.parts.length) { if (i.preloadHints) for (var n = 0; n < i.preloadHints.length; n++)if ("MAP" === i.preloadHints[n].type) return t; i.duration = e.targetDuration, i.preload = !0, t.push(i) } return t }, Oo = function (e, t) { return e === t || e.segments && t.segments && e.segments.length === t.segments.length && e.endList === t.endList && e.mediaSequence === t.mediaSequence && e.preloadSegment === t.preloadSegment }, Bo = function (e, t, i) { void 0 === i && (i = Oo); var n = Fo(e, {}), r = n.playlists[t.id]; if (!r) return null; if (i(r, t)) return null; t.segments = Lo(t); var a = Fo(r, t); if (a.preloadSegment && !t.preloadSegment && delete a.preloadSegment, r.segments) { if (t.skip) { t.segments = t.segments || []; for (var s = 0; s < t.skip.skippedSegments; s++)t.segments.unshift({ skipped: !0 }) } a.segments = function (e, t, i) { var n = e.slice(), r = t.slice(); i = i || 0; for (var a, s = [], o = 0; o < r.length; o++) { var u = n[o + i], l = r[o]; u ? (a = u.map || a, s.push(Do(u, l))) : (a && !l.map && (l.map = a), s.push(l)) } return s }(r.segments, t.segments, t.mediaSequence - r.mediaSequence) } a.segments.forEach((function (e) { Po(e, a.resolvedUri) })); for (var o = 0; o < n.playlists.length; o++)n.playlists[o].id === t.id && (n.playlists[o] = a); return n.playlists[t.id] = a, n.playlists[t.uri] = a, Co(e, (function (e, i, n, r) { if (e.playlists) for (var a = 0; a < e.playlists.length; a++)t.id === e.playlists[a].id && (e.playlists[a] = t) })), n }, Ro = function (e, t) { var i = e.segments || [], n = i[i.length - 1], r = n && n.parts && n.parts[n.parts.length - 1], a = r && r.duration || n && n.duration; return t && a ? 1e3 * a : 500 * (e.partTargetDuration || e.targetDuration || 10) }, Mo = function (e) { function t(t, i, n) { var r; if (void 0 === n && (n = {}), r = e.call(this) || this, !t) throw new Error("A non-empty playlist URL or object is required"); r.logger_ = Xs("PlaylistLoader"); var a = n, s = a.withCredentials, o = void 0 !== s && s, u = a.handleManifestRedirects, l = void 0 !== u && u; r.src = t, r.vhs_ = i, r.withCredentials = o, r.handleManifestRedirects = l; var d = i.options_; return r.customTagParsers = d && d.customTagParsers || [], r.customTagMappers = d && d.customTagMappers || [], r.experimentalLLHLS = d && d.experimentalLLHLS || !1, qs.browser.IE_VERSION && (r.experimentalLLHLS = !1), r.state = "HAVE_NOTHING", r.handleMediaupdatetimeout_ = r.handleMediaupdatetimeout_.bind(c(r)), r.on("mediaupdatetimeout", r.handleMediaupdatetimeout_), r } h(t, e); var i = t.prototype; return i.handleMediaupdatetimeout_ = function () { var e = this; if ("HAVE_METADATA" === this.state) { var t = this.media(), i = zs(this.master.uri, t.uri); this.experimentalLLHLS && (i = function (e, t) { if (t.endList || !t.serverControl) return e; var i = {}; if (t.serverControl.canBlockReload) { var n = t.preloadSegment, a = t.mediaSequence + t.segments.length; if (n) { var s = n.parts || [], o = uo(t) - 1; o > -1 && o !== s.length - 1 && (i._HLS_part = o), (o > -1 || s.length) && a-- } i._HLS_msn = a } if (t.serverControl && t.serverControl.canSkipUntil && (i._HLS_skip = t.serverControl.canSkipDateranges ? "v2" : "YES"), Object.keys(i).length) { var u = new (r().URL)(e);["_HLS_skip", "_HLS_msn", "_HLS_part"].forEach((function (e) { i.hasOwnProperty(e) && u.searchParams.set(e, i[e]) })), e = u.toString() } return e }(i, t)), this.state = "HAVE_CURRENT_METADATA", this.request = this.vhs_.xhr({ uri: i, withCredentials: this.withCredentials }, (function (t, i) { if (e.request) return t ? e.playlistRequestError(e.request, e.media(), "HAVE_METADATA") : void e.haveMetadata({ playlistString: e.request.responseText, url: e.media().uri, id: e.media().id }) })) } }, i.playlistRequestError = function (e, t, i) { var n = t.uri, r = t.id; this.request = null, i && (this.state = i), this.error = { playlist: this.master.playlists[r], status: e.status, message: "HLS playlist request error at URL: " + n + ".", responseText: e.responseText, code: e.status >= 500 ? 4 : 2 }, this.trigger("error") }, i.parseManifest_ = function (e) { var t = this, i = e.url; return function (e) { var t = e.onwarn, i = e.oninfo, n = e.manifestString, r = e.customTagParsers, a = void 0 === r ? [] : r, s = e.customTagMappers, o = void 0 === s ? [] : s, u = e.experimentalLLHLS, l = new M; t && l.on("warn", t), i && l.on("info", i), a.forEach((function (e) { return l.addParser(e) })), o.forEach((function (e) { return l.addTagMapper(e) })), l.push(n), l.end(); var c = l.manifest; if (u || (["preloadSegment", "skip", "serverControl", "renditionReports", "partInf", "partTargetDuration"].forEach((function (e) { c.hasOwnProperty(e) && delete c[e] })), c.segments && c.segments.forEach((function (e) { ["parts", "preloadHints"].forEach((function (t) { e.hasOwnProperty(t) && delete e[t] })) }))), !c.targetDuration) { var d = 10; c.segments && c.segments.length && (d = c.segments.reduce((function (e, t) { return Math.max(e, t.duration) }), 0)), t && t("manifest has no targetDuration defaulting to " + d), c.targetDuration = d } var h = oo(c); if (h.length && !c.partTargetDuration) { var p = h.reduce((function (e, t) { return Math.max(e, t.duration) }), 0); t && (t("manifest has no partTargetDuration defaulting to " + p), So.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")), c.partTargetDuration = p } return c }({ onwarn: function (e) { var n = e.message; return t.logger_("m3u8-parser warn for " + i + ": " + n) }, oninfo: function (e) { var n = e.message; return t.logger_("m3u8-parser info for " + i + ": " + n) }, manifestString: e.manifestString, customTagParsers: this.customTagParsers, customTagMappers: this.customTagMappers, experimentalLLHLS: this.experimentalLLHLS }) }, i.haveMetadata = function (e) { var t = e.playlistString, i = e.playlistObject, n = e.url, r = e.id; this.request = null, this.state = "HAVE_METADATA"; var a = i || this.parseManifest_({ url: n, manifestString: t }); a.lastRequest = Date.now(), wo({ playlist: a, uri: n, id: r }); var s = Bo(this.master, a); this.targetDuration = a.partTargetDuration || a.targetDuration, this.pendingMedia_ = null, s ? (this.master = s, this.media_ = this.master.playlists[r]) : this.trigger("playlistunchanged"), this.updateMediaUpdateTimeout_(Ro(this.media(), !!s)), this.trigger("loadedplaylist") }, i.dispose = function () { this.trigger("dispose"), this.stopRequest(), r().clearTimeout(this.mediaUpdateTimeout), r().clearTimeout(this.finalRenditionTimeout), this.off() }, i.stopRequest = function () { if (this.request) { var e = this.request; this.request = null, e.onreadystatechange = null, e.abort() } }, i.media = function (e, t) { var i = this; if (!e) return this.media_; if ("HAVE_NOTHING" === this.state) throw new Error("Cannot switch media playlist from " + this.state); if ("string" == typeof e) { if (!this.master.playlists[e]) throw new Error("Unknown playlist URI: " + e); e = this.master.playlists[e] } if (r().clearTimeout(this.finalRenditionTimeout), t) { var n = (e.partTargetDuration || e.targetDuration) / 2 * 1e3 || 5e3; this.finalRenditionTimeout = r().setTimeout(this.media.bind(this, e, !1), n) } else { var a = this.state, s = !this.media_ || e.id !== this.media_.id, o = this.master.playlists[e.id]; if (o && o.endList || e.endList && e.segments.length) return this.request && (this.request.onreadystatechange = null, this.request.abort(), this.request = null), this.state = "HAVE_METADATA", this.media_ = e, void (s && (this.trigger("mediachanging"), "HAVE_MASTER" === a ? this.trigger("loadedmetadata") : this.trigger("mediachange"))); if (this.updateMediaUpdateTimeout_(Ro(e, !0)), s) { if (this.state = "SWITCHING_MEDIA", this.request) { if (e.resolvedUri === this.request.url) return; this.request.onreadystatechange = null, this.request.abort(), this.request = null } this.media_ && this.trigger("mediachanging"), this.pendingMedia_ = e, this.request = this.vhs_.xhr({ uri: e.resolvedUri, withCredentials: this.withCredentials }, (function (t, n) { if (i.request) { if (e.lastRequest = Date.now(), e.resolvedUri = Qs(i.handleManifestRedirects, e.resolvedUri, n), t) return i.playlistRequestError(i.request, e, a); i.haveMetadata({ playlistString: n.responseText, url: e.uri, id: e.id }), "HAVE_MASTER" === a ? i.trigger("loadedmetadata") : i.trigger("mediachange") } })) } } }, i.pause = function () { this.mediaUpdateTimeout && (r().clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = null), this.stopRequest(), "HAVE_NOTHING" === this.state && (this.started = !1), "SWITCHING_MEDIA" === this.state ? this.media_ ? this.state = "HAVE_METADATA" : this.state = "HAVE_MASTER" : "HAVE_CURRENT_METADATA" === this.state && (this.state = "HAVE_METADATA") }, i.load = function (e) { var t = this; this.mediaUpdateTimeout && (r().clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = null); var i = this.media(); if (e) { var n = i ? (i.partTargetDuration || i.targetDuration) / 2 * 1e3 : 5e3; this.mediaUpdateTimeout = r().setTimeout((function () { t.mediaUpdateTimeout = null, t.load() }), n) } else this.started ? i && !i.endList ? this.trigger("mediaupdatetimeout") : this.trigger("loadedplaylist") : this.start() }, i.updateMediaUpdateTimeout_ = function (e) { var t = this; this.mediaUpdateTimeout && (r().clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = null), this.media() && !this.media().endList && (this.mediaUpdateTimeout = r().setTimeout((function () { t.mediaUpdateTimeout = null, t.trigger("mediaupdatetimeout"), t.updateMediaUpdateTimeout_(e) }), e)) }, i.start = function () { var e = this; if (this.started = !0, "object" == typeof this.src) return this.src.uri || (this.src.uri = r().location.href), this.src.resolvedUri = this.src.uri, void setTimeout((function () { e.setupInitialPlaylist(e.src) }), 0); this.request = this.vhs_.xhr({ uri: this.src, withCredentials: this.withCredentials }, (function (t, i) { if (e.request) { if (e.request = null, t) return e.error = { status: i.status, message: "HLS playlist request error at URL: " + e.src + ".", responseText: i.responseText, code: 2 }, "HAVE_NOTHING" === e.state && (e.started = !1), e.trigger("error"); e.src = Qs(e.handleManifestRedirects, e.src, i); var n = e.parseManifest_({ manifestString: i.responseText, url: e.src }); e.setupInitialPlaylist(n) } })) }, i.srcUri = function () { return "string" == typeof this.src ? this.src : this.src.uri }, i.setupInitialPlaylist = function (e) { if (this.state = "HAVE_MASTER", e.playlists) return this.master = e, ko(this.master, this.srcUri()), e.playlists.forEach((function (e) { e.segments = Lo(e), e.segments.forEach((function (t) { Po(t, e.resolvedUri) })) })), this.trigger("loadedplaylist"), void (this.request || this.media(this.master.playlists[0])); var t = this.srcUri() || r().location.href; this.master = function (e, t) { var i = Eo(0, t), n = { mediaGroups: { AUDIO: {}, VIDEO: {}, "CLOSED-CAPTIONS": {}, SUBTITLES: {} }, uri: r().location.href, resolvedUri: r().location.href, playlists: [{ uri: t, id: i, resolvedUri: t, attributes: {} }] }; return n.playlists[i] = n.playlists[0], n.playlists[t] = n.playlists[0], n }(0, t), this.haveMetadata({ playlistObject: e, url: t, id: this.master.playlists[0].id }), this.trigger("loadedmetadata") }, t }(Io), No = qs.xhr, Uo = qs.mergeOptions, jo = function (e, t, i, n) { var r = "arraybuffer" === e.responseType ? e.response : e.responseText; !t && r && (e.responseTime = Date.now(), e.roundTripTime = e.responseTime - e.requestTime, e.bytesReceived = r.byteLength || r.length, e.bandwidth || (e.bandwidth = Math.floor(e.bytesReceived / e.roundTripTime * 8 * 1e3))), i.headers && (e.responseHeaders = i.headers), t && "ETIMEDOUT" === t.code && (e.timedout = !0), t || e.aborted || 200 === i.statusCode || 206 === i.statusCode || 0 === i.statusCode || (t = new Error("XHR Failed with a response of: " + (e && (r || e.responseText)))), n(t, e) }, Ho = function () { var e = function e(t, i) { t = Uo({ timeout: 45e3 }, t); var n = e.beforeRequest || qs.Vhs.xhr.beforeRequest; if (n && "function" == typeof n) { var r = n(t); r && (t = r) } var a = (!0 === qs.Vhs.xhr.original ? No : qs.Vhs.xhr)(t, (function (e, t) { return jo(a, e, t, i) })), s = a.abort; return a.abort = function () { return a.aborted = !0, s.apply(a, arguments) }, a.uri = t.uri, a.requestTime = Date.now(), a }; return e.original = !0, e }, Vo = function (e) { var t, i = {}; return e.byterange && (i.Range = "bytes=" + (t = e.byterange).offset + "-" + ("bigint" == typeof t.offset || "bigint" == typeof t.length ? r().BigInt(t.offset) + r().BigInt(t.length) - r().BigInt(1) : t.offset + t.length - 1)), i }, qo = function (e, t) { return e.start(t) + "-" + e.end(t) }, Wo = function (e, t) { var i = e.toString(16); return "00".substring(0, 2 - i.length) + i + (t % 2 ? " " : "") }, Go = function (e) { return e >= 32 && e < 126 ? String.fromCharCode(e) : "." }, zo = function (e) { var t = {}; return Object.keys(e).forEach((function (i) { var n = e[i]; ArrayBuffer.isView(n) ? t[i] = { bytes: n.buffer, byteOffset: n.byteOffset, byteLength: n.byteLength } : t[i] = n })), t }, Qo = function (e) { var t = e.byterange || { length: 1 / 0, offset: 0 }; return [t.length, t.offset, e.resolvedUri].join(",") }, Xo = function (e) { return e.resolvedUri }, $o = function (e) { for (var t = Array.prototype.slice.call(e), i = 16, n = "", r = 0; r < t.length / i; r++)n += t.slice(r * i, r * i + i).map(Wo).join("") + " " + t.slice(r * i, r * i + i).map(Go).join("") + "\n"; return n }, Ko = Object.freeze({ __proto__: null, createTransferableMessage: zo, initSegmentId: Qo, segmentKeyId: Xo, hexDump: $o, tagDump: function (e) { var t = e.bytes; return $o(t) }, textRanges: function (e) { var t, i = ""; for (t = 0; t < e.length; t++)i += qo(e, t) + " "; return i } }), Yo = function (e) { var t = e.playlist, i = e.time, n = void 0 === i ? void 0 : i, r = e.callback; if (!r) throw new Error("getProgramTime: callback must be provided"); if (!t || void 0 === n) return r({ message: "getProgramTime: playlist and time must be provided" }); var a = function (e, t) { if (!t || !t.segments || 0 === t.segments.length) return null; for (var i, n = 0, r = 0; r < t.segments.length && !(e <= (n = (i = t.segments[r]).videoTimingInfo ? i.videoTimingInfo.transmuxedPresentationEnd : n + i.duration)); r++); var a = t.segments[t.segments.length - 1]; if (a.videoTimingInfo && a.videoTimingInfo.transmuxedPresentationEnd < e) return null; if (e > n) { if (e > n + .25 * a.duration) return null; i = a } return { segment: i, estimatedStart: i.videoTimingInfo ? i.videoTimingInfo.transmuxedPresentationStart : n - i.duration, type: i.videoTimingInfo ? "accurate" : "estimate" } }(n, t); if (!a) return r({ message: "valid programTime was not found" }); if ("estimate" === a.type) return r({ message: "Accurate programTime could not be determined. Please seek to e.seekTime and try again", seekTime: a.estimatedStart }); var s = { mediaSeconds: n }, o = function (e, t) { if (!t.dateTimeObject) return null; var i = t.videoTimingInfo.transmuxerPrependedSeconds, n = e - (t.videoTimingInfo.transmuxedPresentationStart + i); return new Date(t.dateTimeObject.getTime() + 1e3 * n) }(n, a.segment); return o && (s.programDateTime = o.toISOString()), r(null, s) }, Zo = function e(t) { var i = t.programTime, n = t.playlist, r = t.retryCount, a = void 0 === r ? 2 : r, s = t.seekTo, o = t.pauseAfterSeek, u = void 0 === o || o, l = t.tech, c = t.callback; if (!c) throw new Error("seekToProgramTime: callback must be provided"); if (void 0 === i || !n || !s) return c({ message: "seekToProgramTime: programTime, seekTo and playlist must be provided" }); if (!n.endList && !l.hasStarted_) return c({ message: "player must be playing a live stream to start buffering" }); if (!function (e) { if (!e.segments || 0 === e.segments.length) return !1; for (var t = 0; t < e.segments.length; t++)if (!e.segments[t].dateTimeObject) return !1; return !0 }(n)) return c({ message: "programDateTime tags must be provided in the manifest " + n.resolvedUri }); var d = function (e, t) { var i; try { i = new Date(e) } catch (e) { return null } if (!t || !t.segments || 0 === t.segments.length) return null; var n = t.segments[0]; if (i < n.dateTimeObject) return null; for (var r = 0; r < t.segments.length - 1 && (n = t.segments[r], !(i < t.segments[r + 1].dateTimeObject)); r++); var a, s = t.segments[t.segments.length - 1], o = s.dateTimeObject, u = s.videoTimingInfo ? (a = s.videoTimingInfo).transmuxedPresentationEnd - a.transmuxedPresentationStart - a.transmuxerPrependedSeconds : s.duration + .25 * s.duration; return i > new Date(o.getTime() + 1e3 * u) ? null : (i > o && (n = s), { segment: n, estimatedStart: n.videoTimingInfo ? n.videoTimingInfo.transmuxedPresentationStart : xo.duration(t, t.mediaSequence + t.segments.indexOf(n)), type: n.videoTimingInfo ? "accurate" : "estimate" }) }(i, n); if (!d) return c({ message: i + " was not found in the stream" }); var h = d.segment, p = function (e, t) { var i, n; try { i = new Date(e), n = new Date(t) } catch (e) { } var r = i.getTime(); return (n.getTime() - r) / 1e3 }(h.dateTimeObject, i); if ("estimate" === d.type) return 0 === a ? c({ message: i + " is not buffered yet. Try again" }) : (s(d.estimatedStart + p), void l.one("seeked", (function () { e({ programTime: i, playlist: n, retryCount: a - 1, seekTo: s, pauseAfterSeek: u, tech: l, callback: c }) }))); var f = h.start + p; l.one("seeked", (function () { return c(null, l.currentTime()) })), u && l.pause(), s(f) }, Jo = function (e, t) { if (4 === e.readyState) return t() }, eu = function (e, t, i) { var n, r = [], a = !1, s = function (e, t, n, r) { return t.abort(), a = !0, i(e, t, n, r) }, o = function (e, t) { if (!a) { if (e) return s(e, t, "", r); var i = t.responseText.substring(r && r.byteLength || 0, t.responseText.length); if (r = function () { for (var e = arguments.length, t = new Array(e), i = 0; i < e; i++)t[i] = arguments[i]; if (t = t.filter((function (e) { return e && (e.byteLength || e.length) && "string" != typeof e })), t.length <= 1) return et(t[0]); var n = t.reduce((function (e, t, i) { return e + (t.byteLength || t.length) }), 0), r = new Uint8Array(n), a = 0; return t.forEach((function (e) { e = et(e), r.set(e, a), a += e.byteLength })), r }(r, at(i, !0)), n = n || ut(r), r.length < 10 || n && r.length < n + 2) return Jo(t, (function () { return s(e, t, "", r) })); var o = kt(r); return "ts" === o && r.length < 188 || !o && r.length < 376 ? Jo(t, (function () { return s(e, t, "", r) })) : s(null, t, o, r) } }, u = { uri: e, beforeSend: function (e) { e.overrideMimeType("text/plain; charset=x-user-defined"), e.addEventListener("progress", (function (t) { return t.total, t.loaded, jo(e, null, { statusCode: e.status }, o) })) } }, l = t(u, (function (e, t) { return jo(l, e, t, o) })); return l }, tu = qs.EventTarget, iu = qs.mergeOptions, nu = function (e, t) { if (!Oo(e, t)) return !1; if (e.sidx && t.sidx && (e.sidx.offset !== t.sidx.offset || e.sidx.length !== t.sidx.length)) return !1; if (!e.sidx && t.sidx || e.sidx && !t.sidx) return !1; if (e.segments && !t.segments || !e.segments && t.segments) return !1; if (!e.segments && !t.segments) return !0; for (var i = 0; i < e.segments.length; i++) { var n = e.segments[i], r = t.segments[i]; if (n.uri !== r.uri) return !1; if (n.byterange || r.byterange) { var a = n.byterange, s = r.byterange; if (a && !s || !a && s) return !1; if (a.offset !== s.offset || a.length !== s.length) return !1 } } return !0 }, ru = function (e, t) { return (Boolean(!e.map && !t.map) || Boolean(e.map && t.map && e.map.byterange.offset === t.map.byterange.offset && e.map.byterange.length === t.map.byterange.length)) && e.uri === t.uri && e.byterange.offset === t.byterange.offset && e.byterange.length === t.byterange.length }, au = function (e, t) { var i = {}; for (var n in e) { var r = e[n].sidx; if (r) { var a = be(r); if (!t[a]) break; var s = t[a].sidxInfo; ru(s, r) && (i[a] = t[a]) } } return i }, su = function (e) { function t(t, i, n, r) { var a; void 0 === n && (n = {}), (a = e.call(this) || this).masterPlaylistLoader_ = r || c(a), r || (a.isMaster_ = !0); var s = n, o = s.withCredentials, u = void 0 !== o && o, l = s.handleManifestRedirects, d = void 0 !== l && l; if (a.vhs_ = i, a.withCredentials = u, a.handleManifestRedirects = d, !t) throw new Error("A non-empty playlist URL or object is required"); return a.on("minimumUpdatePeriod", (function () { a.refreshXml_() })), a.on("mediaupdatetimeout", (function () { a.refreshMedia_(a.media().id) })), a.state = "HAVE_NOTHING", a.loadedPlaylists_ = {}, a.logger_ = Xs("DashPlaylistLoader"), a.isMaster_ ? (a.masterPlaylistLoader_.srcUrl = t, a.masterPlaylistLoader_.sidxMapping_ = {}) : a.childPlaylist_ = t, a } h(t, e); var i = t.prototype; return i.requestErrored_ = function (e, t, i) { return !this.request || (this.request = null, e ? (this.error = "object" != typeof e || e instanceof Error ? { status: t.status, message: "DASH request error at URL: " + t.uri, response: t.response, code: 2 } : e, i && (this.state = i), this.trigger("error"), !0) : void 0) }, i.addSidxSegments_ = function (e, t, i) { var n = this, a = e.sidx && be(e.sidx); if (e.sidx && a && !this.masterPlaylistLoader_.sidxMapping_[a]) { var s = Qs(this.handleManifestRedirects, e.sidx.resolvedUri), o = function (r, s) { if (!n.requestErrored_(r, s, t)) { var o, u = n.masterPlaylistLoader_.sidxMapping_; try { o = Ze()(et(s.response).subarray(8)) } catch (e) { return void n.requestErrored_(e, s, t) } return u[a] = { sidxInfo: e.sidx, sidx: o }, me(e, o, e.sidx.resolvedUri), i(!0) } }; this.request = eu(s, this.vhs_.xhr, (function (t, i, r, a) { if (t) return o(t, i); if (!r || "mp4" !== r) return o({ status: i.status, message: "Unsupported " + (r || "unknown") + " container type for sidx segment at URL: " + s, response: "", playlist: e, internal: !0, blacklistDuration: 1 / 0, code: 2 }, i); var u = e.sidx.byterange, l = u.offset, c = u.length; if (a.length >= c + l) return o(t, { response: a.subarray(l, l + c), status: i.status, uri: i.uri }); n.request = n.vhs_.xhr({ uri: s, responseType: "arraybuffer", headers: Vo({ byterange: e.sidx.byterange }) }, o) })) } else this.mediaRequest_ = r().setTimeout((function () { return i(!1) }), 0) }, i.dispose = function () { this.trigger("dispose"), this.stopRequest(), this.loadedPlaylists_ = {}, r().clearTimeout(this.minimumUpdatePeriodTimeout_), r().clearTimeout(this.mediaRequest_), r().clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = null, this.mediaRequest_ = null, this.minimumUpdatePeriodTimeout_ = null, this.masterPlaylistLoader_.createMupOnMedia_ && (this.off("loadedmetadata", this.masterPlaylistLoader_.createMupOnMedia_), this.masterPlaylistLoader_.createMupOnMedia_ = null), this.off() }, i.hasPendingRequest = function () { return this.request || this.mediaRequest_ }, i.stopRequest = function () { if (this.request) { var e = this.request; this.request = null, e.onreadystatechange = null, e.abort() } }, i.media = function (e) { var t = this; if (!e) return this.media_; if ("HAVE_NOTHING" === this.state) throw new Error("Cannot switch media playlist from " + this.state); var i = this.state; if ("string" == typeof e) { if (!this.masterPlaylistLoader_.master.playlists[e]) throw new Error("Unknown playlist URI: " + e); e = this.masterPlaylistLoader_.master.playlists[e] } var n = !this.media_ || e.id !== this.media_.id; if (n && this.loadedPlaylists_[e.id] && this.loadedPlaylists_[e.id].endList) return this.state = "HAVE_METADATA", this.media_ = e, void (n && (this.trigger("mediachanging"), this.trigger("mediachange"))); n && (this.media_ && this.trigger("mediachanging"), this.addSidxSegments_(e, i, (function (n) { t.haveMetadata({ startingState: i, playlist: e }) }))) }, i.haveMetadata = function (e) { var t = e.startingState, i = e.playlist; this.state = "HAVE_METADATA", this.loadedPlaylists_[i.id] = i, this.mediaRequest_ = null, this.refreshMedia_(i.id), "HAVE_MASTER" === t ? this.trigger("loadedmetadata") : this.trigger("mediachange") }, i.pause = function () { this.masterPlaylistLoader_.createMupOnMedia_ && (this.off("loadedmetadata", this.masterPlaylistLoader_.createMupOnMedia_), this.masterPlaylistLoader_.createMupOnMedia_ = null), this.stopRequest(), r().clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = null, this.isMaster_ && (r().clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_), this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_ = null), "HAVE_NOTHING" === this.state && (this.started = !1) }, i.load = function (e) { var t = this; r().clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = null; var i = this.media(); if (e) { var n = i ? i.targetDuration / 2 * 1e3 : 5e3; this.mediaUpdateTimeout = r().setTimeout((function () { return t.load() }), n) } else this.started ? i && !i.endList ? (this.isMaster_ && !this.minimumUpdatePeriodTimeout_ && (this.trigger("minimumUpdatePeriod"), this.updateMinimumUpdatePeriodTimeout_()), this.trigger("mediaupdatetimeout")) : this.trigger("loadedplaylist") : this.start() }, i.start = function () { var e = this; this.started = !0, this.isMaster_ ? this.requestMaster_((function (t, i) { e.haveMaster_(), e.hasPendingRequest() || e.media_ || e.media(e.masterPlaylistLoader_.master.playlists[0]) })) : this.mediaRequest_ = r().setTimeout((function () { return e.haveMaster_() }), 0) }, i.requestMaster_ = function (e) { var t = this; this.request = this.vhs_.xhr({ uri: this.masterPlaylistLoader_.srcUrl, withCredentials: this.withCredentials }, (function (i, n) { if (!t.requestErrored_(i, n)) { var r = n.responseText !== t.masterPlaylistLoader_.masterXml_; return t.masterPlaylistLoader_.masterXml_ = n.responseText, n.responseHeaders && n.responseHeaders.date ? t.masterLoaded_ = Date.parse(n.responseHeaders.date) : t.masterLoaded_ = Date.now(), t.masterPlaylistLoader_.srcUrl = Qs(t.handleManifestRedirects, t.masterPlaylistLoader_.srcUrl, n), r ? (t.handleMaster_(), void t.syncClientServerClock_((function () { return e(n, r) }))) : e(n, r) } "HAVE_NOTHING" === t.state && (t.started = !1) })) }, i.syncClientServerClock_ = function (e) { var t = this, i = Ke(this.masterPlaylistLoader_.masterXml_); return null === i ? (this.masterPlaylistLoader_.clientOffset_ = this.masterLoaded_ - Date.now(), e()) : "DIRECT" === i.method ? (this.masterPlaylistLoader_.clientOffset_ = i.value - Date.now(), e()) : void (this.request = this.vhs_.xhr({ uri: zs(this.masterPlaylistLoader_.srcUrl, i.value), method: i.method, withCredentials: this.withCredentials }, (function (n, r) { if (t.request) { if (n) return t.masterPlaylistLoader_.clientOffset_ = t.masterLoaded_ - Date.now(), e(); var a; a = "HEAD" === i.method ? r.responseHeaders && r.responseHeaders.date ? Date.parse(r.responseHeaders.date) : t.masterLoaded_ : Date.parse(r.responseText), t.masterPlaylistLoader_.clientOffset_ = a - Date.now(), e() } }))) }, i.haveMaster_ = function () { this.state = "HAVE_MASTER", this.isMaster_ ? this.trigger("loadedplaylist") : this.media_ || this.media(this.childPlaylist_) }, i.handleMaster_ = function () { this.mediaRequest_ = null; var e, t, i, n, r, a, s, o = this.masterPlaylistLoader_.master, u = (e = { masterXml: this.masterPlaylistLoader_.masterXml_, srcUrl: this.masterPlaylistLoader_.srcUrl, clientOffset: this.masterPlaylistLoader_.clientOffset_, sidxMapping: this.masterPlaylistLoader_.sidxMapping_, previousManifest: o }, t = e.masterXml, i = e.srcUrl, n = e.clientOffset, r = e.sidxMapping, a = e.previousManifest, s = $e(t, { manifestUri: i, clientOffset: n, sidxMapping: r, previousManifest: a }), ko(s, i), s); o && (u = function (e, t, i) { for (var n = !0, r = iu(e, { duration: t.duration, minimumUpdatePeriod: t.minimumUpdatePeriod, timelineStarts: t.timelineStarts }), a = 0; a < t.playlists.length; a++) { var s = t.playlists[a]; if (s.sidx) { var o = be(s.sidx); i && i[o] && i[o].sidx && me(s, i[o].sidx, s.sidx.resolvedUri) } var u = Bo(r, s, nu); u && (r = u, n = !1) } return Co(t, (function (e, t, i, a) { if (e.playlists && e.playlists.length) { var s = e.playlists[0].id, o = Bo(r, e.playlists[0], nu); o && ((r = o).mediaGroups[t][i][a].playlists[0] = r.playlists[s], n = !1) } })), t.minimumUpdatePeriod !== e.minimumUpdatePeriod && (n = !1), n ? null : r }(o, u, this.masterPlaylistLoader_.sidxMapping_)), this.masterPlaylistLoader_.master = u || o; var l = this.masterPlaylistLoader_.master.locations && this.masterPlaylistLoader_.master.locations[0]; return l && l !== this.masterPlaylistLoader_.srcUrl && (this.masterPlaylistLoader_.srcUrl = l), (!o || u && u.minimumUpdatePeriod !== o.minimumUpdatePeriod) && this.updateMinimumUpdatePeriodTimeout_(), Boolean(u) }, i.updateMinimumUpdatePeriodTimeout_ = function () { var e = this.masterPlaylistLoader_; e.createMupOnMedia_ && (e.off("loadedmetadata", e.createMupOnMedia_), e.createMupOnMedia_ = null), e.minimumUpdatePeriodTimeout_ && (r().clearTimeout(e.minimumUpdatePeriodTimeout_), e.minimumUpdatePeriodTimeout_ = null); var t = e.master && e.master.minimumUpdatePeriod; 0 === t && (e.media() ? t = 1e3 * e.media().targetDuration : (e.createMupOnMedia_ = e.updateMinimumUpdatePeriodTimeout_, e.one("loadedmetadata", e.createMupOnMedia_))), "number" != typeof t || t <= 0 ? t < 0 && this.logger_("found invalid minimumUpdatePeriod of " + t + ", not setting a timeout") : this.createMUPTimeout_(t) }, i.createMUPTimeout_ = function (e) { var t = this.masterPlaylistLoader_; t.minimumUpdatePeriodTimeout_ = r().setTimeout((function () { t.minimumUpdatePeriodTimeout_ = null, t.trigger("minimumUpdatePeriod"), t.createMUPTimeout_(e) }), e) }, i.refreshXml_ = function () { var e = this; this.requestMaster_((function (t, i) { var n, r, a; i && (e.media_ && (e.media_ = e.masterPlaylistLoader_.master.playlists[e.media_.id]), e.masterPlaylistLoader_.sidxMapping_ = (n = e.masterPlaylistLoader_.master, r = e.masterPlaylistLoader_.sidxMapping_, a = au(n.playlists, r), Co(n, (function (e, t, i, n) { if (e.playlists && e.playlists.length) { var s = e.playlists; a = iu(a, au(s, r)) } })), a), e.addSidxSegments_(e.media(), e.state, (function (t) { e.refreshMedia_(e.media().id) }))) })) }, i.refreshMedia_ = function (e) { var t = this; if (!e) throw new Error("refreshMedia_ must take a media id"); this.media_ && this.isMaster_ && this.handleMaster_(); var i = this.masterPlaylistLoader_.master.playlists, n = !this.media_ || this.media_ !== i[e]; if (n ? this.media_ = i[e] : this.trigger("playlistunchanged"), !this.mediaUpdateTimeout) { !function e() { t.media().endList || (t.mediaUpdateTimeout = r().setTimeout((function () { t.trigger("mediaupdatetimeout"), e() }), Ro(t.media(), Boolean(n)))) }() } this.trigger("loadedplaylist") }, t }(tu), ou = { GOAL_BUFFER_LENGTH: 30, MAX_GOAL_BUFFER_LENGTH: 60, BACK_BUFFER_LENGTH: 30, GOAL_BUFFER_LENGTH_RATE: 1, INITIAL_BANDWIDTH: 4194304, BANDWIDTH_VARIANCE: 1.2, BUFFER_LOW_WATER_LINE: 0, MAX_BUFFER_LOW_WATER_LINE: 30, EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE: 16, BUFFER_LOW_WATER_LINE_RATE: 1, BUFFER_HIGH_WATER_LINE: 30 }, uu = function (e) { return e.on = e.addEventListener, e.off = e.removeEventListener, e }, lu = function (e) { return function () { var t = function (e) { try { return URL.createObjectURL(new Blob([e], { type: "application/javascript" })) } catch (i) { var t = new BlobBuilder; return t.append(e), URL.createObjectURL(t.getBlob()) } }(e), i = uu(new Worker(t)); i.objURL = t; var n = i.terminate; return i.on = i.addEventListener, i.off = i.removeEventListener, i.terminate = function () { return URL.revokeObjectURL(t), n.call(this) }, i } }, cu = function (e) { return "var browserWorkerPolyFill = " + uu.toString() + ";\nbrowserWorkerPolyFill(self);\n" + e }, du = function (e) { return e.toString().replace(/^function.+?{/, "").slice(0, -1) }, hu = cu(du((function () { var e = function () { this.init = function () { var e = {}; this.on = function (t, i) { e[t] || (e[t] = []), e[t] = e[t].concat(i) }, this.off = function (t, i) { var n; return !!e[t] && (n = e[t].indexOf(i), e[t] = e[t].slice(), e[t].splice(n, 1), n > -1) }, this.trigger = function (t) { var i, n, r, a; if (i = e[t]) if (2 === arguments.length) for (r = i.length, n = 0; n < r; ++n)i[n].call(this, arguments[1]); else { for (a = [], n = arguments.length, n = 1; n < arguments.length; ++n)a.push(arguments[n]); for (r = i.length, n = 0; n < r; ++n)i[n].apply(this, a) } }, this.dispose = function () { e = {} } } }; e.prototype.pipe = function (e) { return this.on("data", (function (t) { e.push(t) })), this.on("done", (function (t) { e.flush(t) })), this.on("partialdone", (function (t) { e.partialFlush(t) })), this.on("endedtimeline", (function (t) { e.endTimeline(t) })), this.on("reset", (function (t) { e.reset(t) })), e }, e.prototype.push = function (e) { this.trigger("data", e) }, e.prototype.flush = function (e) { this.trigger("done", e) }, e.prototype.partialFlush = function (e) { this.trigger("partialdone", e) }, e.prototype.endTimeline = function (e) { this.trigger("endedtimeline", e) }, e.prototype.reset = function (e) { this.trigger("reset", e) }; var t, n, r, a, s, o, u, l, c, d, h, p, f, m, g, A, v, y, _, b, T, x, S, E, C, w, k, F, I, D, P, L, O, B, R, M, N, U, j, H, V = e, q = Math.pow(2, 32), W = { getUint64: function (e) { var t, i = new DataView(e.buffer, e.byteOffset, e.byteLength); return i.getBigUint64 ? (t = i.getBigUint64(0)) < Number.MAX_SAFE_INTEGER ? Number(t) : t : i.getUint32(0) * q + i.getUint32(4) }, MAX_UINT32: q }, G = W.MAX_UINT32; !function () { var e; if (x = { avc1: [], avcC: [], btrt: [], dinf: [], dref: [], esds: [], ftyp: [], hdlr: [], mdat: [], mdhd: [], mdia: [], mfhd: [], minf: [], moof: [], moov: [], mp4a: [], mvex: [], mvhd: [], pasp: [], sdtp: [], smhd: [], stbl: [], stco: [], stsc: [], stsd: [], stsz: [], stts: [], styp: [], tfdt: [], tfhd: [], traf: [], trak: [], trun: [], trex: [], tkhd: [], vmhd: [] }, "undefined" != typeof Uint8Array) { for (e in x) x.hasOwnProperty(e) && (x[e] = [e.charCodeAt(0), e.charCodeAt(1), e.charCodeAt(2), e.charCodeAt(3)]); S = new Uint8Array(["i".charCodeAt(0), "s".charCodeAt(0), "o".charCodeAt(0), "m".charCodeAt(0)]), C = new Uint8Array(["a".charCodeAt(0), "v".charCodeAt(0), "c".charCodeAt(0), "1".charCodeAt(0)]), E = new Uint8Array([0, 0, 0, 1]), w = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 105, 100, 101, 111, 72, 97, 110, 100, 108, 101, 114, 0]), k = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 111, 117, 110, 100, 72, 97, 110, 100, 108, 101, 114, 0]), F = { video: w, audio: k }, P = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1]), D = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]), L = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]), O = L, B = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]), R = L, I = new Uint8Array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]) } }(), t = function (e) { var t, i, n = [], r = 0; for (t = 1; t < arguments.length; t++)n.push(arguments[t]); for (t = n.length; t--;)r += n[t].byteLength; for (i = new Uint8Array(r + 8), new DataView(i.buffer, i.byteOffset, i.byteLength).setUint32(0, i.byteLength), i.set(e, 4), t = 0, r = 8; t < n.length; t++)i.set(n[t], r), r += n[t].byteLength; return i }, n = function () { return t(x.dinf, t(x.dref, P)) }, r = function (e) { return t(x.esds, new Uint8Array([0, 0, 0, 0, 3, 25, 0, 0, 0, 4, 17, 64, 21, 0, 6, 0, 0, 0, 218, 192, 0, 0, 218, 192, 5, 2, e.audioobjecttype << 3 | e.samplingfrequencyindex >>> 1, e.samplingfrequencyindex << 7 | e.channelcount << 3, 6, 1, 2])) }, g = function (e) { return t(x.hdlr, F[e]) }, m = function (e) { var i = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 3, 0, 1, 95, 144, e.duration >>> 24 & 255, e.duration >>> 16 & 255, e.duration >>> 8 & 255, 255 & e.duration, 85, 196, 0, 0]); return e.samplerate && (i[12] = e.samplerate >>> 24 & 255, i[13] = e.samplerate >>> 16 & 255, i[14] = e.samplerate >>> 8 & 255, i[15] = 255 & e.samplerate), t(x.mdhd, i) }, f = function (e) { return t(x.mdia, m(e), g(e.type), o(e)) }, s = function (e) { return t(x.mfhd, new Uint8Array([0, 0, 0, 0, (4278190080 & e) >> 24, (16711680 & e) >> 16, (65280 & e) >> 8, 255 & e])) }, o = function (e) { return t(x.minf, "video" === e.type ? t(x.vmhd, I) : t(x.smhd, D), n(), v(e)) }, u = function (e, i) { for (var n = [], r = i.length; r--;)n[r] = _(i[r]); return t.apply(null, [x.moof, s(e)].concat(n)) }, l = function (e) { for (var i = e.length, n = []; i--;)n[i] = h(e[i]); return t.apply(null, [x.moov, d(4294967295)].concat(n).concat(c(e))) }, c = function (e) { for (var i = e.length, n = []; i--;)n[i] = b(e[i]); return t.apply(null, [x.mvex].concat(n)) }, d = function (e) { var i = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 1, 95, 144, (4278190080 & e) >> 24, (16711680 & e) >> 16, (65280 & e) >> 8, 255 & e, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255]); return t(x.mvhd, i) }, A = function (e) { var i, n, r = e.samples || [], a = new Uint8Array(4 + r.length); for (n = 0; n < r.length; n++)i = r[n].flags, a[n + 4] = i.dependsOn << 4 | i.isDependedOn << 2 | i.hasRedundancy; return t(x.sdtp, a) }, v = function (e) { return t(x.stbl, y(e), t(x.stts, R), t(x.stsc, O), t(x.stsz, B), t(x.stco, L)) }, y = function (e) { return t(x.stsd, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1]), "video" === e.type ? M(e) : N(e)) }, M = function (e) { var i, n, r = e.sps || [], a = e.pps || [], s = [], o = []; for (i = 0; i < r.length; i++)s.push((65280 & r[i].byteLength) >>> 8), s.push(255 & r[i].byteLength), s = s.concat(Array.prototype.slice.call(r[i])); for (i = 0; i < a.length; i++)o.push((65280 & a[i].byteLength) >>> 8), o.push(255 & a[i].byteLength), o = o.concat(Array.prototype.slice.call(a[i])); if (n = [x.avc1, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (65280 & e.width) >> 8, 255 & e.width, (65280 & e.height) >> 8, 255 & e.height, 0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 19, 118, 105, 100, 101, 111, 106, 115, 45, 99, 111, 110, 116, 114, 105, 98, 45, 104, 108, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 17, 17]), t(x.avcC, new Uint8Array([1, e.profileIdc, e.profileCompatibility, e.levelIdc, 255].concat([r.length], s, [a.length], o))), t(x.btrt, new Uint8Array([0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192]))], e.sarRatio) { var u = e.sarRatio[0], l = e.sarRatio[1]; n.push(t(x.pasp, new Uint8Array([(4278190080 & u) >> 24, (16711680 & u) >> 16, (65280 & u) >> 8, 255 & u, (4278190080 & l) >> 24, (16711680 & l) >> 16, (65280 & l) >> 8, 255 & l]))) } return t.apply(null, n) }, N = function (e) { return t(x.mp4a, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, (65280 & e.channelcount) >> 8, 255 & e.channelcount, (65280 & e.samplesize) >> 8, 255 & e.samplesize, 0, 0, 0, 0, (65280 & e.samplerate) >> 8, 255 & e.samplerate, 0, 0]), r(e)) }, p = function (e) { var i = new Uint8Array([0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, (4278190080 & e.id) >> 24, (16711680 & e.id) >> 16, (65280 & e.id) >> 8, 255 & e.id, 0, 0, 0, 0, (4278190080 & e.duration) >> 24, (16711680 & e.duration) >> 16, (65280 & e.duration) >> 8, 255 & e.duration, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, (65280 & e.width) >> 8, 255 & e.width, 0, 0, (65280 & e.height) >> 8, 255 & e.height, 0, 0]); return t(x.tkhd, i) }, _ = function (e) { var i, n, r, a, s, o; return i = t(x.tfhd, new Uint8Array([0, 0, 0, 58, (4278190080 & e.id) >> 24, (16711680 & e.id) >> 16, (65280 & e.id) >> 8, 255 & e.id, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])), s = Math.floor(e.baseMediaDecodeTime / G), o = Math.floor(e.baseMediaDecodeTime % G), n = t(x.tfdt, new Uint8Array([1, 0, 0, 0, s >>> 24 & 255, s >>> 16 & 255, s >>> 8 & 255, 255 & s, o >>> 24 & 255, o >>> 16 & 255, o >>> 8 & 255, 255 & o])), 92, "audio" === e.type ? (r = T(e, 92), t(x.traf, i, n, r)) : (a = A(e), r = T(e, a.length + 92), t(x.traf, i, n, r, a)) }, h = function (e) { return e.duration = e.duration || 4294967295, t(x.trak, p(e), f(e)) }, b = function (e) { var i = new Uint8Array([0, 0, 0, 0, (4278190080 & e.id) >> 24, (16711680 & e.id) >> 16, (65280 & e.id) >> 8, 255 & e.id, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1]); return "video" !== e.type && (i[i.length - 1] = 0), t(x.trex, i) }, H = function (e, t) { var i = 0, n = 0, r = 0, a = 0; return e.length && (void 0 !== e[0].duration && (i = 1), void 0 !== e[0].size && (n = 2), void 0 !== e[0].flags && (r = 4), void 0 !== e[0].compositionTimeOffset && (a = 8)), [0, 0, i | n | r | a, 1, (4278190080 & e.length) >>> 24, (16711680 & e.length) >>> 16, (65280 & e.length) >>> 8, 255 & e.length, (4278190080 & t) >>> 24, (16711680 & t) >>> 16, (65280 & t) >>> 8, 255 & t] }, j = function (e, i) { var n, r, a, s, o, u; for (i += 20 + 16 * (s = e.samples || []).length, a = H(s, i), (r = new Uint8Array(a.length + 16 * s.length)).set(a), n = a.length, u = 0; u < s.length; u++)o = s[u], r[n++] = (4278190080 & o.duration) >>> 24, r[n++] = (16711680 & o.duration) >>> 16, r[n++] = (65280 & o.duration) >>> 8, r[n++] = 255 & o.duration, r[n++] = (4278190080 & o.size) >>> 24, r[n++] = (16711680 & o.size) >>> 16, r[n++] = (65280 & o.size) >>> 8, r[n++] = 255 & o.size, r[n++] = o.flags.isLeading << 2 | o.flags.dependsOn, r[n++] = o.flags.isDependedOn << 6 | o.flags.hasRedundancy << 4 | o.flags.paddingValue << 1 | o.flags.isNonSyncSample, r[n++] = 61440 & o.flags.degradationPriority, r[n++] = 15 & o.flags.degradationPriority, r[n++] = (4278190080 & o.compositionTimeOffset) >>> 24, r[n++] = (16711680 & o.compositionTimeOffset) >>> 16, r[n++] = (65280 & o.compositionTimeOffset) >>> 8, r[n++] = 255 & o.compositionTimeOffset; return t(x.trun, r) }, U = function (e, i) { var n, r, a, s, o, u; for (i += 20 + 8 * (s = e.samples || []).length, a = H(s, i), (n = new Uint8Array(a.length + 8 * s.length)).set(a), r = a.length, u = 0; u < s.length; u++)o = s[u], n[r++] = (4278190080 & o.duration) >>> 24, n[r++] = (16711680 & o.duration) >>> 16, n[r++] = (65280 & o.duration) >>> 8, n[r++] = 255 & o.duration, n[r++] = (4278190080 & o.size) >>> 24, n[r++] = (16711680 & o.size) >>> 16, n[r++] = (65280 & o.size) >>> 8, n[r++] = 255 & o.size; return t(x.trun, n) }, T = function (e, t) { return "audio" === e.type ? U(e, t) : j(e, t) }; a = function () { return t(x.ftyp, S, E, S, C) }; var z, Q, X, $, K, Y, Z, J, ee = function (e) { return t(x.mdat, e) }, te = u, ie = function (e) { var t, i = a(), n = l(e); return (t = new Uint8Array(i.byteLength + n.byteLength)).set(i), t.set(n, i.byteLength), t }, ne = function (e, t) { var i = { size: 0, flags: { isLeading: 0, dependsOn: 1, isDependedOn: 0, hasRedundancy: 0, degradationPriority: 0, isNonSyncSample: 1 } }; return i.dataOffset = t, i.compositionTimeOffset = e.pts - e.dts, i.duration = e.duration, i.size = 4 * e.length, i.size += e.byteLength, e.keyFrame && (i.flags.dependsOn = 2, i.flags.isNonSyncSample = 0), i }, re = function (e) { var t, i, n = [], r = []; for (r.byteLength = 0, r.nalCount = 0, r.duration = 0, n.byteLength = 0, t = 0; t < e.length; t++)"access_unit_delimiter_rbsp" === (i = e[t]).nalUnitType ? (n.length && (n.duration = i.dts - n.dts, r.byteLength += n.byteLength, r.nalCount += n.length, r.duration += n.duration, r.push(n)), (n = [i]).byteLength = i.data.byteLength, n.pts = i.pts, n.dts = i.dts) : ("slice_layer_without_partitioning_rbsp_idr" === i.nalUnitType && (n.keyFrame = !0), n.duration = i.dts - n.dts, n.byteLength += i.data.byteLength, n.push(i)); return r.length && (!n.duration || n.duration <= 0) && (n.duration = r[r.length - 1].duration), r.byteLength += n.byteLength, r.nalCount += n.length, r.duration += n.duration, r.push(n), r }, ae = function (e) { var t, i, n = [], r = []; for (n.byteLength = 0, n.nalCount = 0, n.duration = 0, n.pts = e[0].pts, n.dts = e[0].dts, r.byteLength = 0, r.nalCount = 0, r.duration = 0, r.pts = e[0].pts, r.dts = e[0].dts, t = 0; t < e.length; t++)(i = e[t]).keyFrame ? (n.length && (r.push(n), r.byteLength += n.byteLength, r.nalCount += n.nalCount, r.duration += n.duration), (n = [i]).nalCount = i.length, n.byteLength = i.byteLength, n.pts = i.pts, n.dts = i.dts, n.duration = i.duration) : (n.duration += i.duration, n.nalCount += i.length, n.byteLength += i.byteLength, n.push(i)); return r.length && n.duration <= 0 && (n.duration = r[r.length - 1].duration), r.byteLength += n.byteLength, r.nalCount += n.nalCount, r.duration += n.duration, r.push(n), r }, se = function (e) { var t; return !e[0][0].keyFrame && e.length > 1 && (t = e.shift(), e.byteLength -= t.byteLength, e.nalCount -= t.nalCount, e[0][0].dts = t.dts, e[0][0].pts = t.pts, e[0][0].duration += t.duration), e }, oe = function (e, t) { var i, n, r, a, s, o = t || 0, u = []; for (i = 0; i < e.length; i++)for (a = e[i], n = 0; n < a.length; n++)s = a[n], o += (r = ne(s, o)).size, u.push(r); return u }, ue = function (e) { var t, i, n, r, a, s, o = 0, u = e.byteLength, l = e.nalCount, c = new Uint8Array(u + 4 * l), d = new DataView(c.buffer); for (t = 0; t < e.length; t++)for (r = e[t], i = 0; i < r.length; i++)for (a = r[i], n = 0; n < a.length; n++)s = a[n], d.setUint32(o, s.data.byteLength), o += 4, c.set(s.data, o), o += s.data.byteLength; return c }, le = [33, 16, 5, 32, 164, 27], ce = [33, 65, 108, 84, 1, 2, 4, 8, 168, 2, 4, 8, 17, 191, 252], de = function (e) { for (var t = []; e--;)t.push(0); return t }, he = function () { if (!z) { var e = { 96e3: [le, [227, 64], de(154), [56]], 88200: [le, [231], de(170), [56]], 64e3: [le, [248, 192], de(240), [56]], 48e3: [le, [255, 192], de(268), [55, 148, 128], de(54), [112]], 44100: [le, [255, 192], de(268), [55, 163, 128], de(84), [112]], 32e3: [le, [255, 192], de(268), [55, 234], de(226), [112]], 24e3: [le, [255, 192], de(268), [55, 255, 128], de(268), [111, 112], de(126), [224]], 16e3: [le, [255, 192], de(268), [55, 255, 128], de(268), [111, 255], de(269), [223, 108], de(195), [1, 192]], 12e3: [ce, de(268), [3, 127, 248], de(268), [6, 255, 240], de(268), [13, 255, 224], de(268), [27, 253, 128], de(259), [56]], 11025: [ce, de(268), [3, 127, 248], de(268), [6, 255, 240], de(268), [13, 255, 224], de(268), [27, 255, 192], de(268), [55, 175, 128], de(108), [112]], 8e3: [ce, de(268), [3, 121, 16], de(47), [7]] }; t = e, z = Object.keys(t).reduce((function (e, i) { return e[i] = new Uint8Array(t[i].reduce((function (e, t) { return e.concat(t) }), [])), e }), {}) } var t; return z }, pe = 9e4; Y = function (e, t) { return Q(K(e, t)) }, Z = function (e, t) { return X($(e), t) }, J = function (e, t, i) { return $(i ? e : e - t) }; var fe = pe, me = Q = function (e) { return e * pe }, ge = (X = function (e, t) { return e * t }, $ = function (e) { return e / pe }), Ae = (K = function (e, t) { return e / t }, Y), ve = Z, ye = J, _e = function (e, t, i, n) { var r, a, s, o, u, l = 0, c = 0, d = 0; if (t.length && (r = Ae(e.baseMediaDecodeTime, e.samplerate), a = Math.ceil(fe / (e.samplerate / 1024)), i && n && (l = r - Math.max(i, n), d = (c = Math.floor(l / a)) * a), !(c < 1 || d > fe / 2))) { for ((s = he()[e.samplerate]) || (s = t[0].data), o = 0; o < c; o++)u = t[0], t.splice(0, 0, { data: s, dts: u.dts - a, pts: u.pts - a }); return e.baseMediaDecodeTime -= Math.floor(ve(d, e.samplerate)), d } }, be = function (e, t, i) { return t.minSegmentDts >= i ? e : (t.minSegmentDts = 1 / 0, e.filter((function (e) { return e.dts >= i && (t.minSegmentDts = Math.min(t.minSegmentDts, e.dts), t.minSegmentPts = t.minSegmentDts, !0) }))) }, Te = function (e) { var t, i, n = []; for (t = 0; t < e.length; t++)i = e[t], n.push({ size: i.data.byteLength, duration: 1024 }); return n }, xe = function (e) { var t, i, n = 0, r = new Uint8Array(function (e) { var t, i = 0; for (t = 0; t < e.length; t++)i += e[t].data.byteLength; return i }(e)); for (t = 0; t < e.length; t++)i = e[t], r.set(i.data, n), n += i.data.byteLength; return r }, Se = fe, Ee = function (e) { delete e.minSegmentDts, delete e.maxSegmentDts, delete e.minSegmentPts, delete e.maxSegmentPts }, Ce = function (e, t) { var i, n = e.minSegmentDts; return t || (n -= e.timelineStartInfo.dts), i = e.timelineStartInfo.baseMediaDecodeTime, i += n, i = Math.max(0, i), "audio" === e.type && (i *= e.samplerate / Se, i = Math.floor(i)), i }, we = function (e, t) { "number" == typeof t.pts && (void 0 === e.timelineStartInfo.pts && (e.timelineStartInfo.pts = t.pts), void 0 === e.minSegmentPts ? e.minSegmentPts = t.pts : e.minSegmentPts = Math.min(e.minSegmentPts, t.pts), void 0 === e.maxSegmentPts ? e.maxSegmentPts = t.pts : e.maxSegmentPts = Math.max(e.maxSegmentPts, t.pts)), "number" == typeof t.dts && (void 0 === e.timelineStartInfo.dts && (e.timelineStartInfo.dts = t.dts), void 0 === e.minSegmentDts ? e.minSegmentDts = t.dts : e.minSegmentDts = Math.min(e.minSegmentDts, t.dts), void 0 === e.maxSegmentDts ? e.maxSegmentDts = t.dts : e.maxSegmentDts = Math.max(e.maxSegmentDts, t.dts)) }, ke = function (e) { for (var t = 0, i = { payloadType: -1, payloadSize: 0 }, n = 0, r = 0; t < e.byteLength && 128 !== e[t];) { for (; 255 === e[t];)n += 255, t++; for (n += e[t++]; 255 === e[t];)r += 255, t++; if (r += e[t++], !i.payload && 4 === n) { if ("GA94" === String.fromCharCode(e[t + 3], e[t + 4], e[t + 5], e[t + 6])) { i.payloadType = n, i.payloadSize = r, i.payload = e.subarray(t, t + r); break } i.payload = void 0 } t += r, n = 0, r = 0 } return i }, Fe = function (e) { return 181 !== e.payload[0] || 49 != (e.payload[1] << 8 | e.payload[2]) || "GA94" !== String.fromCharCode(e.payload[3], e.payload[4], e.payload[5], e.payload[6]) || 3 !== e.payload[7] ? null : e.payload.subarray(8, e.payload.length - 1) }, Ie = function (e, t) { var i, n, r, a, s = []; if (!(64 & t[0])) return s; for (n = 31 & t[0], i = 0; i < n; i++)a = { type: 3 & t[(r = 3 * i) + 2], pts: e }, 4 & t[r + 2] && (a.ccData = t[r + 3] << 8 | t[r + 4], s.push(a)); return s }, De = function (e) { for (var t, i, n = e.byteLength, r = [], a = 1; a < n - 2;)0 === e[a] && 0 === e[a + 1] && 3 === e[a + 2] ? (r.push(a + 2), a += 2) : a++; if (0 === r.length) return e; t = n - r.length, i = new Uint8Array(t); var s = 0; for (a = 0; a < t; s++, a++)s === r[0] && (s++, r.shift()), i[a] = e[s]; return i }, Pe = 4, Le = function e(t) { t = t || {}, e.prototype.init.call(this), this.parse708captions_ = "boolean" != typeof t.parse708captions || t.parse708captions, this.captionPackets_ = [], this.ccStreams_ = [new qe(0, 0), new qe(0, 1), new qe(1, 0), new qe(1, 1)], this.parse708captions_ && (this.cc708Stream_ = new Ne({ captionServices: t.captionServices })), this.reset(), this.ccStreams_.forEach((function (e) { e.on("data", this.trigger.bind(this, "data")), e.on("partialdone", this.trigger.bind(this, "partialdone")), e.on("done", this.trigger.bind(this, "done")) }), this), this.parse708captions_ && (this.cc708Stream_.on("data", this.trigger.bind(this, "data")), this.cc708Stream_.on("partialdone", this.trigger.bind(this, "partialdone")), this.cc708Stream_.on("done", this.trigger.bind(this, "done"))) }; (Le.prototype = new V).push = function (e) { var t, i, n; if ("sei_rbsp" === e.nalUnitType && (t = ke(e.escapedRBSP)).payload && t.payloadType === Pe && (i = Fe(t))) if (e.dts < this.latestDts_) this.ignoreNextEqualDts_ = !0; else { if (e.dts === this.latestDts_ && this.ignoreNextEqualDts_) return this.numSameDts_--, void (this.numSameDts_ || (this.ignoreNextEqualDts_ = !1)); n = Ie(e.pts, i), this.captionPackets_ = this.captionPackets_.concat(n), this.latestDts_ !== e.dts && (this.numSameDts_ = 0), this.numSameDts_++, this.latestDts_ = e.dts } }, Le.prototype.flushCCStreams = function (e) { this.ccStreams_.forEach((function (t) { return "flush" === e ? t.flush() : t.partialFlush() }), this) }, Le.prototype.flushStream = function (e) { this.captionPackets_.length ? (this.captionPackets_.forEach((function (e, t) { e.presortIndex = t })), this.captionPackets_.sort((function (e, t) { return e.pts === t.pts ? e.presortIndex - t.presortIndex : e.pts - t.pts })), this.captionPackets_.forEach((function (e) { e.type < 2 ? this.dispatchCea608Packet(e) : this.dispatchCea708Packet(e) }), this), this.captionPackets_.length = 0, this.flushCCStreams(e)) : this.flushCCStreams(e) }, Le.prototype.flush = function () { return this.flushStream("flush") }, Le.prototype.partialFlush = function () { return this.flushStream("partialFlush") }, Le.prototype.reset = function () { this.latestDts_ = null, this.ignoreNextEqualDts_ = !1, this.numSameDts_ = 0, this.activeCea608Channel_ = [null, null], this.ccStreams_.forEach((function (e) { e.reset() })) }, Le.prototype.dispatchCea608Packet = function (e) { this.setsTextOrXDSActive(e) ? this.activeCea608Channel_[e.type] = null : this.setsChannel1Active(e) ? this.activeCea608Channel_[e.type] = 0 : this.setsChannel2Active(e) && (this.activeCea608Channel_[e.type] = 1), null !== this.activeCea608Channel_[e.type] && this.ccStreams_[(e.type << 1) + this.activeCea608Channel_[e.type]].push(e) }, Le.prototype.setsChannel1Active = function (e) { return 4096 == (30720 & e.ccData) }, Le.prototype.setsChannel2Active = function (e) { return 6144 == (30720 & e.ccData) }, Le.prototype.setsTextOrXDSActive = function (e) { return 256 == (28928 & e.ccData) || 4138 == (30974 & e.ccData) || 6186 == (30974 & e.ccData) }, Le.prototype.dispatchCea708Packet = function (e) { this.parse708captions_ && this.cc708Stream_.push(e) }; var Oe = { 127: 9834, 4128: 32, 4129: 160, 4133: 8230, 4138: 352, 4140: 338, 4144: 9608, 4145: 8216, 4146: 8217, 4147: 8220, 4148: 8221, 4149: 8226, 4153: 8482, 4154: 353, 4156: 339, 4157: 8480, 4159: 376, 4214: 8539, 4215: 8540, 4216: 8541, 4217: 8542, 4218: 9168, 4219: 9124, 4220: 9123, 4221: 9135, 4222: 9126, 4223: 9121, 4256: 12600 }, Be = function (e) { return 32 <= e && e <= 127 || 160 <= e && e <= 255 }, Re = function (e) { this.windowNum = e, this.reset() }; Re.prototype.reset = function () { this.clearText(), this.pendingNewLine = !1, this.winAttr = {}, this.penAttr = {}, this.penLoc = {}, this.penColor = {}, this.visible = 0, this.rowLock = 0, this.columnLock = 0, this.priority = 0, this.relativePositioning = 0, this.anchorVertical = 0, this.anchorHorizontal = 0, this.anchorPoint = 0, this.rowCount = 1, this.virtualRowCount = this.rowCount + 1, this.columnCount = 41, this.windowStyle = 0, this.penStyle = 0 }, Re.prototype.getText = function () { return this.rows.join("\n") }, Re.prototype.clearText = function () { this.rows = [""], this.rowIdx = 0 }, Re.prototype.newLine = function (e) { for (this.rows.length >= this.virtualRowCount && "function" == typeof this.beforeRowOverflow && this.beforeRowOverflow(e), this.rows.length > 0 && (this.rows.push(""), this.rowIdx++); this.rows.length > this.virtualRowCount;)this.rows.shift(), this.rowIdx-- }, Re.prototype.isEmpty = function () { return 0 === this.rows.length || 1 === this.rows.length && "" === this.rows[0] }, Re.prototype.addText = function (e) { this.rows[this.rowIdx] += e }, Re.prototype.backspace = function () { if (!this.isEmpty()) { var e = this.rows[this.rowIdx]; this.rows[this.rowIdx] = e.substr(0, e.length - 1) } }; var Me = function (e, t, i) { this.serviceNum = e, this.text = "", this.currentWindow = new Re(-1), this.windows = [], this.stream = i, "string" == typeof t && this.createTextDecoder(t) }; Me.prototype.init = function (e, t) { this.startPts = e; for (var i = 0; i < 8; i++)this.windows[i] = new Re(i), "function" == typeof t && (this.windows[i].beforeRowOverflow = t) }, Me.prototype.setCurrentWindow = function (e) { this.currentWindow = this.windows[e] }, Me.prototype.createTextDecoder = function (e) { if ("undefined" == typeof TextDecoder) this.stream.trigger("log", { level: "warn", message: "The `encoding` option is unsupported without TextDecoder support" }); else try { this.textDecoder_ = new TextDecoder(e) } catch (t) { this.stream.trigger("log", { level: "warn", message: "TextDecoder could not be created with " + e + " encoding. " + t }) } }; var Ne = function e(t) { t = t || {}, e.prototype.init.call(this); var i, n = this, r = t.captionServices || {}, a = {}; Object.keys(r).forEach((function (e) { i = r[e], /^SERVICE/.test(e) && (a[e] = i.encoding) })), this.serviceEncodings = a, this.current708Packet = null, this.services = {}, this.push = function (e) { 3 === e.type ? (n.new708Packet(), n.add708Bytes(e)) : (null === n.current708Packet && n.new708Packet(), n.add708Bytes(e)) } }; Ne.prototype = new V, Ne.prototype.new708Packet = function () { null !== this.current708Packet && this.push708Packet(), this.current708Packet = { data: [], ptsVals: [] } }, Ne.prototype.add708Bytes = function (e) { var t = e.ccData, i = t >>> 8, n = 255 & t; this.current708Packet.ptsVals.push(e.pts), this.current708Packet.data.push(i), this.current708Packet.data.push(n) }, Ne.prototype.push708Packet = function () { var e = this.current708Packet, t = e.data, i = null, n = null, r = 0, a = t[r++]; for (e.seq = a >> 6, e.sizeCode = 63 & a; r < t.length; r++)n = 31 & (a = t[r++]), 7 === (i = a >> 5) && n > 0 && (i = a = t[r++]), this.pushServiceBlock(i, r, n), n > 0 && (r += n - 1) }, Ne.prototype.pushServiceBlock = function (e, t, i) { var n, r = t, a = this.current708Packet.data, s = this.services[e]; for (s || (s = this.initService(e, r)); r < t + i && r < a.length; r++)n = a[r], Be(n) ? r = this.handleText(r, s) : 24 === n ? r = this.multiByteCharacter(r, s) : 16 === n ? r = this.extendedCommands(r, s) : 128 <= n && n <= 135 ? r = this.setCurrentWindow(r, s) : 152 <= n && n <= 159 ? r = this.defineWindow(r, s) : 136 === n ? r = this.clearWindows(r, s) : 140 === n ? r = this.deleteWindows(r, s) : 137 === n ? r = this.displayWindows(r, s) : 138 === n ? r = this.hideWindows(r, s) : 139 === n ? r = this.toggleWindows(r, s) : 151 === n ? r = this.setWindowAttributes(r, s) : 144 === n ? r = this.setPenAttributes(r, s) : 145 === n ? r = this.setPenColor(r, s) : 146 === n ? r = this.setPenLocation(r, s) : 143 === n ? s = this.reset(r, s) : 8 === n ? s.currentWindow.backspace() : 12 === n ? s.currentWindow.clearText() : 13 === n ? s.currentWindow.pendingNewLine = !0 : 14 === n ? s.currentWindow.clearText() : 141 === n && r++ }, Ne.prototype.extendedCommands = function (e, t) { var i = this.current708Packet.data[++e]; return Be(i) && (e = this.handleText(e, t, { isExtended: !0 })), e }, Ne.prototype.getPts = function (e) { return this.current708Packet.ptsVals[Math.floor(e / 2)] }, Ne.prototype.initService = function (e, t) { var i, n, r = this; return (i = "SERVICE" + e) in this.serviceEncodings && (n = this.serviceEncodings[i]), this.services[e] = new Me(e, n, r), this.services[e].init(this.getPts(t), (function (t) { r.flushDisplayed(t, r.services[e]) })), this.services[e] }, Ne.prototype.handleText = function (e, t, i) { var n, r, a, s, o = i && i.isExtended, u = i && i.isMultiByte, l = this.current708Packet.data, c = o ? 4096 : 0, d = l[e], h = l[e + 1], p = t.currentWindow; return t.textDecoder_ && !o ? (u ? (r = [d, h], e++) : r = [d], n = t.textDecoder_.decode(new Uint8Array(r))) : (s = Oe[a = c | d] || a, n = 4096 & a && a === s ? "" : String.fromCharCode(s)), p.pendingNewLine && !p.isEmpty() && p.newLine(this.getPts(e)), p.pendingNewLine = !1, p.addText(n), e }, Ne.prototype.multiByteCharacter = function (e, t) { var i = this.current708Packet.data, n = i[e + 1], r = i[e + 2]; return Be(n) && Be(r) && (e = this.handleText(++e, t, { isMultiByte: !0 })), e }, Ne.prototype.setCurrentWindow = function (e, t) { var i = 7 & this.current708Packet.data[e]; return t.setCurrentWindow(i), e }, Ne.prototype.defineWindow = function (e, t) { var i = this.current708Packet.data, n = i[e], r = 7 & n; t.setCurrentWindow(r); var a = t.currentWindow; return n = i[++e], a.visible = (32 & n) >> 5, a.rowLock = (16 & n) >> 4, a.columnLock = (8 & n) >> 3, a.priority = 7 & n, n = i[++e], a.relativePositioning = (128 & n) >> 7, a.anchorVertical = 127 & n, n = i[++e], a.anchorHorizontal = n, n = i[++e], a.anchorPoint = (240 & n) >> 4, a.rowCount = 15 & n, n = i[++e], a.columnCount = 63 & n, n = i[++e], a.windowStyle = (56 & n) >> 3, a.penStyle = 7 & n, a.virtualRowCount = a.rowCount + 1, e }, Ne.prototype.setWindowAttributes = function (e, t) { var i = this.current708Packet.data, n = i[e], r = t.currentWindow.winAttr; return n = i[++e], r.fillOpacity = (192 & n) >> 6, r.fillRed = (48 & n) >> 4, r.fillGreen = (12 & n) >> 2, r.fillBlue = 3 & n, n = i[++e], r.borderType = (192 & n) >> 6, r.borderRed = (48 & n) >> 4, r.borderGreen = (12 & n) >> 2, r.borderBlue = 3 & n, n = i[++e], r.borderType += (128 & n) >> 5, r.wordWrap = (64 & n) >> 6, r.printDirection = (48 & n) >> 4, r.scrollDirection = (12 & n) >> 2, r.justify = 3 & n, n = i[++e], r.effectSpeed = (240 & n) >> 4, r.effectDirection = (12 & n) >> 2, r.displayEffect = 3 & n, e }, Ne.prototype.flushDisplayed = function (e, t) { for (var i = [], n = 0; n < 8; n++)t.windows[n].visible && !t.windows[n].isEmpty() && i.push(t.windows[n].getText()); t.endPts = e, t.text = i.join("\n\n"), this.pushCaption(t), t.startPts = e }, Ne.prototype.pushCaption = function (e) { "" !== e.text && (this.trigger("data", { startPts: e.startPts, endPts: e.endPts, text: e.text, stream: "cc708_" + e.serviceNum }), e.text = "", e.startPts = e.endPts) }, Ne.prototype.displayWindows = function (e, t) { var i = this.current708Packet.data[++e], n = this.getPts(e); this.flushDisplayed(n, t); for (var r = 0; r < 8; r++)i & 1 << r && (t.windows[r].visible = 1); return e }, Ne.prototype.hideWindows = function (e, t) { var i = this.current708Packet.data[++e], n = this.getPts(e); this.flushDisplayed(n, t); for (var r = 0; r < 8; r++)i & 1 << r && (t.windows[r].visible = 0); return e }, Ne.prototype.toggleWindows = function (e, t) { var i = this.current708Packet.data[++e], n = this.getPts(e); this.flushDisplayed(n, t); for (var r = 0; r < 8; r++)i & 1 << r && (t.windows[r].visible ^= 1); return e }, Ne.prototype.clearWindows = function (e, t) { var i = this.current708Packet.data[++e], n = this.getPts(e); this.flushDisplayed(n, t); for (var r = 0; r < 8; r++)i & 1 << r && t.windows[r].clearText(); return e }, Ne.prototype.deleteWindows = function (e, t) { var i = this.current708Packet.data[++e], n = this.getPts(e); this.flushDisplayed(n, t); for (var r = 0; r < 8; r++)i & 1 << r && t.windows[r].reset(); return e }, Ne.prototype.setPenAttributes = function (e, t) { var i = this.current708Packet.data, n = i[e], r = t.currentWindow.penAttr; return n = i[++e], r.textTag = (240 & n) >> 4, r.offset = (12 & n) >> 2, r.penSize = 3 & n, n = i[++e], r.italics = (128 & n) >> 7, r.underline = (64 & n) >> 6, r.edgeType = (56 & n) >> 3, r.fontStyle = 7 & n, e }, Ne.prototype.setPenColor = function (e, t) { var i = this.current708Packet.data, n = i[e], r = t.currentWindow.penColor; return n = i[++e], r.fgOpacity = (192 & n) >> 6, r.fgRed = (48 & n) >> 4, r.fgGreen = (12 & n) >> 2, r.fgBlue = 3 & n, n = i[++e], r.bgOpacity = (192 & n) >> 6, r.bgRed = (48 & n) >> 4, r.bgGreen = (12 & n) >> 2, r.bgBlue = 3 & n, n = i[++e], r.edgeRed = (48 & n) >> 4, r.edgeGreen = (12 & n) >> 2, r.edgeBlue = 3 & n, e }, Ne.prototype.setPenLocation = function (e, t) { var i = this.current708Packet.data, n = i[e], r = t.currentWindow.penLoc; return t.currentWindow.pendingNewLine = !0, n = i[++e], r.row = 15 & n, n = i[++e], r.column = 63 & n, e }, Ne.prototype.reset = function (e, t) { var i = this.getPts(e); return this.flushDisplayed(i, t), this.initService(t.serviceNum, e) }; var Ue = { 42: 225, 92: 233, 94: 237, 95: 243, 96: 250, 123: 231, 124: 247, 125: 209, 126: 241, 127: 9608, 304: 174, 305: 176, 306: 189, 307: 191, 308: 8482, 309: 162, 310: 163, 311: 9834, 312: 224, 313: 160, 314: 232, 315: 226, 316: 234, 317: 238, 318: 244, 319: 251, 544: 193, 545: 201, 546: 211, 547: 218, 548: 220, 549: 252, 550: 8216, 551: 161, 552: 42, 553: 39, 554: 8212, 555: 169, 556: 8480, 557: 8226, 558: 8220, 559: 8221, 560: 192, 561: 194, 562: 199, 563: 200, 564: 202, 565: 203, 566: 235, 567: 206, 568: 207, 569: 239, 570: 212, 571: 217, 572: 249, 573: 219, 574: 171, 575: 187, 800: 195, 801: 227, 802: 205, 803: 204, 804: 236, 805: 210, 806: 242, 807: 213, 808: 245, 809: 123, 810: 125, 811: 92, 812: 94, 813: 95, 814: 124, 815: 126, 816: 196, 817: 228, 818: 214, 819: 246, 820: 223, 821: 165, 822: 164, 823: 9474, 824: 197, 825: 229, 826: 216, 827: 248, 828: 9484, 829: 9488, 830: 9492, 831: 9496 }, je = function (e) { return null === e ? "" : (e = Ue[e] || e, String.fromCharCode(e)) }, He = [4352, 4384, 4608, 4640, 5376, 5408, 5632, 5664, 5888, 5920, 4096, 4864, 4896, 5120, 5152], Ve = function () { for (var e = [], t = 15; t--;)e.push(""); return e }, qe = function e(t, i) { e.prototype.init.call(this), this.field_ = t || 0, this.dataChannel_ = i || 0, this.name_ = "CC" + (1 + (this.field_ << 1 | this.dataChannel_)), this.setConstants(), this.reset(), this.push = function (e) { var t, i, n, r, a; if ((t = 32639 & e.ccData) !== this.lastControlCode_) { if (4096 == (61440 & t) ? this.lastControlCode_ = t : t !== this.PADDING_ && (this.lastControlCode_ = null), n = t >>> 8, r = 255 & t, t !== this.PADDING_) if (t === this.RESUME_CAPTION_LOADING_) this.mode_ = "popOn"; else if (t === this.END_OF_CAPTION_) this.mode_ = "popOn", this.clearFormatting(e.pts), this.flushDisplayed(e.pts), i = this.displayed_, this.displayed_ = this.nonDisplayed_, this.nonDisplayed_ = i, this.startPts_ = e.pts; else if (t === this.ROLL_UP_2_ROWS_) this.rollUpRows_ = 2, this.setRollUp(e.pts); else if (t === this.ROLL_UP_3_ROWS_) this.rollUpRows_ = 3, this.setRollUp(e.pts); else if (t === this.ROLL_UP_4_ROWS_) this.rollUpRows_ = 4, this.setRollUp(e.pts); else if (t === this.CARRIAGE_RETURN_) this.clearFormatting(e.pts), this.flushDisplayed(e.pts), this.shiftRowsUp_(), this.startPts_ = e.pts; else if (t === this.BACKSPACE_) "popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[this.row_] = this.displayed_[this.row_].slice(0, -1); else if (t === this.ERASE_DISPLAYED_MEMORY_) this.flushDisplayed(e.pts), this.displayed_ = Ve(); else if (t === this.ERASE_NON_DISPLAYED_MEMORY_) this.nonDisplayed_ = Ve(); else if (t === this.RESUME_DIRECT_CAPTIONING_) "paintOn" !== this.mode_ && (this.flushDisplayed(e.pts), this.displayed_ = Ve()), this.mode_ = "paintOn", this.startPts_ = e.pts; else if (this.isSpecialCharacter(n, r)) a = je((n = (3 & n) << 8) | r), this[this.mode_](e.pts, a), this.column_++; else if (this.isExtCharacter(n, r)) "popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[this.row_] = this.displayed_[this.row_].slice(0, -1), a = je((n = (3 & n) << 8) | r), this[this.mode_](e.pts, a), this.column_++; else if (this.isMidRowCode(n, r)) this.clearFormatting(e.pts), this[this.mode_](e.pts, " "), this.column_++, 14 == (14 & r) && this.addFormatting(e.pts, ["i"]), 1 == (1 & r) && this.addFormatting(e.pts, ["u"]); else if (this.isOffsetControlCode(n, r)) this.column_ += 3 & r; else if (this.isPAC(n, r)) { var s = He.indexOf(7968 & t); "rollUp" === this.mode_ && (s - this.rollUpRows_ + 1 < 0 && (s = this.rollUpRows_ - 1), this.setRollUp(e.pts, s)), s !== this.row_ && (this.clearFormatting(e.pts), this.row_ = s), 1 & r && -1 === this.formatting_.indexOf("u") && this.addFormatting(e.pts, ["u"]), 16 == (16 & t) && (this.column_ = 4 * ((14 & t) >> 1)), this.isColorPAC(r) && 14 == (14 & r) && this.addFormatting(e.pts, ["i"]) } else this.isNormalChar(n) && (0 === r && (r = null), a = je(n), a += je(r), this[this.mode_](e.pts, a), this.column_ += a.length) } else this.lastControlCode_ = null } }; qe.prototype = new V, qe.prototype.flushDisplayed = function (e) { var t = this.displayed_.map((function (e, t) { try { return e.trim() } catch (e) { return this.trigger("log", { level: "warn", message: "Skipping a malformed 608 caption at index " + t + "." }), "" } }), this).join("\n").replace(/^\n+|\n+$/g, ""); t.length && this.trigger("data", { startPts: this.startPts_, endPts: e, text: t, stream: this.name_ }) }, qe.prototype.reset = function () { this.mode_ = "popOn", this.topRow_ = 0, this.startPts_ = 0, this.displayed_ = Ve(), this.nonDisplayed_ = Ve(), this.lastControlCode_ = null, this.column_ = 0, this.row_ = 14, this.rollUpRows_ = 2, this.formatting_ = [] }, qe.prototype.setConstants = function () { 0 === this.dataChannel_ ? (this.BASE_ = 16, this.EXT_ = 17, this.CONTROL_ = (20 | this.field_) << 8, this.OFFSET_ = 23) : 1 === this.dataChannel_ && (this.BASE_ = 24, this.EXT_ = 25, this.CONTROL_ = (28 | this.field_) << 8, this.OFFSET_ = 31), this.PADDING_ = 0, this.RESUME_CAPTION_LOADING_ = 32 | this.CONTROL_, this.END_OF_CAPTION_ = 47 | this.CONTROL_, this.ROLL_UP_2_ROWS_ = 37 | this.CONTROL_, this.ROLL_UP_3_ROWS_ = 38 | this.CONTROL_, this.ROLL_UP_4_ROWS_ = 39 | this.CONTROL_, this.CARRIAGE_RETURN_ = 45 | this.CONTROL_, this.RESUME_DIRECT_CAPTIONING_ = 41 | this.CONTROL_, this.BACKSPACE_ = 33 | this.CONTROL_, this.ERASE_DISPLAYED_MEMORY_ = 44 | this.CONTROL_, this.ERASE_NON_DISPLAYED_MEMORY_ = 46 | this.CONTROL_ }, qe.prototype.isSpecialCharacter = function (e, t) { return e === this.EXT_ && t >= 48 && t <= 63 }, qe.prototype.isExtCharacter = function (e, t) { return (e === this.EXT_ + 1 || e === this.EXT_ + 2) && t >= 32 && t <= 63 }, qe.prototype.isMidRowCode = function (e, t) { return e === this.EXT_ && t >= 32 && t <= 47 }, qe.prototype.isOffsetControlCode = function (e, t) { return e === this.OFFSET_ && t >= 33 && t <= 35 }, qe.prototype.isPAC = function (e, t) { return e >= this.BASE_ && e < this.BASE_ + 8 && t >= 64 && t <= 127 }, qe.prototype.isColorPAC = function (e) { return e >= 64 && e <= 79 || e >= 96 && e <= 127 }, qe.prototype.isNormalChar = function (e) { return e >= 32 && e <= 127 }, qe.prototype.setRollUp = function (e, t) { if ("rollUp" !== this.mode_ && (this.row_ = 14, this.mode_ = "rollUp", this.flushDisplayed(e), this.nonDisplayed_ = Ve(), this.displayed_ = Ve()), void 0 !== t && t !== this.row_) for (var i = 0; i < this.rollUpRows_; i++)this.displayed_[t - i] = this.displayed_[this.row_ - i], this.displayed_[this.row_ - i] = ""; void 0 === t && (t = this.row_), this.topRow_ = t - this.rollUpRows_ + 1 }, qe.prototype.addFormatting = function (e, t) { this.formatting_ = this.formatting_.concat(t); var i = t.reduce((function (e, t) { return e + "<" + t + ">" }), ""); this[this.mode_](e, i) }, qe.prototype.clearFormatting = function (e) { if (this.formatting_.length) { var t = this.formatting_.reverse().reduce((function (e, t) { return e + "</" + t + ">" }), ""); this.formatting_ = [], this[this.mode_](e, t) } }, qe.prototype.popOn = function (e, t) { var i = this.nonDisplayed_[this.row_]; i += t, this.nonDisplayed_[this.row_] = i }, qe.prototype.rollUp = function (e, t) { var i = this.displayed_[this.row_]; i += t, this.displayed_[this.row_] = i }, qe.prototype.shiftRowsUp_ = function () { var e; for (e = 0; e < this.topRow_; e++)this.displayed_[e] = ""; for (e = this.row_ + 1; e < 15; e++)this.displayed_[e] = ""; for (e = this.topRow_; e < this.row_; e++)this.displayed_[e] = this.displayed_[e + 1]; this.displayed_[this.row_] = "" }, qe.prototype.paintOn = function (e, t) { var i = this.displayed_[this.row_]; i += t, this.displayed_[this.row_] = i }; var We = { CaptionStream: Le, Cea608Stream: qe, Cea708Stream: Ne }, Ge = { H264_STREAM_TYPE: 27, ADTS_STREAM_TYPE: 15, METADATA_STREAM_TYPE: 21 }, ze = "shared", Qe = function (e, t) { var i = 1; for (e > t && (i = -1); Math.abs(t - e) > 4294967296;)e += 8589934592 * i; return e }, Xe = function e(t) { var i, n; e.prototype.init.call(this), this.type_ = t || ze, this.push = function (e) { this.type_ !== ze && e.type !== this.type_ || (void 0 === n && (n = e.dts), e.dts = Qe(e.dts, n), e.pts = Qe(e.pts, n), i = e.dts, this.trigger("data", e)) }, this.flush = function () { n = i, this.trigger("done") }, this.endTimeline = function () { this.flush(), this.trigger("endedtimeline") }, this.discontinuity = function () { n = void 0, i = void 0 }, this.reset = function () { this.discontinuity(), this.trigger("reset") } }; Xe.prototype = new V; var $e, Ke = Xe, Ye = Qe, Ze = function (e, t, i) { var n, r = ""; for (n = t; n < i; n++)r += "%" + ("00" + e[n].toString(16)).slice(-2); return r }, Je = function (e, t, i) { return decodeURIComponent(Ze(e, t, i)) }, et = function (e) { return e[0] << 21 | e[1] << 14 | e[2] << 7 | e[3] }, tt = { TXXX: function (e) { var t; if (3 === e.data[0]) { for (t = 1; t < e.data.length; t++)if (0 === e.data[t]) { e.description = Je(e.data, 1, t), e.value = Je(e.data, t + 1, e.data.length).replace(/\0*$/, ""); break } e.data = e.value } }, WXXX: function (e) { var t; if (3 === e.data[0]) for (t = 1; t < e.data.length; t++)if (0 === e.data[t]) { e.description = Je(e.data, 1, t), e.url = Je(e.data, t + 1, e.data.length); break } }, PRIV: function (e) { var t, i; for (t = 0; t < e.data.length; t++)if (0 === e.data[t]) { e.owner = (i = e.data, unescape(Ze(i, 0, t))); break } e.privateData = e.data.subarray(t + 1), e.data = e.privateData } }; $e = function (e) { var t, i = { descriptor: e && e.descriptor }, n = 0, r = [], a = 0; if ($e.prototype.init.call(this), this.dispatchType = Ge.METADATA_STREAM_TYPE.toString(16), i.descriptor) for (t = 0; t < i.descriptor.length; t++)this.dispatchType += ("00" + i.descriptor[t].toString(16)).slice(-2); this.push = function (e) { var t, i, s, o, u; if ("timed-metadata" === e.type) if (e.dataAlignmentIndicator && (a = 0, r.length = 0), 0 === r.length && (e.data.length < 10 || e.data[0] !== "I".charCodeAt(0) || e.data[1] !== "D".charCodeAt(0) || e.data[2] !== "3".charCodeAt(0))) this.trigger("log", { level: "warn", message: "Skipping unrecognized metadata packet" }); else if (r.push(e), a += e.data.byteLength, 1 === r.length && (n = et(e.data.subarray(6, 10)), n += 10), !(a < n)) { for (t = { data: new Uint8Array(n), frames: [], pts: r[0].pts, dts: r[0].dts }, u = 0; u < n;)t.data.set(r[0].data.subarray(0, n - u), u), u += r[0].data.byteLength, a -= r[0].data.byteLength, r.shift(); i = 10, 64 & t.data[5] && (i += 4, i += et(t.data.subarray(10, 14)), n -= et(t.data.subarray(16, 20))); do { if ((s = et(t.data.subarray(i + 4, i + 8))) < 1) return void this.trigger("log", { level: "warn", message: "Malformed ID3 frame encountered. Skipping metadata parsing." }); if ((o = { id: String.fromCharCode(t.data[i], t.data[i + 1], t.data[i + 2], t.data[i + 3]), data: t.data.subarray(i + 10, i + s + 10) }).key = o.id, tt[o.id] && (tt[o.id](o), "com.apple.streaming.transportStreamTimestamp" === o.owner)) { var l = o.data, c = (1 & l[3]) << 30 | l[4] << 22 | l[5] << 14 | l[6] << 6 | l[7] >>> 2; c *= 4, c += 3 & l[7], o.timeStamp = c, void 0 === t.pts && void 0 === t.dts && (t.pts = o.timeStamp, t.dts = o.timeStamp), this.trigger("timestamp", o) } t.frames.push(o), i += 10, i += s } while (i < n); this.trigger("data", t) } } }, $e.prototype = new V; var it, nt, rt, at = $e, st = Ke, ot = 188; (it = function () { var e = new Uint8Array(ot), t = 0; it.prototype.init.call(this), this.push = function (i) { var n, r = 0, a = ot; for (t ? ((n = new Uint8Array(i.byteLength + t)).set(e.subarray(0, t)), n.set(i, t), t = 0) : n = i; a < n.byteLength;)71 !== n[r] || 71 !== n[a] ? (r++, a++) : (this.trigger("data", n.subarray(r, a)), r += ot, a += ot); r < n.byteLength && (e.set(n.subarray(r), 0), t = n.byteLength - r) }, this.flush = function () { t === ot && 71 === e[0] && (this.trigger("data", e), t = 0), this.trigger("done") }, this.endTimeline = function () { this.flush(), this.trigger("endedtimeline") }, this.reset = function () { t = 0, this.trigger("reset") } }).prototype = new V, nt = function () { var e, t, i, n; nt.prototype.init.call(this), n = this, this.packetsWaitingForPmt = [], this.programMapTable = void 0, e = function (e, n) { var r = 0; n.payloadUnitStartIndicator && (r += e[r] + 1), "pat" === n.type ? t(e.subarray(r), n) : i(e.subarray(r), n) }, t = function (e, t) { t.section_number = e[7], t.last_section_number = e[8], n.pmtPid = (31 & e[10]) << 8 | e[11], t.pmtPid = n.pmtPid }, i = function (e, t) { var i, r; if (1 & e[5]) { for (n.programMapTable = { video: null, audio: null, "timed-metadata": {} }, i = 3 + ((15 & e[1]) << 8 | e[2]) - 4, r = 12 + ((15 & e[10]) << 8 | e[11]); r < i;) { var a = e[r], s = (31 & e[r + 1]) << 8 | e[r + 2]; a === Ge.H264_STREAM_TYPE && null === n.programMapTable.video ? n.programMapTable.video = s : a === Ge.ADTS_STREAM_TYPE && null === n.programMapTable.audio ? n.programMapTable.audio = s : a === Ge.METADATA_STREAM_TYPE && (n.programMapTable["timed-metadata"][s] = a), r += 5 + ((15 & e[r + 3]) << 8 | e[r + 4]) } t.programMapTable = n.programMapTable } }, this.push = function (t) { var i = {}, n = 4; if (i.payloadUnitStartIndicator = !!(64 & t[1]), i.pid = 31 & t[1], i.pid <<= 8, i.pid |= t[2], (48 & t[3]) >>> 4 > 1 && (n += t[n] + 1), 0 === i.pid) i.type = "pat", e(t.subarray(n), i), this.trigger("data", i); else if (i.pid === this.pmtPid) for (i.type = "pmt", e(t.subarray(n), i), this.trigger("data", i); this.packetsWaitingForPmt.length;)this.processPes_.apply(this, this.packetsWaitingForPmt.shift()); else void 0 === this.programMapTable ? this.packetsWaitingForPmt.push([t, n, i]) : this.processPes_(t, n, i) }, this.processPes_ = function (e, t, i) { i.pid === this.programMapTable.video ? i.streamType = Ge.H264_STREAM_TYPE : i.pid === this.programMapTable.audio ? i.streamType = Ge.ADTS_STREAM_TYPE : i.streamType = this.programMapTable["timed-metadata"][i.pid], i.type = "pes", i.data = e.subarray(t), this.trigger("data", i) } }, nt.prototype = new V, nt.STREAM_TYPES = { h264: 27, adts: 15 }, rt = function () { var e, t = this, i = !1, n = { data: [], size: 0 }, r = { data: [], size: 0 }, a = { data: [], size: 0 }, s = function (e, i, n) { var r, a, s = new Uint8Array(e.size), o = { type: i }, u = 0, l = 0; if (e.data.length && !(e.size < 9)) { for (o.trackId = e.data[0].pid, u = 0; u < e.data.length; u++)a = e.data[u], s.set(a.data, l), l += a.data.byteLength; var c, d, h, p; d = o, p = (c = s)[0] << 16 | c[1] << 8 | c[2], d.data = new Uint8Array, 1 === p && (d.packetLength = 6 + (c[4] << 8 | c[5]), d.dataAlignmentIndicator = 0 != (4 & c[6]), 192 & (h = c[7]) && (d.pts = (14 & c[9]) << 27 | (255 & c[10]) << 20 | (254 & c[11]) << 12 | (255 & c[12]) << 5 | (254 & c[13]) >>> 3, d.pts *= 4, d.pts += (6 & c[13]) >>> 1, d.dts = d.pts, 64 & h && (d.dts = (14 & c[14]) << 27 | (255 & c[15]) << 20 | (254 & c[16]) << 12 | (255 & c[17]) << 5 | (254 & c[18]) >>> 3, d.dts *= 4, d.dts += (6 & c[18]) >>> 1)), d.data = c.subarray(9 + c[8])), r = "video" === i || o.packetLength <= e.size, (n || r) && (e.size = 0, e.data.length = 0), r && t.trigger("data", o) } }; rt.prototype.init.call(this), this.push = function (o) { ({ pat: function () { }, pes: function () { var e, t; switch (o.streamType) { case Ge.H264_STREAM_TYPE: e = n, t = "video"; break; case Ge.ADTS_STREAM_TYPE: e = r, t = "audio"; break; case Ge.METADATA_STREAM_TYPE: e = a, t = "timed-metadata"; break; default: return }o.payloadUnitStartIndicator && s(e, t, !0), e.data.push(o), e.size += o.data.byteLength }, pmt: function () { var n = { type: "metadata", tracks: [] }; null !== (e = o.programMapTable).video && n.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +e.video, codec: "avc", type: "video" }), null !== e.audio && n.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +e.audio, codec: "adts", type: "audio" }), i = !0, t.trigger("data", n) } })[o.type]() }, this.reset = function () { n.size = 0, n.data.length = 0, r.size = 0, r.data.length = 0, this.trigger("reset") }, this.flushStreams_ = function () { s(n, "video"), s(r, "audio"), s(a, "timed-metadata") }, this.flush = function () { if (!i && e) { var n = { type: "metadata", tracks: [] }; null !== e.video && n.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +e.video, codec: "avc", type: "video" }), null !== e.audio && n.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +e.audio, codec: "adts", type: "audio" }), t.trigger("data", n) } i = !1, this.flushStreams_(), this.trigger("done") } }, rt.prototype = new V; var ut = { PAT_PID: 0, MP2T_PACKET_LENGTH: ot, TransportPacketStream: it, TransportParseStream: nt, ElementaryStream: rt, TimestampRolloverStream: st, CaptionStream: We.CaptionStream, Cea608Stream: We.Cea608Stream, Cea708Stream: We.Cea708Stream, MetadataStream: at }; for (var lt in Ge) Ge.hasOwnProperty(lt) && (ut[lt] = Ge[lt]); var ct, dt = ut, ht = fe, pt = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350]; ct = function (e) { var t, i = 0; ct.prototype.init.call(this), this.skipWarn_ = function (e, t) { this.trigger("log", { level: "warn", message: "adts skiping bytes " + e + " to " + t + " in frame " + i + " outside syncword" }) }, this.push = function (n) { var r, a, s, o, u, l = 0; if (e || (i = 0), "audio" === n.type) { var c; for (t && t.length ? (s = t, (t = new Uint8Array(s.byteLength + n.data.byteLength)).set(s), t.set(n.data, s.byteLength)) : t = n.data; l + 7 < t.length;)if (255 === t[l] && 240 == (246 & t[l + 1])) { if ("number" == typeof c && (this.skipWarn_(c, l), c = null), a = 2 * (1 & ~t[l + 1]), r = (3 & t[l + 3]) << 11 | t[l + 4] << 3 | (224 & t[l + 5]) >> 5, u = (o = 1024 * (1 + (3 & t[l + 6]))) * ht / pt[(60 & t[l + 2]) >>> 2], t.byteLength - l < r) break; this.trigger("data", { pts: n.pts + i * u, dts: n.dts + i * u, sampleCount: o, audioobjecttype: 1 + (t[l + 2] >>> 6 & 3), channelcount: (1 & t[l + 2]) << 2 | (192 & t[l + 3]) >>> 6, samplerate: pt[(60 & t[l + 2]) >>> 2], samplingfrequencyindex: (60 & t[l + 2]) >>> 2, samplesize: 16, data: t.subarray(l + 7 + a, l + r) }), i++, l += r } else "number" != typeof c && (c = l), l++; "number" == typeof c && (this.skipWarn_(c, l), c = null), t = t.subarray(l) } }, this.flush = function () { i = 0, this.trigger("done") }, this.reset = function () { t = void 0, this.trigger("reset") }, this.endTimeline = function () { t = void 0, this.trigger("endedtimeline") } }, ct.prototype = new V; var ft, mt, gt, At = ct, vt = function (e) { var t = e.byteLength, i = 0, n = 0; this.length = function () { return 8 * t }, this.bitsAvailable = function () { return 8 * t + n }, this.loadWord = function () { var r = e.byteLength - t, a = new Uint8Array(4), s = Math.min(4, t); if (0 === s) throw new Error("no bytes available"); a.set(e.subarray(r, r + s)), i = new DataView(a.buffer).getUint32(0), n = 8 * s, t -= s }, this.skipBits = function (e) { var r; n > e ? (i <<= e, n -= e) : (e -= n, e -= 8 * (r = Math.floor(e / 8)), t -= r, this.loadWord(), i <<= e, n -= e) }, this.readBits = function (e) { var r = Math.min(n, e), a = i >>> 32 - r; return (n -= r) > 0 ? i <<= r : t > 0 && this.loadWord(), (r = e - r) > 0 ? a << r | this.readBits(r) : a }, this.skipLeadingZeros = function () { var e; for (e = 0; e < n; ++e)if (0 != (i & 2147483648 >>> e)) return i <<= e, n -= e, e; return this.loadWord(), e + this.skipLeadingZeros() }, this.skipUnsignedExpGolomb = function () { this.skipBits(1 + this.skipLeadingZeros()) }, this.skipExpGolomb = function () { this.skipBits(1 + this.skipLeadingZeros()) }, this.readUnsignedExpGolomb = function () { var e = this.skipLeadingZeros(); return this.readBits(e + 1) - 1 }, this.readExpGolomb = function () { var e = this.readUnsignedExpGolomb(); return 1 & e ? 1 + e >>> 1 : -1 * (e >>> 1) }, this.readBoolean = function () { return 1 === this.readBits(1) }, this.readUnsignedByte = function () { return this.readBits(8) }, this.loadWord() }; mt = function () { var e, t, i = 0; mt.prototype.init.call(this), this.push = function (n) { var r; t ? ((r = new Uint8Array(t.byteLength + n.data.byteLength)).set(t), r.set(n.data, t.byteLength), t = r) : t = n.data; for (var a = t.byteLength; i < a - 3; i++)if (1 === t[i + 2]) { e = i + 5; break } for (; e < a;)switch (t[e]) { case 0: if (0 !== t[e - 1]) { e += 2; break } if (0 !== t[e - 2]) { e++; break } i + 3 !== e - 2 && this.trigger("data", t.subarray(i + 3, e - 2)); do { e++ } while (1 !== t[e] && e < a); i = e - 2, e += 3; break; case 1: if (0 !== t[e - 1] || 0 !== t[e - 2]) { e += 3; break } this.trigger("data", t.subarray(i + 3, e - 2)), i = e - 2, e += 3; break; default: e += 3 }t = t.subarray(i), e -= i, i = 0 }, this.reset = function () { t = null, i = 0, this.trigger("reset") }, this.flush = function () { t && t.byteLength > 3 && this.trigger("data", t.subarray(i + 3)), t = null, i = 0, this.trigger("done") }, this.endTimeline = function () { this.flush(), this.trigger("endedtimeline") } }, mt.prototype = new V, gt = { 100: !0, 110: !0, 122: !0, 244: !0, 44: !0, 83: !0, 86: !0, 118: !0, 128: !0, 138: !0, 139: !0, 134: !0 }, ft = function () { var e, t, i, n, r, a, s, o = new mt; ft.prototype.init.call(this), e = this, this.push = function (e) { "video" === e.type && (t = e.trackId, i = e.pts, n = e.dts, o.push(e)) }, o.on("data", (function (s) { var o = { trackId: t, pts: i, dts: n, data: s, nalUnitTypeCode: 31 & s[0] }; switch (o.nalUnitTypeCode) { case 5: o.nalUnitType = "slice_layer_without_partitioning_rbsp_idr"; break; case 6: o.nalUnitType = "sei_rbsp", o.escapedRBSP = r(s.subarray(1)); break; case 7: o.nalUnitType = "seq_parameter_set_rbsp", o.escapedRBSP = r(s.subarray(1)), o.config = a(o.escapedRBSP); break; case 8: o.nalUnitType = "pic_parameter_set_rbsp"; break; case 9: o.nalUnitType = "access_unit_delimiter_rbsp" }e.trigger("data", o) })), o.on("done", (function () { e.trigger("done") })), o.on("partialdone", (function () { e.trigger("partialdone") })), o.on("reset", (function () { e.trigger("reset") })), o.on("endedtimeline", (function () { e.trigger("endedtimeline") })), this.flush = function () { o.flush() }, this.partialFlush = function () { o.partialFlush() }, this.reset = function () { o.reset() }, this.endTimeline = function () { o.endTimeline() }, s = function (e, t) { var i, n = 8, r = 8; for (i = 0; i < e; i++)0 !== r && (r = (n + t.readExpGolomb() + 256) % 256), n = 0 === r ? n : r }, r = function (e) { for (var t, i, n = e.byteLength, r = [], a = 1; a < n - 2;)0 === e[a] && 0 === e[a + 1] && 3 === e[a + 2] ? (r.push(a + 2), a += 2) : a++; if (0 === r.length) return e; t = n - r.length, i = new Uint8Array(t); var s = 0; for (a = 0; a < t; s++, a++)s === r[0] && (s++, r.shift()), i[a] = e[s]; return i }, a = function (e) { var t, i, n, r, a, o, u, l, c, d, h, p, f = 0, m = 0, g = 0, A = 0, v = [1, 1]; if (i = (t = new vt(e)).readUnsignedByte(), r = t.readUnsignedByte(), n = t.readUnsignedByte(), t.skipUnsignedExpGolomb(), gt[i] && (3 === (a = t.readUnsignedExpGolomb()) && t.skipBits(1), t.skipUnsignedExpGolomb(), t.skipUnsignedExpGolomb(), t.skipBits(1), t.readBoolean())) for (h = 3 !== a ? 8 : 12, p = 0; p < h; p++)t.readBoolean() && s(p < 6 ? 16 : 64, t); if (t.skipUnsignedExpGolomb(), 0 === (o = t.readUnsignedExpGolomb())) t.readUnsignedExpGolomb(); else if (1 === o) for (t.skipBits(1), t.skipExpGolomb(), t.skipExpGolomb(), u = t.readUnsignedExpGolomb(), p = 0; p < u; p++)t.skipExpGolomb(); if (t.skipUnsignedExpGolomb(), t.skipBits(1), l = t.readUnsignedExpGolomb(), c = t.readUnsignedExpGolomb(), 0 === (d = t.readBits(1)) && t.skipBits(1), t.skipBits(1), t.readBoolean() && (f = t.readUnsignedExpGolomb(), m = t.readUnsignedExpGolomb(), g = t.readUnsignedExpGolomb(), A = t.readUnsignedExpGolomb()), t.readBoolean() && t.readBoolean()) { switch (t.readUnsignedByte()) { case 1: v = [1, 1]; break; case 2: v = [12, 11]; break; case 3: v = [10, 11]; break; case 4: v = [16, 11]; break; case 5: v = [40, 33]; break; case 6: v = [24, 11]; break; case 7: v = [20, 11]; break; case 8: v = [32, 11]; break; case 9: v = [80, 33]; break; case 10: v = [18, 11]; break; case 11: v = [15, 11]; break; case 12: v = [64, 33]; break; case 13: v = [160, 99]; break; case 14: v = [4, 3]; break; case 15: v = [3, 2]; break; case 16: v = [2, 1]; break; case 255: v = [t.readUnsignedByte() << 8 | t.readUnsignedByte(), t.readUnsignedByte() << 8 | t.readUnsignedByte()] }v && (v[0], v[1]) } return { profileIdc: i, levelIdc: n, profileCompatibility: r, width: 16 * (l + 1) - 2 * f - 2 * m, height: (2 - d) * (c + 1) * 16 - 2 * g - 2 * A, sarRatio: v } } }, ft.prototype = new V; var yt, _t = { H264Stream: ft, NalByteStream: mt }, bt = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350], Tt = function (e, t) { var i = e[t + 6] << 21 | e[t + 7] << 14 | e[t + 8] << 7 | e[t + 9]; return i = i >= 0 ? i : 0, (16 & e[t + 5]) >> 4 ? i + 20 : i + 10 }, xt = function e(t, i) { return t.length - i < 10 || t[i] !== "I".charCodeAt(0) || t[i + 1] !== "D".charCodeAt(0) || t[i + 2] !== "3".charCodeAt(0) ? i : e(t, i += Tt(t, i)) }, St = function (e) { return e[0] << 21 | e[1] << 14 | e[2] << 7 | e[3] }, Et = { isLikelyAacData: function (e) { var t = xt(e, 0); return e.length >= t + 2 && 255 == (255 & e[t]) && 240 == (240 & e[t + 1]) && 16 == (22 & e[t + 1]) }, parseId3TagSize: Tt, parseAdtsSize: function (e, t) { var i = (224 & e[t + 5]) >> 5, n = e[t + 4] << 3; return 6144 & e[t + 3] | n | i }, parseType: function (e, t) { return e[t] === "I".charCodeAt(0) && e[t + 1] === "D".charCodeAt(0) && e[t + 2] === "3".charCodeAt(0) ? "timed-metadata" : !0 & e[t] && 240 == (240 & e[t + 1]) ? "audio" : null }, parseSampleRate: function (e) { for (var t = 0; t + 5 < e.length;) { if (255 === e[t] && 240 == (246 & e[t + 1])) return bt[(60 & e[t + 2]) >>> 2]; t++ } return null }, parseAacTimestamp: function (e) { var t, i, n; t = 10, 64 & e[5] && (t += 4, t += St(e.subarray(10, 14))); do { if ((i = St(e.subarray(t + 4, t + 8))) < 1) return null; if ("PRIV" === String.fromCharCode(e[t], e[t + 1], e[t + 2], e[t + 3])) { n = e.subarray(t + 10, t + i + 10); for (var r = 0; r < n.byteLength; r++)if (0 === n[r]) { var a = unescape(function (e, t, i) { var n, r = ""; for (n = t; n < i; n++)r += "%" + ("00" + e[n].toString(16)).slice(-2); return r }(n, 0, r)); if ("com.apple.streaming.transportStreamTimestamp" === a) { var s = n.subarray(r + 1), o = (1 & s[3]) << 30 | s[4] << 22 | s[5] << 14 | s[6] << 6 | s[7] >>> 2; return o *= 4, o += 3 & s[7] } break } } t += 10, t += i } while (t < e.byteLength); return null } }; (yt = function () { var e = new Uint8Array, t = 0; yt.prototype.init.call(this), this.setTimestamp = function (e) { t = e }, this.push = function (i) { var n, r, a, s, o = 0, u = 0; for (e.length ? (s = e.length, (e = new Uint8Array(i.byteLength + s)).set(e.subarray(0, s)), e.set(i, s)) : e = i; e.length - u >= 3;)if (e[u] !== "I".charCodeAt(0) || e[u + 1] !== "D".charCodeAt(0) || e[u + 2] !== "3".charCodeAt(0)) if (255 != (255 & e[u]) || 240 != (240 & e[u + 1])) u++; else { if (e.length - u < 7) break; if (u + (o = Et.parseAdtsSize(e, u)) > e.length) break; a = { type: "audio", data: e.subarray(u, u + o), pts: t, dts: t }, this.trigger("data", a), u += o } else { if (e.length - u < 10) break; if (u + (o = Et.parseId3TagSize(e, u)) > e.length) break; r = { type: "timed-metadata", data: e.subarray(u, u + o) }, this.trigger("data", r), u += o } n = e.length - u, e = n > 0 ? e.subarray(u) : new Uint8Array }, this.reset = function () { e = new Uint8Array, this.trigger("reset") }, this.endTimeline = function () { e = new Uint8Array, this.trigger("endedtimeline") } }).prototype = new V; var Ct, wt, kt, Ft, It = yt, Dt = ["audioobjecttype", "channelcount", "samplerate", "samplingfrequencyindex", "samplesize"], Pt = ["width", "height", "profileIdc", "levelIdc", "profileCompatibility", "sarRatio"], Lt = _t.H264Stream, Ot = Et.isLikelyAacData, Bt = fe, Rt = function (e, t) { t.stream = e, this.trigger("log", t) }, Mt = function (e, t) { for (var i = Object.keys(t), n = 0; n < i.length; n++) { var r = i[n]; "headOfPipeline" !== r && t[r].on && t[r].on("log", Rt.bind(e, r)) } }, Nt = function (e, t) { var i; if (e.length !== t.length) return !1; for (i = 0; i < e.length; i++)if (e[i] !== t[i]) return !1; return !0 }, Ut = function (e, t, i, n, r, a) { return { start: { dts: e, pts: e + (i - t) }, end: { dts: e + (n - t), pts: e + (r - i) }, prependedContentDuration: a, baseMediaDecodeTime: e } }; wt = function (e, t) { var i, n = [], r = 0, a = 0, s = 1 / 0; i = (t = t || {}).firstSequenceNumber || 0, wt.prototype.init.call(this), this.push = function (t) { we(e, t), e && Dt.forEach((function (i) { e[i] = t[i] })), n.push(t) }, this.setEarliestDts = function (e) { r = e }, this.setVideoBaseMediaDecodeTime = function (e) { s = e }, this.setAudioAppendStart = function (e) { a = e }, this.flush = function () { var o, u, l, c, d, h, p; 0 !== n.length ? (o = be(n, e, r), e.baseMediaDecodeTime = Ce(e, t.keepOriginalTimestamps), p = _e(e, o, a, s), e.samples = Te(o), l = ee(xe(o)), n = [], u = te(i, [e]), c = new Uint8Array(u.byteLength + l.byteLength), i++, c.set(u), c.set(l, u.byteLength), Ee(e), d = Math.ceil(1024 * Bt / e.samplerate), o.length && (h = o.length * d, this.trigger("segmentTimingInfo", Ut(Ae(e.baseMediaDecodeTime, e.samplerate), o[0].dts, o[0].pts, o[0].dts + h, o[0].pts + h, p || 0)), this.trigger("timingInfo", { start: o[0].pts, end: o[0].pts + h })), this.trigger("data", { track: e, boxes: c }), this.trigger("done", "AudioSegmentStream")) : this.trigger("done", "AudioSegmentStream") }, this.reset = function () { Ee(e), n = [], this.trigger("reset") } }, wt.prototype = new V, Ct = function (e, t) { var i, n, r, a = [], s = []; i = (t = t || {}).firstSequenceNumber || 0, Ct.prototype.init.call(this), delete e.minPTS, this.gopCache_ = [], this.push = function (t) { we(e, t), "seq_parameter_set_rbsp" !== t.nalUnitType || n || (n = t.config, e.sps = [t.data], Pt.forEach((function (t) { e[t] = n[t] }), this)), "pic_parameter_set_rbsp" !== t.nalUnitType || r || (r = t.data, e.pps = [t.data]), a.push(t) }, this.flush = function () { for (var n, r, o, u, l, c, d, h, p = 0; a.length && "access_unit_delimiter_rbsp" !== a[0].nalUnitType;)a.shift(); if (0 === a.length) return this.resetStream_(), void this.trigger("done", "VideoSegmentStream"); if (n = re(a), (o = ae(n))[0][0].keyFrame || ((r = this.getGopForFusion_(a[0], e)) ? (p = r.duration, o.unshift(r), o.byteLength += r.byteLength, o.nalCount += r.nalCount, o.pts = r.pts, o.dts = r.dts, o.duration += r.duration) : o = se(o)), s.length) { var f; if (!(f = t.alignGopsAtEnd ? this.alignGopsAtEnd_(o) : this.alignGopsAtStart_(o))) return this.gopCache_.unshift({ gop: o.pop(), pps: e.pps, sps: e.sps }), this.gopCache_.length = Math.min(6, this.gopCache_.length), a = [], this.resetStream_(), void this.trigger("done", "VideoSegmentStream"); Ee(e), o = f } we(e, o), e.samples = oe(o), l = ee(ue(o)), e.baseMediaDecodeTime = Ce(e, t.keepOriginalTimestamps), this.trigger("processedGopsInfo", o.map((function (e) { return { pts: e.pts, dts: e.dts, byteLength: e.byteLength } }))), d = o[0], h = o[o.length - 1], this.trigger("segmentTimingInfo", Ut(e.baseMediaDecodeTime, d.dts, d.pts, h.dts + h.duration, h.pts + h.duration, p)), this.trigger("timingInfo", { start: o[0].pts, end: o[o.length - 1].pts + o[o.length - 1].duration }), this.gopCache_.unshift({ gop: o.pop(), pps: e.pps, sps: e.sps }), this.gopCache_.length = Math.min(6, this.gopCache_.length), a = [], this.trigger("baseMediaDecodeTime", e.baseMediaDecodeTime), this.trigger("timelineStartInfo", e.timelineStartInfo), u = te(i, [e]), c = new Uint8Array(u.byteLength + l.byteLength), i++, c.set(u), c.set(l, u.byteLength), this.trigger("data", { track: e, boxes: c }), this.resetStream_(), this.trigger("done", "VideoSegmentStream") }, this.reset = function () { this.resetStream_(), a = [], this.gopCache_.length = 0, s.length = 0, this.trigger("reset") }, this.resetStream_ = function () { Ee(e), n = void 0, r = void 0 }, this.getGopForFusion_ = function (t) { var i, n, r, a, s, o = 1 / 0; for (s = 0; s < this.gopCache_.length; s++)r = (a = this.gopCache_[s]).gop, e.pps && Nt(e.pps[0], a.pps[0]) && e.sps && Nt(e.sps[0], a.sps[0]) && (r.dts < e.timelineStartInfo.dts || (i = t.dts - r.dts - r.duration) >= -1e4 && i <= 45e3 && (!n || o > i) && (n = a, o = i)); return n ? n.gop : null }, this.alignGopsAtStart_ = function (e) { var t, i, n, r, a, o, u, l; for (a = e.byteLength, o = e.nalCount, u = e.duration, t = i = 0; t < s.length && i < e.length && (n = s[t], r = e[i], n.pts !== r.pts);)r.pts > n.pts ? t++ : (i++, a -= r.byteLength, o -= r.nalCount, u -= r.duration); return 0 === i ? e : i === e.length ? null : ((l = e.slice(i)).byteLength = a, l.duration = u, l.nalCount = o, l.pts = l[0].pts, l.dts = l[0].dts, l) }, this.alignGopsAtEnd_ = function (e) { var t, i, n, r, a, o, u; for (t = s.length - 1, i = e.length - 1, a = null, o = !1; t >= 0 && i >= 0;) { if (n = s[t], r = e[i], n.pts === r.pts) { o = !0; break } n.pts > r.pts ? t-- : (t === s.length - 1 && (a = i), i--) } if (!o && null === a) return null; if (0 === (u = o ? i : a)) return e; var l = e.slice(u), c = l.reduce((function (e, t) { return e.byteLength += t.byteLength, e.duration += t.duration, e.nalCount += t.nalCount, e }), { byteLength: 0, duration: 0, nalCount: 0 }); return l.byteLength = c.byteLength, l.duration = c.duration, l.nalCount = c.nalCount, l.pts = l[0].pts, l.dts = l[0].dts, l }, this.alignGopsWith = function (e) { s = e } }, Ct.prototype = new V, Ft = function (e, t) { this.numberOfTracks = 0, this.metadataStream = t, void 0 !== (e = e || {}).remux ? this.remuxTracks = !!e.remux : this.remuxTracks = !0, "boolean" == typeof e.keepOriginalTimestamps ? this.keepOriginalTimestamps = e.keepOriginalTimestamps : this.keepOriginalTimestamps = !1, this.pendingTracks = [], this.videoTrack = null, this.pendingBoxes = [], this.pendingCaptions = [], this.pendingMetadata = [], this.pendingBytes = 0, this.emittedTracks = 0, Ft.prototype.init.call(this), this.push = function (e) { return e.text ? this.pendingCaptions.push(e) : e.frames ? this.pendingMetadata.push(e) : (this.pendingTracks.push(e.track), this.pendingBytes += e.boxes.byteLength, "video" === e.track.type && (this.videoTrack = e.track, this.pendingBoxes.push(e.boxes)), void ("audio" === e.track.type && (this.audioTrack = e.track, this.pendingBoxes.unshift(e.boxes)))) } }, Ft.prototype = new V, Ft.prototype.flush = function (e) { var t, i, n, r, a = 0, s = { captions: [], captionStreams: {}, metadata: [], info: {} }, o = 0; if (this.pendingTracks.length < this.numberOfTracks) { if ("VideoSegmentStream" !== e && "AudioSegmentStream" !== e) return; if (this.remuxTracks) return; if (0 === this.pendingTracks.length) return this.emittedTracks++, void (this.emittedTracks >= this.numberOfTracks && (this.trigger("done"), this.emittedTracks = 0)) } if (this.videoTrack ? (o = this.videoTrack.timelineStartInfo.pts, Pt.forEach((function (e) { s.info[e] = this.videoTrack[e] }), this)) : this.audioTrack && (o = this.audioTrack.timelineStartInfo.pts, Dt.forEach((function (e) { s.info[e] = this.audioTrack[e] }), this)), this.videoTrack || this.audioTrack) { for (1 === this.pendingTracks.length ? s.type = this.pendingTracks[0].type : s.type = "combined", this.emittedTracks += this.pendingTracks.length, n = ie(this.pendingTracks), s.initSegment = new Uint8Array(n.byteLength), s.initSegment.set(n), s.data = new Uint8Array(this.pendingBytes), r = 0; r < this.pendingBoxes.length; r++)s.data.set(this.pendingBoxes[r], a), a += this.pendingBoxes[r].byteLength; for (r = 0; r < this.pendingCaptions.length; r++)(t = this.pendingCaptions[r]).startTime = ye(t.startPts, o, this.keepOriginalTimestamps), t.endTime = ye(t.endPts, o, this.keepOriginalTimestamps), s.captionStreams[t.stream] = !0, s.captions.push(t); for (r = 0; r < this.pendingMetadata.length; r++)(i = this.pendingMetadata[r]).cueTime = ye(i.pts, o, this.keepOriginalTimestamps), s.metadata.push(i); for (s.metadata.dispatchType = this.metadataStream.dispatchType, this.pendingTracks.length = 0, this.videoTrack = null, this.pendingBoxes.length = 0, this.pendingCaptions.length = 0, this.pendingBytes = 0, this.pendingMetadata.length = 0, this.trigger("data", s), r = 0; r < s.captions.length; r++)t = s.captions[r], this.trigger("caption", t); for (r = 0; r < s.metadata.length; r++)i = s.metadata[r], this.trigger("id3Frame", i) } this.emittedTracks >= this.numberOfTracks && (this.trigger("done"), this.emittedTracks = 0) }, Ft.prototype.setRemux = function (e) { this.remuxTracks = e }, kt = function (e) { var t, i, n = this, r = !0; kt.prototype.init.call(this), e = e || {}, this.baseMediaDecodeTime = e.baseMediaDecodeTime || 0, this.transmuxPipeline_ = {}, this.setupAacPipeline = function () { var r = {}; this.transmuxPipeline_ = r, r.type = "aac", r.metadataStream = new dt.MetadataStream, r.aacStream = new It, r.audioTimestampRolloverStream = new dt.TimestampRolloverStream("audio"), r.timedMetadataTimestampRolloverStream = new dt.TimestampRolloverStream("timed-metadata"), r.adtsStream = new At, r.coalesceStream = new Ft(e, r.metadataStream), r.headOfPipeline = r.aacStream, r.aacStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream), r.aacStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream), r.metadataStream.on("timestamp", (function (e) { r.aacStream.setTimestamp(e.timeStamp) })), r.aacStream.on("data", (function (a) { "timed-metadata" !== a.type && "audio" !== a.type || r.audioSegmentStream || (i = i || { timelineStartInfo: { baseMediaDecodeTime: n.baseMediaDecodeTime }, codec: "adts", type: "audio" }, r.coalesceStream.numberOfTracks++, r.audioSegmentStream = new wt(i, e), r.audioSegmentStream.on("log", n.getLogTrigger_("audioSegmentStream")), r.audioSegmentStream.on("timingInfo", n.trigger.bind(n, "audioTimingInfo")), r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream), n.trigger("trackinfo", { hasAudio: !!i, hasVideo: !!t })) })), r.coalesceStream.on("data", this.trigger.bind(this, "data")), r.coalesceStream.on("done", this.trigger.bind(this, "done")), Mt(this, r) }, this.setupTsPipeline = function () { var r = {}; this.transmuxPipeline_ = r, r.type = "ts", r.metadataStream = new dt.MetadataStream, r.packetStream = new dt.TransportPacketStream, r.parseStream = new dt.TransportParseStream, r.elementaryStream = new dt.ElementaryStream, r.timestampRolloverStream = new dt.TimestampRolloverStream, r.adtsStream = new At, r.h264Stream = new Lt, r.captionStream = new dt.CaptionStream(e), r.coalesceStream = new Ft(e, r.metadataStream), r.headOfPipeline = r.packetStream, r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream).pipe(r.timestampRolloverStream), r.timestampRolloverStream.pipe(r.h264Stream), r.timestampRolloverStream.pipe(r.adtsStream), r.timestampRolloverStream.pipe(r.metadataStream).pipe(r.coalesceStream), r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream), r.elementaryStream.on("data", (function (a) { var s; if ("metadata" === a.type) { for (s = a.tracks.length; s--;)t || "video" !== a.tracks[s].type ? i || "audio" !== a.tracks[s].type || ((i = a.tracks[s]).timelineStartInfo.baseMediaDecodeTime = n.baseMediaDecodeTime) : (t = a.tracks[s]).timelineStartInfo.baseMediaDecodeTime = n.baseMediaDecodeTime; t && !r.videoSegmentStream && (r.coalesceStream.numberOfTracks++, r.videoSegmentStream = new Ct(t, e), r.videoSegmentStream.on("log", n.getLogTrigger_("videoSegmentStream")), r.videoSegmentStream.on("timelineStartInfo", (function (t) { i && !e.keepOriginalTimestamps && (i.timelineStartInfo = t, r.audioSegmentStream.setEarliestDts(t.dts - n.baseMediaDecodeTime)) })), r.videoSegmentStream.on("processedGopsInfo", n.trigger.bind(n, "gopInfo")), r.videoSegmentStream.on("segmentTimingInfo", n.trigger.bind(n, "videoSegmentTimingInfo")), r.videoSegmentStream.on("baseMediaDecodeTime", (function (e) { i && r.audioSegmentStream.setVideoBaseMediaDecodeTime(e) })), r.videoSegmentStream.on("timingInfo", n.trigger.bind(n, "videoTimingInfo")), r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)), i && !r.audioSegmentStream && (r.coalesceStream.numberOfTracks++, r.audioSegmentStream = new wt(i, e), r.audioSegmentStream.on("log", n.getLogTrigger_("audioSegmentStream")), r.audioSegmentStream.on("timingInfo", n.trigger.bind(n, "audioTimingInfo")), r.audioSegmentStream.on("segmentTimingInfo", n.trigger.bind(n, "audioSegmentTimingInfo")), r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream)), n.trigger("trackinfo", { hasAudio: !!i, hasVideo: !!t }) } })), r.coalesceStream.on("data", this.trigger.bind(this, "data")), r.coalesceStream.on("id3Frame", (function (e) { e.dispatchType = r.metadataStream.dispatchType, n.trigger("id3Frame", e) })), r.coalesceStream.on("caption", this.trigger.bind(this, "caption")), r.coalesceStream.on("done", this.trigger.bind(this, "done")), Mt(this, r) }, this.setBaseMediaDecodeTime = function (n) { var r = this.transmuxPipeline_; e.keepOriginalTimestamps || (this.baseMediaDecodeTime = n), i && (i.timelineStartInfo.dts = void 0, i.timelineStartInfo.pts = void 0, Ee(i), r.audioTimestampRolloverStream && r.audioTimestampRolloverStream.discontinuity()), t && (r.videoSegmentStream && (r.videoSegmentStream.gopCache_ = []), t.timelineStartInfo.dts = void 0, t.timelineStartInfo.pts = void 0, Ee(t), r.captionStream.reset()), r.timestampRolloverStream && r.timestampRolloverStream.discontinuity() }, this.setAudioAppendStart = function (e) { i && this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e) }, this.setRemux = function (t) { var i = this.transmuxPipeline_; e.remux = t, i && i.coalesceStream && i.coalesceStream.setRemux(t) }, this.alignGopsWith = function (e) { t && this.transmuxPipeline_.videoSegmentStream && this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e) }, this.getLogTrigger_ = function (e) { var t = this; return function (i) { i.stream = e, t.trigger("log", i) } }, this.push = function (e) { if (r) { var t = Ot(e); t && "aac" !== this.transmuxPipeline_.type ? this.setupAacPipeline() : t || "ts" === this.transmuxPipeline_.type || this.setupTsPipeline(), r = !1 } this.transmuxPipeline_.headOfPipeline.push(e) }, this.flush = function () { r = !0, this.transmuxPipeline_.headOfPipeline.flush() }, this.endTimeline = function () { this.transmuxPipeline_.headOfPipeline.endTimeline() }, this.reset = function () { this.transmuxPipeline_.headOfPipeline && this.transmuxPipeline_.headOfPipeline.reset() }, this.resetCaptions = function () { this.transmuxPipeline_.captionStream && this.transmuxPipeline_.captionStream.reset() } }, kt.prototype = new V; var jt, Ht, Vt, qt = { Transmuxer: kt, VideoSegmentStream: Ct, AudioSegmentStream: wt, AUDIO_PROPERTIES: Dt, VIDEO_PROPERTIES: Pt, generateSegmentTimingInfo: Ut }, Wt = function (e) { return e >>> 0 }, Gt = function (e) { return ("00" + e.toString(16)).slice(-2) }, zt = function (e) { var t = ""; return t += String.fromCharCode(e[0]), t += String.fromCharCode(e[1]), t += String.fromCharCode(e[2]), t += String.fromCharCode(e[3]) }, Qt = Wt, Xt = function e(t, i) { var n, r, a, s, o, u = []; if (!i.length) return null; for (n = 0; n < t.byteLength;)r = Qt(t[n] << 24 | t[n + 1] << 16 | t[n + 2] << 8 | t[n + 3]), a = zt(t.subarray(n + 4, n + 8)), s = r > 1 ? n + r : t.byteLength, a === i[0] && (1 === i.length ? u.push(t.subarray(n + 8, s)) : (o = e(t.subarray(n + 8, s), i.slice(1))).length && (u = u.concat(o))), n = s; return u }, $t = Wt, Kt = W.getUint64, Yt = function (e) { var t = { version: e[0], flags: new Uint8Array(e.subarray(1, 4)) }; return 1 === t.version ? t.baseMediaDecodeTime = Kt(e.subarray(4)) : t.baseMediaDecodeTime = $t(e[4] << 24 | e[5] << 16 | e[6] << 8 | e[7]), t }, Zt = function (e) { return { isLeading: (12 & e[0]) >>> 2, dependsOn: 3 & e[0], isDependedOn: (192 & e[1]) >>> 6, hasRedundancy: (48 & e[1]) >>> 4, paddingValue: (14 & e[1]) >>> 1, isNonSyncSample: 1 & e[1], degradationPriority: e[2] << 8 | e[3] } }, Jt = function (e) { var t, i = { version: e[0], flags: new Uint8Array(e.subarray(1, 4)), samples: [] }, n = new DataView(e.buffer, e.byteOffset, e.byteLength), r = 1 & i.flags[2], a = 4 & i.flags[2], s = 1 & i.flags[1], o = 2 & i.flags[1], u = 4 & i.flags[1], l = 8 & i.flags[1], c = n.getUint32(4), d = 8; for (r && (i.dataOffset = n.getInt32(d), d += 4), a && c && (t = { flags: Zt(e.subarray(d, d + 4)) }, d += 4, s && (t.duration = n.getUint32(d), d += 4), o && (t.size = n.getUint32(d), d += 4), l && (1 === i.version ? t.compositionTimeOffset = n.getInt32(d) : t.compositionTimeOffset = n.getUint32(d), d += 4), i.samples.push(t), c--); c--;)t = {}, s && (t.duration = n.getUint32(d), d += 4), o && (t.size = n.getUint32(d), d += 4), u && (t.flags = Zt(e.subarray(d, d + 4)), d += 4), l && (1 === i.version ? t.compositionTimeOffset = n.getInt32(d) : t.compositionTimeOffset = n.getUint32(d), d += 4), i.samples.push(t); return i }, ei = function (e) { var t, i = new DataView(e.buffer, e.byteOffset, e.byteLength), n = { version: e[0], flags: new Uint8Array(e.subarray(1, 4)), trackId: i.getUint32(4) }, r = 1 & n.flags[2], a = 2 & n.flags[2], s = 8 & n.flags[2], o = 16 & n.flags[2], u = 32 & n.flags[2], l = 65536 & n.flags[0], c = 131072 & n.flags[0]; return t = 8, r && (t += 4, n.baseDataOffset = i.getUint32(12), t += 4), a && (n.sampleDescriptionIndex = i.getUint32(t), t += 4), s && (n.defaultSampleDuration = i.getUint32(t), t += 4), o && (n.defaultSampleSize = i.getUint32(t), t += 4), u && (n.defaultSampleFlags = i.getUint32(t)), l && (n.durationIsEmpty = !0), !r && c && (n.baseDataOffsetIsMoof = !0), n }, ti = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : void 0 !== i.g ? i.g : "undefined" != typeof self ? self : {}, ii = "undefined" != typeof window ? window : void 0 !== ti ? ti : "undefined" != typeof self ? self : {}, ni = De, ri = We.CaptionStream, ai = function (e, t) { for (var i = e, n = 0; n < t.length; n++) { var r = t[n]; if (i < r.size) return r; i -= r.size } return null }, si = function (e, t) { var i = Xt(e, ["moof", "traf"]), n = Xt(e, ["mdat"]), r = {}, a = []; return n.forEach((function (e, t) { var n = i[t]; a.push({ mdat: e, traf: n }) })), a.forEach((function (e) { var i, n, a = e.mdat, s = e.traf, o = Xt(s, ["tfhd"]), u = ei(o[0]), l = u.trackId, c = Xt(s, ["tfdt"]), d = c.length > 0 ? Yt(c[0]).baseMediaDecodeTime : 0, h = Xt(s, ["trun"]); t === l && h.length > 0 && (i = function (e, t, i) { var n = t, r = i.defaultSampleDuration || 0, a = i.defaultSampleSize || 0, s = i.trackId, o = []; return e.forEach((function (e) { var t = Jt(e).samples; t.forEach((function (e) { void 0 === e.duration && (e.duration = r), void 0 === e.size && (e.size = a), e.trackId = s, e.dts = n, void 0 === e.compositionTimeOffset && (e.compositionTimeOffset = 0), "bigint" == typeof n ? (e.pts = n + ii.BigInt(e.compositionTimeOffset), n += ii.BigInt(e.duration)) : (e.pts = n + e.compositionTimeOffset, n += e.duration) })), o = o.concat(t) })), o }(h, d, u), n = function (e, t, i) { var n, r, a, s, o = new DataView(e.buffer, e.byteOffset, e.byteLength), u = { logs: [], seiNals: [] }; for (r = 0; r + 4 < e.length; r += a)if (a = o.getUint32(r), r += 4, !(a <= 0)) switch (31 & e[r]) { case 6: var l = e.subarray(r + 1, r + 1 + a), c = ai(r, t); if (n = { nalUnitType: "sei_rbsp", size: a, data: l, escapedRBSP: ni(l), trackId: i }, c) n.pts = c.pts, n.dts = c.dts, s = c; else { if (!s) { u.logs.push({ level: "warn", message: "We've encountered a nal unit without data at " + r + " for trackId " + i + ". See mux.js#223." }); break } n.pts = s.pts, n.dts = s.dts } u.seiNals.push(n) }return u }(a, i, l), r[l] || (r[l] = { seiNals: [], logs: [] }), r[l].seiNals = r[l].seiNals.concat(n.seiNals), r[l].logs = r[l].logs.concat(n.logs)) })), r }, oi = function () { var e, t, i, n, r, a, s = !1; this.isInitialized = function () { return s }, this.init = function (t) { e = new ri, s = !0, a = !!t && t.isPartial, e.on("data", (function (e) { e.startTime = e.startPts / n, e.endTime = e.endPts / n, r.captions.push(e), r.captionStreams[e.stream] = !0 })), e.on("log", (function (e) { r.logs.push(e) })) }, this.isNewInit = function (e, t) { return !(e && 0 === e.length || t && "object" == typeof t && 0 === Object.keys(t).length) && (i !== e[0] || n !== t[i]) }, this.parse = function (e, a, s) { var o; if (!this.isInitialized()) return null; if (!a || !s) return null; if (this.isNewInit(a, s)) i = a[0], n = s[i]; else if (null === i || !n) return t.push(e), null; for (; t.length > 0;) { var u = t.shift(); this.parse(u, a, s) } return o = function (e, t, i) { if (null === t) return null; var n = si(e, t)[t] || {}; return { seiNals: n.seiNals, logs: n.logs, timescale: i } }(e, i, n), o && o.logs && (r.logs = r.logs.concat(o.logs)), null !== o && o.seiNals ? (this.pushNals(o.seiNals), this.flushStream(), r) : r.logs.length ? { logs: r.logs, captions: [], captionStreams: [] } : null }, this.pushNals = function (t) { if (!this.isInitialized() || !t || 0 === t.length) return null; t.forEach((function (t) { e.push(t) })) }, this.flushStream = function () { if (!this.isInitialized()) return null; a ? e.partialFlush() : e.flush() }, this.clearParsedCaptions = function () { r.captions = [], r.captionStreams = {}, r.logs = [] }, this.resetCaptionStream = function () { if (!this.isInitialized()) return null; e.reset() }, this.clearAllCaptions = function () { this.clearParsedCaptions(), this.resetCaptionStream() }, this.reset = function () { t = [], i = null, n = null, r ? this.clearParsedCaptions() : r = { captions: [], captionStreams: {}, logs: [] }, this.resetCaptionStream() }, this.reset() }, ui = Wt, li = Gt, ci = W.getUint64; jt = function (e, t) { var i = Xt(t, ["moof", "traf"]).reduce((function (t, i) { var n, r, a = Xt(i, ["tfhd"])[0], s = ui(a[4] << 24 | a[5] << 16 | a[6] << 8 | a[7]), o = e[s] || 9e4, u = Xt(i, ["tfdt"])[0], l = new DataView(u.buffer, u.byteOffset, u.byteLength); return "bigint" == typeof (n = 1 === u[0] ? ci(u.subarray(4, 12)) : l.getUint32(4)) ? r = n / ii.BigInt(o) : "number" != typeof n || isNaN(n) || (r = n / o), r < Number.MAX_SAFE_INTEGER && (r = Number(r)), r < t && (t = r), t }), 1 / 0); return "bigint" == typeof i || isFinite(i) ? i : 0 }, Vt = function (e) { var t = 0 === e[0] ? 12 : 20; return ui(e[t] << 24 | e[t + 1] << 16 | e[t + 2] << 8 | e[t + 3]) }, Ht = function (e) { var t = Xt(e, ["moov", "trak"]), i = []; return t.forEach((function (e) { var t, n, r = {}, a = Xt(e, ["tkhd"])[0]; a && (n = (t = new DataView(a.buffer, a.byteOffset, a.byteLength)).getUint8(0), r.id = 0 === n ? t.getUint32(12) : t.getUint32(20)); var s = Xt(e, ["mdia", "hdlr"])[0]; if (s) { var o = zt(s.subarray(8, 12)); r.type = "vide" === o ? "video" : "soun" === o ? "audio" : o } var u = Xt(e, ["mdia", "minf", "stbl", "stsd"])[0]; if (u) { var l = u.subarray(8); r.codec = zt(l.subarray(4, 8)); var c, d = Xt(l, [r.codec])[0]; d && (/^[asm]vc[1-9]$/i.test(r.codec) ? (c = d.subarray(78), "avcC" === zt(c.subarray(4, 8)) && c.length > 11 ? (r.codec += ".", r.codec += li(c[9]), r.codec += li(c[10]), r.codec += li(c[11])) : r.codec = "avc1.4d400d") : /^mp4[a,v]$/i.test(r.codec) ? (c = d.subarray(28), "esds" === zt(c.subarray(4, 8)) && c.length > 20 && 0 !== c[19] ? (r.codec += "." + li(c[19]), r.codec += "." + li(c[20] >>> 2 & 63).replace(/^0/, "")) : r.codec = "mp4a.40.2") : r.codec = r.codec.toLowerCase()) } var h = Xt(e, ["mdia", "mdhd"])[0]; h && (r.timescale = Vt(h)), i.push(r) })), i }; var di = jt, hi = Ht, pi = function (e) { var t = 31 & e[1]; return t <<= 8, t |= e[2] }, fi = function (e) { return !!(64 & e[1]) }, mi = function (e) { var t = 0; return (48 & e[3]) >>> 4 > 1 && (t += e[4] + 1), t }, gi = function (e) { switch (e) { case 5: return "slice_layer_without_partitioning_rbsp_idr"; case 6: return "sei_rbsp"; case 7: return "seq_parameter_set_rbsp"; case 8: return "pic_parameter_set_rbsp"; case 9: return "access_unit_delimiter_rbsp"; default: return null } }, Ai = { parseType: function (e, t) { var i = pi(e); return 0 === i ? "pat" : i === t ? "pmt" : t ? "pes" : null }, parsePat: function (e) { var t = fi(e), i = 4 + mi(e); return t && (i += e[i] + 1), (31 & e[i + 10]) << 8 | e[i + 11] }, parsePmt: function (e) { var t = {}, i = fi(e), n = 4 + mi(e); if (i && (n += e[n] + 1), 1 & e[n + 5]) { var r; r = 3 + ((15 & e[n + 1]) << 8 | e[n + 2]) - 4; for (var a = 12 + ((15 & e[n + 10]) << 8 | e[n + 11]); a < r;) { var s = n + a; t[(31 & e[s + 1]) << 8 | e[s + 2]] = e[s], a += 5 + ((15 & e[s + 3]) << 8 | e[s + 4]) } return t } }, parsePayloadUnitStartIndicator: fi, parsePesType: function (e, t) { switch (t[pi(e)]) { case Ge.H264_STREAM_TYPE: return "video"; case Ge.ADTS_STREAM_TYPE: return "audio"; case Ge.METADATA_STREAM_TYPE: return "timed-metadata"; default: return null } }, parsePesTime: function (e) { if (!fi(e)) return null; var t = 4 + mi(e); if (t >= e.byteLength) return null; var i, n = null; return 192 & (i = e[t + 7]) && ((n = {}).pts = (14 & e[t + 9]) << 27 | (255 & e[t + 10]) << 20 | (254 & e[t + 11]) << 12 | (255 & e[t + 12]) << 5 | (254 & e[t + 13]) >>> 3, n.pts *= 4, n.pts += (6 & e[t + 13]) >>> 1, n.dts = n.pts, 64 & i && (n.dts = (14 & e[t + 14]) << 27 | (255 & e[t + 15]) << 20 | (254 & e[t + 16]) << 12 | (255 & e[t + 17]) << 5 | (254 & e[t + 18]) >>> 3, n.dts *= 4, n.dts += (6 & e[t + 18]) >>> 1)), n }, videoPacketContainsKeyFrame: function (e) { for (var t = 4 + mi(e), i = e.subarray(t), n = 0, r = 0, a = !1; r < i.byteLength - 3; r++)if (1 === i[r + 2]) { n = r + 5; break } for (; n < i.byteLength;)switch (i[n]) { case 0: if (0 !== i[n - 1]) { n += 2; break } if (0 !== i[n - 2]) { n++; break } r + 3 !== n - 2 && "slice_layer_without_partitioning_rbsp_idr" === gi(31 & i[r + 3]) && (a = !0); do { n++ } while (1 !== i[n] && n < i.length); r = n - 2, n += 3; break; case 1: if (0 !== i[n - 1] || 0 !== i[n - 2]) { n += 3; break } "slice_layer_without_partitioning_rbsp_idr" === gi(31 & i[r + 3]) && (a = !0), r = n - 2, n += 3; break; default: n += 3 }return i = i.subarray(r), n -= r, r = 0, i && i.byteLength > 3 && "slice_layer_without_partitioning_rbsp_idr" === gi(31 & i[r + 3]) && (a = !0), a } }, vi = Ye, yi = {}; yi.ts = Ai, yi.aac = Et; var _i = fe, bi = 188, Ti = 71, xi = function (e, t, i) { for (var n, r, a, s, o = 0, u = bi, l = !1; u <= e.byteLength;)if (e[o] !== Ti || e[u] !== Ti && u !== e.byteLength) o++, u++; else { if (n = e.subarray(o, u), "pes" === yi.ts.parseType(n, t.pid)) r = yi.ts.parsePesType(n, t.table), a = yi.ts.parsePayloadUnitStartIndicator(n), "audio" === r && a && (s = yi.ts.parsePesTime(n)) && (s.type = "audio", i.audio.push(s), l = !0); if (l) break; o += bi, u += bi } for (o = (u = e.byteLength) - bi, l = !1; o >= 0;)if (e[o] !== Ti || e[u] !== Ti && u !== e.byteLength) o--, u--; else { if (n = e.subarray(o, u), "pes" === yi.ts.parseType(n, t.pid)) r = yi.ts.parsePesType(n, t.table), a = yi.ts.parsePayloadUnitStartIndicator(n), "audio" === r && a && (s = yi.ts.parsePesTime(n)) && (s.type = "audio", i.audio.push(s), l = !0); if (l) break; o -= bi, u -= bi } }, Si = function (e, t, i) { for (var n, r, a, s, o, u, l, c = 0, d = bi, h = !1, p = { data: [], size: 0 }; d < e.byteLength;)if (e[c] !== Ti || e[d] !== Ti) c++, d++; else { if (n = e.subarray(c, d), "pes" === yi.ts.parseType(n, t.pid)) if (r = yi.ts.parsePesType(n, t.table), a = yi.ts.parsePayloadUnitStartIndicator(n), "video" === r && (a && !h && (s = yi.ts.parsePesTime(n)) && (s.type = "video", i.video.push(s), h = !0), !i.firstKeyFrame)) { if (a && 0 !== p.size) { for (o = new Uint8Array(p.size), u = 0; p.data.length;)l = p.data.shift(), o.set(l, u), u += l.byteLength; if (yi.ts.videoPacketContainsKeyFrame(o)) { var f = yi.ts.parsePesTime(o); f ? (i.firstKeyFrame = f, i.firstKeyFrame.type = "video") : console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.") } p.size = 0 } p.data.push(n), p.size += n.byteLength } if (h && i.firstKeyFrame) break; c += bi, d += bi } for (c = (d = e.byteLength) - bi, h = !1; c >= 0;)if (e[c] !== Ti || e[d] !== Ti) c--, d--; else { if (n = e.subarray(c, d), "pes" === yi.ts.parseType(n, t.pid)) r = yi.ts.parsePesType(n, t.table), a = yi.ts.parsePayloadUnitStartIndicator(n), "video" === r && a && (s = yi.ts.parsePesTime(n)) && (s.type = "video", i.video.push(s), h = !0); if (h) break; c -= bi, d -= bi } }, Ei = function (e) { var t = { pid: null, table: null }, i = {}; for (var n in function (e, t) { for (var i, n = 0, r = bi; r < e.byteLength;)if (e[n] !== Ti || e[r] !== Ti) n++, r++; else { switch (i = e.subarray(n, r), yi.ts.parseType(i, t.pid)) { case "pat": t.pid = yi.ts.parsePat(i); break; case "pmt": var a = yi.ts.parsePmt(i); t.table = t.table || {}, Object.keys(a).forEach((function (e) { t.table[e] = a[e] })) }n += bi, r += bi } }(e, t), t.table) { if (t.table.hasOwnProperty(n)) switch (t.table[n]) { case Ge.H264_STREAM_TYPE: i.video = [], Si(e, t, i), 0 === i.video.length && delete i.video; break; case Ge.ADTS_STREAM_TYPE: i.audio = [], xi(e, t, i), 0 === i.audio.length && delete i.audio } } return i }, Ci = function (e, t) { var i; return i = yi.aac.isLikelyAacData(e) ? function (e) { for (var t, i = !1, n = 0, r = null, a = null, s = 0, o = 0; e.length - o >= 3;) { switch (yi.aac.parseType(e, o)) { case "timed-metadata": if (e.length - o < 10) { i = !0; break } if ((s = yi.aac.parseId3TagSize(e, o)) > e.length) { i = !0; break } null === a && (t = e.subarray(o, o + s), a = yi.aac.parseAacTimestamp(t)), o += s; break; case "audio": if (e.length - o < 7) { i = !0; break } if ((s = yi.aac.parseAdtsSize(e, o)) > e.length) { i = !0; break } null === r && (t = e.subarray(o, o + s), r = yi.aac.parseSampleRate(t)), n++, o += s; break; default: o++ }if (i) return null } if (null === r || null === a) return null; var u = _i / r; return { audio: [{ type: "audio", dts: a, pts: a }, { type: "audio", dts: a + 1024 * n * u, pts: a + 1024 * n * u }] } }(e) : Ei(e), i && (i.audio || i.video) ? (function (e, t) { if (e.audio && e.audio.length) { var i = t; (void 0 === i || isNaN(i)) && (i = e.audio[0].dts), e.audio.forEach((function (e) { e.dts = vi(e.dts, i), e.pts = vi(e.pts, i), e.dtsTime = e.dts / _i, e.ptsTime = e.pts / _i })) } if (e.video && e.video.length) { var n = t; if ((void 0 === n || isNaN(n)) && (n = e.video[0].dts), e.video.forEach((function (e) { e.dts = vi(e.dts, n), e.pts = vi(e.pts, n), e.dtsTime = e.dts / _i, e.ptsTime = e.pts / _i })), e.firstKeyFrame) { var r = e.firstKeyFrame; r.dts = vi(r.dts, n), r.pts = vi(r.pts, n), r.dtsTime = r.dts / _i, r.ptsTime = r.pts / _i } } }(i, t), i) : null }, wi = function () { function e(e, t) { this.options = t || {}, this.self = e, this.init() } var t = e.prototype; return t.init = function () { this.transmuxer && this.transmuxer.dispose(), this.transmuxer = new qt.Transmuxer(this.options), function (e, t) { t.on("data", (function (t) { var i = t.initSegment; t.initSegment = { data: i.buffer, byteOffset: i.byteOffset, byteLength: i.byteLength }; var n = t.data; t.data = n.buffer, e.postMessage({ action: "data", segment: t, byteOffset: n.byteOffset, byteLength: n.byteLength }, [t.data]) })), t.on("done", (function (t) { e.postMessage({ action: "done" }) })), t.on("gopInfo", (function (t) { e.postMessage({ action: "gopInfo", gopInfo: t }) })), t.on("videoSegmentTimingInfo", (function (t) { var i = { start: { decode: ge(t.start.dts), presentation: ge(t.start.pts) }, end: { decode: ge(t.end.dts), presentation: ge(t.end.pts) }, baseMediaDecodeTime: ge(t.baseMediaDecodeTime) }; t.prependedContentDuration && (i.prependedContentDuration = ge(t.prependedContentDuration)), e.postMessage({ action: "videoSegmentTimingInfo", videoSegmentTimingInfo: i }) })), t.on("audioSegmentTimingInfo", (function (t) { var i = { start: { decode: ge(t.start.dts), presentation: ge(t.start.pts) }, end: { decode: ge(t.end.dts), presentation: ge(t.end.pts) }, baseMediaDecodeTime: ge(t.baseMediaDecodeTime) }; t.prependedContentDuration && (i.prependedContentDuration = ge(t.prependedContentDuration)), e.postMessage({ action: "audioSegmentTimingInfo", audioSegmentTimingInfo: i }) })), t.on("id3Frame", (function (t) { e.postMessage({ action: "id3Frame", id3Frame: t }) })), t.on("caption", (function (t) { e.postMessage({ action: "caption", caption: t }) })), t.on("trackinfo", (function (t) { e.postMessage({ action: "trackinfo", trackInfo: t }) })), t.on("audioTimingInfo", (function (t) { e.postMessage({ action: "audioTimingInfo", audioTimingInfo: { start: ge(t.start), end: ge(t.end) } }) })), t.on("videoTimingInfo", (function (t) { e.postMessage({ action: "videoTimingInfo", videoTimingInfo: { start: ge(t.start), end: ge(t.end) } }) })), t.on("log", (function (t) { e.postMessage({ action: "log", log: t }) })) }(this.self, this.transmuxer) }, t.pushMp4Captions = function (e) { this.captionParser || (this.captionParser = new oi, this.captionParser.init()); var t = new Uint8Array(e.data, e.byteOffset, e.byteLength), i = this.captionParser.parse(t, e.trackIds, e.timescales); this.self.postMessage({ action: "mp4Captions", captions: i && i.captions || [], logs: i && i.logs || [], data: t.buffer }, [t.buffer]) }, t.probeMp4StartTime = function (e) { var t = e.timescales, i = e.data, n = di(t, i); this.self.postMessage({ action: "probeMp4StartTime", startTime: n, data: i }, [i.buffer]) }, t.probeMp4Tracks = function (e) { var t = e.data, i = hi(t); this.self.postMessage({ action: "probeMp4Tracks", tracks: i, data: t }, [t.buffer]) }, t.probeTs = function (e) { var t = e.data, i = e.baseStartTime, n = "number" != typeof i || isNaN(i) ? void 0 : i * fe, r = Ci(t, n), a = null; r && ((a = { hasVideo: r.video && 2 === r.video.length || !1, hasAudio: r.audio && 2 === r.audio.length || !1 }).hasVideo && (a.videoStart = r.video[0].ptsTime), a.hasAudio && (a.audioStart = r.audio[0].ptsTime)), this.self.postMessage({ action: "probeTs", result: a, data: t }, [t.buffer]) }, t.clearAllMp4Captions = function () { this.captionParser && this.captionParser.clearAllCaptions() }, t.clearParsedMp4Captions = function () { this.captionParser && this.captionParser.clearParsedCaptions() }, t.push = function (e) { var t = new Uint8Array(e.data, e.byteOffset, e.byteLength); this.transmuxer.push(t) }, t.reset = function () { this.transmuxer.reset() }, t.setTimestampOffset = function (e) { var t = e.timestampOffset || 0; this.transmuxer.setBaseMediaDecodeTime(Math.round(me(t))) }, t.setAudioAppendStart = function (e) { this.transmuxer.setAudioAppendStart(Math.ceil(me(e.appendStart))) }, t.setRemux = function (e) { this.transmuxer.setRemux(e.remux) }, t.flush = function (e) { this.transmuxer.flush(), self.postMessage({ action: "done", type: "transmuxed" }) }, t.endTimeline = function () { this.transmuxer.endTimeline(), self.postMessage({ action: "endedtimeline", type: "transmuxed" }) }, t.alignGopsWith = function (e) { this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice()) }, e }(); self.onmessage = function (e) { "init" === e.data.action && e.data.options ? this.messageHandlers = new wi(self, e.data.options) : (this.messageHandlers || (this.messageHandlers = new wi(self)), e.data && e.data.action && "init" !== e.data.action && this.messageHandlers[e.data.action] && this.messageHandlers[e.data.action](e.data)) } }))), pu = lu(hu), fu = function (e) { var t = e.transmuxer, i = e.bytes, n = e.audioAppendStart, r = e.gopsToAlignWith, a = e.remux, s = e.onData, o = e.onTrackInfo, u = e.onAudioTimingInfo, l = e.onVideoTimingInfo, c = e.onVideoSegmentTimingInfo, d = e.onAudioSegmentTimingInfo, h = e.onId3, p = e.onCaptions, f = e.onDone, m = e.onEndedTimeline, g = e.onTransmuxerLog, A = e.isEndOfTimeline, v = { buffer: [] }, y = A; if (t.onmessage = function (i) { t.currentTransmux === e && ("data" === i.data.action && function (e, t, i) { var n = e.data.segment, r = n.type, a = n.initSegment, s = n.captions, o = n.captionStreams, u = n.metadata, l = n.videoFrameDtsTime, c = n.videoFramePtsTime; t.buffer.push({ captions: s, captionStreams: o, metadata: u }); var d = e.data.segment.boxes || { data: e.data.segment.data }, h = { type: r, data: new Uint8Array(d.data, d.data.byteOffset, d.data.byteLength), initSegment: new Uint8Array(a.data, a.byteOffset, a.byteLength) }; void 0 !== l && (h.videoFrameDtsTime = l), void 0 !== c && (h.videoFramePtsTime = c), i(h) }(i, v, s), "trackinfo" === i.data.action && o(i.data.trackInfo), "gopInfo" === i.data.action && function (e, t) { t.gopInfo = e.data.gopInfo }(i, v), "audioTimingInfo" === i.data.action && u(i.data.audioTimingInfo), "videoTimingInfo" === i.data.action && l(i.data.videoTimingInfo), "videoSegmentTimingInfo" === i.data.action && c(i.data.videoSegmentTimingInfo), "audioSegmentTimingInfo" === i.data.action && d(i.data.audioSegmentTimingInfo), "id3Frame" === i.data.action && h([i.data.id3Frame], i.data.id3Frame.dispatchType), "caption" === i.data.action && p(i.data.caption), "endedtimeline" === i.data.action && (y = !1, m()), "log" === i.data.action && g(i.data.log), "transmuxed" === i.data.type && (y || (t.onmessage = null, function (e) { var t = e.transmuxedData, i = e.callback; t.buffer = [], i(t) }({ transmuxedData: v, callback: f }), mu(t)))) }, n && t.postMessage({ action: "setAudioAppendStart", appendStart: n }), Array.isArray(r) && t.postMessage({ action: "alignGopsWith", gopsToAlignWith: r }), void 0 !== a && t.postMessage({ action: "setRemux", remux: a }), i.byteLength) { var _ = i instanceof ArrayBuffer ? i : i.buffer, b = i instanceof ArrayBuffer ? 0 : i.byteOffset; t.postMessage({ action: "push", data: _, byteOffset: b, byteLength: i.byteLength }, [_]) } A && t.postMessage({ action: "endTimeline" }), t.postMessage({ action: "flush" }) }, mu = function (e) { e.currentTransmux = null, e.transmuxQueue.length && (e.currentTransmux = e.transmuxQueue.shift(), "function" == typeof e.currentTransmux ? e.currentTransmux() : fu(e.currentTransmux)) }, gu = function (e, t) { e.postMessage({ action: t }), mu(e) }, Au = function (e, t) { if (!t.currentTransmux) return t.currentTransmux = e, void gu(t, e); t.transmuxQueue.push(gu.bind(null, t, e)) }, vu = function (e) { if (!e.transmuxer.currentTransmux) return e.transmuxer.currentTransmux = e, void fu(e); e.transmuxer.transmuxQueue.push(e) }, yu = function (e) { Au("reset", e) }, _u = function (e) { var t = new pu; t.currentTransmux = null, t.transmuxQueue = []; var i = t.terminate; return t.terminate = function () { return t.currentTransmux = null, t.transmuxQueue.length = 0, i.call(t) }, t.postMessage({ action: "init", options: e }), t }, bu = function (e) { var t = e.transmuxer, i = e.endAction || e.action, n = e.callback, r = o({}, e, { endAction: null, transmuxer: null, callback: null }); if (t.addEventListener("message", (function r(a) { a.data.action === i && (t.removeEventListener("message", r), a.data.data && (a.data.data = new Uint8Array(a.data.data, e.byteOffset || 0, e.byteLength || a.data.data.byteLength), e.data && (e.data = a.data.data)), n(a.data)) })), e.data) { var a = e.data instanceof ArrayBuffer; r.byteOffset = a ? 0 : e.data.byteOffset, r.byteLength = e.data.byteLength; var s = [a ? e.data : e.data.buffer]; t.postMessage(r, s) } else t.postMessage(r) }, Tu = 2, xu = -101, Su = -102, Eu = function (e) { e.forEach((function (e) { e.abort() })) }, Cu = function (e, t) { return t.timedout ? { status: t.status, message: "HLS request timed-out at URL: " + t.uri, code: xu, xhr: t } : t.aborted ? { status: t.status, message: "HLS request aborted at URL: " + t.uri, code: Su, xhr: t } : e ? { status: t.status, message: "HLS request errored at URL: " + t.uri, code: Tu, xhr: t } : "arraybuffer" === t.responseType && 0 === t.response.byteLength ? { status: t.status, message: "Empty HLS response at URL: " + t.uri, code: Tu, xhr: t } : null }, wu = function (e, t, i) { return function (n, r) { var a = r.response, s = Cu(n, r); if (s) return i(s, e); if (16 !== a.byteLength) return i({ status: r.status, message: "Invalid HLS key at URL: " + r.uri, code: Tu, xhr: r }, e); for (var o = new DataView(a), u = new Uint32Array([o.getUint32(0), o.getUint32(4), o.getUint32(8), o.getUint32(12)]), l = 0; l < t.length; l++)t[l].bytes = u; return i(null, e) } }, ku = function (e, t) { var i = kt(e.map.bytes); if ("mp4" !== i) { var n = e.map.resolvedUri || e.map.uri; return t({ internal: !0, message: "Found unsupported " + (i || "unknown") + " container for initialization segment at URL: " + n, code: Tu }) } bu({ action: "probeMp4Tracks", data: e.map.bytes, transmuxer: e.transmuxer, callback: function (i) { var n = i.tracks, r = i.data; return e.map.bytes = r, n.forEach((function (t) { e.map.tracks = e.map.tracks || {}, e.map.tracks[t.type] || (e.map.tracks[t.type] = t, "number" == typeof t.id && t.timescale && (e.map.timescales = e.map.timescales || {}, e.map.timescales[t.id] = t.timescale)) })), t(null) } }) }, Fu = function (e) { var t = e.segment, i = e.finishProcessingFn, n = e.responseType; return function (e, r) { var a = Cu(e, r); if (a) return i(a, t); var s = "arraybuffer" !== n && r.responseText ? function (e) { for (var t = new Uint8Array(new ArrayBuffer(e.length)), i = 0; i < e.length; i++)t[i] = e.charCodeAt(i); return t.buffer }(r.responseText.substring(t.lastReachedChar || 0)) : r.response; return t.stats = function (e) { return { bandwidth: e.bandwidth, bytesReceived: e.bytesReceived || 0, roundTripTime: e.roundTripTime || 0 } }(r), t.key ? t.encryptedBytes = new Uint8Array(s) : t.bytes = new Uint8Array(s), i(null, t) } }, Iu = function (e) { var t = e.segment, i = e.bytes, n = e.trackInfoFn, r = e.timingInfoFn, a = e.videoSegmentTimingInfoFn, s = e.audioSegmentTimingInfoFn, o = e.id3Fn, u = e.captionsFn, l = e.isEndOfTimeline, c = e.endedTimelineFn, d = e.dataFn, h = e.doneFn, p = e.onTransmuxerLog, f = t.map && t.map.tracks || {}, m = Boolean(f.audio && f.video), g = r.bind(null, t, "audio", "start"), A = r.bind(null, t, "audio", "end"), v = r.bind(null, t, "video", "start"), y = r.bind(null, t, "video", "end"); bu({ action: "probeTs", transmuxer: t.transmuxer, data: i, baseStartTime: t.baseStartTime, callback: function (e) { t.bytes = i = e.data; var r = e.result; r && (n(t, { hasAudio: r.hasAudio, hasVideo: r.hasVideo, isMuxed: m }), n = null, r.hasAudio && !m && g(r.audioStart), r.hasVideo && v(r.videoStart), g = null, v = null), vu({ bytes: i, transmuxer: t.transmuxer, audioAppendStart: t.audioAppendStart, gopsToAlignWith: t.gopsToAlignWith, remux: m, onData: function (e) { e.type = "combined" === e.type ? "video" : e.type, d(t, e) }, onTrackInfo: function (e) { n && (m && (e.isMuxed = !0), n(t, e)) }, onAudioTimingInfo: function (e) { g && void 0 !== e.start && (g(e.start), g = null), A && void 0 !== e.end && A(e.end) }, onVideoTimingInfo: function (e) { v && void 0 !== e.start && (v(e.start), v = null), y && void 0 !== e.end && y(e.end) }, onVideoSegmentTimingInfo: function (e) { a(e) }, onAudioSegmentTimingInfo: function (e) { s(e) }, onId3: function (e, i) { o(t, e, i) }, onCaptions: function (e) { u(t, [e]) }, isEndOfTimeline: l, onEndedTimeline: function () { c() }, onTransmuxerLog: p, onDone: function (e) { h && (e.type = "combined" === e.type ? "video" : e.type, h(null, t, e)) } }) } }) }, Du = function (e) { var t = e.segment, i = e.bytes, n = e.trackInfoFn, r = e.timingInfoFn, a = e.videoSegmentTimingInfoFn, s = e.audioSegmentTimingInfoFn, o = e.id3Fn, u = e.captionsFn, l = e.isEndOfTimeline, c = e.endedTimelineFn, d = e.dataFn, h = e.doneFn, p = e.onTransmuxerLog, f = new Uint8Array(i); if (function (e) { return dt(e, ["moof"]).length > 0 }(f)) { t.isFmp4 = !0; var m = t.map.tracks, g = { isFmp4: !0, hasVideo: !!m.video, hasAudio: !!m.audio }; m.audio && m.audio.codec && "enca" !== m.audio.codec && (g.audioCodec = m.audio.codec), m.video && m.video.codec && "encv" !== m.video.codec && (g.videoCodec = m.video.codec), m.video && m.audio && (g.isMuxed = !0), n(t, g); var A = function (e) { d(t, { data: f, type: g.hasAudio && !g.isMuxed ? "audio" : "video" }), e && e.length && u(t, e), h(null, t, {}) }; bu({ action: "probeMp4StartTime", timescales: t.map.timescales, data: f, transmuxer: t.transmuxer, callback: function (e) { var n = e.data, a = e.startTime; i = n.buffer, t.bytes = f = n, g.hasAudio && !g.isMuxed && r(t, "audio", "start", a), g.hasVideo && r(t, "video", "start", a), m.video && n.byteLength && t.transmuxer ? bu({ action: "pushMp4Captions", endAction: "mp4Captions", transmuxer: t.transmuxer, data: f, timescales: t.map.timescales, trackIds: [m.video.id], callback: function (e) { i = e.data.buffer, t.bytes = f = e.data, e.logs.forEach((function (e) { p(qs.mergeOptions(e, { stream: "mp4CaptionParser" })) })), A(e.captions) } }) : A() } }) } else if (t.transmuxer) { if (void 0 === t.container && (t.container = kt(f)), "ts" !== t.container && "aac" !== t.container) return n(t, { hasAudio: !1, hasVideo: !1 }), void h(null, t, {}); Iu({ segment: t, bytes: i, trackInfoFn: n, timingInfoFn: r, videoSegmentTimingInfoFn: a, audioSegmentTimingInfoFn: s, id3Fn: o, captionsFn: u, isEndOfTimeline: l, endedTimelineFn: c, dataFn: d, doneFn: h, onTransmuxerLog: p }) } else h(null, t, {}) }, Pu = function (e, t) { var i, n = e.id, r = e.key, a = e.encryptedBytes, s = e.decryptionWorker; s.addEventListener("message", (function e(i) { if (i.data.source === n) { s.removeEventListener("message", e); var r = i.data.decrypted; t(new Uint8Array(r.bytes, r.byteOffset, r.byteLength)) } })), i = r.bytes.slice ? r.bytes.slice() : new Uint32Array(Array.prototype.slice.call(r.bytes)), s.postMessage(zo({ source: n, encrypted: a, key: i, iv: r.iv }), [a.buffer, i.buffer]) }, Lu = function (e) { var t = e.activeXhrs, i = e.decryptionWorker, n = e.trackInfoFn, r = e.timingInfoFn, a = e.videoSegmentTimingInfoFn, s = e.audioSegmentTimingInfoFn, o = e.id3Fn, u = e.captionsFn, l = e.isEndOfTimeline, c = e.endedTimelineFn, d = e.dataFn, h = e.doneFn, p = e.onTransmuxerLog, f = 0, m = !1; return function (e, g) { if (!m) { if (e) return m = !0, Eu(t), h(e, g); if ((f += 1) === t.length) { var A = function () { if (g.encryptedBytes) return function (e) { var t = e.decryptionWorker, i = e.segment, n = e.trackInfoFn, r = e.timingInfoFn, a = e.videoSegmentTimingInfoFn, s = e.audioSegmentTimingInfoFn, o = e.id3Fn, u = e.captionsFn, l = e.isEndOfTimeline, c = e.endedTimelineFn, d = e.dataFn, h = e.doneFn, p = e.onTransmuxerLog; Pu({ id: i.requestId, key: i.key, encryptedBytes: i.encryptedBytes, decryptionWorker: t }, (function (e) { i.bytes = e, Du({ segment: i, bytes: i.bytes, trackInfoFn: n, timingInfoFn: r, videoSegmentTimingInfoFn: a, audioSegmentTimingInfoFn: s, id3Fn: o, captionsFn: u, isEndOfTimeline: l, endedTimelineFn: c, dataFn: d, doneFn: h, onTransmuxerLog: p }) })) }({ decryptionWorker: i, segment: g, trackInfoFn: n, timingInfoFn: r, videoSegmentTimingInfoFn: a, audioSegmentTimingInfoFn: s, id3Fn: o, captionsFn: u, isEndOfTimeline: l, endedTimelineFn: c, dataFn: d, doneFn: h, onTransmuxerLog: p }); Du({ segment: g, bytes: g.bytes, trackInfoFn: n, timingInfoFn: r, videoSegmentTimingInfoFn: a, audioSegmentTimingInfoFn: s, id3Fn: o, captionsFn: u, isEndOfTimeline: l, endedTimelineFn: c, dataFn: d, doneFn: h, onTransmuxerLog: p }) }; if (g.endOfAllRequests = Date.now(), g.map && g.map.encryptedBytes && !g.map.bytes) return Pu({ decryptionWorker: i, id: g.requestId + "-init", encryptedBytes: g.map.encryptedBytes, key: g.map.key }, (function (e) { g.map.bytes = e, ku(g, (function (e) { if (e) return Eu(t), h(e, g); A() })) })); A() } } } }, Ou = function (e) { var t = e.segment, i = e.progressFn; return e.trackInfoFn, e.timingInfoFn, e.videoSegmentTimingInfoFn, e.audioSegmentTimingInfoFn, e.id3Fn, e.captionsFn, e.isEndOfTimeline, e.endedTimelineFn, e.dataFn, function (e) { if (!e.target.aborted) return t.stats = qs.mergeOptions(t.stats, function (e) { var t = e.target, i = { bandwidth: 1 / 0, bytesReceived: 0, roundTripTime: Date.now() - t.requestTime || 0 }; return i.bytesReceived = e.loaded, i.bandwidth = Math.floor(i.bytesReceived / i.roundTripTime * 8 * 1e3), i }(e)), !t.stats.firstBytesReceivedAt && t.stats.bytesReceived && (t.stats.firstBytesReceivedAt = Date.now()), i(e, t) } }, Bu = function (e) { var t = e.xhr, i = e.xhrOptions, n = e.decryptionWorker, r = e.segment, a = e.abortFn, s = e.progressFn, o = e.trackInfoFn, u = e.timingInfoFn, l = e.videoSegmentTimingInfoFn, c = e.audioSegmentTimingInfoFn, d = e.id3Fn, h = e.captionsFn, p = e.isEndOfTimeline, f = e.endedTimelineFn, m = e.dataFn, g = e.doneFn, A = e.onTransmuxerLog, v = [], y = Lu({ activeXhrs: v, decryptionWorker: n, trackInfoFn: o, timingInfoFn: u, videoSegmentTimingInfoFn: l, audioSegmentTimingInfoFn: c, id3Fn: d, captionsFn: h, isEndOfTimeline: p, endedTimelineFn: f, dataFn: m, doneFn: g, onTransmuxerLog: A }); if (r.key && !r.key.bytes) { var _ = [r.key]; r.map && !r.map.bytes && r.map.key && r.map.key.resolvedUri === r.key.resolvedUri && _.push(r.map.key); var b = t(qs.mergeOptions(i, { uri: r.key.resolvedUri, responseType: "arraybuffer" }), wu(r, _, y)); v.push(b) } if (r.map && !r.map.bytes) { if (r.map.key && (!r.key || r.key.resolvedUri !== r.map.key.resolvedUri)) { var T = t(qs.mergeOptions(i, { uri: r.map.key.resolvedUri, responseType: "arraybuffer" }), wu(r, [r.map.key], y)); v.push(T) } var x = qs.mergeOptions(i, { uri: r.map.resolvedUri, responseType: "arraybuffer", headers: Vo(r.map) }), S = function (e) { var t = e.segment, i = e.finishProcessingFn; return function (e, n) { var r = Cu(e, n); if (r) return i(r, t); var a = new Uint8Array(n.response); if (t.map.key) return t.map.encryptedBytes = a, i(null, t); t.map.bytes = a, ku(t, (function (e) { if (e) return e.xhr = n, e.status = n.status, i(e, t); i(null, t) })) } }({ segment: r, finishProcessingFn: y }), E = t(x, S); v.push(E) } var C = qs.mergeOptions(i, { uri: r.part && r.part.resolvedUri || r.resolvedUri, responseType: "arraybuffer", headers: Vo(r) }), w = t(C, Fu({ segment: r, finishProcessingFn: y, responseType: C.responseType })); w.addEventListener("progress", Ou({ segment: r, progressFn: s, trackInfoFn: o, timingInfoFn: u, videoSegmentTimingInfoFn: l, audioSegmentTimingInfoFn: c, id3Fn: d, captionsFn: h, isEndOfTimeline: p, endedTimelineFn: f, dataFn: m })), v.push(w); var k = {}; return v.forEach((function (e) { e.addEventListener("loadend", function (e) { var t = e.loadendState, i = e.abortFn; return function (e) { e.target.aborted && i && !t.calledAbortFn && (i(), t.calledAbortFn = !0) } }({ loadendState: k, abortFn: a })) })), function () { return Eu(v) } }, Ru = Xs("CodecUtils"), Mu = function (e, t) { var i = t.attributes || {}; return e && e.mediaGroups && e.mediaGroups.AUDIO && i.AUDIO && e.mediaGroups.AUDIO[i.AUDIO] }, Nu = function (e) { var t = {}; return e.forEach((function (e) { var i = e.mediaType, n = e.type, r = e.details; t[i] = t[i] || [], t[i].push(H("" + n + r)) })), Object.keys(t).forEach((function (e) { if (t[e].length > 1) return Ru("multiple " + e + " codecs found as attributes: " + t[e].join(", ") + ". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs."), void (t[e] = null); t[e] = t[e][0] })), t }, Uu = function (e) { var t = 0; return e.audio && t++, e.video && t++, t }, ju = function (e, t) { var i = t.attributes || {}, n = Nu(function (e) { var t = e.attributes || {}; if (t.CODECS) return V(t.CODECS) }(t) || []); if (Mu(e, t) && !n.audio && !function (e, t) { if (!Mu(e, t)) return !0; var i = t.attributes || {}, n = e.mediaGroups.AUDIO[i.AUDIO]; for (var r in n) if (!n[r].uri && !n[r].playlists) return !0; return !1 }(e, t)) { var r = Nu(function (e, t) { if (!e.mediaGroups.AUDIO || !t) return null; var i = e.mediaGroups.AUDIO[t]; if (!i) return null; for (var n in i) { var r = i[n]; if (r.default && r.playlists) return V(r.playlists[0].attributes.CODECS) } return null }(e, i.AUDIO) || []); r.audio && (n.audio = r.audio) } return n }, Hu = Xs("PlaylistSelector"), Vu = function (e) { if (e && e.playlist) { var t = e.playlist; return JSON.stringify({ id: t.id, bandwidth: e.bandwidth, width: e.width, height: e.height, codecs: t.attributes && t.attributes.CODECS || "" }) } }, qu = function (e, t) { if (!e) return ""; var i = r().getComputedStyle(e); return i ? i[t] : "" }, Wu = function (e, t) { var i = e.slice(); e.sort((function (e, n) { var r = t(e, n); return 0 === r ? i.indexOf(e) - i.indexOf(n) : r })) }, Gu = function (e, t) { var i, n; return e.attributes.BANDWIDTH && (i = e.attributes.BANDWIDTH), i = i || r().Number.MAX_VALUE, t.attributes.BANDWIDTH && (n = t.attributes.BANDWIDTH), i - (n = n || r().Number.MAX_VALUE) }, zu = function (e, t, i, n, a, s) { if (e) { var o = { bandwidth: t, width: i, height: n, limitRenditionByPlayerDimensions: a }, u = e.playlists; xo.isAudioOnly(e) && (u = s.getAudioTrackPlaylists_(), o.audioOnly = !0); var l = u.map((function (e) { var t = e.attributes && e.attributes.RESOLUTION && e.attributes.RESOLUTION.width, i = e.attributes && e.attributes.RESOLUTION && e.attributes.RESOLUTION.height; return { bandwidth: e.attributes && e.attributes.BANDWIDTH || r().Number.MAX_VALUE, width: t, height: i, playlist: e } })); Wu(l, (function (e, t) { return e.bandwidth - t.bandwidth })); var c = (l = l.filter((function (e) { return !xo.isIncompatible(e.playlist) }))).filter((function (e) { return xo.isEnabled(e.playlist) })); c.length || (c = l.filter((function (e) { return !xo.isDisabled(e.playlist) }))); var d = c.filter((function (e) { return e.bandwidth * ou.BANDWIDTH_VARIANCE < t })), h = d[d.length - 1], p = d.filter((function (e) { return e.bandwidth === h.bandwidth }))[0]; if (!1 === a) { var f = p || c[0] || l[0]; if (f && f.playlist) { var m = "sortedPlaylistReps"; return p && (m = "bandwidthBestRep"), c[0] && (m = "enabledPlaylistReps"), Hu("choosing " + Vu(f) + " using " + m + " with options", o), f.playlist } return Hu("could not choose a playlist with options", o), null } var g = d.filter((function (e) { return e.width && e.height })); Wu(g, (function (e, t) { return e.width - t.width })); var A = g.filter((function (e) { return e.width === i && e.height === n })); h = A[A.length - 1]; var v, y, _, b, T = A.filter((function (e) { return e.bandwidth === h.bandwidth }))[0]; if (T || (y = (v = g.filter((function (e) { return e.width > i || e.height > n }))).filter((function (e) { return e.width === v[0].width && e.height === v[0].height })), h = y[y.length - 1], _ = y.filter((function (e) { return e.bandwidth === h.bandwidth }))[0]), s.experimentalLeastPixelDiffSelector) { var x = g.map((function (e) { return e.pixelDiff = Math.abs(e.width - i) + Math.abs(e.height - n), e })); Wu(x, (function (e, t) { return e.pixelDiff === t.pixelDiff ? t.bandwidth - e.bandwidth : e.pixelDiff - t.pixelDiff })), b = x[0] } var S = b || _ || T || p || c[0] || l[0]; if (S && S.playlist) { var E = "sortedPlaylistReps"; return b ? E = "leastPixelDiffRep" : _ ? E = "resolutionPlusOneRep" : T ? E = "resolutionBestRep" : p ? E = "bandwidthBestRep" : c[0] && (E = "enabledPlaylistReps"), Hu("choosing " + Vu(S) + " using " + E + " with options", o), S.playlist } return Hu("could not choose a playlist with options", o), null } }, Qu = function () { var e = this.useDevicePixelRatio && r().devicePixelRatio || 1; return zu(this.playlists.master, this.systemBandwidth, parseInt(qu(this.tech_.el(), "width"), 10) * e, parseInt(qu(this.tech_.el(), "height"), 10) * e, this.limitRenditionByPlayerDimensions, this.masterPlaylistController_) }, Xu = function (e) { var t = e.inbandTextTracks, i = e.metadataArray, n = e.timestampOffset, a = e.videoDuration; if (i) { var s = r().WebKitDataCue || r().VTTCue, o = t.metadataTrack_; if (o && (i.forEach((function (e) { var t = e.cueTime + n; !("number" != typeof t || r().isNaN(t) || t < 0) && t < 1 / 0 && e.frames.forEach((function (e) { var i = new s(t, t, e.value || e.url || e.data || ""); i.frame = e, i.value = e, function (e) { Object.defineProperties(e.frame, { id: { get: function () { return qs.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."), e.value.key } }, value: { get: function () { return qs.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."), e.value.data } }, privateData: { get: function () { return qs.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."), e.value.data } } }) }(i), o.addCue(i) })) })), o.cues && o.cues.length)) { for (var u = o.cues, l = [], c = 0; c < u.length; c++)u[c] && l.push(u[c]); var d = l.reduce((function (e, t) { var i = e[t.startTime] || []; return i.push(t), e[t.startTime] = i, e }), {}), h = Object.keys(d).sort((function (e, t) { return Number(e) - Number(t) })); h.forEach((function (e, t) { var i = d[e], n = Number(h[t + 1]) || a; i.forEach((function (e) { e.endTime = n })) })) } } }, $u = function (e, t, i) { var n, r; if (i && i.cues) for (n = i.cues.length; n--;)(r = i.cues[n]).startTime >= e && r.endTime <= t && i.removeCue(r) }, Ku = function (e) { return "number" == typeof e && isFinite(e) }, Yu = 1 / 60, Zu = function (e) { var t = e.startOfSegment, i = e.duration, n = e.segment, r = e.part, a = e.playlist, s = a.mediaSequence, o = a.id, u = a.segments, l = void 0 === u ? [] : u, c = e.mediaIndex, d = e.partIndex, h = e.timeline, p = l.length - 1, f = "mediaIndex/partIndex increment"; e.getMediaInfoForTime ? f = "getMediaInfoForTime (" + e.getMediaInfoForTime + ")" : e.isSyncRequest && (f = "getSyncSegmentCandidate (isSyncRequest)"), e.independent && (f += " with independent " + e.independent); var m = "number" == typeof d, g = e.segment.uri ? "segment" : "pre-segment", A = m ? uo({ preloadSegment: n }) - 1 : 0; return g + " [" + (s + c) + "/" + (s + p) + "]" + (m ? " part [" + d + "/" + A + "]" : "") + " segment start/end [" + n.start + " => " + n.end + "]" + (m ? " part start/end [" + r.start + " => " + r.end + "]" : "") + " startOfSegment [" + t + "] duration [" + i + "] timeline [" + h + "] selected by [" + f + "] playlist [" + o + "]" }, Ju = function (e) { return e + "TimingInfo" }, el = function (e) { var t = e.timelineChangeController, i = e.currentTimeline, n = e.segmentTimeline, r = e.loaderType, a = e.audioDisabled; if (i === n) return !1; if ("audio" === r) { var s = t.lastTimelineChange({ type: "main" }); return !s || s.to !== n } if ("main" === r && a) { var o = t.pendingTimelineChange({ type: "audio" }); return !o || o.to !== n } return !1 }, tl = function (e) { var t = e.segmentDuration, i = e.maxDuration; return !!t && Math.round(t) > i + $s }, il = function (e, t) { if ("hls" !== t) return null; var i, n, a = (i = { audioTimingInfo: e.audioTimingInfo, videoTimingInfo: e.videoTimingInfo }, n = 0, ["video", "audio"].forEach((function (e) { var t = i[e + "TimingInfo"]; if (t) { var a, s = t.start, o = t.end; "bigint" == typeof s || "bigint" == typeof o ? a = r().BigInt(o) - r().BigInt(s) : "number" == typeof s && "number" == typeof o && (a = o - s), void 0 !== a && a > n && (n = a) } })), "bigint" == typeof n && n < Number.MAX_SAFE_INTEGER && (n = Number(n)), n); if (!a) return null; var s = e.playlist.targetDuration, o = tl({ segmentDuration: a, maxDuration: 2 * s }), u = tl({ segmentDuration: a, maxDuration: s }), l = "Segment with index " + e.mediaIndex + " from playlist " + e.playlist.id + " has a duration of " + a + " when the reported duration is " + e.duration + " and the target duration is " + s + ". For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1"; return o || u ? { severity: o ? "warn" : "info", message: l } : null }, nl = function (e) { function t(t, i) { var n; if (n = e.call(this) || this, !t) throw new TypeError("Initialization settings are required"); if ("function" != typeof t.currentTime) throw new TypeError("No currentTime getter specified"); if (!t.mediaSource) throw new TypeError("No MediaSource specified"); return n.bandwidth = t.bandwidth, n.throughput = { rate: 0, count: 0 }, n.roundTrip = NaN, n.resetStats_(), n.mediaIndex = null, n.partIndex = null, n.hasPlayed_ = t.hasPlayed, n.currentTime_ = t.currentTime, n.seekable_ = t.seekable, n.seeking_ = t.seeking, n.duration_ = t.duration, n.mediaSource_ = t.mediaSource, n.vhs_ = t.vhs, n.loaderType_ = t.loaderType, n.currentMediaInfo_ = void 0, n.startingMediaInfo_ = void 0, n.segmentMetadataTrack_ = t.segmentMetadataTrack, n.goalBufferLength_ = t.goalBufferLength, n.sourceType_ = t.sourceType, n.sourceUpdater_ = t.sourceUpdater, n.inbandTextTracks_ = t.inbandTextTracks, n.state_ = "INIT", n.timelineChangeController_ = t.timelineChangeController, n.shouldSaveSegmentTimingInfo_ = !0, n.parse708captions_ = t.parse708captions, n.captionServices_ = t.captionServices, n.experimentalExactManifestTimings = t.experimentalExactManifestTimings, n.checkBufferTimeout_ = null, n.error_ = void 0, n.currentTimeline_ = -1, n.pendingSegment_ = null, n.xhrOptions_ = null, n.pendingSegments_ = [], n.audioDisabled_ = !1, n.isPendingTimestampOffset_ = !1, n.gopBuffer_ = [], n.timeMapping_ = 0, n.safeAppend_ = qs.browser.IE_VERSION >= 11, n.appendInitSegment_ = { audio: !0, video: !0 }, n.playlistOfLastInitSegment_ = { audio: null, video: null }, n.callQueue_ = [], n.loadQueue_ = [], n.metadataQueue_ = { id3: [], caption: [] }, n.waitingOnRemove_ = !1, n.quotaExceededErrorRetryTimeout_ = null, n.activeInitSegmentId_ = null, n.initSegments_ = {}, n.cacheEncryptionKeys_ = t.cacheEncryptionKeys, n.keyCache_ = {}, n.decrypter_ = t.decrypter, n.syncController_ = t.syncController, n.syncPoint_ = { segmentIndex: 0, time: 0 }, n.transmuxer_ = n.createTransmuxer_(), n.triggerSyncInfoUpdate_ = function () { return n.trigger("syncinfoupdate") }, n.syncController_.on("syncinfoupdate", n.triggerSyncInfoUpdate_), n.mediaSource_.addEventListener("sourceopen", (function () { n.isEndOfStream_() || (n.ended_ = !1) })), n.fetchAtBuffer_ = !1, n.logger_ = Xs("SegmentLoader[" + n.loaderType_ + "]"), Object.defineProperty(c(n), "state", { get: function () { return this.state_ }, set: function (e) { e !== this.state_ && (this.logger_(this.state_ + " -> " + e), this.state_ = e, this.trigger("statechange")) } }), n.sourceUpdater_.on("ready", (function () { n.hasEnoughInfoToAppend_() && n.processCallQueue_() })), "main" === n.loaderType_ && n.timelineChangeController_.on("pendingtimelinechange", (function () { n.hasEnoughInfoToAppend_() && n.processCallQueue_() })), "audio" === n.loaderType_ && n.timelineChangeController_.on("timelinechange", (function () { n.hasEnoughInfoToLoad_() && n.processLoadQueue_(), n.hasEnoughInfoToAppend_() && n.processCallQueue_() })), n } h(t, e); var i = t.prototype; return i.createTransmuxer_ = function () { return _u({ remux: !1, alignGopsAtEnd: this.safeAppend_, keepOriginalTimestamps: !0, parse708captions: this.parse708captions_, captionServices: this.captionServices_ }) }, i.resetStats_ = function () { this.mediaBytesTransferred = 0, this.mediaRequests = 0, this.mediaRequestsAborted = 0, this.mediaRequestsTimedout = 0, this.mediaRequestsErrored = 0, this.mediaTransferDuration = 0, this.mediaSecondsLoaded = 0, this.mediaAppends = 0 }, i.dispose = function () { this.trigger("dispose"), this.state = "DISPOSED", this.pause(), this.abort_(), this.transmuxer_ && this.transmuxer_.terminate(), this.resetStats_(), this.checkBufferTimeout_ && r().clearTimeout(this.checkBufferTimeout_), this.syncController_ && this.triggerSyncInfoUpdate_ && this.syncController_.off("syncinfoupdate", this.triggerSyncInfoUpdate_), this.off() }, i.setAudio = function (e) { this.audioDisabled_ = !e, e ? this.appendInitSegment_.audio = !0 : this.sourceUpdater_.removeAudio(0, this.duration_()) }, i.abort = function () { "WAITING" === this.state ? (this.abort_(), this.state = "READY", this.paused() || this.monitorBuffer_()) : this.pendingSegment_ && (this.pendingSegment_ = null) }, i.abort_ = function () { this.pendingSegment_ && this.pendingSegment_.abortRequests && this.pendingSegment_.abortRequests(), this.pendingSegment_ = null, this.callQueue_ = [], this.loadQueue_ = [], this.metadataQueue_.id3 = [], this.metadataQueue_.caption = [], this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_), this.waitingOnRemove_ = !1, r().clearTimeout(this.quotaExceededErrorRetryTimeout_), this.quotaExceededErrorRetryTimeout_ = null }, i.checkForAbort_ = function (e) { return "APPENDING" !== this.state || this.pendingSegment_ ? !this.pendingSegment_ || this.pendingSegment_.requestId !== e : (this.state = "READY", !0) }, i.error = function (e) { return void 0 !== e && (this.logger_("error occurred:", e), this.error_ = e), this.pendingSegment_ = null, this.error_ }, i.endOfStream = function () { this.ended_ = !0, this.transmuxer_ && yu(this.transmuxer_), this.gopBuffer_.length = 0, this.pause(), this.trigger("ended") }, i.buffered_ = function () { var e = this.getMediaInfo_(); if (!this.sourceUpdater_ || !e) return qs.createTimeRanges(); if ("main" === this.loaderType_) { var t = e.hasAudio, i = e.hasVideo, n = e.isMuxed; if (i && t && !this.audioDisabled_ && !n) return this.sourceUpdater_.buffered(); if (i) return this.sourceUpdater_.videoBuffered() } return this.sourceUpdater_.audioBuffered() }, i.initSegmentForMap = function (e, t) { if (void 0 === t && (t = !1), !e) return null; var i = Qo(e), n = this.initSegments_[i]; return t && !n && e.bytes && (this.initSegments_[i] = n = { resolvedUri: e.resolvedUri, byterange: e.byterange, bytes: e.bytes, tracks: e.tracks, timescales: e.timescales }), n || e }, i.segmentKey = function (e, t) { if (void 0 === t && (t = !1), !e) return null; var i = Xo(e), n = this.keyCache_[i]; this.cacheEncryptionKeys_ && t && !n && e.bytes && (this.keyCache_[i] = n = { resolvedUri: e.resolvedUri, bytes: e.bytes }); var r = { resolvedUri: (n || e).resolvedUri }; return n && (r.bytes = n.bytes), r }, i.couldBeginLoading_ = function () { return this.playlist_ && !this.paused() }, i.load = function () { if (this.monitorBuffer_(), this.playlist_) return "INIT" === this.state && this.couldBeginLoading_() ? this.init_() : void (!this.couldBeginLoading_() || "READY" !== this.state && "INIT" !== this.state || (this.state = "READY")) }, i.init_ = function () { return this.state = "READY", this.resetEverything(), this.monitorBuffer_() }, i.playlist = function (e, t) { if (void 0 === t && (t = {}), e) { var i = this.playlist_, n = this.pendingSegment_; this.playlist_ = e, this.xhrOptions_ = t, "INIT" === this.state && (e.syncInfo = { mediaSequence: e.mediaSequence, time: 0 }, "main" === this.loaderType_ && this.syncController_.setDateTimeMappingForStart(e)); var r = null; if (i && (i.id ? r = i.id : i.uri && (r = i.uri)), this.logger_("playlist update [" + r + " => " + (e.id || e.uri) + "]"), this.trigger("syncinfoupdate"), "INIT" === this.state && this.couldBeginLoading_()) return this.init_(); if (!i || i.uri !== e.uri) return null !== this.mediaIndex && (e.endList ? this.resyncLoader() : this.resetLoader()), this.currentMediaInfo_ = void 0, void this.trigger("playlistupdate"); var a = e.mediaSequence - i.mediaSequence; if (this.logger_("live window shift [" + a + "]"), null !== this.mediaIndex) if (this.mediaIndex -= a, this.mediaIndex < 0) this.mediaIndex = null, this.partIndex = null; else { var s = this.playlist_.segments[this.mediaIndex]; if (this.partIndex && (!s.parts || !s.parts.length || !s.parts[this.partIndex])) { var o = this.mediaIndex; this.logger_("currently processing part (index " + this.partIndex + ") no longer exists."), this.resetLoader(), this.mediaIndex = o } } n && (n.mediaIndex -= a, n.mediaIndex < 0 ? (n.mediaIndex = null, n.partIndex = null) : (n.mediaIndex >= 0 && (n.segment = e.segments[n.mediaIndex]), n.partIndex >= 0 && n.segment.parts && (n.part = n.segment.parts[n.partIndex]))), this.syncController_.saveExpiredSegmentInfo(i, e) } }, i.pause = function () { this.checkBufferTimeout_ && (r().clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = null) }, i.paused = function () { return null === this.checkBufferTimeout_ }, i.resetEverything = function (e) { this.ended_ = !1, this.appendInitSegment_ = { audio: !0, video: !0 }, this.resetLoader(), this.remove(0, 1 / 0, e), this.transmuxer_ && (this.transmuxer_.postMessage({ action: "clearAllMp4Captions" }), this.transmuxer_.postMessage({ action: "reset" })) }, i.resetLoader = function () { this.fetchAtBuffer_ = !1, this.resyncLoader() }, i.resyncLoader = function () { this.transmuxer_ && yu(this.transmuxer_), this.mediaIndex = null, this.partIndex = null, this.syncPoint_ = null, this.isPendingTimestampOffset_ = !1, this.callQueue_ = [], this.loadQueue_ = [], this.metadataQueue_.id3 = [], this.metadataQueue_.caption = [], this.abort(), this.transmuxer_ && this.transmuxer_.postMessage({ action: "clearParsedMp4Captions" }) }, i.remove = function (e, t, i, n) { if (void 0 === i && (i = function () { }), void 0 === n && (n = !1), t === 1 / 0 && (t = this.duration_()), t <= e) this.logger_("skipping remove because end ${end} is <= start ${start}"); else if (this.sourceUpdater_ && this.getMediaInfo_()) { var r = 1, a = function () { 0 === --r && i() }; for (var s in !n && this.audioDisabled_ || (r++, this.sourceUpdater_.removeAudio(e, t, a)), (n || "main" === this.loaderType_) && (this.gopBuffer_ = function (e, t, i, n) { for (var r = Math.ceil((t - n) * Ft.ONE_SECOND_IN_TS), a = Math.ceil((i - n) * Ft.ONE_SECOND_IN_TS), s = e.slice(), o = e.length; o-- && !(e[o].pts <= a);); if (-1 === o) return s; for (var u = o + 1; u-- && !(e[u].pts <= r);); return u = Math.max(u, 0), s.splice(u, o - u + 1), s }(this.gopBuffer_, e, t, this.timeMapping_), r++, this.sourceUpdater_.removeVideo(e, t, a)), this.inbandTextTracks_) $u(e, t, this.inbandTextTracks_[s]); $u(e, t, this.segmentMetadataTrack_), a() } else this.logger_("skipping remove because no source updater or starting media info") }, i.monitorBuffer_ = function () { this.checkBufferTimeout_ && r().clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = r().setTimeout(this.monitorBufferTick_.bind(this), 1) }, i.monitorBufferTick_ = function () { "READY" === this.state && this.fillBuffer_(), this.checkBufferTimeout_ && r().clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = r().setTimeout(this.monitorBufferTick_.bind(this), 500) }, i.fillBuffer_ = function () { if (!this.sourceUpdater_.updating()) { var e = this.chooseNextRequest_(); e && ("number" == typeof e.timestampOffset && (this.isPendingTimestampOffset_ = !1, this.timelineChangeController_.pendingTimelineChange({ type: this.loaderType_, from: this.currentTimeline_, to: e.timeline })), this.loadSegment_(e)) } }, i.isEndOfStream_ = function (e, t, i) { if (void 0 === e && (e = this.mediaIndex), void 0 === t && (t = this.playlist_), void 0 === i && (i = this.partIndex), !t || !this.mediaSource_) return !1; var n = "number" == typeof e && t.segments[e], r = e + 1 === t.segments.length, a = !n || !n.parts || i + 1 === n.parts.length; return t.endList && "open" === this.mediaSource_.readyState && r && a }, i.chooseNextRequest_ = function () { var e = this.buffered_(), t = io(e) || 0, i = no(e, this.currentTime_()), n = !this.hasPlayed_() && i >= 1, r = i >= this.goalBufferLength_(), a = this.playlist_.segments; if (!a.length || n || r) return null; this.syncPoint_ = this.syncPoint_ || this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_()); var s = { partIndex: null, mediaIndex: null, startOfSegment: null, playlist: this.playlist_, isSyncRequest: Boolean(!this.syncPoint_) }; if (s.isSyncRequest) s.mediaIndex = function (e, t, i) { t = t || []; for (var n = [], r = 0, a = 0; a < t.length; a++) { var s = t[a]; if (e === s.timeline && (n.push(a), (r += s.duration) > i)) return a } return 0 === n.length ? 0 : n[n.length - 1] }(this.currentTimeline_, a, t); else if (null !== this.mediaIndex) { var o = a[this.mediaIndex], u = "number" == typeof this.partIndex ? this.partIndex : -1; s.startOfSegment = o.end ? o.end : t, o.parts && o.parts[u + 1] ? (s.mediaIndex = this.mediaIndex, s.partIndex = u + 1) : s.mediaIndex = this.mediaIndex + 1 } else { var l = xo.getMediaInfoForTime({ experimentalExactManifestTimings: this.experimentalExactManifestTimings, playlist: this.playlist_, currentTime: this.fetchAtBuffer_ ? t : this.currentTime_(), startingPartIndex: this.syncPoint_.partIndex, startingSegmentIndex: this.syncPoint_.segmentIndex, startTime: this.syncPoint_.time }), c = l.segmentIndex, d = l.startTime, h = l.partIndex; s.getMediaInfoForTime = this.fetchAtBuffer_ ? "bufferedEnd " + t : "currentTime " + this.currentTime_(), s.mediaIndex = c, s.startOfSegment = d, s.partIndex = h } var p = a[s.mediaIndex], f = p && "number" == typeof s.partIndex && p.parts && p.parts[s.partIndex]; if (!p || "number" == typeof s.partIndex && !f) return null; if ("number" != typeof s.partIndex && p.parts && (s.partIndex = 0, f = p.parts[0]), !i && f && !f.independent) if (0 === s.partIndex) { var m = a[s.mediaIndex - 1], g = m.parts && m.parts.length && m.parts[m.parts.length - 1]; g && g.independent && (s.mediaIndex -= 1, s.partIndex = m.parts.length - 1, s.independent = "previous segment") } else p.parts[s.partIndex - 1].independent && (s.partIndex -= 1, s.independent = "previous part"); var A = this.mediaSource_ && "ended" === this.mediaSource_.readyState; return s.mediaIndex >= a.length - 1 && A && !this.seeking_() ? null : this.generateSegmentInfo_(s) }, i.generateSegmentInfo_ = function (e) { var t = e.independent, i = e.playlist, n = e.mediaIndex, r = e.startOfSegment, a = e.isSyncRequest, s = e.partIndex, o = e.forceTimestampOffset, u = e.getMediaInfoForTime, l = i.segments[n], c = "number" == typeof s && l.parts[s], d = { requestId: "segment-loader-" + Math.random(), uri: c && c.resolvedUri || l.resolvedUri, mediaIndex: n, partIndex: c ? s : null, isSyncRequest: a, startOfSegment: r, playlist: i, bytes: null, encryptedBytes: null, timestampOffset: null, timeline: l.timeline, duration: c && c.duration || l.duration, segment: l, part: c, byteLength: 0, transmuxer: this.transmuxer_, getMediaInfoForTime: u, independent: t }, h = void 0 !== o ? o : this.isPendingTimestampOffset_; d.timestampOffset = this.timestampOffsetForSegment_({ segmentTimeline: l.timeline, currentTimeline: this.currentTimeline_, startOfSegment: r, buffered: this.buffered_(), overrideCheck: h }); var p = io(this.sourceUpdater_.audioBuffered()); return "number" == typeof p && (d.audioAppendStart = p - this.sourceUpdater_.audioTimestampOffset()), this.sourceUpdater_.videoBuffered().length && (d.gopsToAlignWith = function (e, t, i) { if (null == t || !e.length) return []; var n, r = Math.ceil((t - i + 3) * Ft.ONE_SECOND_IN_TS); for (n = 0; n < e.length && !(e[n].pts > r); n++); return e.slice(n) }(this.gopBuffer_, this.currentTime_() - this.sourceUpdater_.videoTimestampOffset(), this.timeMapping_)), d }, i.timestampOffsetForSegment_ = function (e) { return i = (t = e).segmentTimeline, n = t.currentTimeline, r = t.startOfSegment, a = t.buffered, t.overrideCheck || i !== n ? i < n ? r : a.length ? a.end(a.length - 1) : r : null; var t, i, n, r, a }, i.earlyAbortWhenNeeded_ = function (e) { if (!this.vhs_.tech_.paused() && this.xhrOptions_.timeout && this.playlist_.attributes.BANDWIDTH && !(Date.now() - (e.firstBytesReceivedAt || Date.now()) < 1e3)) { var t = this.currentTime_(), i = e.bandwidth, n = this.pendingSegment_.duration, r = xo.estimateSegmentRequestTime(n, i, this.playlist_, e.bytesReceived), a = function (e, t, i) { return void 0 === i && (i = 1), ((e.length ? e.end(e.length - 1) : 0) - t) / i }(this.buffered_(), t, this.vhs_.tech_.playbackRate()) - 1; if (!(r <= a)) { var s = function (e) { var t = e.master, i = e.currentTime, n = e.bandwidth, r = e.duration, a = e.segmentDuration, s = e.timeUntilRebuffer, o = e.currentTimeline, u = e.syncController, l = t.playlists.filter((function (e) { return !xo.isIncompatible(e) })), c = l.filter(xo.isEnabled); c.length || (c = l.filter((function (e) { return !xo.isDisabled(e) }))); var d = c.filter(xo.hasAttribute.bind(null, "BANDWIDTH")).map((function (e) { var t = u.getSyncPoint(e, r, o, i) ? 1 : 2; return { playlist: e, rebufferingImpact: xo.estimateSegmentRequestTime(a, n, e) * t - s } })), h = d.filter((function (e) { return e.rebufferingImpact <= 0 })); return Wu(h, (function (e, t) { return Gu(t.playlist, e.playlist) })), h.length ? h[0] : (Wu(d, (function (e, t) { return e.rebufferingImpact - t.rebufferingImpact })), d[0] || null) }({ master: this.vhs_.playlists.master, currentTime: t, bandwidth: i, duration: this.duration_(), segmentDuration: n, timeUntilRebuffer: a, currentTimeline: this.currentTimeline_, syncController: this.syncController_ }); if (s) { var o = r - a - s.rebufferingImpact, u = .5; a <= $s && (u = 1), !s.playlist || s.playlist.uri === this.playlist_.uri || o < u || (this.bandwidth = s.playlist.attributes.BANDWIDTH * ou.BANDWIDTH_VARIANCE + 1, this.trigger("earlyabort")) } } } }, i.handleAbort_ = function (e) { this.logger_("Aborting " + Zu(e)), this.mediaRequestsAborted += 1 }, i.handleProgress_ = function (e, t) { this.earlyAbortWhenNeeded_(t.stats), this.checkForAbort_(t.requestId) || this.trigger("progress") }, i.handleTrackInfo_ = function (e, t) { this.earlyAbortWhenNeeded_(e.stats), this.checkForAbort_(e.requestId) || this.checkForIllegalMediaSwitch(t) || (t = t || {}, function (e, t) { if (!e && !t || !e && t || e && !t) return !1; if (e === t) return !0; var i = Object.keys(e).sort(), n = Object.keys(t).sort(); if (i.length !== n.length) return !1; for (var r = 0; r < i.length; r++) { var a = i[r]; if (a !== n[r]) return !1; if (e[a] !== t[a]) return !1 } return !0 }(this.currentMediaInfo_, t) || (this.appendInitSegment_ = { audio: !0, video: !0 }, this.startingMediaInfo_ = t, this.currentMediaInfo_ = t, this.logger_("trackinfo update", t), this.trigger("trackinfo")), this.checkForAbort_(e.requestId) || (this.pendingSegment_.trackInfo = t, this.hasEnoughInfoToAppend_() && this.processCallQueue_())) }, i.handleTimingInfo_ = function (e, t, i, n) { if (this.earlyAbortWhenNeeded_(e.stats), !this.checkForAbort_(e.requestId)) { var r = this.pendingSegment_, a = Ju(t); r[a] = r[a] || {}, r[a][i] = n, this.logger_("timinginfo: " + t + " - " + i + " - " + n), this.hasEnoughInfoToAppend_() && this.processCallQueue_() } }, i.handleCaptions_ = function (e, t) { var i = this; if (this.earlyAbortWhenNeeded_(e.stats), !this.checkForAbort_(e.requestId)) if (0 !== t.length) if (this.pendingSegment_.hasAppendedData_) { var n = null === this.sourceUpdater_.videoTimestampOffset() ? this.sourceUpdater_.audioTimestampOffset() : this.sourceUpdater_.videoTimestampOffset(), a = {}; t.forEach((function (e) { a[e.stream] = a[e.stream] || { startTime: 1 / 0, captions: [], endTime: 0 }; var t = a[e.stream]; t.startTime = Math.min(t.startTime, e.startTime + n), t.endTime = Math.max(t.endTime, e.endTime + n), t.captions.push(e) })), Object.keys(a).forEach((function (e) { var t = a[e], s = t.startTime, o = t.endTime, u = t.captions, l = i.inbandTextTracks_; i.logger_("adding cues from " + s + " -> " + o + " for " + e), function (e, t, i) { if (!e[i]) { t.trigger({ type: "usage", name: "vhs-608" }), t.trigger({ type: "usage", name: "hls-608" }); var n = i; /^cc708_/.test(i) && (n = "SERVICE" + i.split("_")[1]); var r = t.textTracks().getTrackById(n); if (r) e[i] = r; else { var a = i, s = i, o = !1, u = (t.options_.vhs && t.options_.vhs.captionServices || {})[n]; u && (a = u.label, s = u.language, o = u.default), e[i] = t.addRemoteTextTrack({ kind: "captions", id: n, default: o, label: a, language: s }, !1).track } } }(l, i.vhs_.tech_, e), $u(s, o, l[e]), function (e) { var t = e.inbandTextTracks, i = e.captionArray, n = e.timestampOffset; if (i) { var a = r().WebKitDataCue || r().VTTCue; i.forEach((function (e) { var i = e.stream; t[i].addCue(new a(e.startTime + n, e.endTime + n, e.text)) })) } }({ captionArray: u, inbandTextTracks: l, timestampOffset: n }) })), this.transmuxer_ && this.transmuxer_.postMessage({ action: "clearParsedMp4Captions" }) } else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this, e, t)); else this.logger_("SegmentLoader received no captions from a caption event") }, i.handleId3_ = function (e, t, i) { if (this.earlyAbortWhenNeeded_(e.stats), !this.checkForAbort_(e.requestId)) if (this.pendingSegment_.hasAppendedData_) { var n = null === this.sourceUpdater_.videoTimestampOffset() ? this.sourceUpdater_.audioTimestampOffset() : this.sourceUpdater_.videoTimestampOffset(); !function (e, t, i) { e.metadataTrack_ || (e.metadataTrack_ = i.addRemoteTextTrack({ kind: "metadata", label: "Timed Metadata" }, !1).track, e.metadataTrack_.inBandMetadataTrackDispatchType = t) }(this.inbandTextTracks_, i, this.vhs_.tech_), Xu({ inbandTextTracks: this.inbandTextTracks_, metadataArray: t, timestampOffset: n, videoDuration: this.duration_() }) } else this.metadataQueue_.id3.push(this.handleId3_.bind(this, e, t, i)) }, i.processMetadataQueue_ = function () { this.metadataQueue_.id3.forEach((function (e) { return e() })), this.metadataQueue_.caption.forEach((function (e) { return e() })), this.metadataQueue_.id3 = [], this.metadataQueue_.caption = [] }, i.processCallQueue_ = function () { var e = this.callQueue_; this.callQueue_ = [], e.forEach((function (e) { return e() })) }, i.processLoadQueue_ = function () { var e = this.loadQueue_; this.loadQueue_ = [], e.forEach((function (e) { return e() })) }, i.hasEnoughInfoToLoad_ = function () { if ("audio" !== this.loaderType_) return !0; var e = this.pendingSegment_; return !!e && (!this.getCurrentMediaInfo_() || !el({ timelineChangeController: this.timelineChangeController_, currentTimeline: this.currentTimeline_, segmentTimeline: e.timeline, loaderType: this.loaderType_, audioDisabled: this.audioDisabled_ })) }, i.getCurrentMediaInfo_ = function (e) { return void 0 === e && (e = this.pendingSegment_), e && e.trackInfo || this.currentMediaInfo_ }, i.getMediaInfo_ = function (e) { return void 0 === e && (e = this.pendingSegment_), this.getCurrentMediaInfo_(e) || this.startingMediaInfo_ }, i.hasEnoughInfoToAppend_ = function () { if (!this.sourceUpdater_.ready()) return !1; if (this.waitingOnRemove_ || this.quotaExceededErrorRetryTimeout_) return !1; var e = this.pendingSegment_, t = this.getCurrentMediaInfo_(); if (!e || !t) return !1; var i = t.hasAudio, n = t.hasVideo, r = t.isMuxed; return !(n && !e.videoTimingInfo) && (!(i && !this.audioDisabled_ && !r && !e.audioTimingInfo) && !el({ timelineChangeController: this.timelineChangeController_, currentTimeline: this.currentTimeline_, segmentTimeline: e.timeline, loaderType: this.loaderType_, audioDisabled: this.audioDisabled_ })) }, i.handleData_ = function (e, t) { if (this.earlyAbortWhenNeeded_(e.stats), !this.checkForAbort_(e.requestId)) if (!this.callQueue_.length && this.hasEnoughInfoToAppend_()) { var i = this.pendingSegment_; if (this.setTimeMapping_(i.timeline), this.updateMediaSecondsLoaded_(i.part || i.segment), "closed" !== this.mediaSource_.readyState) { if (e.map && (e.map = this.initSegmentForMap(e.map, !0), i.segment.map = e.map), e.key && this.segmentKey(e.key, !0), i.isFmp4 = e.isFmp4, i.timingInfo = i.timingInfo || {}, i.isFmp4) this.trigger("fmp4"), i.timingInfo.start = i[Ju(t.type)].start; else { var n, r = this.getCurrentMediaInfo_(), a = "main" === this.loaderType_ && r && r.hasVideo; a && (n = i.videoTimingInfo.start), i.timingInfo.start = this.trueSegmentStart_({ currentStart: i.timingInfo.start, playlist: i.playlist, mediaIndex: i.mediaIndex, currentVideoTimestampOffset: this.sourceUpdater_.videoTimestampOffset(), useVideoTimingInfo: a, firstVideoFrameTimeForData: n, videoTimingInfo: i.videoTimingInfo, audioTimingInfo: i.audioTimingInfo }) } if (this.updateAppendInitSegmentStatus(i, t.type), this.updateSourceBufferTimestampOffset_(i), i.isSyncRequest) { this.updateTimingInfoEnd_(i), this.syncController_.saveSegmentTimingInfo({ segmentInfo: i, shouldSaveTimelineMapping: "main" === this.loaderType_ }); var s = this.chooseNextRequest_(); if (s.mediaIndex !== i.mediaIndex || s.partIndex !== i.partIndex) return void this.logger_("sync segment was incorrect, not appending"); this.logger_("sync segment was correct, appending") } i.hasAppendedData_ = !0, this.processMetadataQueue_(), this.appendData_(i, t) } } else this.callQueue_.push(this.handleData_.bind(this, e, t)) }, i.updateAppendInitSegmentStatus = function (e, t) { "main" !== this.loaderType_ || "number" != typeof e.timestampOffset || e.changedTimestampOffset || (this.appendInitSegment_ = { audio: !0, video: !0 }), this.playlistOfLastInitSegment_[t] !== e.playlist && (this.appendInitSegment_[t] = !0) }, i.getInitSegmentAndUpdateState_ = function (e) { var t = e.type, i = e.initSegment, n = e.map, r = e.playlist; if (n) { var a = Qo(n); if (this.activeInitSegmentId_ === a) return null; i = this.initSegmentForMap(n, !0).bytes, this.activeInitSegmentId_ = a } return i && this.appendInitSegment_[t] ? (this.playlistOfLastInitSegment_[t] = r, this.appendInitSegment_[t] = !1, this.activeInitSegmentId_ = null, i) : null }, i.handleQuotaExceededError_ = function (e, t) { var i = this, n = e.segmentInfo, a = e.type, s = e.bytes, o = this.sourceUpdater_.audioBuffered(), u = this.sourceUpdater_.videoBuffered(); o.length > 1 && this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: " + to(o).join(", ")), u.length > 1 && this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: " + to(u).join(", ")); var l = o.length ? o.start(0) : 0, c = o.length ? o.end(o.length - 1) : 0, d = u.length ? u.start(0) : 0, h = u.length ? u.end(u.length - 1) : 0; if (c - l <= 1 && h - d <= 1) return this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: " + s.byteLength + ", audio buffer: " + to(o).join(", ") + ", video buffer: " + to(u).join(", ") + ", "), this.error({ message: "Quota exceeded error with append of a single segment of content", excludeUntil: 1 / 0 }), void this.trigger("error"); this.waitingOnRemove_ = !0, this.callQueue_.push(this.appendToSourceBuffer_.bind(this, { segmentInfo: n, type: a, bytes: s })); var p = this.currentTime_() - 1; this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to " + p), this.remove(0, p, (function () { i.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"), i.waitingOnRemove_ = !1, i.quotaExceededErrorRetryTimeout_ = r().setTimeout((function () { i.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"), i.quotaExceededErrorRetryTimeout_ = null, i.processCallQueue_() }), 1e3) }), !0) }, i.handleAppendError_ = function (e, t) { var i = e.segmentInfo, n = e.type, r = e.bytes; t && (22 !== t.code ? (this.logger_("Received non QUOTA_EXCEEDED_ERR on append", t), this.error(n + " append of " + r.length + "b failed for segment #" + i.mediaIndex + " in playlist " + i.playlist.id), this.trigger("appenderror")) : this.handleQuotaExceededError_({ segmentInfo: i, type: n, bytes: r })) }, i.appendToSourceBuffer_ = function (e) { var t, i, n, r = e.segmentInfo, a = e.type, s = e.initSegment, o = e.data, u = e.bytes; if (!u) { var l = [o], c = o.byteLength; s && (l.unshift(s), c += s.byteLength), n = 0, (t = { bytes: c, segments: l }).bytes && (i = new Uint8Array(t.bytes), t.segments.forEach((function (e) { i.set(e, n), n += e.byteLength }))), u = i } this.sourceUpdater_.appendBuffer({ segmentInfo: r, type: a, bytes: u }, this.handleAppendError_.bind(this, { segmentInfo: r, type: a, bytes: u })) }, i.handleSegmentTimingInfo_ = function (e, t, i) { if (this.pendingSegment_ && t === this.pendingSegment_.requestId) { var n = this.pendingSegment_.segment, r = e + "TimingInfo"; n[r] || (n[r] = {}), n[r].transmuxerPrependedSeconds = i.prependedContentDuration || 0, n[r].transmuxedPresentationStart = i.start.presentation, n[r].transmuxedDecodeStart = i.start.decode, n[r].transmuxedPresentationEnd = i.end.presentation, n[r].transmuxedDecodeEnd = i.end.decode, n[r].baseMediaDecodeTime = i.baseMediaDecodeTime } }, i.appendData_ = function (e, t) { var i = t.type, n = t.data; if (n && n.byteLength && ("audio" !== i || !this.audioDisabled_)) { var r = this.getInitSegmentAndUpdateState_({ type: i, initSegment: t.initSegment, playlist: e.playlist, map: e.isFmp4 ? e.segment.map : null }); this.appendToSourceBuffer_({ segmentInfo: e, type: i, initSegment: r, data: n }) } }, i.loadSegment_ = function (e) { var t = this; this.state = "WAITING", this.pendingSegment_ = e, this.trimBackBuffer_(e), "number" == typeof e.timestampOffset && this.transmuxer_ && this.transmuxer_.postMessage({ action: "clearAllMp4Captions" }), this.hasEnoughInfoToLoad_() ? this.updateTransmuxerAndRequestSegment_(e) : this.loadQueue_.push((function () { var i = o({}, e, { forceTimestampOffset: !0 }); o(e, t.generateSegmentInfo_(i)), t.isPendingTimestampOffset_ = !1, t.updateTransmuxerAndRequestSegment_(e) })) }, i.updateTransmuxerAndRequestSegment_ = function (e) { var t = this; this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset) && (this.gopBuffer_.length = 0, e.gopsToAlignWith = [], this.timeMapping_ = 0, this.transmuxer_.postMessage({ action: "reset" }), this.transmuxer_.postMessage({ action: "setTimestampOffset", timestampOffset: e.timestampOffset })); var i = this.createSimplifiedSegmentObj_(e), n = this.isEndOfStream_(e.mediaIndex, e.playlist, e.partIndex), r = null !== this.mediaIndex, a = e.timeline !== this.currentTimeline_ && e.timeline > 0, s = n || r && a; this.logger_("Requesting " + Zu(e)), i.map && !i.map.bytes && (this.logger_("going to request init segment."), this.appendInitSegment_ = { video: !0, audio: !0 }), e.abortRequests = Bu({ xhr: this.vhs_.xhr, xhrOptions: this.xhrOptions_, decryptionWorker: this.decrypter_, segment: i, abortFn: this.handleAbort_.bind(this, e), progressFn: this.handleProgress_.bind(this), trackInfoFn: this.handleTrackInfo_.bind(this), timingInfoFn: this.handleTimingInfo_.bind(this), videoSegmentTimingInfoFn: this.handleSegmentTimingInfo_.bind(this, "video", e.requestId), audioSegmentTimingInfoFn: this.handleSegmentTimingInfo_.bind(this, "audio", e.requestId), captionsFn: this.handleCaptions_.bind(this), isEndOfTimeline: s, endedTimelineFn: function () { t.logger_("received endedtimeline callback") }, id3Fn: this.handleId3_.bind(this), dataFn: this.handleData_.bind(this), doneFn: this.segmentRequestFinished_.bind(this), onTransmuxerLog: function (i) { var n = i.message, r = i.level, a = i.stream; t.logger_(Zu(e) + " logged from transmuxer stream " + a + " as a " + r + ": " + n) } }) }, i.trimBackBuffer_ = function (e) { var t = function (e, t, i) { var n = t - ou.BACK_BUFFER_LENGTH; e.length && (n = Math.max(n, e.start(0))); var r = t - i; return Math.min(r, n) }(this.seekable_(), this.currentTime_(), this.playlist_.targetDuration || 10); t > 0 && this.remove(0, t) }, i.createSimplifiedSegmentObj_ = function (e) { var t = e.segment, i = e.part, n = { resolvedUri: i ? i.resolvedUri : t.resolvedUri, byterange: i ? i.byterange : t.byterange, requestId: e.requestId, transmuxer: e.transmuxer, audioAppendStart: e.audioAppendStart, gopsToAlignWith: e.gopsToAlignWith, part: e.part }, r = e.playlist.segments[e.mediaIndex - 1]; if (r && r.timeline === t.timeline && (r.videoTimingInfo ? n.baseStartTime = r.videoTimingInfo.transmuxedDecodeEnd : r.audioTimingInfo && (n.baseStartTime = r.audioTimingInfo.transmuxedDecodeEnd)), t.key) { var a = t.key.iv || new Uint32Array([0, 0, 0, e.mediaIndex + e.playlist.mediaSequence]); n.key = this.segmentKey(t.key), n.key.iv = a } return t.map && (n.map = this.initSegmentForMap(t.map)), n }, i.saveTransferStats_ = function (e) { this.mediaRequests += 1, e && (this.mediaBytesTransferred += e.bytesReceived, this.mediaTransferDuration += e.roundTripTime) }, i.saveBandwidthRelatedStats_ = function (e, t) { this.pendingSegment_.byteLength = t.bytesReceived, e < Yu ? this.logger_("Ignoring segment's bandwidth because its duration of " + e + " is less than the min to record 0.016666666666666666") : (this.bandwidth = t.bandwidth, this.roundTrip = t.roundTripTime) }, i.handleTimeout_ = function () { this.mediaRequestsTimedout += 1, this.bandwidth = 1, this.roundTrip = NaN, this.trigger("bandwidthupdate") }, i.segmentRequestFinished_ = function (e, t, i) { if (this.callQueue_.length) this.callQueue_.push(this.segmentRequestFinished_.bind(this, e, t, i)); else if (this.saveTransferStats_(t.stats), this.pendingSegment_ && t.requestId === this.pendingSegment_.requestId) { if (e) { if (this.pendingSegment_ = null, this.state = "READY", e.code === Su) return; return this.pause(), e.code === xu ? void this.handleTimeout_() : (this.mediaRequestsErrored += 1, this.error(e), void this.trigger("error")) } var n = this.pendingSegment_; this.saveBandwidthRelatedStats_(n.duration, t.stats), n.endOfAllRequests = t.endOfAllRequests, i.gopInfo && (this.gopBuffer_ = function (e, t, i) { if (!t.length) return e; if (i) return t.slice(); for (var n = t[0].pts, r = 0; r < e.length && !(e[r].pts >= n); r++); return e.slice(0, r).concat(t) }(this.gopBuffer_, i.gopInfo, this.safeAppend_)), this.state = "APPENDING", this.trigger("appending"), this.waitForAppendsToComplete_(n) } }, i.setTimeMapping_ = function (e) { var t = this.syncController_.mappingForTimeline(e); null !== t && (this.timeMapping_ = t) }, i.updateMediaSecondsLoaded_ = function (e) { "number" == typeof e.start && "number" == typeof e.end ? this.mediaSecondsLoaded += e.end - e.start : this.mediaSecondsLoaded += e.duration }, i.shouldUpdateTransmuxerTimestampOffset_ = function (e) { return null !== e && ("main" === this.loaderType_ && e !== this.sourceUpdater_.videoTimestampOffset() || !this.audioDisabled_ && e !== this.sourceUpdater_.audioTimestampOffset()) }, i.trueSegmentStart_ = function (e) { var t = e.currentStart, i = e.playlist, n = e.mediaIndex, r = e.firstVideoFrameTimeForData, a = e.currentVideoTimestampOffset, s = e.useVideoTimingInfo, o = e.videoTimingInfo, u = e.audioTimingInfo; if (void 0 !== t) return t; if (!s) return u.start; var l = i.segments[n - 1]; return 0 !== n && l && void 0 !== l.start && l.end === r + a ? o.start : r }, i.waitForAppendsToComplete_ = function (e) { var t = this.getCurrentMediaInfo_(e); if (!t) return this.error({ message: "No starting media returned, likely due to an unsupported media format.", blacklistDuration: 1 / 0 }), void this.trigger("error"); var i = t.hasAudio, n = t.hasVideo, r = t.isMuxed, a = "main" === this.loaderType_ && n, s = !this.audioDisabled_ && i && !r; if (e.waitingOnAppends = 0, !e.hasAppendedData_) return e.timingInfo || "number" != typeof e.timestampOffset || (this.isPendingTimestampOffset_ = !0), e.timingInfo = { start: 0 }, e.waitingOnAppends++, this.isPendingTimestampOffset_ || (this.updateSourceBufferTimestampOffset_(e), this.processMetadataQueue_()), void this.checkAppendsDone_(e); a && e.waitingOnAppends++, s && e.waitingOnAppends++, a && this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this, e)), s && this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this, e)) }, i.checkAppendsDone_ = function (e) { this.checkForAbort_(e.requestId) || (e.waitingOnAppends--, 0 === e.waitingOnAppends && this.handleAppendsDone_()) }, i.checkForIllegalMediaSwitch = function (e) { var t = function (e, t, i) { return "main" === e && t && i ? i.hasAudio || i.hasVideo ? t.hasVideo && !i.hasVideo ? "Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest." : !t.hasVideo && i.hasVideo ? "Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest." : null : "Neither audio nor video found in segment." : null }(this.loaderType_, this.getCurrentMediaInfo_(), e); return !!t && (this.error({ message: t, blacklistDuration: 1 / 0 }), this.trigger("error"), !0) }, i.updateSourceBufferTimestampOffset_ = function (e) { if (null !== e.timestampOffset && "number" == typeof e.timingInfo.start && !e.changedTimestampOffset && "main" === this.loaderType_) { var t = !1; e.timestampOffset -= e.timingInfo.start, e.changedTimestampOffset = !0, e.timestampOffset !== this.sourceUpdater_.videoTimestampOffset() && (this.sourceUpdater_.videoTimestampOffset(e.timestampOffset), t = !0), e.timestampOffset !== this.sourceUpdater_.audioTimestampOffset() && (this.sourceUpdater_.audioTimestampOffset(e.timestampOffset), t = !0), t && this.trigger("timestampoffset") } }, i.updateTimingInfoEnd_ = function (e) { e.timingInfo = e.timingInfo || {}; var t = this.getMediaInfo_(), i = "main" === this.loaderType_ && t && t.hasVideo && e.videoTimingInfo ? e.videoTimingInfo : e.audioTimingInfo; i && (e.timingInfo.end = "number" == typeof i.end ? i.end : i.start + e.duration) }, i.handleAppendsDone_ = function () { if (this.pendingSegment_ && this.trigger("appendsdone"), !this.pendingSegment_) return this.state = "READY", void (this.paused() || this.monitorBuffer_()); var e = this.pendingSegment_; this.updateTimingInfoEnd_(e), this.shouldSaveSegmentTimingInfo_ && this.syncController_.saveSegmentTimingInfo({ segmentInfo: e, shouldSaveTimelineMapping: "main" === this.loaderType_ }); var t = il(e, this.sourceType_); if (t && ("warn" === t.severity ? qs.log.warn(t.message) : this.logger_(t.message)), this.recordThroughput_(e), this.pendingSegment_ = null, this.state = "READY", !e.isSyncRequest || (this.trigger("syncinfoupdate"), e.hasAppendedData_)) { this.logger_("Appended " + Zu(e)), this.addSegmentMetadataCue_(e), this.fetchAtBuffer_ = !0, this.currentTimeline_ !== e.timeline && (this.timelineChangeController_.lastTimelineChange({ type: this.loaderType_, from: this.currentTimeline_, to: e.timeline }), "main" !== this.loaderType_ || this.audioDisabled_ || this.timelineChangeController_.lastTimelineChange({ type: "audio", from: this.currentTimeline_, to: e.timeline })), this.currentTimeline_ = e.timeline, this.trigger("syncinfoupdate"); var i = e.segment, n = e.part, r = i.end && this.currentTime_() - i.end > 3 * e.playlist.targetDuration, a = n && n.end && this.currentTime_() - n.end > 3 * e.playlist.partTargetDuration; if (r || a) return this.logger_("bad " + (r ? "segment" : "part") + " " + Zu(e)), void this.resetEverything(); null !== this.mediaIndex && this.trigger("bandwidthupdate"), this.trigger("progress"), this.mediaIndex = e.mediaIndex, this.partIndex = e.partIndex, this.isEndOfStream_(e.mediaIndex, e.playlist, e.partIndex) && this.endOfStream(), this.trigger("appended"), e.hasAppendedData_ && this.mediaAppends++, this.paused() || this.monitorBuffer_() } else this.logger_("Throwing away un-appended sync request " + Zu(e)) }, i.recordThroughput_ = function (e) { if (e.duration < Yu) this.logger_("Ignoring segment's throughput because its duration of " + e.duration + " is less than the min to record 0.016666666666666666"); else { var t = this.throughput.rate, i = Date.now() - e.endOfAllRequests + 1, n = Math.floor(e.byteLength / i * 8 * 1e3); this.throughput.rate += (n - t) / ++this.throughput.count } }, i.addSegmentMetadataCue_ = function (e) { if (this.segmentMetadataTrack_) { var t = e.segment, i = t.start, n = t.end; if (Ku(i) && Ku(n)) { $u(i, n, this.segmentMetadataTrack_); var a = r().WebKitDataCue || r().VTTCue, s = { custom: t.custom, dateTimeObject: t.dateTimeObject, dateTimeString: t.dateTimeString, bandwidth: e.playlist.attributes.BANDWIDTH, resolution: e.playlist.attributes.RESOLUTION, codecs: e.playlist.attributes.CODECS, byteLength: e.byteLength, uri: e.uri, timeline: e.timeline, playlist: e.playlist.id, start: i, end: n }, o = new a(i, n, JSON.stringify(s)); o.value = s, this.segmentMetadataTrack_.addCue(o) } } }, t }(qs.EventTarget); function rl() { } var al, sl = function (e) { return "string" != typeof e ? e : e.replace(/./, (function (e) { return e.toUpperCase() })) }, ol = ["video", "audio"], ul = function (e, t) { var i = t[e + "Buffer"]; return i && i.updating || t.queuePending[e] }, ll = function e(t, i) { if (0 !== i.queue.length) { var n = 0, r = i.queue[n]; if ("mediaSource" !== r.type) { if ("mediaSource" !== t && i.ready() && "closed" !== i.mediaSource.readyState && !ul(t, i)) { if (r.type !== t) { if (n = function (e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; if ("mediaSource" === n.type) return null; if (n.type === e) return i } return null }(t, i.queue), null === n) return; r = i.queue[n] } return i.queue.splice(n, 1), i.queuePending[t] = r, r.action(t, i), r.doneFn ? void 0 : (i.queuePending[t] = null, void e(t, i)) } } else i.updating() || "closed" === i.mediaSource.readyState || (i.queue.shift(), r.action(i), r.doneFn && r.doneFn(), e("audio", i), e("video", i)) } }, cl = function (e, t) { var i = t[e + "Buffer"], n = sl(e); i && (i.removeEventListener("updateend", t["on" + n + "UpdateEnd_"]), i.removeEventListener("error", t["on" + n + "Error_"]), t.codecs[e] = null, t[e + "Buffer"] = null) }, dl = function (e, t) { return e && t && -1 !== Array.prototype.indexOf.call(e.sourceBuffers, t) }, hl = function (e, t, i) { return function (n, r) { var a = r[n + "Buffer"]; if (dl(r.mediaSource, a)) { r.logger_("Appending segment " + t.mediaIndex + "'s " + e.length + " bytes to " + n + "Buffer"); try { a.appendBuffer(e) } catch (e) { r.logger_("Error with code " + e.code + " " + (22 === e.code ? "(QUOTA_EXCEEDED_ERR) " : "") + "when appending segment " + t.mediaIndex + " to " + n + "Buffer"), r.queuePending[n] = null, i(e) } } } }, pl = function (e, t) { return function (i, n) { var r = n[i + "Buffer"]; if (dl(n.mediaSource, r)) { n.logger_("Removing " + e + " to " + t + " from " + i + "Buffer"); try { r.remove(e, t) } catch (r) { n.logger_("Remove " + e + " to " + t + " from " + i + "Buffer failed") } } } }, fl = function (e) { return function (t, i) { var n = i[t + "Buffer"]; dl(i.mediaSource, n) && (i.logger_("Setting " + t + "timestampOffset to " + e), n.timestampOffset = e) } }, ml = function (e) { return function (t, i) { e() } }, gl = function (e) { return function (t) { if ("open" === t.mediaSource.readyState) { t.logger_("Calling mediaSource endOfStream(" + (e || "") + ")"); try { t.mediaSource.endOfStream(e) } catch (e) { qs.log.warn("Failed to call media source endOfStream", e) } } } }, Al = function (e) { return function (t) { t.logger_("Setting mediaSource duration to " + e); try { t.mediaSource.duration = e } catch (e) { qs.log.warn("Failed to set media source duration", e) } } }, vl = function () { return function (e, t) { if ("open" === t.mediaSource.readyState) { var i = t[e + "Buffer"]; if (dl(t.mediaSource, i)) { t.logger_("calling abort on " + e + "Buffer"); try { i.abort() } catch (t) { qs.log.warn("Failed to abort on " + e + "Buffer", t) } } } } }, yl = function (e, t) { return function (i) { var n = sl(e), r = W(t); i.logger_("Adding " + e + "Buffer with codec " + t + " to mediaSource"); var a = i.mediaSource.addSourceBuffer(r); a.addEventListener("updateend", i["on" + n + "UpdateEnd_"]), a.addEventListener("error", i["on" + n + "Error_"]), i.codecs[e] = t, i[e + "Buffer"] = a } }, _l = function (e) { return function (t) { var i = t[e + "Buffer"]; if (cl(e, t), dl(t.mediaSource, i)) { t.logger_("Removing " + e + "Buffer with codec " + t.codecs[e] + " from mediaSource"); try { t.mediaSource.removeSourceBuffer(i) } catch (t) { qs.log.warn("Failed to removeSourceBuffer " + e + "Buffer", t) } } } }, bl = function (e) { return function (t, i) { var n = i[t + "Buffer"], r = W(e); dl(i.mediaSource, n) && i.codecs[t] !== e && (i.logger_("changing " + t + "Buffer codec from " + i.codecs[t] + " to " + e), n.changeType(r), i.codecs[t] = e) } }, Tl = function (e) { var t = e.type, i = e.sourceUpdater, n = e.action, r = e.doneFn, a = e.name; i.queue.push({ type: t, action: n, doneFn: r, name: a }), ll(t, i) }, xl = function (e, t) { return function (i) { if (t.queuePending[e]) { var n = t.queuePending[e].doneFn; t.queuePending[e] = null, n && n(t[e + "Error_"]) } ll(e, t) } }, Sl = function (e) { function t(t) { var i; return (i = e.call(this) || this).mediaSource = t, i.sourceopenListener_ = function () { return ll("mediaSource", c(i)) }, i.mediaSource.addEventListener("sourceopen", i.sourceopenListener_), i.logger_ = Xs("SourceUpdater"), i.audioTimestampOffset_ = 0, i.videoTimestampOffset_ = 0, i.queue = [], i.queuePending = { audio: null, video: null }, i.delayedAudioAppendQueue_ = [], i.videoAppendQueued_ = !1, i.codecs = {}, i.onVideoUpdateEnd_ = xl("video", c(i)), i.onAudioUpdateEnd_ = xl("audio", c(i)), i.onVideoError_ = function (e) { i.videoError_ = e }, i.onAudioError_ = function (e) { i.audioError_ = e }, i.createdSourceBuffers_ = !1, i.initializedEme_ = !1, i.triggeredReady_ = !1, i } h(t, e); var i = t.prototype; return i.initializedEme = function () { this.initializedEme_ = !0, this.triggerReady() }, i.hasCreatedSourceBuffers = function () { return this.createdSourceBuffers_ }, i.hasInitializedAnyEme = function () { return this.initializedEme_ }, i.ready = function () { return this.hasCreatedSourceBuffers() && this.hasInitializedAnyEme() }, i.createSourceBuffers = function (e) { this.hasCreatedSourceBuffers() || (this.addOrChangeSourceBuffers(e), this.createdSourceBuffers_ = !0, this.trigger("createdsourcebuffers"), this.triggerReady()) }, i.triggerReady = function () { this.ready() && !this.triggeredReady_ && (this.triggeredReady_ = !0, this.trigger("ready")) }, i.addSourceBuffer = function (e, t) { Tl({ type: "mediaSource", sourceUpdater: this, action: yl(e, t), name: "addSourceBuffer" }) }, i.abort = function (e) { Tl({ type: e, sourceUpdater: this, action: vl(e), name: "abort" }) }, i.removeSourceBuffer = function (e) { this.canRemoveSourceBuffer() ? Tl({ type: "mediaSource", sourceUpdater: this, action: _l(e), name: "removeSourceBuffer" }) : qs.log.error("removeSourceBuffer is not supported!") }, i.canRemoveSourceBuffer = function () { return !qs.browser.IE_VERSION && !qs.browser.IS_FIREFOX && r().MediaSource && r().MediaSource.prototype && "function" == typeof r().MediaSource.prototype.removeSourceBuffer }, t.canChangeType = function () { return r().SourceBuffer && r().SourceBuffer.prototype && "function" == typeof r().SourceBuffer.prototype.changeType }, i.canChangeType = function () { return this.constructor.canChangeType() }, i.changeType = function (e, t) { this.canChangeType() ? Tl({ type: e, sourceUpdater: this, action: bl(t), name: "changeType" }) : qs.log.error("changeType is not supported!") }, i.addOrChangeSourceBuffers = function (e) { var t = this; if (!e || "object" != typeof e || 0 === Object.keys(e).length) throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs"); Object.keys(e).forEach((function (i) { var n = e[i]; if (!t.hasCreatedSourceBuffers()) return t.addSourceBuffer(i, n); t.canChangeType() && t.changeType(i, n) })) }, i.appendBuffer = function (e, t) { var i = this, n = e.segmentInfo, r = e.type, a = e.bytes; if (this.processedAppend_ = !0, "audio" === r && this.videoBuffer && !this.videoAppendQueued_) return this.delayedAudioAppendQueue_.push([e, t]), void this.logger_("delayed audio append of " + a.length + " until video append"); if (Tl({ type: r, sourceUpdater: this, action: hl(a, n || { mediaIndex: -1 }, t), doneFn: t, name: "appendBuffer" }), "video" === r) { if (this.videoAppendQueued_ = !0, !this.delayedAudioAppendQueue_.length) return; var s = this.delayedAudioAppendQueue_.slice(); this.logger_("queuing delayed audio " + s.length + " appendBuffers"), this.delayedAudioAppendQueue_.length = 0, s.forEach((function (e) { i.appendBuffer.apply(i, e) })) } }, i.audioBuffered = function () { return dl(this.mediaSource, this.audioBuffer) && this.audioBuffer.buffered ? this.audioBuffer.buffered : qs.createTimeRange() }, i.videoBuffered = function () { return dl(this.mediaSource, this.videoBuffer) && this.videoBuffer.buffered ? this.videoBuffer.buffered : qs.createTimeRange() }, i.buffered = function () { var e = dl(this.mediaSource, this.videoBuffer) ? this.videoBuffer : null, t = dl(this.mediaSource, this.audioBuffer) ? this.audioBuffer : null; return t && !e ? this.audioBuffered() : e && !t ? this.videoBuffered() : function (e, t) { var i = null, n = null, r = 0, a = [], s = []; if (!(e && e.length && t && t.length)) return qs.createTimeRange(); for (var o = e.length; o--;)a.push({ time: e.start(o), type: "start" }), a.push({ time: e.end(o), type: "end" }); for (o = t.length; o--;)a.push({ time: t.start(o), type: "start" }), a.push({ time: t.end(o), type: "end" }); for (a.sort((function (e, t) { return e.time - t.time })), o = 0; o < a.length; o++)"start" === a[o].type ? 2 == ++r && (i = a[o].time) : "end" === a[o].type && 1 == --r && (n = a[o].time), null !== i && null !== n && (s.push([i, n]), i = null, n = null); return qs.createTimeRanges(s) }(this.audioBuffered(), this.videoBuffered()) }, i.setDuration = function (e, t) { void 0 === t && (t = rl), Tl({ type: "mediaSource", sourceUpdater: this, action: Al(e), name: "duration", doneFn: t }) }, i.endOfStream = function (e, t) { void 0 === e && (e = null), void 0 === t && (t = rl), "string" != typeof e && (e = void 0), Tl({ type: "mediaSource", sourceUpdater: this, action: gl(e), name: "endOfStream", doneFn: t }) }, i.removeAudio = function (e, t, i) { void 0 === i && (i = rl), this.audioBuffered().length && 0 !== this.audioBuffered().end(0) ? Tl({ type: "audio", sourceUpdater: this, action: pl(e, t), doneFn: i, name: "remove" }) : i() }, i.removeVideo = function (e, t, i) { void 0 === i && (i = rl), this.videoBuffered().length && 0 !== this.videoBuffered().end(0) ? Tl({ type: "video", sourceUpdater: this, action: pl(e, t), doneFn: i, name: "remove" }) : i() }, i.updating = function () { return !(!ul("audio", this) && !ul("video", this)) }, i.audioTimestampOffset = function (e) { return void 0 !== e && this.audioBuffer && this.audioTimestampOffset_ !== e && (Tl({ type: "audio", sourceUpdater: this, action: fl(e), name: "timestampOffset" }), this.audioTimestampOffset_ = e), this.audioTimestampOffset_ }, i.videoTimestampOffset = function (e) { return void 0 !== e && this.videoBuffer && this.videoTimestampOffset !== e && (Tl({ type: "video", sourceUpdater: this, action: fl(e), name: "timestampOffset" }), this.videoTimestampOffset_ = e), this.videoTimestampOffset_ }, i.audioQueueCallback = function (e) { this.audioBuffer && Tl({ type: "audio", sourceUpdater: this, action: ml(e), name: "callback" }) }, i.videoQueueCallback = function (e) { this.videoBuffer && Tl({ type: "video", sourceUpdater: this, action: ml(e), name: "callback" }) }, i.dispose = function () { var e = this; this.trigger("dispose"), ol.forEach((function (t) { e.abort(t), e.canRemoveSourceBuffer() ? e.removeSourceBuffer(t) : e[t + "QueueCallback"]((function () { return cl(t, e) })) })), this.videoAppendQueued_ = !1, this.delayedAudioAppendQueue_.length = 0, this.sourceopenListener_ && this.mediaSource.removeEventListener("sourceopen", this.sourceopenListener_), this.off() }, t }(qs.EventTarget), El = function (e) { return decodeURIComponent(escape(String.fromCharCode.apply(null, e))) }, Cl = new Uint8Array("\n\n".split("").map((function (e) { return e.charCodeAt(0) }))), wl = function (e) { function t(t, i) { var n; return void 0 === i && (i = {}), (n = e.call(this, t, i) || this).mediaSource_ = null, n.subtitlesTrack_ = null, n.loaderType_ = "subtitle", n.featuresNativeTextTracks_ = t.featuresNativeTextTracks, n.shouldSaveSegmentTimingInfo_ = !1, n } h(t, e); var i = t.prototype; return i.createTransmuxer_ = function () { return null }, i.buffered_ = function () { if (!this.subtitlesTrack_ || !this.subtitlesTrack_.cues || !this.subtitlesTrack_.cues.length) return qs.createTimeRanges(); var e = this.subtitlesTrack_.cues, t = e[0].startTime, i = e[e.length - 1].startTime; return qs.createTimeRanges([[t, i]]) }, i.initSegmentForMap = function (e, t) { if (void 0 === t && (t = !1), !e) return null; var i = Qo(e), n = this.initSegments_[i]; if (t && !n && e.bytes) { var r = Cl.byteLength + e.bytes.byteLength, a = new Uint8Array(r); a.set(e.bytes), a.set(Cl, e.bytes.byteLength), this.initSegments_[i] = n = { resolvedUri: e.resolvedUri, byterange: e.byterange, bytes: a } } return n || e }, i.couldBeginLoading_ = function () { return this.playlist_ && this.subtitlesTrack_ && !this.paused() }, i.init_ = function () { return this.state = "READY", this.resetEverything(), this.monitorBuffer_() }, i.track = function (e) { return void 0 === e || (this.subtitlesTrack_ = e, "INIT" === this.state && this.couldBeginLoading_() && this.init_()), this.subtitlesTrack_ }, i.remove = function (e, t) { $u(e, t, this.subtitlesTrack_) }, i.fillBuffer_ = function () { var e = this, t = this.chooseNextRequest_(); if (t) { if (null === this.syncController_.timestampOffsetForTimeline(t.timeline)) { return this.syncController_.one("timestampoffset", (function () { e.state = "READY", e.paused() || e.monitorBuffer_() })), void (this.state = "WAITING_ON_TIMELINE") } this.loadSegment_(t) } }, i.timestampOffsetForSegment_ = function () { return null }, i.chooseNextRequest_ = function () { return this.skipEmptySegments_(e.prototype.chooseNextRequest_.call(this)) }, i.skipEmptySegments_ = function (e) { for (; e && e.segment.empty;) { if (e.mediaIndex + 1 >= e.playlist.segments.length) { e = null; break } e = this.generateSegmentInfo_({ playlist: e.playlist, mediaIndex: e.mediaIndex + 1, startOfSegment: e.startOfSegment + e.duration, isSyncRequest: e.isSyncRequest }) } return e }, i.stopForError = function (e) { this.error(e), this.state = "READY", this.pause(), this.trigger("error") }, i.segmentRequestFinished_ = function (e, t, i) { var n = this; if (this.subtitlesTrack_) { if (this.saveTransferStats_(t.stats), !this.pendingSegment_) return this.state = "READY", void (this.mediaRequestsAborted += 1); if (e) return e.code === xu && this.handleTimeout_(), e.code === Su ? this.mediaRequestsAborted += 1 : this.mediaRequestsErrored += 1, void this.stopForError(e); var a = this.pendingSegment_; this.saveBandwidthRelatedStats_(a.duration, t.stats), this.state = "APPENDING", this.trigger("appending"); var s = a.segment; if (s.map && (s.map.bytes = t.map.bytes), a.bytes = t.bytes, "function" != typeof r().WebVTT && this.subtitlesTrack_ && this.subtitlesTrack_.tech_) { var o, u = function () { n.subtitlesTrack_.tech_.off("vttjsloaded", o), n.stopForError({ message: "Error loading vtt.js" }) }; return o = function () { n.subtitlesTrack_.tech_.off("vttjserror", u), n.segmentRequestFinished_(e, t, i) }, this.state = "WAITING_ON_VTTJS", this.subtitlesTrack_.tech_.one("vttjsloaded", o), void this.subtitlesTrack_.tech_.one("vttjserror", u) } s.requested = !0; try { this.parseVTTCues_(a) } catch (e) { return void this.stopForError({ message: e.message }) } if (this.updateTimeMapping_(a, this.syncController_.timelines[a.timeline], this.playlist_), a.cues.length ? a.timingInfo = { start: a.cues[0].startTime, end: a.cues[a.cues.length - 1].endTime } : a.timingInfo = { start: a.startOfSegment, end: a.startOfSegment + a.duration }, a.isSyncRequest) return this.trigger("syncinfoupdate"), this.pendingSegment_ = null, void (this.state = "READY"); a.byteLength = a.bytes.byteLength, this.mediaSecondsLoaded += s.duration, a.cues.forEach((function (e) { n.subtitlesTrack_.addCue(n.featuresNativeTextTracks_ ? new (r().VTTCue)(e.startTime, e.endTime, e.text) : e) })), function (e) { var t = e.cues; if (t) for (var i = 0; i < t.length; i++) { for (var n = [], r = 0, a = 0; a < t.length; a++)t[i].startTime === t[a].startTime && t[i].endTime === t[a].endTime && t[i].text === t[a].text && ++r > 1 && n.push(t[a]); n.length && n.forEach((function (t) { return e.removeCue(t) })) } }(this.subtitlesTrack_), this.handleAppendsDone_() } else this.state = "READY" }, i.handleData_ = function () { }, i.updateTimingInfoEnd_ = function () { }, i.parseVTTCues_ = function (e) { var t, i = !1; "function" == typeof r().TextDecoder ? t = new (r().TextDecoder)("utf8") : (t = r().WebVTT.StringDecoder(), i = !0); var n = new (r().WebVTT.Parser)(r(), r().vttjs, t); if (e.cues = [], e.timestampmap = { MPEGTS: 0, LOCAL: 0 }, n.oncue = e.cues.push.bind(e.cues), n.ontimestampmap = function (t) { e.timestampmap = t }, n.onparsingerror = function (e) { qs.log.warn("Error encountered when parsing cues: " + e.message) }, e.segment.map) { var a = e.segment.map.bytes; i && (a = El(a)), n.parse(a) } var s = e.bytes; i && (s = El(s)), n.parse(s), n.flush() }, i.updateTimeMapping_ = function (e, t, i) { var n = e.segment; if (t) if (e.cues.length) { var r = e.timestampmap, a = r.MPEGTS / Ft.ONE_SECOND_IN_TS - r.LOCAL + t.mapping; if (e.cues.forEach((function (e) { e.startTime += a, e.endTime += a })), !i.syncInfo) { var s = e.cues[0].startTime, o = e.cues[e.cues.length - 1].startTime; i.syncInfo = { mediaSequence: i.mediaSequence + e.mediaIndex, time: Math.min(s, o - n.duration) } } } else n.empty = !0 }, t }(nl), kl = function (e, t) { for (var i = e.cues, n = 0; n < i.length; n++) { var r = i[n]; if (t >= r.adStartTime && t <= r.adEndTime) return r } return null }, Fl = [{ name: "VOD", run: function (e, t, i, n, r) { if (i !== 1 / 0) { return { time: 0, segmentIndex: 0, partIndex: null } } return null } }, { name: "ProgramDateTime", run: function (e, t, i, n, r) { if (!Object.keys(e.timelineToDatetimeMappings).length) return null; var a = null, s = null, o = so(t); r = r || 0; for (var u = 0; u < o.length; u++) { var l = o[t.endList || 0 === r ? u : o.length - (u + 1)], c = l.segment, d = e.timelineToDatetimeMappings[c.timeline]; if (d && c.dateTimeObject) { var h = c.dateTimeObject.getTime() / 1e3 + d; if (c.parts && "number" == typeof l.partIndex) for (var p = 0; p < l.partIndex; p++)h += c.parts[p].duration; var f = Math.abs(r - h); if (null !== s && (0 === f || s < f)) break; s = f, a = { time: h, segmentIndex: l.segmentIndex, partIndex: l.partIndex } } } return a } }, { name: "Segment", run: function (e, t, i, n, r) { var a = null, s = null; r = r || 0; for (var o = so(t), u = 0; u < o.length; u++) { var l = o[t.endList || 0 === r ? u : o.length - (u + 1)], c = l.segment, d = l.part && l.part.start || c && c.start; if (c.timeline === n && void 0 !== d) { var h = Math.abs(r - d); if (null !== s && s < h) break; (!a || null === s || s >= h) && (s = h, a = { time: d, segmentIndex: l.segmentIndex, partIndex: l.partIndex }) } } return a } }, { name: "Discontinuity", run: function (e, t, i, n, r) { var a = null; if (r = r || 0, t.discontinuityStarts && t.discontinuityStarts.length) for (var s = null, o = 0; o < t.discontinuityStarts.length; o++) { var u = t.discontinuityStarts[o], l = t.discontinuitySequence + o + 1, c = e.discontinuities[l]; if (c) { var d = Math.abs(r - c.time); if (null !== s && s < d) break; (!a || null === s || s >= d) && (s = d, a = { time: c.time, segmentIndex: u, partIndex: null }) } } return a } }, { name: "Playlist", run: function (e, t, i, n, r) { return t.syncInfo ? { time: t.syncInfo.time, segmentIndex: t.syncInfo.mediaSequence - t.mediaSequence, partIndex: null } : null } }], Il = function (e) { function t(t) { var i; return (i = e.call(this) || this).timelines = [], i.discontinuities = [], i.timelineToDatetimeMappings = {}, i.logger_ = Xs("SyncController"), i } h(t, e); var i = t.prototype; return i.getSyncPoint = function (e, t, i, n) { var r = this.runStrategies_(e, t, i, n); return r.length ? this.selectSyncPoint_(r, { key: "time", value: n }) : null }, i.getExpiredTime = function (e, t) { if (!e || !e.segments) return null; var i = this.runStrategies_(e, t, e.discontinuitySequence, 0); if (!i.length) return null; var n = this.selectSyncPoint_(i, { key: "segmentIndex", value: 0 }); return n.segmentIndex > 0 && (n.time *= -1), Math.abs(n.time + po({ defaultDuration: e.targetDuration, durationList: e.segments, startIndex: n.segmentIndex, endIndex: 0 })) }, i.runStrategies_ = function (e, t, i, n) { for (var r = [], a = 0; a < Fl.length; a++) { var s = Fl[a], o = s.run(this, e, t, i, n); o && (o.strategy = s.name, r.push({ strategy: s.name, syncPoint: o })) } return r }, i.selectSyncPoint_ = function (e, t) { for (var i = e[0].syncPoint, n = Math.abs(e[0].syncPoint[t.key] - t.value), r = e[0].strategy, a = 1; a < e.length; a++) { var s = Math.abs(e[a].syncPoint[t.key] - t.value); s < n && (n = s, i = e[a].syncPoint, r = e[a].strategy) } return this.logger_("syncPoint for [" + t.key + ": " + t.value + "] chosen with strategy [" + r + "]: [time:" + i.time + ", segmentIndex:" + i.segmentIndex + ("number" == typeof i.partIndex ? ",partIndex:" + i.partIndex : "") + "]"), i }, i.saveExpiredSegmentInfo = function (e, t) { var i = t.mediaSequence - e.mediaSequence; if (i > 86400) qs.log.warn("Not saving expired segment info. Media sequence gap " + i + " is too large."); else for (var n = i - 1; n >= 0; n--) { var r = e.segments[n]; if (r && void 0 !== r.start) { t.syncInfo = { mediaSequence: e.mediaSequence + n, time: r.start }, this.logger_("playlist refresh sync: [time:" + t.syncInfo.time + ", mediaSequence: " + t.syncInfo.mediaSequence + "]"), this.trigger("syncinfoupdate"); break } } }, i.setDateTimeMappingForStart = function (e) { if (this.timelineToDatetimeMappings = {}, e.segments && e.segments.length && e.segments[0].dateTimeObject) { var t = e.segments[0], i = t.dateTimeObject.getTime() / 1e3; this.timelineToDatetimeMappings[t.timeline] = -i } }, i.saveSegmentTimingInfo = function (e) { var t = e.segmentInfo, i = e.shouldSaveTimelineMapping, n = this.calculateSegmentTimeMapping_(t, t.timingInfo, i), r = t.segment; n && (this.saveDiscontinuitySyncInfo_(t), t.playlist.syncInfo || (t.playlist.syncInfo = { mediaSequence: t.playlist.mediaSequence + t.mediaIndex, time: r.start })); var a = r.dateTimeObject; r.discontinuity && i && a && (this.timelineToDatetimeMappings[r.timeline] = -a.getTime() / 1e3) }, i.timestampOffsetForTimeline = function (e) { return void 0 === this.timelines[e] ? null : this.timelines[e].time }, i.mappingForTimeline = function (e) { return void 0 === this.timelines[e] ? null : this.timelines[e].mapping }, i.calculateSegmentTimeMapping_ = function (e, t, i) { var n, r, a = e.segment, s = e.part, o = this.timelines[e.timeline]; if ("number" == typeof e.timestampOffset) o = { time: e.startOfSegment, mapping: e.startOfSegment - t.start }, i && (this.timelines[e.timeline] = o, this.trigger("timestampoffset"), this.logger_("time mapping for timeline " + e.timeline + ": [time: " + o.time + "] [mapping: " + o.mapping + "]")), n = e.startOfSegment, r = t.end + o.mapping; else { if (!o) return !1; n = t.start + o.mapping, r = t.end + o.mapping } return s && (s.start = n, s.end = r), (!a.start || n < a.start) && (a.start = n), a.end = r, !0 }, i.saveDiscontinuitySyncInfo_ = function (e) { var t = e.playlist, i = e.segment; if (i.discontinuity) this.discontinuities[i.timeline] = { time: i.start, accuracy: 0 }; else if (t.discontinuityStarts && t.discontinuityStarts.length) for (var n = 0; n < t.discontinuityStarts.length; n++) { var r = t.discontinuityStarts[n], a = t.discontinuitySequence + n + 1, s = r - e.mediaIndex, o = Math.abs(s); if (!this.discontinuities[a] || this.discontinuities[a].accuracy > o) { var u = void 0; u = s < 0 ? i.start - po({ defaultDuration: t.targetDuration, durationList: t.segments, startIndex: e.mediaIndex, endIndex: r }) : i.end + po({ defaultDuration: t.targetDuration, durationList: t.segments, startIndex: e.mediaIndex + 1, endIndex: r }), this.discontinuities[a] = { time: u, accuracy: o } } } }, i.dispose = function () { this.trigger("dispose"), this.off() }, t }(qs.EventTarget), Dl = function (e) { function t() { var t; return (t = e.call(this) || this).pendingTimelineChanges_ = {}, t.lastTimelineChanges_ = {}, t } h(t, e); var i = t.prototype; return i.clearPendingTimelineChange = function (e) { this.pendingTimelineChanges_[e] = null, this.trigger("pendingtimelinechange") }, i.pendingTimelineChange = function (e) { var t = e.type, i = e.from, n = e.to; return "number" == typeof i && "number" == typeof n && (this.pendingTimelineChanges_[t] = { type: t, from: i, to: n }, this.trigger("pendingtimelinechange")), this.pendingTimelineChanges_[t] }, i.lastTimelineChange = function (e) { var t = e.type, i = e.from, n = e.to; return "number" == typeof i && "number" == typeof n && (this.lastTimelineChanges_[t] = { type: t, from: i, to: n }, delete this.pendingTimelineChanges_[t], this.trigger("timelinechange")), this.lastTimelineChanges_[t] }, i.dispose = function () { this.trigger("dispose"), this.pendingTimelineChanges_ = {}, this.lastTimelineChanges_ = {}, this.off() }, t }(qs.EventTarget), Pl = cu(du((function () { function e(e, t, i) { return e(i = { path: t, exports: {}, require: function (e, t) { return function () { throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs") }(null == t && i.path) } }, i.exports), i.exports } var t = e((function (e) { function t(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } e.exports = function (e, i, n) { return i && t(e.prototype, i), n && t(e, n), e }, e.exports.default = e.exports, e.exports.__esModule = !0 })), i = e((function (e) { function t(i, n) { return e.exports = t = Object.setPrototypeOf || function (e, t) { return e.__proto__ = t, e }, e.exports.default = e.exports, e.exports.__esModule = !0, t(i, n) } e.exports = t, e.exports.default = e.exports, e.exports.__esModule = !0 })), n = e((function (e) { e.exports = function (e, t) { e.prototype = Object.create(t.prototype), e.prototype.constructor = e, i(e, t) }, e.exports.default = e.exports, e.exports.__esModule = !0 })), r = function () { function e() { this.listeners = {} } var t = e.prototype; return t.on = function (e, t) { this.listeners[e] || (this.listeners[e] = []), this.listeners[e].push(t) }, t.off = function (e, t) { if (!this.listeners[e]) return !1; var i = this.listeners[e].indexOf(t); return this.listeners[e] = this.listeners[e].slice(0), this.listeners[e].splice(i, 1), i > -1 }, t.trigger = function (e) { var t = this.listeners[e]; if (t) if (2 === arguments.length) for (var i = t.length, n = 0; n < i; ++n)t[n].call(this, arguments[1]); else for (var r = Array.prototype.slice.call(arguments, 1), a = t.length, s = 0; s < a; ++s)t[s].apply(this, r) }, t.dispose = function () { this.listeners = {} }, t.pipe = function (e) { this.on("data", (function (t) { e.push(t) })) }, e }(); var a = null, s = function () { function e(e) { var t, i, n; a || (a = function () { var e, t, i, n, r, a, s, o, u = [[[], [], [], [], []], [[], [], [], [], []]], l = u[0], c = u[1], d = l[4], h = c[4], p = [], f = []; for (e = 0; e < 256; e++)f[(p[e] = e << 1 ^ 283 * (e >> 7)) ^ e] = e; for (t = i = 0; !d[t]; t ^= n || 1, i = f[i] || 1)for (a = (a = i ^ i << 1 ^ i << 2 ^ i << 3 ^ i << 4) >> 8 ^ 255 & a ^ 99, d[t] = a, h[a] = t, o = 16843009 * p[r = p[n = p[t]]] ^ 65537 * r ^ 257 * n ^ 16843008 * t, s = 257 * p[a] ^ 16843008 * a, e = 0; e < 4; e++)l[e][t] = s = s << 24 ^ s >>> 8, c[e][a] = o = o << 24 ^ o >>> 8; for (e = 0; e < 5; e++)l[e] = l[e].slice(0), c[e] = c[e].slice(0); return u }()), this._tables = [[a[0][0].slice(), a[0][1].slice(), a[0][2].slice(), a[0][3].slice(), a[0][4].slice()], [a[1][0].slice(), a[1][1].slice(), a[1][2].slice(), a[1][3].slice(), a[1][4].slice()]]; var r = this._tables[0][4], s = this._tables[1], o = e.length, u = 1; if (4 !== o && 6 !== o && 8 !== o) throw new Error("Invalid aes key size"); var l = e.slice(0), c = []; for (this._key = [l, c], t = o; t < 4 * o + 28; t++)n = l[t - 1], (t % o == 0 || 8 === o && t % o == 4) && (n = r[n >>> 24] << 24 ^ r[n >> 16 & 255] << 16 ^ r[n >> 8 & 255] << 8 ^ r[255 & n], t % o == 0 && (n = n << 8 ^ n >>> 24 ^ u << 24, u = u << 1 ^ 283 * (u >> 7))), l[t] = l[t - o] ^ n; for (i = 0; t; i++, t--)n = l[3 & i ? t : t - 4], c[i] = t <= 4 || i < 4 ? n : s[0][r[n >>> 24]] ^ s[1][r[n >> 16 & 255]] ^ s[2][r[n >> 8 & 255]] ^ s[3][r[255 & n]] } return e.prototype.decrypt = function (e, t, i, n, r, a) { var s, o, u, l, c = this._key[1], d = e ^ c[0], h = n ^ c[1], p = i ^ c[2], f = t ^ c[3], m = c.length / 4 - 2, g = 4, A = this._tables[1], v = A[0], y = A[1], _ = A[2], b = A[3], T = A[4]; for (l = 0; l < m; l++)s = v[d >>> 24] ^ y[h >> 16 & 255] ^ _[p >> 8 & 255] ^ b[255 & f] ^ c[g], o = v[h >>> 24] ^ y[p >> 16 & 255] ^ _[f >> 8 & 255] ^ b[255 & d] ^ c[g + 1], u = v[p >>> 24] ^ y[f >> 16 & 255] ^ _[d >> 8 & 255] ^ b[255 & h] ^ c[g + 2], f = v[f >>> 24] ^ y[d >> 16 & 255] ^ _[h >> 8 & 255] ^ b[255 & p] ^ c[g + 3], g += 4, d = s, h = o, p = u; for (l = 0; l < 4; l++)r[(3 & -l) + a] = T[d >>> 24] << 24 ^ T[h >> 16 & 255] << 16 ^ T[p >> 8 & 255] << 8 ^ T[255 & f] ^ c[g++], s = d, d = h, h = p, p = f, f = s }, e }(), o = function (e) { function t() { var t; return (t = e.call(this, r) || this).jobs = [], t.delay = 1, t.timeout_ = null, t } n(t, e); var i = t.prototype; return i.processJob_ = function () { this.jobs.shift()(), this.jobs.length ? this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay) : this.timeout_ = null }, i.push = function (e) { this.jobs.push(e), this.timeout_ || (this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay)) }, t }(r), u = function (e) { return e << 24 | (65280 & e) << 8 | (16711680 & e) >> 8 | e >>> 24 }, l = function () { function e(t, i, n, r) { var a = e.STEP, s = new Int32Array(t.buffer), l = new Uint8Array(t.byteLength), c = 0; for (this.asyncStream_ = new o, this.asyncStream_.push(this.decryptChunk_(s.subarray(c, c + a), i, n, l)), c = a; c < s.length; c += a)n = new Uint32Array([u(s[c - 4]), u(s[c - 3]), u(s[c - 2]), u(s[c - 1])]), this.asyncStream_.push(this.decryptChunk_(s.subarray(c, c + a), i, n, l)); this.asyncStream_.push((function () { var e; r(null, (e = l).subarray(0, e.byteLength - e[e.byteLength - 1])) })) } return e.prototype.decryptChunk_ = function (e, t, i, n) { return function () { var r = function (e, t, i) { var n, r, a, o, l, c, d, h, p, f = new Int32Array(e.buffer, e.byteOffset, e.byteLength >> 2), m = new s(Array.prototype.slice.call(t)), g = new Uint8Array(e.byteLength), A = new Int32Array(g.buffer); for (n = i[0], r = i[1], a = i[2], o = i[3], p = 0; p < f.length; p += 4)l = u(f[p]), c = u(f[p + 1]), d = u(f[p + 2]), h = u(f[p + 3]), m.decrypt(l, c, d, h, A, p), A[p] = u(A[p] ^ n), A[p + 1] = u(A[p + 1] ^ r), A[p + 2] = u(A[p + 2] ^ a), A[p + 3] = u(A[p + 3] ^ o), n = l, r = c, a = d, o = h; return g }(e, t, i); n.set(r, e.byteOffset) } }, t(e, null, [{ key: "STEP", get: function () { return 32e3 } }]), e }(); self.onmessage = function (e) { var t = e.data, i = new Uint8Array(t.encrypted.bytes, t.encrypted.byteOffset, t.encrypted.byteLength), n = new Uint32Array(t.key.bytes, t.key.byteOffset, t.key.byteLength / 4), r = new Uint32Array(t.iv.bytes, t.iv.byteOffset, t.iv.byteLength / 4); new l(i, n, r, (function (e, i) { var n, r; self.postMessage((n = { source: t.source, decrypted: i }, r = {}, Object.keys(n).forEach((function (e) { var t = n[e]; ArrayBuffer.isView(t) ? r[e] = { bytes: t.buffer, byteOffset: t.byteOffset, byteLength: t.byteLength } : r[e] = t })), r), [i.buffer]) })) } }))), Ll = lu(Pl), Ol = function (e) { var t = e.default ? "main" : "alternative"; return e.characteristics && e.characteristics.indexOf("public.accessibility.describes-video") >= 0 && (t = "main-desc"), t }, Bl = function (e, t) { e.abort(), e.pause(), t && t.activePlaylistLoader && (t.activePlaylistLoader.pause(), t.activePlaylistLoader = null) }, Rl = function (e, t) { t.activePlaylistLoader = e, e.load() }, Ml = { AUDIO: function (e, t) { return function () { var i = t.segmentLoaders[e], n = t.mediaTypes[e], r = t.blacklistCurrentPlaylist; Bl(i, n); var a = n.activeTrack(), s = n.activeGroup(), o = (s.filter((function (e) { return e.default }))[0] || s[0]).id, u = n.tracks[o]; if (a !== u) { for (var l in qs.log.warn("Problem encountered loading the alternate audio track.Switching back to default."), n.tracks) n.tracks[l].enabled = n.tracks[l] === u; n.onTrackChanged() } else r({ message: "Problem encountered loading the default audio track." }) } }, SUBTITLES: function (e, t) { return function () { var i = t.segmentLoaders[e], n = t.mediaTypes[e]; qs.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."), Bl(i, n); var r = n.activeTrack(); r && (r.mode = "disabled"), n.onTrackChanged() } } }, Nl = { AUDIO: function (e, t, i) { if (t) { var n = i.tech, r = i.requestOptions, a = i.segmentLoaders[e]; t.on("loadedmetadata", (function () { var e = t.media(); a.playlist(e, r), (!n.paused() || e.endList && "none" !== n.preload()) && a.load() })), t.on("loadedplaylist", (function () { a.playlist(t.media(), r), n.paused() || a.load() })), t.on("error", Ml[e](e, i)) } }, SUBTITLES: function (e, t, i) { var n = i.tech, r = i.requestOptions, a = i.segmentLoaders[e], s = i.mediaTypes[e]; t.on("loadedmetadata", (function () { var e = t.media(); a.playlist(e, r), a.track(s.activeTrack()), (!n.paused() || e.endList && "none" !== n.preload()) && a.load() })), t.on("loadedplaylist", (function () { a.playlist(t.media(), r), n.paused() || a.load() })), t.on("error", Ml[e](e, i)) } }, Ul = { AUDIO: function (e, t) { var i = t.vhs, n = t.sourceType, r = t.segmentLoaders[e], a = t.requestOptions, s = t.master.mediaGroups, o = t.mediaTypes[e], u = o.groups, l = o.tracks, c = o.logger_, d = t.masterPlaylistLoader, h = To(d.master); for (var p in s[e] && 0 !== Object.keys(s[e]).length || (s[e] = { main: { default: { default: !0 } } }, h && (s[e].main.default.playlists = d.master.playlists)), s[e]) for (var f in u[p] || (u[p] = []), s[e][p]) { var m = s[e][p][f], g = void 0; if (h ? (c("AUDIO group '" + p + "' label '" + f + "' is a master playlist"), m.isMasterPlaylist = !0, g = null) : g = "vhs-json" === n && m.playlists ? new Mo(m.playlists[0], i, a) : m.resolvedUri ? new Mo(m.resolvedUri, i, a) : m.playlists && "dash" === n ? new su(m.playlists[0], i, a, d) : null, m = qs.mergeOptions({ id: f, playlistLoader: g }, m), Nl[e](e, m.playlistLoader, t), u[p].push(m), void 0 === l[f]) { var A = new qs.AudioTrack({ id: f, kind: Ol(m), enabled: !1, language: m.language, default: m.default, label: f }); l[f] = A } } r.on("error", Ml[e](e, t)) }, SUBTITLES: function (e, t) { var i = t.tech, n = t.vhs, r = t.sourceType, a = t.segmentLoaders[e], s = t.requestOptions, o = t.master.mediaGroups, u = t.mediaTypes[e], l = u.groups, c = u.tracks, d = t.masterPlaylistLoader; for (var h in o[e]) for (var p in l[h] || (l[h] = []), o[e][h]) if (!o[e][h][p].forced) { var f = o[e][h][p], m = void 0; if ("hls" === r) m = new Mo(f.resolvedUri, n, s); else if ("dash" === r) { if (!f.playlists.filter((function (e) { return e.excludeUntil !== 1 / 0 })).length) return; m = new su(f.playlists[0], n, s, d) } else "vhs-json" === r && (m = new Mo(f.playlists ? f.playlists[0] : f.resolvedUri, n, s)); if (f = qs.mergeOptions({ id: p, playlistLoader: m }, f), Nl[e](e, f.playlistLoader, t), l[h].push(f), void 0 === c[p]) { var g = i.addRemoteTextTrack({ id: p, kind: "subtitles", default: f.default && f.autoselect, language: f.language, label: p }, !1).track; c[p] = g } } a.on("error", Ml[e](e, t)) }, "CLOSED-CAPTIONS": function (e, t) { var i = t.tech, n = t.master.mediaGroups, r = t.mediaTypes[e], a = r.groups, s = r.tracks; for (var o in n[e]) for (var u in a[o] || (a[o] = []), n[e][o]) { var l = n[e][o][u]; if (/^(?:CC|SERVICE)/.test(l.instreamId)) { var c = i.options_.vhs && i.options_.vhs.captionServices || {}, d = { label: u, language: l.language, instreamId: l.instreamId, default: l.default && l.autoselect }; if (c[d.instreamId] && (d = qs.mergeOptions(d, c[d.instreamId])), void 0 === d.default && delete d.default, a[o].push(qs.mergeOptions({ id: u }, l)), void 0 === s[u]) { var h = i.addRemoteTextTrack({ id: d.instreamId, kind: "captions", default: d.default, language: d.language, label: d.label }, !1).track; s[u] = h } } } } }, jl = function e(t, i) { for (var n = 0; n < t.length; n++) { if (_o(i, t[n])) return !0; if (t[n].playlists && e(t[n].playlists, i)) return !0 } return !1 }, Hl = { AUDIO: function (e, t) { return function () { var i = t.mediaTypes[e].tracks; for (var n in i) if (i[n].enabled) return i[n]; return null } }, SUBTITLES: function (e, t) { return function () { var i = t.mediaTypes[e].tracks; for (var n in i) if ("showing" === i[n].mode || "hidden" === i[n].mode) return i[n]; return null } } }, Vl = function (e) { ["AUDIO", "SUBTITLES", "CLOSED-CAPTIONS"].forEach((function (t) { Ul[t](t, e) })); var t = e.mediaTypes, i = e.masterPlaylistLoader, n = e.tech, r = e.vhs, a = e.segmentLoaders, s = a.AUDIO, o = a.main;["AUDIO", "SUBTITLES"].forEach((function (i) { t[i].activeGroup = function (e, t) { return function (i) { var n = t.masterPlaylistLoader, r = t.mediaTypes[e].groups, a = n.media(); if (!a) return null; var s = null; a.attributes[e] && (s = r[a.attributes[e]]); var o = Object.keys(r); if (!s) if ("AUDIO" === e && o.length > 1 && To(t.master)) for (var u = 0; u < o.length; u++) { var l = r[o[u]]; if (jl(l, a)) { s = l; break } } else r.main ? s = r.main : 1 === o.length && (s = r[o[0]]); return void 0 === i ? s : null !== i && s && s.filter((function (e) { return e.id === i.id }))[0] || null } }(i, e), t[i].activeTrack = Hl[i](i, e), t[i].onGroupChanged = function (e, t) { return function () { var i = t.segmentLoaders, n = i[e], r = i.main, a = t.mediaTypes[e], s = a.activeTrack(), o = a.getActiveGroup(), u = a.activePlaylistLoader, l = a.lastGroup_; o && l && o.id === l.id || (a.lastGroup_ = o, a.lastTrack_ = s, Bl(n, a), o && !o.isMasterPlaylist && (o.playlistLoader ? (n.resyncLoader(), Rl(o.playlistLoader, a)) : u && r.resetEverything())) } }(i, e), t[i].onGroupChanging = function (e, t) { return function () { var i = t.segmentLoaders[e]; t.mediaTypes[e].lastGroup_ = null, i.abort(), i.pause() } }(i, e), t[i].onTrackChanged = function (e, t) { return function () { var i = t.masterPlaylistLoader, n = t.segmentLoaders, r = n[e], a = n.main, s = t.mediaTypes[e], o = s.activeTrack(), u = s.getActiveGroup(), l = s.activePlaylistLoader, c = s.lastTrack_; if ((!c || !o || c.id !== o.id) && (s.lastGroup_ = u, s.lastTrack_ = o, Bl(r, s), u)) { if (u.isMasterPlaylist) { if (!o || !c || o.id === c.id) return; var d = t.vhs.masterPlaylistController_, h = d.selectPlaylist(); if (d.media() === h) return; return s.logger_("track change. Switching master audio from " + c.id + " to " + o.id), i.pause(), a.resetEverything(), void d.fastQualityChange_(h) } if ("AUDIO" === e) { if (!u.playlistLoader) return a.setAudio(!0), void a.resetEverything(); r.setAudio(!0), a.setAudio(!1) } l !== u.playlistLoader ? (r.track && r.track(o), r.resetEverything(), Rl(u.playlistLoader, s)) : Rl(u.playlistLoader, s) } } }(i, e), t[i].getActiveGroup = function (e, t) { var i = t.mediaTypes; return function () { var t = i[e].activeTrack(); return t ? i[e].activeGroup(t) : null } }(i, e) })); var u = t.AUDIO.activeGroup(); if (u) { var l = (u.filter((function (e) { return e.default }))[0] || u[0]).id; t.AUDIO.tracks[l].enabled = !0, t.AUDIO.onGroupChanged(), t.AUDIO.onTrackChanged(), t.AUDIO.getActiveGroup().playlistLoader ? (o.setAudio(!1), s.setAudio(!0)) : o.setAudio(!0) } i.on("mediachange", (function () { ["AUDIO", "SUBTITLES"].forEach((function (e) { return t[e].onGroupChanged() })) })), i.on("mediachanging", (function () { ["AUDIO", "SUBTITLES"].forEach((function (e) { return t[e].onGroupChanging() })) })); var c = function () { t.AUDIO.onTrackChanged(), n.trigger({ type: "usage", name: "vhs-audio-change" }), n.trigger({ type: "usage", name: "hls-audio-change" }) }; for (var d in n.audioTracks().addEventListener("change", c), n.remoteTextTracks().addEventListener("change", t.SUBTITLES.onTrackChanged), r.on("dispose", (function () { n.audioTracks().removeEventListener("change", c), n.remoteTextTracks().removeEventListener("change", t.SUBTITLES.onTrackChanged) })), n.clearTracks("audio"), t.AUDIO.tracks) n.audioTracks().addTrack(t.AUDIO.tracks[d]) }, ql = ["mediaRequests", "mediaRequestsAborted", "mediaRequestsTimedout", "mediaRequestsErrored", "mediaTransferDuration", "mediaBytesTransferred", "mediaAppends"], Wl = function (e) { return this.audioSegmentLoader_[e] + this.mainSegmentLoader_[e] }, Gl = function (e) { function t(t) { var i; i = e.call(this) || this; var n = t.src, a = t.handleManifestRedirects, s = t.withCredentials, o = t.tech, u = t.bandwidth, l = t.externVhs, d = t.useCueTags, h = t.blacklistDuration, p = t.enableLowInitialPlaylist, f = t.sourceType, m = t.cacheEncryptionKeys, g = t.experimentalBufferBasedABR, A = t.experimentalLeastPixelDiffSelector, v = t.captionServices; if (!n) throw new Error("A non-empty playlist URL or JSON manifest string is required"); var y = t.maxPlaylistRetries; null == y && (y = 1 / 0), al = l, i.experimentalBufferBasedABR = Boolean(g), i.experimentalLeastPixelDiffSelector = Boolean(A), i.withCredentials = s, i.tech_ = o, i.vhs_ = o.vhs, i.sourceType_ = f, i.useCueTags_ = d, i.blacklistDuration = h, i.maxPlaylistRetries = y, i.enableLowInitialPlaylist = p, i.useCueTags_ && (i.cueTagsTrack_ = i.tech_.addTextTrack("metadata", "ad-cues"), i.cueTagsTrack_.inBandMetadataTrackDispatchType = ""), i.requestOptions_ = { withCredentials: s, handleManifestRedirects: a, maxPlaylistRetries: y, timeout: null }, i.on("error", i.pauseLoading), i.mediaTypes_ = function () { var e = {}; return ["AUDIO", "SUBTITLES", "CLOSED-CAPTIONS"].forEach((function (t) { e[t] = { groups: {}, tracks: {}, activePlaylistLoader: null, activeGroup: rl, activeTrack: rl, getActiveGroup: rl, onGroupChanged: rl, onTrackChanged: rl, lastTrack_: null, logger_: Xs("MediaGroups[" + t + "]") } })), e }(), i.mediaSource = new (r().MediaSource), i.handleDurationChange_ = i.handleDurationChange_.bind(c(i)), i.handleSourceOpen_ = i.handleSourceOpen_.bind(c(i)), i.handleSourceEnded_ = i.handleSourceEnded_.bind(c(i)), i.mediaSource.addEventListener("durationchange", i.handleDurationChange_), i.mediaSource.addEventListener("sourceopen", i.handleSourceOpen_), i.mediaSource.addEventListener("sourceended", i.handleSourceEnded_), i.seekable_ = qs.createTimeRanges(), i.hasPlayed_ = !1, i.syncController_ = new Il(t), i.segmentMetadataTrack_ = o.addRemoteTextTrack({ kind: "metadata", label: "segment-metadata" }, !1).track, i.decrypter_ = new Ll, i.sourceUpdater_ = new Sl(i.mediaSource), i.inbandTextTracks_ = {}, i.timelineChangeController_ = new Dl; var _ = { vhs: i.vhs_, parse708captions: t.parse708captions, captionServices: v, mediaSource: i.mediaSource, currentTime: i.tech_.currentTime.bind(i.tech_), seekable: function () { return i.seekable() }, seeking: function () { return i.tech_.seeking() }, duration: function () { return i.duration() }, hasPlayed: function () { return i.hasPlayed_ }, goalBufferLength: function () { return i.goalBufferLength() }, bandwidth: u, syncController: i.syncController_, decrypter: i.decrypter_, sourceType: i.sourceType_, inbandTextTracks: i.inbandTextTracks_, cacheEncryptionKeys: m, sourceUpdater: i.sourceUpdater_, timelineChangeController: i.timelineChangeController_, experimentalExactManifestTimings: t.experimentalExactManifestTimings }; i.masterPlaylistLoader_ = "dash" === i.sourceType_ ? new su(n, i.vhs_, i.requestOptions_) : new Mo(n, i.vhs_, i.requestOptions_), i.setupMasterPlaylistLoaderListeners_(), i.mainSegmentLoader_ = new nl(qs.mergeOptions(_, { segmentMetadataTrack: i.segmentMetadataTrack_, loaderType: "main" }), t), i.audioSegmentLoader_ = new nl(qs.mergeOptions(_, { loaderType: "audio" }), t), i.subtitleSegmentLoader_ = new wl(qs.mergeOptions(_, { loaderType: "vtt", featuresNativeTextTracks: i.tech_.featuresNativeTextTracks }), t), i.setupSegmentLoaderListeners_(), i.experimentalBufferBasedABR && (i.masterPlaylistLoader_.one("loadedplaylist", (function () { return i.startABRTimer_() })), i.tech_.on("pause", (function () { return i.stopABRTimer_() })), i.tech_.on("play", (function () { return i.startABRTimer_() }))), ql.forEach((function (e) { i[e + "_"] = Wl.bind(c(i), e) })), i.logger_ = Xs("MPC"), i.triggeredFmp4Usage = !1, "none" === i.tech_.preload() ? (i.loadOnPlay_ = function () { i.loadOnPlay_ = null, i.masterPlaylistLoader_.load() }, i.tech_.one("play", i.loadOnPlay_)) : i.masterPlaylistLoader_.load(), i.timeToLoadedData__ = -1, i.mainAppendsToLoadedData__ = -1, i.audioAppendsToLoadedData__ = -1; var b = "none" === i.tech_.preload() ? "play" : "loadstart"; return i.tech_.one(b, (function () { var e = Date.now(); i.tech_.one("loadeddata", (function () { i.timeToLoadedData__ = Date.now() - e, i.mainAppendsToLoadedData__ = i.mainSegmentLoader_.mediaAppends, i.audioAppendsToLoadedData__ = i.audioSegmentLoader_.mediaAppends })) })), i } h(t, e); var i = t.prototype; return i.mainAppendsToLoadedData_ = function () { return this.mainAppendsToLoadedData__ }, i.audioAppendsToLoadedData_ = function () { return this.audioAppendsToLoadedData__ }, i.appendsToLoadedData_ = function () { var e = this.mainAppendsToLoadedData_(), t = this.audioAppendsToLoadedData_(); return -1 === e || -1 === t ? -1 : e + t }, i.timeToLoadedData_ = function () { return this.timeToLoadedData__ }, i.checkABR_ = function () { var e = this.selectPlaylist(); e && this.shouldSwitchToMedia_(e) && this.switchMedia_(e, "abr") }, i.switchMedia_ = function (e, t, i) { var n = this.media(), r = n && (n.id || n.uri), a = e.id || e.uri; r && r !== a && (this.logger_("switch media " + r + " -> " + a + " from " + t), this.tech_.trigger({ type: "usage", name: "vhs-rendition-change-" + t })), this.masterPlaylistLoader_.media(e, i) }, i.startABRTimer_ = function () { var e = this; this.stopABRTimer_(), this.abrTimer_ = r().setInterval((function () { return e.checkABR_() }), 250) }, i.stopABRTimer_ = function () { this.tech_.scrubbing && this.tech_.scrubbing() || (r().clearInterval(this.abrTimer_), this.abrTimer_ = null) }, i.getAudioTrackPlaylists_ = function () { var e = this.master(), t = e && e.playlists || []; if (!e || !e.mediaGroups || !e.mediaGroups.AUDIO) return t; var i, n = e.mediaGroups.AUDIO, r = Object.keys(n); if (Object.keys(this.mediaTypes_.AUDIO.groups).length) i = this.mediaTypes_.AUDIO.activeTrack(); else { var a = n.main || r.length && n[r[0]]; for (var s in a) if (a[s].default) { i = { label: s }; break } } if (!i) return t; var o = []; for (var u in n) if (n[u][i.label]) { var l = n[u][i.label]; if (l.playlists && l.playlists.length) o.push.apply(o, l.playlists); else if (l.uri) o.push(l); else if (e.playlists.length) for (var c = 0; c < e.playlists.length; c++) { var d = e.playlists[c]; d.attributes && d.attributes.AUDIO && d.attributes.AUDIO === u && o.push(d) } } return o.length ? o : t }, i.setupMasterPlaylistLoaderListeners_ = function () { var e = this; this.masterPlaylistLoader_.on("loadedmetadata", (function () { var t = e.masterPlaylistLoader_.media(), i = 1.5 * t.targetDuration * 1e3; yo(e.masterPlaylistLoader_.master, e.masterPlaylistLoader_.media()) ? e.requestOptions_.timeout = 0 : e.requestOptions_.timeout = i, t.endList && "none" !== e.tech_.preload() && (e.mainSegmentLoader_.playlist(t, e.requestOptions_), e.mainSegmentLoader_.load()), Vl({ sourceType: e.sourceType_, segmentLoaders: { AUDIO: e.audioSegmentLoader_, SUBTITLES: e.subtitleSegmentLoader_, main: e.mainSegmentLoader_ }, tech: e.tech_, requestOptions: e.requestOptions_, masterPlaylistLoader: e.masterPlaylistLoader_, vhs: e.vhs_, master: e.master(), mediaTypes: e.mediaTypes_, blacklistCurrentPlaylist: e.blacklistCurrentPlaylist.bind(e) }), e.triggerPresenceUsage_(e.master(), t), e.setupFirstPlay(), !e.mediaTypes_.AUDIO.activePlaylistLoader || e.mediaTypes_.AUDIO.activePlaylistLoader.media() ? e.trigger("selectedinitialmedia") : e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata", (function () { e.trigger("selectedinitialmedia") })) })), this.masterPlaylistLoader_.on("loadedplaylist", (function () { e.loadOnPlay_ && e.tech_.off("play", e.loadOnPlay_); var t = e.masterPlaylistLoader_.media(); if (!t) { var i; if (e.excludeUnsupportedVariants_(), e.enableLowInitialPlaylist && (i = e.selectInitialPlaylist()), i || (i = e.selectPlaylist()), !i || !e.shouldSwitchToMedia_(i)) return; if (e.initialMedia_ = i, e.switchMedia_(e.initialMedia_, "initial"), !("vhs-json" === e.sourceType_ && e.initialMedia_.segments)) return; t = e.initialMedia_ } e.handleUpdatedMediaPlaylist(t) })), this.masterPlaylistLoader_.on("error", (function () { e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error) })), this.masterPlaylistLoader_.on("mediachanging", (function () { e.mainSegmentLoader_.abort(), e.mainSegmentLoader_.pause() })), this.masterPlaylistLoader_.on("mediachange", (function () { var t = e.masterPlaylistLoader_.media(), i = 1.5 * t.targetDuration * 1e3; yo(e.masterPlaylistLoader_.master, e.masterPlaylistLoader_.media()) ? e.requestOptions_.timeout = 0 : e.requestOptions_.timeout = i, e.mainSegmentLoader_.playlist(t, e.requestOptions_), e.mainSegmentLoader_.load(), e.tech_.trigger({ type: "mediachange", bubbles: !0 }) })), this.masterPlaylistLoader_.on("playlistunchanged", (function () { var t = e.masterPlaylistLoader_.media(); "playlist-unchanged" !== t.lastExcludeReason_ && (e.stuckAtPlaylistEnd_(t) && (e.blacklistCurrentPlaylist({ message: "Playlist no longer updating.", reason: "playlist-unchanged" }), e.tech_.trigger("playliststuck"))) })), this.masterPlaylistLoader_.on("renditiondisabled", (function () { e.tech_.trigger({ type: "usage", name: "vhs-rendition-disabled" }), e.tech_.trigger({ type: "usage", name: "hls-rendition-disabled" }) })), this.masterPlaylistLoader_.on("renditionenabled", (function () { e.tech_.trigger({ type: "usage", name: "vhs-rendition-enabled" }), e.tech_.trigger({ type: "usage", name: "hls-rendition-enabled" }) })) }, i.handleUpdatedMediaPlaylist = function (e) { this.useCueTags_ && this.updateAdCues_(e), this.mainSegmentLoader_.playlist(e, this.requestOptions_), this.updateDuration(!e.endList), this.tech_.paused() || (this.mainSegmentLoader_.load(), this.audioSegmentLoader_ && this.audioSegmentLoader_.load()) }, i.triggerPresenceUsage_ = function (e, t) { var i = e.mediaGroups || {}, n = !0, r = Object.keys(i.AUDIO); for (var a in i.AUDIO) for (var s in i.AUDIO[a]) { i.AUDIO[a][s].uri || (n = !1) } n && (this.tech_.trigger({ type: "usage", name: "vhs-demuxed" }), this.tech_.trigger({ type: "usage", name: "hls-demuxed" })), Object.keys(i.SUBTITLES).length && (this.tech_.trigger({ type: "usage", name: "vhs-webvtt" }), this.tech_.trigger({ type: "usage", name: "hls-webvtt" })), al.Playlist.isAes(t) && (this.tech_.trigger({ type: "usage", name: "vhs-aes" }), this.tech_.trigger({ type: "usage", name: "hls-aes" })), r.length && Object.keys(i.AUDIO[r[0]]).length > 1 && (this.tech_.trigger({ type: "usage", name: "vhs-alternate-audio" }), this.tech_.trigger({ type: "usage", name: "hls-alternate-audio" })), this.useCueTags_ && (this.tech_.trigger({ type: "usage", name: "vhs-playlist-cue-tags" }), this.tech_.trigger({ type: "usage", name: "hls-playlist-cue-tags" })) }, i.shouldSwitchToMedia_ = function (e) { var t = this.masterPlaylistLoader_.media() || this.masterPlaylistLoader_.pendingMedia_, i = this.tech_.currentTime(), n = this.bufferLowWaterLine(), r = this.bufferHighWaterLine(); return function (e) { var t = e.currentPlaylist, i = e.buffered, n = e.currentTime, r = e.nextPlaylist, a = e.bufferLowWaterLine, s = e.bufferHighWaterLine, o = e.duration, u = e.experimentalBufferBasedABR, l = e.log; if (!r) return qs.log.warn("We received no playlist to switch to. Please check your stream."), !1; var c = "allowing switch " + (t && t.id || "null") + " -> " + r.id; if (!t) return l(c + " as current playlist is not set"), !0; if (r.id === t.id) return !1; var d = Boolean(Zs(i, n).length); if (!t.endList) return d || "number" != typeof t.partTargetDuration ? (l(c + " as current playlist is live"), !0) : (l("not " + c + " as current playlist is live llhls, but currentTime isn't in buffered."), !1); var h = no(i, n), p = u ? ou.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE : ou.MAX_BUFFER_LOW_WATER_LINE; if (o < p) return l(c + " as duration < max low water line (" + o + " < " + p + ")"), !0; var f = r.attributes.BANDWIDTH, m = t.attributes.BANDWIDTH; if (f < m && (!u || h < s)) { var g = c + " as next bandwidth < current bandwidth (" + f + " < " + m + ")"; return u && (g += " and forwardBuffer < bufferHighWaterLine (" + h + " < " + s + ")"), l(g), !0 } if ((!u || f > m) && h >= a) { var A = c + " as forwardBuffer >= bufferLowWaterLine (" + h + " >= " + a + ")"; return u && (A += " and next bandwidth > current bandwidth (" + f + " > " + m + ")"), l(A), !0 } return l("not " + c + " as no switching criteria met"), !1 }({ buffered: this.tech_.buffered(), currentTime: i, currentPlaylist: t, nextPlaylist: e, bufferLowWaterLine: n, bufferHighWaterLine: r, duration: this.duration(), experimentalBufferBasedABR: this.experimentalBufferBasedABR, log: this.logger_ }) }, i.setupSegmentLoaderListeners_ = function () { var e = this; this.experimentalBufferBasedABR || (this.mainSegmentLoader_.on("bandwidthupdate", (function () { var t = e.selectPlaylist(); e.shouldSwitchToMedia_(t) && e.switchMedia_(t, "bandwidthupdate"), e.tech_.trigger("bandwidthupdate") })), this.mainSegmentLoader_.on("progress", (function () { e.trigger("progress") }))), this.mainSegmentLoader_.on("error", (function () { e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error()) })), this.mainSegmentLoader_.on("appenderror", (function () { e.error = e.mainSegmentLoader_.error_, e.trigger("error") })), this.mainSegmentLoader_.on("syncinfoupdate", (function () { e.onSyncInfoUpdate_() })), this.mainSegmentLoader_.on("timestampoffset", (function () { e.tech_.trigger({ type: "usage", name: "vhs-timestamp-offset" }), e.tech_.trigger({ type: "usage", name: "hls-timestamp-offset" }) })), this.audioSegmentLoader_.on("syncinfoupdate", (function () { e.onSyncInfoUpdate_() })), this.audioSegmentLoader_.on("appenderror", (function () { e.error = e.audioSegmentLoader_.error_, e.trigger("error") })), this.mainSegmentLoader_.on("ended", (function () { e.logger_("main segment loader ended"), e.onEndOfStream() })), this.mainSegmentLoader_.on("earlyabort", (function (t) { e.experimentalBufferBasedABR || (e.delegateLoaders_("all", ["abort"]), e.blacklistCurrentPlaylist({ message: "Aborted early because there isn't enough bandwidth to complete the request without rebuffering." }, 120)) })); var t = function () { if (!e.sourceUpdater_.hasCreatedSourceBuffers()) return e.tryToCreateSourceBuffers_(); var t = e.getCodecsOrExclude_(); t && e.sourceUpdater_.addOrChangeSourceBuffers(t) }; this.mainSegmentLoader_.on("trackinfo", t), this.audioSegmentLoader_.on("trackinfo", t), this.mainSegmentLoader_.on("fmp4", (function () { e.triggeredFmp4Usage || (e.tech_.trigger({ type: "usage", name: "vhs-fmp4" }), e.tech_.trigger({ type: "usage", name: "hls-fmp4" }), e.triggeredFmp4Usage = !0) })), this.audioSegmentLoader_.on("fmp4", (function () { e.triggeredFmp4Usage || (e.tech_.trigger({ type: "usage", name: "vhs-fmp4" }), e.tech_.trigger({ type: "usage", name: "hls-fmp4" }), e.triggeredFmp4Usage = !0) })), this.audioSegmentLoader_.on("ended", (function () { e.logger_("audioSegmentLoader ended"), e.onEndOfStream() })) }, i.mediaSecondsLoaded_ = function () { return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded + this.mainSegmentLoader_.mediaSecondsLoaded) }, i.load = function () { this.mainSegmentLoader_.load(), this.mediaTypes_.AUDIO.activePlaylistLoader && this.audioSegmentLoader_.load(), this.mediaTypes_.SUBTITLES.activePlaylistLoader && this.subtitleSegmentLoader_.load() }, i.smoothQualityChange_ = function (e) { void 0 === e && (e = this.selectPlaylist()), this.fastQualityChange_(e) }, i.fastQualityChange_ = function (e) { var t = this; void 0 === e && (e = this.selectPlaylist()), e !== this.masterPlaylistLoader_.media() ? (this.switchMedia_(e, "fast-quality"), this.mainSegmentLoader_.resetEverything((function () { qs.browser.IE_VERSION || qs.browser.IS_EDGE ? t.tech_.setCurrentTime(t.tech_.currentTime() + .04) : t.tech_.setCurrentTime(t.tech_.currentTime()) }))) : this.logger_("skipping fastQualityChange because new media is same as old") }, i.play = function () { if (!this.setupFirstPlay()) { this.tech_.ended() && this.tech_.setCurrentTime(0), this.hasPlayed_ && this.load(); var e = this.tech_.seekable(); return this.tech_.duration() === 1 / 0 && this.tech_.currentTime() < e.start(0) ? this.tech_.setCurrentTime(e.end(e.length - 1)) : void 0 } }, i.setupFirstPlay = function () { var e = this, t = this.masterPlaylistLoader_.media(); if (!t || this.tech_.paused() || this.hasPlayed_) return !1; if (!t.endList) { var i = this.seekable(); if (!i.length) return !1; if (qs.browser.IE_VERSION && 0 === this.tech_.readyState()) return this.tech_.one("loadedmetadata", (function () { e.trigger("firstplay"), e.tech_.setCurrentTime(i.end(0)), e.hasPlayed_ = !0 })), !1; this.trigger("firstplay"), this.tech_.setCurrentTime(i.end(0)) } return this.hasPlayed_ = !0, this.load(), !0 }, i.handleSourceOpen_ = function () { if (this.tryToCreateSourceBuffers_(), this.tech_.autoplay()) { var e = this.tech_.play(); void 0 !== e && "function" == typeof e.then && e.then(null, (function (e) { })) } this.trigger("sourceopen") }, i.handleSourceEnded_ = function () { if (this.inbandTextTracks_.metadataTrack_) { var e = this.inbandTextTracks_.metadataTrack_.cues; if (e && e.length) { var t = this.duration(); e[e.length - 1].endTime = isNaN(t) || Math.abs(t) === 1 / 0 ? Number.MAX_VALUE : t } } }, i.handleDurationChange_ = function () { this.tech_.trigger("durationchange") }, i.onEndOfStream = function () { var e = this.mainSegmentLoader_.ended_; if (this.mediaTypes_.AUDIO.activePlaylistLoader) { var t = this.mainSegmentLoader_.getCurrentMediaInfo_(); e = !t || t.hasVideo ? e && this.audioSegmentLoader_.ended_ : this.audioSegmentLoader_.ended_ } e && (this.stopABRTimer_(), this.sourceUpdater_.endOfStream()) }, i.stuckAtPlaylistEnd_ = function (e) { if (!this.seekable().length) return !1; var t = this.syncController_.getExpiredTime(e, this.duration()); if (null === t) return !1; var i = al.Playlist.playlistEnd(e, t), n = this.tech_.currentTime(), r = this.tech_.buffered(); if (!r.length) return i - n <= Ks; var a = r.end(r.length - 1); return a - n <= Ks && i - a <= Ks }, i.blacklistCurrentPlaylist = function (e, t) { void 0 === e && (e = {}); var i = e.playlist || this.masterPlaylistLoader_.media(); if (t = t || e.blacklistDuration || this.blacklistDuration, !i) return this.error = e, void ("open" !== this.mediaSource.readyState ? this.trigger("error") : this.sourceUpdater_.endOfStream("network")); i.playlistErrors_++; var n, r = this.masterPlaylistLoader_.master.playlists, a = r.filter(Ao), s = 1 === a.length && a[0] === i; if (1 === r.length && t !== 1 / 0) return qs.log.warn("Problem encountered with playlist " + i.id + ". Trying again since it is the only playlist."), this.tech_.trigger("retryplaylist"), this.masterPlaylistLoader_.load(s); if (s) { var o = !1; r.forEach((function (e) { if (e !== i) { var t = e.excludeUntil; void 0 !== t && t !== 1 / 0 && (o = !0, delete e.excludeUntil) } })), o && (qs.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."), this.tech_.trigger("retryplaylist")) } n = i.playlistErrors_ > this.maxPlaylistRetries ? 1 / 0 : Date.now() + 1e3 * t, i.excludeUntil = n, e.reason && (i.lastExcludeReason_ = e.reason), this.tech_.trigger("blacklistplaylist"), this.tech_.trigger({ type: "usage", name: "vhs-rendition-blacklisted" }), this.tech_.trigger({ type: "usage", name: "hls-rendition-blacklisted" }); var u = this.selectPlaylist(); if (!u) return this.error = "Playback cannot continue. No available working or supported playlists.", void this.trigger("error"); var l = e.internal ? this.logger_ : qs.log.warn, c = e.message ? " " + e.message : ""; l((e.internal ? "Internal problem" : "Problem") + " encountered with playlist " + i.id + "." + c + " Switching to playlist " + u.id + "."), u.attributes.AUDIO !== i.attributes.AUDIO && this.delegateLoaders_("audio", ["abort", "pause"]), u.attributes.SUBTITLES !== i.attributes.SUBTITLES && this.delegateLoaders_("subtitle", ["abort", "pause"]), this.delegateLoaders_("main", ["abort", "pause"]); var d = u.targetDuration / 2 * 1e3 || 5e3, h = "number" == typeof u.lastRequest && Date.now() - u.lastRequest <= d; return this.switchMedia_(u, "exclude", s || h) }, i.pauseLoading = function () { this.delegateLoaders_("all", ["abort", "pause"]), this.stopABRTimer_() }, i.delegateLoaders_ = function (e, t) { var i = this, n = [], r = "all" === e; (r || "main" === e) && n.push(this.masterPlaylistLoader_); var a = []; (r || "audio" === e) && a.push("AUDIO"), (r || "subtitle" === e) && (a.push("CLOSED-CAPTIONS"), a.push("SUBTITLES")), a.forEach((function (e) { var t = i.mediaTypes_[e] && i.mediaTypes_[e].activePlaylistLoader; t && n.push(t) })), ["main", "audio", "subtitle"].forEach((function (t) { var r = i[t + "SegmentLoader_"]; !r || e !== t && "all" !== e || n.push(r) })), n.forEach((function (e) { return t.forEach((function (t) { "function" == typeof e[t] && e[t]() })) })) }, i.setCurrentTime = function (e) { var t = Zs(this.tech_.buffered(), e); return this.masterPlaylistLoader_ && this.masterPlaylistLoader_.media() && this.masterPlaylistLoader_.media().segments ? t && t.length ? e : (this.mainSegmentLoader_.resetEverything(), this.mainSegmentLoader_.abort(), this.mediaTypes_.AUDIO.activePlaylistLoader && (this.audioSegmentLoader_.resetEverything(), this.audioSegmentLoader_.abort()), this.mediaTypes_.SUBTITLES.activePlaylistLoader && (this.subtitleSegmentLoader_.resetEverything(), this.subtitleSegmentLoader_.abort()), void this.load()) : 0 }, i.duration = function () { if (!this.masterPlaylistLoader_) return 0; var e = this.masterPlaylistLoader_.media(); return e ? e.endList ? this.mediaSource ? this.mediaSource.duration : al.Playlist.duration(e) : 1 / 0 : 0 }, i.seekable = function () { return this.seekable_ }, i.onSyncInfoUpdate_ = function () { var e; if (this.masterPlaylistLoader_) { var t = this.masterPlaylistLoader_.media(); if (t) { var i = this.syncController_.getExpiredTime(t, this.duration()); if (null !== i) { var n = this.masterPlaylistLoader_.master, r = al.Playlist.seekable(t, i, al.Playlist.liveEdgeDelay(n, t)); if (0 !== r.length) { if (this.mediaTypes_.AUDIO.activePlaylistLoader) { if (t = this.mediaTypes_.AUDIO.activePlaylistLoader.media(), null === (i = this.syncController_.getExpiredTime(t, this.duration()))) return; if (0 === (e = al.Playlist.seekable(t, i, al.Playlist.liveEdgeDelay(n, t))).length) return } var a, s; this.seekable_ && this.seekable_.length && (a = this.seekable_.end(0), s = this.seekable_.start(0)), e ? e.start(0) > r.end(0) || r.start(0) > e.end(0) ? this.seekable_ = r : this.seekable_ = qs.createTimeRanges([[e.start(0) > r.start(0) ? e.start(0) : r.start(0), e.end(0) < r.end(0) ? e.end(0) : r.end(0)]]) : this.seekable_ = r, this.seekable_ && this.seekable_.length && this.seekable_.end(0) === a && this.seekable_.start(0) === s || (this.logger_("seekable updated [" + eo(this.seekable_) + "]"), this.tech_.trigger("seekablechanged")) } } } } }, i.updateDuration = function (e) { if (this.updateDuration_ && (this.mediaSource.removeEventListener("sourceopen", this.updateDuration_), this.updateDuration_ = null), "open" !== this.mediaSource.readyState) return this.updateDuration_ = this.updateDuration.bind(this, e), void this.mediaSource.addEventListener("sourceopen", this.updateDuration_); if (e) { var t = this.seekable(); if (!t.length) return; (isNaN(this.mediaSource.duration) || this.mediaSource.duration < t.end(t.length - 1)) && this.sourceUpdater_.setDuration(t.end(t.length - 1)) } else { var i = this.tech_.buffered(), n = al.Playlist.duration(this.masterPlaylistLoader_.media()); i.length > 0 && (n = Math.max(n, i.end(i.length - 1))), this.mediaSource.duration !== n && this.sourceUpdater_.setDuration(n) } }, i.dispose = function () { var e = this; this.trigger("dispose"), this.decrypter_.terminate(), this.masterPlaylistLoader_.dispose(), this.mainSegmentLoader_.dispose(), this.loadOnPlay_ && this.tech_.off("play", this.loadOnPlay_), ["AUDIO", "SUBTITLES"].forEach((function (t) { var i = e.mediaTypes_[t].groups; for (var n in i) i[n].forEach((function (e) { e.playlistLoader && e.playlistLoader.dispose() })) })), this.audioSegmentLoader_.dispose(), this.subtitleSegmentLoader_.dispose(), this.sourceUpdater_.dispose(), this.timelineChangeController_.dispose(), this.stopABRTimer_(), this.updateDuration_ && this.mediaSource.removeEventListener("sourceopen", this.updateDuration_), this.mediaSource.removeEventListener("durationchange", this.handleDurationChange_), this.mediaSource.removeEventListener("sourceopen", this.handleSourceOpen_), this.mediaSource.removeEventListener("sourceended", this.handleSourceEnded_), this.off() }, i.master = function () { return this.masterPlaylistLoader_.master }, i.media = function () { return this.masterPlaylistLoader_.media() || this.initialMedia_ }, i.areMediaTypesKnown_ = function () { var e = !!this.mediaTypes_.AUDIO.activePlaylistLoader, t = !!this.mainSegmentLoader_.getCurrentMediaInfo_(), i = !e || !!this.audioSegmentLoader_.getCurrentMediaInfo_(); return !(!t || !i) }, i.getCodecsOrExclude_ = function () { var e = this, t = { main: this.mainSegmentLoader_.getCurrentMediaInfo_() || {}, audio: this.audioSegmentLoader_.getCurrentMediaInfo_() || {} }; t.video = t.main; var i = ju(this.master(), this.media()), n = {}, r = !!this.mediaTypes_.AUDIO.activePlaylistLoader; if (t.main.hasVideo && (n.video = i.video || t.main.videoCodec || "avc1.4d400d"), t.main.isMuxed && (n.video += "," + (i.audio || t.main.audioCodec || Q)), (t.main.hasAudio && !t.main.isMuxed || t.audio.hasAudio || r) && (n.audio = i.audio || t.main.audioCodec || t.audio.audioCodec || Q, t.audio.isFmp4 = t.main.hasAudio && !t.main.isMuxed ? t.main.isFmp4 : t.audio.isFmp4), n.audio || n.video) { var a, s = {}; if (["video", "audio"].forEach((function (e) { if (n.hasOwnProperty(e) && (r = t[e].isFmp4, o = n[e], !(r ? G(o) : z(o)))) { var i = t[e].isFmp4 ? "browser" : "muxer"; s[i] = s[i] || [], s[i].push(n[e]), "audio" === e && (a = i) } var r, o })), r && a && this.media().attributes.AUDIO) { var o = this.media().attributes.AUDIO; this.master().playlists.forEach((function (t) { (t.attributes && t.attributes.AUDIO) === o && t !== e.media() && (t.excludeUntil = 1 / 0) })), this.logger_("excluding audio group " + o + " as " + a + ' does not support codec(s): "' + n.audio + '"') } if (!Object.keys(s).length) { if (this.sourceUpdater_.hasCreatedSourceBuffers() && !this.sourceUpdater_.canChangeType()) { var u = []; if (["video", "audio"].forEach((function (t) { var i = (V(e.sourceUpdater_.codecs[t] || "")[0] || {}).type, r = (V(n[t] || "")[0] || {}).type; i && r && i.toLowerCase() !== r.toLowerCase() && u.push('"' + e.sourceUpdater_.codecs[t] + '" -> "' + n[t] + '"') })), u.length) return void this.blacklistCurrentPlaylist({ playlist: this.media(), message: "Codec switching not supported: " + u.join(", ") + ".", blacklistDuration: 1 / 0, internal: !0 }) } return n } var l = Object.keys(s).reduce((function (e, t) { return e && (e += ", "), e += t + ' does not support codec(s): "' + s[t].join(",") + '"' }), "") + "."; this.blacklistCurrentPlaylist({ playlist: this.media(), internal: !0, message: l, blacklistDuration: 1 / 0 }) } else this.blacklistCurrentPlaylist({ playlist: this.media(), message: "Could not determine codecs for playlist.", blacklistDuration: 1 / 0 }) }, i.tryToCreateSourceBuffers_ = function () { if ("open" === this.mediaSource.readyState && !this.sourceUpdater_.hasCreatedSourceBuffers() && this.areMediaTypesKnown_()) { var e = this.getCodecsOrExclude_(); if (e) { this.sourceUpdater_.createSourceBuffers(e); var t = [e.video, e.audio].filter(Boolean).join(","); this.excludeIncompatibleVariants_(t) } } }, i.excludeUnsupportedVariants_ = function () { var e = this, t = this.master().playlists, i = []; Object.keys(t).forEach((function (n) { var r = t[n]; if (-1 === i.indexOf(r.id)) { i.push(r.id); var a = ju(e.master, r), s = []; !a.audio || z(a.audio) || G(a.audio) || s.push("audio codec " + a.audio), !a.video || z(a.video) || G(a.video) || s.push("video codec " + a.video), a.text && "stpp.ttml.im1t" === a.text && s.push("text codec " + a.text), s.length && (r.excludeUntil = 1 / 0, e.logger_("excluding " + r.id + " for unsupported: " + s.join(", "))) } })) }, i.excludeIncompatibleVariants_ = function (e) { var t = this, i = [], n = this.master().playlists, r = Nu(V(e)), a = Uu(r), s = r.video && V(r.video)[0] || null, o = r.audio && V(r.audio)[0] || null; Object.keys(n).forEach((function (e) { var r = n[e]; if (-1 === i.indexOf(r.id) && r.excludeUntil !== 1 / 0) { i.push(r.id); var u = [], l = ju(t.masterPlaylistLoader_.master, r), c = Uu(l); if (l.audio || l.video) { if (c !== a && u.push('codec count "' + c + '" !== "' + a + '"'), !t.sourceUpdater_.canChangeType()) { var d = l.video && V(l.video)[0] || null, h = l.audio && V(l.audio)[0] || null; d && s && d.type.toLowerCase() !== s.type.toLowerCase() && u.push('video codec "' + d.type + '" !== "' + s.type + '"'), h && o && h.type.toLowerCase() !== o.type.toLowerCase() && u.push('audio codec "' + h.type + '" !== "' + o.type + '"') } u.length && (r.excludeUntil = 1 / 0, t.logger_("blacklisting " + r.id + ": " + u.join(" && "))) } } })) }, i.updateAdCues_ = function (e) { var t = 0, i = this.seekable(); i.length && (t = i.start(0)), function (e, t, i) { if (void 0 === i && (i = 0), e.segments) for (var n, a = i, s = 0; s < e.segments.length; s++) { var o = e.segments[s]; if (n || (n = kl(t, a + o.duration / 2)), n) { if ("cueIn" in o) { n.endTime = a, n.adEndTime = a, a += o.duration, n = null; continue } if (a < n.endTime) { a += o.duration; continue } n.endTime += o.duration } else if ("cueOut" in o && ((n = new (r().VTTCue)(a, a + o.duration, o.cueOut)).adStartTime = a, n.adEndTime = a + parseFloat(o.cueOut), t.addCue(n)), "cueOutCont" in o) { var u = o.cueOutCont.split("/").map(parseFloat), l = u[0], c = u[1]; (n = new (r().VTTCue)(a, a + o.duration, "")).adStartTime = a - l, n.adEndTime = n.adStartTime + c, t.addCue(n) } a += o.duration } }(e, this.cueTagsTrack_, t) }, i.goalBufferLength = function () { var e = this.tech_.currentTime(), t = ou.GOAL_BUFFER_LENGTH, i = ou.GOAL_BUFFER_LENGTH_RATE, n = Math.max(t, ou.MAX_GOAL_BUFFER_LENGTH); return Math.min(t + e * i, n) }, i.bufferLowWaterLine = function () { var e = this.tech_.currentTime(), t = ou.BUFFER_LOW_WATER_LINE, i = ou.BUFFER_LOW_WATER_LINE_RATE, n = Math.max(t, ou.MAX_BUFFER_LOW_WATER_LINE), r = Math.max(t, ou.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE); return Math.min(t + e * i, this.experimentalBufferBasedABR ? r : n) }, i.bufferHighWaterLine = function () { return ou.BUFFER_HIGH_WATER_LINE }, t }(qs.EventTarget), zl = function (e, t, i) { var n, r, a, s = e.masterPlaylistController_, o = s[(e.options_.smoothQualityChange ? "smooth" : "fast") + "QualityChange_"].bind(s); if (t.attributes) { var u = t.attributes.RESOLUTION; this.width = u && u.width, this.height = u && u.height, this.bandwidth = t.attributes.BANDWIDTH } this.codecs = ju(s.master(), t), this.playlist = t, this.id = i, this.enabled = (n = e.playlists, r = t.id, a = o, function (e) { var t = n.master.playlists[r], i = go(t), s = Ao(t); return void 0 === e ? s : (e ? delete t.disabled : t.disabled = !0, e === s || i || (a(), e ? n.trigger("renditionenabled") : n.trigger("renditiondisabled")), e) }) }, Ql = ["seeking", "seeked", "pause", "playing", "error"], Xl = function () { function e(e) { var t = this; this.masterPlaylistController_ = e.masterPlaylistController, this.tech_ = e.tech, this.seekable = e.seekable, this.allowSeeksWithinUnsafeLiveWindow = e.allowSeeksWithinUnsafeLiveWindow, this.liveRangeSafeTimeDelta = e.liveRangeSafeTimeDelta, this.media = e.media, this.consecutiveUpdates = 0, this.lastRecordedTime = null, this.timer_ = null, this.checkCurrentTimeTimeout_ = null, this.logger_ = Xs("PlaybackWatcher"), this.logger_("initialize"); var i = function () { return t.monitorCurrentTime_() }, n = function () { return t.monitorCurrentTime_() }, a = function () { return t.techWaiting_() }, s = function () { return t.cancelTimer_() }, o = this.masterPlaylistController_, u = ["main", "subtitle", "audio"], l = {}; u.forEach((function (e) { l[e] = { reset: function () { return t.resetSegmentDownloads_(e) }, updateend: function () { return t.checkSegmentDownloads_(e) } }, o[e + "SegmentLoader_"].on("appendsdone", l[e].updateend), o[e + "SegmentLoader_"].on("playlistupdate", l[e].reset), t.tech_.on(["seeked", "seeking"], l[e].reset) })); var c = function (e) { ["main", "audio"].forEach((function (i) { o[i + "SegmentLoader_"][e]("appended", t.seekingAppendCheck_) })) }; this.seekingAppendCheck_ = function () { t.fixesBadSeeks_() && (t.consecutiveUpdates = 0, t.lastRecordedTime = t.tech_.currentTime(), c("off")) }, this.clearSeekingAppendCheck_ = function () { return c("off") }, this.watchForBadSeeking_ = function () { t.clearSeekingAppendCheck_(), c("on") }, this.tech_.on("seeked", this.clearSeekingAppendCheck_), this.tech_.on("seeking", this.watchForBadSeeking_), this.tech_.on("waiting", a), this.tech_.on(Ql, s), this.tech_.on("canplay", n), this.tech_.one("play", i), this.dispose = function () { t.clearSeekingAppendCheck_(), t.logger_("dispose"), t.tech_.off("waiting", a), t.tech_.off(Ql, s), t.tech_.off("canplay", n), t.tech_.off("play", i), t.tech_.off("seeking", t.watchForBadSeeking_), t.tech_.off("seeked", t.clearSeekingAppendCheck_), u.forEach((function (e) { o[e + "SegmentLoader_"].off("appendsdone", l[e].updateend), o[e + "SegmentLoader_"].off("playlistupdate", l[e].reset), t.tech_.off(["seeked", "seeking"], l[e].reset) })), t.checkCurrentTimeTimeout_ && r().clearTimeout(t.checkCurrentTimeTimeout_), t.cancelTimer_() } } var t = e.prototype; return t.monitorCurrentTime_ = function () { this.checkCurrentTime_(), this.checkCurrentTimeTimeout_ && r().clearTimeout(this.checkCurrentTimeTimeout_), this.checkCurrentTimeTimeout_ = r().setTimeout(this.monitorCurrentTime_.bind(this), 250) }, t.resetSegmentDownloads_ = function (e) { var t = this.masterPlaylistController_[e + "SegmentLoader_"]; this[e + "StalledDownloads_"] > 0 && this.logger_("resetting possible stalled download count for " + e + " loader"), this[e + "StalledDownloads_"] = 0, this[e + "Buffered_"] = t.buffered_() }, t.checkSegmentDownloads_ = function (e) { var t = this.masterPlaylistController_, i = t[e + "SegmentLoader_"], n = i.buffered_(), r = function (e, t) { if (e === t) return !1; if (!e && t || !t && e) return !0; if (e.length !== t.length) return !0; for (var i = 0; i < e.length; i++)if (e.start(i) !== t.start(i) || e.end(i) !== t.end(i)) return !0; return !1 }(this[e + "Buffered_"], n); this[e + "Buffered_"] = n, r ? this.resetSegmentDownloads_(e) : (this[e + "StalledDownloads_"]++, this.logger_("found #" + this[e + "StalledDownloads_"] + " " + e + " appends that did not increase buffer (possible stalled download)", { playlistId: i.playlist_ && i.playlist_.id, buffered: to(n) }), this[e + "StalledDownloads_"] < 10 || (this.logger_(e + " loader stalled download exclusion"), this.resetSegmentDownloads_(e), this.tech_.trigger({ type: "usage", name: "vhs-" + e + "-download-exclusion" }), "subtitle" !== e && t.blacklistCurrentPlaylist({ message: "Excessive " + e + " segment downloading detected." }, 1 / 0))) }, t.checkCurrentTime_ = function () { if (!this.tech_.paused() && !this.tech_.seeking()) { var e = this.tech_.currentTime(), t = this.tech_.buffered(); if (this.lastRecordedTime === e && (!t.length || e + Ks >= t.end(t.length - 1))) return this.techWaiting_(); this.consecutiveUpdates >= 5 && e === this.lastRecordedTime ? (this.consecutiveUpdates++, this.waiting_()) : e === this.lastRecordedTime ? this.consecutiveUpdates++ : (this.consecutiveUpdates = 0, this.lastRecordedTime = e) } }, t.cancelTimer_ = function () { this.consecutiveUpdates = 0, this.timer_ && (this.logger_("cancelTimer_"), clearTimeout(this.timer_)), this.timer_ = null }, t.fixesBadSeeks_ = function () { if (!this.tech_.seeking()) return !1; var e, t = this.seekable(), i = this.tech_.currentTime(); this.afterSeekableWindow_(t, i, this.media(), this.allowSeeksWithinUnsafeLiveWindow) && (e = t.end(t.length - 1)); if (this.beforeSeekableWindow_(t, i)) { var n = t.start(0); e = n + (n === t.end(0) ? 0 : Ks) } if (void 0 !== e) return this.logger_("Trying to seek outside of seekable at time " + i + " with seekable range " + eo(t) + ". Seeking to " + e + "."), this.tech_.setCurrentTime(e), !0; for (var r = this.masterPlaylistController_.sourceUpdater_, a = this.tech_.buffered(), s = r.audioBuffer ? r.audioBuffered() : null, o = r.videoBuffer ? r.videoBuffered() : null, u = this.media(), l = u.partTargetDuration ? u.partTargetDuration : 2 * (u.targetDuration - $s), c = [s, o], d = 0; d < c.length; d++) { if (c[d]) if (no(c[d], i) < l) return !1 } var h = Js(a, i); return 0 !== h.length && (e = h.start(0) + Ks, this.logger_("Buffered region starts (" + h.start(0) + ")  just beyond seek point (" + i + "). Seeking to " + e + "."), this.tech_.setCurrentTime(e), !0) }, t.waiting_ = function () { if (!this.techWaiting_()) { var e = this.tech_.currentTime(), t = this.tech_.buffered(), i = Zs(t, e); return i.length && e + 3 <= i.end(0) ? (this.cancelTimer_(), this.tech_.setCurrentTime(e), this.logger_("Stopped at " + e + " while inside a buffered region [" + i.start(0) + " -> " + i.end(0) + "]. Attempting to resume playback by seeking to the current time."), this.tech_.trigger({ type: "usage", name: "vhs-unknown-waiting" }), void this.tech_.trigger({ type: "usage", name: "hls-unknown-waiting" })) : void 0 } }, t.techWaiting_ = function () { var e = this.seekable(), t = this.tech_.currentTime(); if (this.tech_.seeking() || null !== this.timer_) return !0; if (this.beforeSeekableWindow_(e, t)) { var i = e.end(e.length - 1); return this.logger_("Fell out of live window at time " + t + ". Seeking to live point (seekable end) " + i), this.cancelTimer_(), this.tech_.setCurrentTime(i), this.tech_.trigger({ type: "usage", name: "vhs-live-resync" }), this.tech_.trigger({ type: "usage", name: "hls-live-resync" }), !0 } var n = this.tech_.vhs.masterPlaylistController_.sourceUpdater_, r = this.tech_.buffered(); if (this.videoUnderflow_({ audioBuffered: n.audioBuffered(), videoBuffered: n.videoBuffered(), currentTime: t })) return this.cancelTimer_(), this.tech_.setCurrentTime(t), this.tech_.trigger({ type: "usage", name: "vhs-video-underflow" }), this.tech_.trigger({ type: "usage", name: "hls-video-underflow" }), !0; var a = Js(r, t); if (a.length > 0) { var s = a.start(0) - t; return this.logger_("Stopped at " + t + ", setting timer for " + s + ", seeking to " + a.start(0)), this.cancelTimer_(), this.timer_ = setTimeout(this.skipTheGap_.bind(this), 1e3 * s, t), !0 } return !1 }, t.afterSeekableWindow_ = function (e, t, i, n) { if (void 0 === n && (n = !1), !e.length) return !1; var r = e.end(e.length - 1) + Ks; return !i.endList && n && (r = e.end(e.length - 1) + 3 * i.targetDuration), t > r }, t.beforeSeekableWindow_ = function (e, t) { return !!(e.length && e.start(0) > 0 && t < e.start(0) - this.liveRangeSafeTimeDelta) }, t.videoUnderflow_ = function (e) { var t = e.videoBuffered, i = e.audioBuffered, n = e.currentTime; if (t) { var r; if (t.length && i.length) { var a = Zs(t, n - 3), s = Zs(t, n), o = Zs(i, n); o.length && !s.length && a.length && (r = { start: a.end(0), end: o.end(0) }) } else { Js(t, n).length || (r = this.gapFromVideoUnderflow_(t, n)) } return !!r && (this.logger_("Encountered a gap in video from " + r.start + " to " + r.end + ". Seeking to current time " + n), !0) } }, t.skipTheGap_ = function (e) { var t = this.tech_.buffered(), i = this.tech_.currentTime(), n = Js(t, i); this.cancelTimer_(), 0 !== n.length && i === e && (this.logger_("skipTheGap_:", "currentTime:", i, "scheduled currentTime:", e, "nextRange start:", n.start(0)), this.tech_.setCurrentTime(n.start(0) + $s), this.tech_.trigger({ type: "usage", name: "vhs-gap-skip" }), this.tech_.trigger({ type: "usage", name: "hls-gap-skip" })) }, t.gapFromVideoUnderflow_ = function (e, t) { for (var i = function (e) { if (e.length < 2) return qs.createTimeRanges(); for (var t = [], i = 1; i < e.length; i++) { var n = e.end(i - 1), r = e.start(i); t.push([n, r]) } return qs.createTimeRanges(t) }(e), n = 0; n < i.length; n++) { var r = i.start(n), a = i.end(n); if (t - r < 4 && t - r > 2) return { start: r, end: a } } return null }, e }(), $l = { errorInterval: 30, getSource: function (e) { return e(this.tech({ IWillNotUseThisInPlugins: !0 }).currentSource_ || this.currentSource()) } }, Kl = function e(t, i) { var n = 0, r = 0, a = qs.mergeOptions($l, i); t.ready((function () { t.trigger({ type: "usage", name: "vhs-error-reload-initialized" }), t.trigger({ type: "usage", name: "hls-error-reload-initialized" }) })); var s = function () { r && t.currentTime(r) }, o = function (e) { null != e && (r = t.duration() !== 1 / 0 && t.currentTime() || 0, t.one("loadedmetadata", s), t.src(e), t.trigger({ type: "usage", name: "vhs-error-reload" }), t.trigger({ type: "usage", name: "hls-error-reload" }), t.play()) }, u = function () { return Date.now() - n < 1e3 * a.errorInterval ? (t.trigger({ type: "usage", name: "vhs-error-reload-canceled" }), void t.trigger({ type: "usage", name: "hls-error-reload-canceled" })) : a.getSource && "function" == typeof a.getSource ? (n = Date.now(), a.getSource.call(t, o)) : void qs.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!") }, l = function e() { t.off("loadedmetadata", s), t.off("error", u), t.off("dispose", e) }; t.on("error", u), t.on("dispose", l), t.reloadSourceOnError = function (i) { l(), e(t, i) } }, Yl = "2.13.1", Zl = { PlaylistLoader: Mo, Playlist: xo, utils: Ko, STANDARD_PLAYLIST_SELECTOR: Qu, INITIAL_PLAYLIST_SELECTOR: function () { var e = this, t = this.playlists.master.playlists.filter(xo.isEnabled); return Wu(t, (function (e, t) { return Gu(e, t) })), t.filter((function (t) { return !!ju(e.playlists.master, t).video }))[0] || null }, lastBandwidthSelector: Qu, movingAverageBandwidthSelector: function (e) { var t = -1, i = -1; if (e < 0 || e > 1) throw new Error("Moving average bandwidth decay must be between 0 and 1."); return function () { var n = this.useDevicePixelRatio && r().devicePixelRatio || 1; return t < 0 && (t = this.systemBandwidth, i = this.systemBandwidth), this.systemBandwidth > 0 && this.systemBandwidth !== i && (t = e * this.systemBandwidth + (1 - e) * t, i = this.systemBandwidth), zu(this.playlists.master, t, parseInt(qu(this.tech_.el(), "width"), 10) * n, parseInt(qu(this.tech_.el(), "height"), 10) * n, this.limitRenditionByPlayerDimensions, this.masterPlaylistController_) } }, comparePlaylistBandwidth: Gu, comparePlaylistResolution: function (e, t) { var i, n; return e.attributes.RESOLUTION && e.attributes.RESOLUTION.width && (i = e.attributes.RESOLUTION.width), i = i || r().Number.MAX_VALUE, t.attributes.RESOLUTION && t.attributes.RESOLUTION.width && (n = t.attributes.RESOLUTION.width), i === (n = n || r().Number.MAX_VALUE) && e.attributes.BANDWIDTH && t.attributes.BANDWIDTH ? e.attributes.BANDWIDTH - t.attributes.BANDWIDTH : i - n }, xhr: Ho() }; Object.keys(ou).forEach((function (e) { Object.defineProperty(Zl, e, { get: function () { return qs.log.warn("using Vhs." + e + " is UNSAFE be sure you know what you are doing"), ou[e] }, set: function (t) { qs.log.warn("using Vhs." + e + " is UNSAFE be sure you know what you are doing"), "number" != typeof t || t < 0 ? qs.log.warn("value of Vhs." + e + " must be greater than or equal to 0") : ou[e] = t } }) })); var Jl = "videojs-vhs", ec = function (e, t) { for (var i = t.media(), n = -1, r = 0; r < e.length; r++)if (e[r].id === i.id) { n = r; break } e.selectedIndex_ = n, e.trigger({ selectedIndex: n, type: "change" }) }; Zl.canPlaySource = function () { return qs.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.") }; var tc = function (e) { var t = e.player, i = e.sourceKeySystems, n = e.audioMedia, r = e.mainPlaylists; if (!t.eme.initializeMediaKeys) return Promise.resolve(); var a = function (e, t) { return e.reduce((function (e, i) { if (!i.contentProtection) return e; var n = t.reduce((function (e, t) { var n = i.contentProtection[t]; return n && n.pssh && (e[t] = { pssh: n.pssh }), e }), {}); return Object.keys(n).length && e.push(n), e }), []) }(n ? r.concat([n]) : r, Object.keys(i)), s = [], o = []; return a.forEach((function (e) { o.push(new Promise((function (e, i) { t.tech_.one("keysessioncreated", e) }))), s.push(new Promise((function (i, n) { t.eme.initializeMediaKeys({ keySystems: e }, (function (e) { e ? n(e) : i() })) }))) })), Promise.race([Promise.all(s), Promise.race(o)]) }, ic = function (e) { var t = e.player, i = function (e, t, i) { if (!e) return e; var n = {}; t && t.attributes && t.attributes.CODECS && (n = Nu(V(t.attributes.CODECS))), i && i.attributes && i.attributes.CODECS && (n.audio = i.attributes.CODECS); var r = W(n.video), a = W(n.audio), s = {}; for (var o in e) s[o] = {}, a && (s[o].audioContentType = a), r && (s[o].videoContentType = r), t.contentProtection && t.contentProtection[o] && t.contentProtection[o].pssh && (s[o].pssh = t.contentProtection[o].pssh), "string" == typeof e[o] && (s[o].url = e[o]); return qs.mergeOptions(e, s) }(e.sourceKeySystems, e.media, e.audioMedia); return !!i && (t.currentSource().keySystems = i, !(i && !t.eme) || (qs.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"), !1)) }, nc = function () { if (!r().localStorage) return null; var e = r().localStorage.getItem(Jl); if (!e) return null; try { return JSON.parse(e) } catch (e) { return null } }; Zl.supportsNativeHls = function () { if (!s() || !s().createElement) return !1; var e = s().createElement("video"); if (!qs.getTech("Html5").isSupported()) return !1; return ["application/vnd.apple.mpegurl", "audio/mpegurl", "audio/x-mpegurl", "application/x-mpegurl", "video/x-mpegurl", "video/mpegurl", "application/mpegurl"].some((function (t) { return /maybe|probably/i.test(e.canPlayType(t)) })) }(), Zl.supportsNativeDash = !!(s() && s().createElement && qs.getTech("Html5").isSupported()) && /maybe|probably/i.test(s().createElement("video").canPlayType("application/dash+xml")), Zl.supportsTypeNatively = function (e) { return "hls" === e ? Zl.supportsNativeHls : "dash" === e && Zl.supportsNativeDash }, Zl.isSupported = function () { return qs.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.") }; var rc = function (e) { function t(t, i, n) { var r; if (r = e.call(this, i, qs.mergeOptions(n.hls, n.vhs)) || this, n.hls && Object.keys(n.hls).length && qs.log.warn("Using hls options is deprecated. Use vhs instead."), "number" == typeof n.initialBandwidth && (r.options_.bandwidth = n.initialBandwidth), r.logger_ = Xs("VhsHandler"), i.options_ && i.options_.playerId) { var a = qs(i.options_.playerId); a.hasOwnProperty("hls") || Object.defineProperty(a, "hls", { get: function () { return qs.log.warn("player.hls is deprecated. Use player.tech().vhs instead."), i.trigger({ type: "usage", name: "hls-player-access" }), c(r) }, configurable: !0 }), a.hasOwnProperty("vhs") || Object.defineProperty(a, "vhs", { get: function () { return qs.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."), i.trigger({ type: "usage", name: "vhs-player-access" }), c(r) }, configurable: !0 }), a.hasOwnProperty("dash") || Object.defineProperty(a, "dash", { get: function () { return qs.log.warn("player.dash is deprecated. Use player.tech().vhs instead."), c(r) }, configurable: !0 }), r.player_ = a } if (r.tech_ = i, r.source_ = t, r.stats = {}, r.ignoreNextSeekingEvent_ = !1, r.setOptions_(), r.options_.overrideNative && i.overrideNativeAudioTracks && i.overrideNativeVideoTracks) i.overrideNativeAudioTracks(!0), i.overrideNativeVideoTracks(!0); else if (r.options_.overrideNative && (i.featuresNativeVideoTracks || i.featuresNativeAudioTracks)) throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB"); return r.on(s(), ["fullscreenchange", "webkitfullscreenchange", "mozfullscreenchange", "MSFullscreenChange"], (function (e) { var t = s().fullscreenElement || s().webkitFullscreenElement || s().mozFullScreenElement || s().msFullscreenElement; t && t.contains(r.tech_.el()) ? r.masterPlaylistController_.fastQualityChange_() : r.masterPlaylistController_.checkABR_() })), r.on(r.tech_, "seeking", (function () { this.ignoreNextSeekingEvent_ ? this.ignoreNextSeekingEvent_ = !1 : this.setCurrentTime(this.tech_.currentTime()) })), r.on(r.tech_, "error", (function () { this.tech_.error() && this.masterPlaylistController_ && this.masterPlaylistController_.pauseLoading() })), r.on(r.tech_, "play", r.play), r } h(t, e); var i = t.prototype; return i.setOptions_ = function () { var e = this; if (this.options_.withCredentials = this.options_.withCredentials || !1, this.options_.handleManifestRedirects = !1 !== this.options_.handleManifestRedirects, this.options_.limitRenditionByPlayerDimensions = !1 !== this.options_.limitRenditionByPlayerDimensions, this.options_.useDevicePixelRatio = this.options_.useDevicePixelRatio || !1, this.options_.smoothQualityChange = this.options_.smoothQualityChange || !1, this.options_.useBandwidthFromLocalStorage = void 0 !== this.source_.useBandwidthFromLocalStorage ? this.source_.useBandwidthFromLocalStorage : this.options_.useBandwidthFromLocalStorage || !1, this.options_.useNetworkInformationApi = this.options_.useNetworkInformationApi || !1, this.options_.customTagParsers = this.options_.customTagParsers || [], this.options_.customTagMappers = this.options_.customTagMappers || [], this.options_.cacheEncryptionKeys = this.options_.cacheEncryptionKeys || !1, "number" != typeof this.options_.blacklistDuration && (this.options_.blacklistDuration = 300), "number" != typeof this.options_.bandwidth && this.options_.useBandwidthFromLocalStorage) { var t = nc(); t && t.bandwidth && (this.options_.bandwidth = t.bandwidth, this.tech_.trigger({ type: "usage", name: "vhs-bandwidth-from-local-storage" }), this.tech_.trigger({ type: "usage", name: "hls-bandwidth-from-local-storage" })), t && t.throughput && (this.options_.throughput = t.throughput, this.tech_.trigger({ type: "usage", name: "vhs-throughput-from-local-storage" }), this.tech_.trigger({ type: "usage", name: "hls-throughput-from-local-storage" })) } "number" != typeof this.options_.bandwidth && (this.options_.bandwidth = ou.INITIAL_BANDWIDTH), this.options_.enableLowInitialPlaylist = this.options_.enableLowInitialPlaylist && this.options_.bandwidth === ou.INITIAL_BANDWIDTH, ["withCredentials", "useDevicePixelRatio", "limitRenditionByPlayerDimensions", "bandwidth", "smoothQualityChange", "customTagParsers", "customTagMappers", "handleManifestRedirects", "cacheEncryptionKeys", "playlistSelector", "initialPlaylistSelector", "experimentalBufferBasedABR", "liveRangeSafeTimeDelta", "experimentalLLHLS", "useNetworkInformationApi", "experimentalExactManifestTimings", "experimentalLeastPixelDiffSelector"].forEach((function (t) { void 0 !== e.source_[t] && (e.options_[t] = e.source_[t]) })), this.limitRenditionByPlayerDimensions = this.options_.limitRenditionByPlayerDimensions, this.useDevicePixelRatio = this.options_.useDevicePixelRatio }, i.src = function (e, t) { var i = this; if (e) { var n; this.setOptions_(), this.options_.src = 0 === (n = this.source_.src).toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,") ? JSON.parse(n.substring(n.indexOf(",") + 1)) : n, this.options_.tech = this.tech_, this.options_.externVhs = Zl, this.options_.sourceType = K(t), this.options_.seekTo = function (e) { i.tech_.setCurrentTime(e) }, this.options_.smoothQualityChange && qs.log.warn("smoothQualityChange is deprecated and will be removed in the next major version"), this.masterPlaylistController_ = new Gl(this.options_); var a = qs.mergeOptions({ liveRangeSafeTimeDelta: Ks }, this.options_, { seekable: function () { return i.seekable() }, media: function () { return i.masterPlaylistController_.media() }, masterPlaylistController: this.masterPlaylistController_ }); this.playbackWatcher_ = new Xl(a), this.masterPlaylistController_.on("error", (function () { var e = qs.players[i.tech_.options_.playerId], t = i.masterPlaylistController_.error; "object" != typeof t || t.code ? "string" == typeof t && (t = { message: t, code: 3 }) : t.code = 3, e.error(t) })); var s = this.options_.experimentalBufferBasedABR ? Zl.movingAverageBandwidthSelector(.55) : Zl.STANDARD_PLAYLIST_SELECTOR; this.masterPlaylistController_.selectPlaylist = this.selectPlaylist ? this.selectPlaylist.bind(this) : s.bind(this), this.masterPlaylistController_.selectInitialPlaylist = Zl.INITIAL_PLAYLIST_SELECTOR.bind(this), this.playlists = this.masterPlaylistController_.masterPlaylistLoader_, this.mediaSource = this.masterPlaylistController_.mediaSource, Object.defineProperties(this, { selectPlaylist: { get: function () { return this.masterPlaylistController_.selectPlaylist }, set: function (e) { this.masterPlaylistController_.selectPlaylist = e.bind(this) } }, throughput: { get: function () { return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate }, set: function (e) { this.masterPlaylistController_.mainSegmentLoader_.throughput.rate = e, this.masterPlaylistController_.mainSegmentLoader_.throughput.count = 1 } }, bandwidth: { get: function () { var e = this.masterPlaylistController_.mainSegmentLoader_.bandwidth, t = r().navigator.connection || r().navigator.mozConnection || r().navigator.webkitConnection, i = 1e7; if (this.options_.useNetworkInformationApi && t) { var n = 1e3 * t.downlink * 1e3; e = n >= i && e >= i ? Math.max(e, n) : n } return e }, set: function (e) { this.masterPlaylistController_.mainSegmentLoader_.bandwidth = e, this.masterPlaylistController_.mainSegmentLoader_.throughput = { rate: 0, count: 0 } } }, systemBandwidth: { get: function () { var e, t = 1 / (this.bandwidth || 1); return e = this.throughput > 0 ? 1 / this.throughput : 0, Math.floor(1 / (t + e)) }, set: function () { qs.log.error('The "systemBandwidth" property is read-only') } } }), this.options_.bandwidth && (this.bandwidth = this.options_.bandwidth), this.options_.throughput && (this.throughput = this.options_.throughput), Object.defineProperties(this.stats, { bandwidth: { get: function () { return i.bandwidth || 0 }, enumerable: !0 }, mediaRequests: { get: function () { return i.masterPlaylistController_.mediaRequests_() || 0 }, enumerable: !0 }, mediaRequestsAborted: { get: function () { return i.masterPlaylistController_.mediaRequestsAborted_() || 0 }, enumerable: !0 }, mediaRequestsTimedout: { get: function () { return i.masterPlaylistController_.mediaRequestsTimedout_() || 0 }, enumerable: !0 }, mediaRequestsErrored: { get: function () { return i.masterPlaylistController_.mediaRequestsErrored_() || 0 }, enumerable: !0 }, mediaTransferDuration: { get: function () { return i.masterPlaylistController_.mediaTransferDuration_() || 0 }, enumerable: !0 }, mediaBytesTransferred: { get: function () { return i.masterPlaylistController_.mediaBytesTransferred_() || 0 }, enumerable: !0 }, mediaSecondsLoaded: { get: function () { return i.masterPlaylistController_.mediaSecondsLoaded_() || 0 }, enumerable: !0 }, mediaAppends: { get: function () { return i.masterPlaylistController_.mediaAppends_() || 0 }, enumerable: !0 }, mainAppendsToLoadedData: { get: function () { return i.masterPlaylistController_.mainAppendsToLoadedData_() || 0 }, enumerable: !0 }, audioAppendsToLoadedData: { get: function () { return i.masterPlaylistController_.audioAppendsToLoadedData_() || 0 }, enumerable: !0 }, appendsToLoadedData: { get: function () { return i.masterPlaylistController_.appendsToLoadedData_() || 0 }, enumerable: !0 }, timeToLoadedData: { get: function () { return i.masterPlaylistController_.timeToLoadedData_() || 0 }, enumerable: !0 }, buffered: { get: function () { return to(i.tech_.buffered()) }, enumerable: !0 }, currentTime: { get: function () { return i.tech_.currentTime() }, enumerable: !0 }, currentSource: { get: function () { return i.tech_.currentSource_ }, enumerable: !0 }, currentTech: { get: function () { return i.tech_.name_ }, enumerable: !0 }, duration: { get: function () { return i.tech_.duration() }, enumerable: !0 }, master: { get: function () { return i.playlists.master }, enumerable: !0 }, playerDimensions: { get: function () { return i.tech_.currentDimensions() }, enumerable: !0 }, seekable: { get: function () { return to(i.tech_.seekable()) }, enumerable: !0 }, timestamp: { get: function () { return Date.now() }, enumerable: !0 }, videoPlaybackQuality: { get: function () { return i.tech_.getVideoPlaybackQuality() }, enumerable: !0 } }), this.tech_.one("canplay", this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)), this.tech_.on("bandwidthupdate", (function () { i.options_.useBandwidthFromLocalStorage && function (e) { if (!r().localStorage) return !1; var t = nc(); t = t ? qs.mergeOptions(t, e) : e; try { r().localStorage.setItem(Jl, JSON.stringify(t)) } catch (e) { return !1 } }({ bandwidth: i.bandwidth, throughput: Math.round(i.throughput) }) })), this.masterPlaylistController_.on("selectedinitialmedia", (function () { var e; (e = i).representations = function () { var t = e.masterPlaylistController_.master(), i = To(t) ? e.masterPlaylistController_.getAudioTrackPlaylists_() : t.playlists; return i ? i.filter((function (e) { return !go(e) })).map((function (t, i) { return new zl(e, t, t.id) })) : [] } })), this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers", (function () { i.setupEme_() })), this.on(this.masterPlaylistController_, "progress", (function () { this.tech_.trigger("progress") })), this.on(this.masterPlaylistController_, "firstplay", (function () { this.ignoreNextSeekingEvent_ = !0 })), this.setupQualityLevels_(), this.tech_.el() && (this.mediaSourceUrl_ = r().URL.createObjectURL(this.masterPlaylistController_.mediaSource), this.tech_.src(this.mediaSourceUrl_)) } }, i.createKeySessions_ = function () { var e = this, t = this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader; this.logger_("waiting for EME key session creation"), tc({ player: this.player_, sourceKeySystems: this.source_.keySystems, audioMedia: t && t.media(), mainPlaylists: this.playlists.master.playlists }).then((function () { e.logger_("created EME key session"), e.masterPlaylistController_.sourceUpdater_.initializedEme() })).catch((function (t) { e.logger_("error while creating EME key session", t), e.player_.error({ message: "Failed to initialize media keys for EME", code: 3 }) })) }, i.handleWaitingForKey_ = function () { this.logger_("waitingforkey fired, attempting to create any new key sessions"), this.createKeySessions_() }, i.setupEme_ = function () { var e = this, t = this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader, i = ic({ player: this.player_, sourceKeySystems: this.source_.keySystems, media: this.playlists.media(), audioMedia: t && t.media() }); this.player_.tech_.on("keystatuschange", (function (t) { "output-restricted" === t.status && e.masterPlaylistController_.blacklistCurrentPlaylist({ playlist: e.masterPlaylistController_.media(), message: "DRM keystatus changed to " + t.status + ". Playlist will fail to play. Check for HDCP content.", blacklistDuration: 1 / 0 }) })), this.handleWaitingForKey_ = this.handleWaitingForKey_.bind(this), this.player_.tech_.on("waitingforkey", this.handleWaitingForKey_), 11 !== qs.browser.IE_VERSION && i ? this.createKeySessions_() : this.masterPlaylistController_.sourceUpdater_.initializedEme() }, i.setupQualityLevels_ = function () { var e = this, t = qs.players[this.tech_.options_.playerId]; t && t.qualityLevels && !this.qualityLevels_ && (this.qualityLevels_ = t.qualityLevels(), this.masterPlaylistController_.on("selectedinitialmedia", (function () { var t, i; t = e.qualityLevels_, (i = e).representations().forEach((function (e) { t.addQualityLevel(e) })), ec(t, i.playlists) })), this.playlists.on("mediachange", (function () { ec(e.qualityLevels_, e.playlists) }))) }, t.version = function () { return { "@videojs/http-streaming": Yl, "mux.js": "6.0.1", "mpd-parser": "0.21.0", "m3u8-parser": "4.7.0", "aes-decrypter": "3.1.2" } }, i.version = function () { return this.constructor.version() }, i.canChangeType = function () { return Sl.canChangeType() }, i.play = function () { this.masterPlaylistController_.play() }, i.setCurrentTime = function (e) { this.masterPlaylistController_.setCurrentTime(e) }, i.duration = function () { return this.masterPlaylistController_.duration() }, i.seekable = function () { return this.masterPlaylistController_.seekable() }, i.dispose = function () { this.playbackWatcher_ && this.playbackWatcher_.dispose(), this.masterPlaylistController_ && this.masterPlaylistController_.dispose(), this.qualityLevels_ && this.qualityLevels_.dispose(), this.player_ && (delete this.player_.vhs, delete this.player_.dash, delete this.player_.hls), this.tech_ && this.tech_.vhs && delete this.tech_.vhs, this.tech_ && delete this.tech_.hls, this.mediaSourceUrl_ && r().URL.revokeObjectURL && (r().URL.revokeObjectURL(this.mediaSourceUrl_), this.mediaSourceUrl_ = null), this.tech_ && this.tech_.off("waitingforkey", this.handleWaitingForKey_), e.prototype.dispose.call(this) }, i.convertToProgramTime = function (e, t) { return Yo({ playlist: this.masterPlaylistController_.media(), time: e, callback: t }) }, i.seekToProgramTime = function (e, t, i, n) { return void 0 === i && (i = !0), void 0 === n && (n = 2), Zo({ programTime: e, playlist: this.masterPlaylistController_.media(), retryCount: n, pauseAfterSeek: i, seekTo: this.options_.seekTo, tech: this.options_.tech, callback: t }) }, t }(qs.getComponent("Component")), ac = { name: "videojs-http-streaming", VERSION: Yl, canHandleSource: function (e, t) { void 0 === t && (t = {}); var i = qs.mergeOptions(qs.options, t); return ac.canPlayType(e.type, i) }, handleSource: function (e, t, i) { void 0 === i && (i = {}); var n = qs.mergeOptions(qs.options, i); return t.vhs = new rc(e, t, n), qs.hasOwnProperty("hls") || Object.defineProperty(t, "hls", { get: function () { return qs.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."), t.vhs }, configurable: !0 }), t.vhs.xhr = Ho(), t.vhs.src(e.src, e.type), t.vhs }, canPlayType: function (e, t) { void 0 === t && (t = {}); var i = qs.mergeOptions(qs.options, t), n = i.vhs, r = (n = void 0 === n ? {} : n).overrideNative, a = void 0 === r ? !qs.browser.IS_ANY_SAFARI : r, s = i.hls, o = (s = void 0 === s ? {} : s).overrideNative, u = void 0 !== o && o, l = K(e); return l && (!Zl.supportsTypeNatively(l) || u || a) ? "maybe" : "" } }; (G("avc1.4d400d,mp4a.40.2") && qs.getTech("Html5").registerSourceHandler(ac, 0), qs.VhsHandler = rc, Object.defineProperty(qs, "HlsHandler", { get: function () { return qs.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."), rc }, configurable: !0 }), qs.VhsSourceHandler = ac, Object.defineProperty(qs, "HlsSourceHandler", { get: function () { return qs.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."), ac }, configurable: !0 }), qs.Vhs = Zl, Object.defineProperty(qs, "Hls", { get: function () { return qs.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."), Zl }, configurable: !0 }), qs.use || (qs.registerComponent("Hls", Zl), qs.registerComponent("Vhs", Zl)), qs.options.vhs = qs.options.vhs || {}, qs.options.hls = qs.options.hls || {}, qs.getPlugin && qs.getPlugin("reloadSourceOnError")) || (qs.registerPlugin || qs.plugin)("reloadSourceOnError", (function (e) { Kl(this, e) })); const sc = qs }, 13407: (e, t, i) => { var n = i(58908), r = e.exports = { WebVTT: i(63706), VTTCue: i(22230), VTTRegion: i(13710) }; n.vttjs = r, n.WebVTT = r.WebVTT; var a = r.VTTCue, s = r.VTTRegion, o = n.VTTCue, u = n.VTTRegion; r.shim = function () { n.VTTCue = a, n.VTTRegion = s }, r.restore = function () { n.VTTCue = o, n.VTTRegion = u }, n.VTTCue || r.shim() }, 63706: (e, t, i) => { var n = i(89144), r = Object.create || function () { function e() { } return function (t) { if (1 !== arguments.length) throw new Error("Object.create shim only accepts one parameter."); return e.prototype = t, new e } }(); function a(e, t) { this.name = "ParsingError", this.code = e.code, this.message = t || e.message } function s(e) { function t(e, t, i, n) { return 3600 * (0 | e) + 60 * (0 | t) + (0 | i) + (0 | n) / 1e3 } var i = e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/); return i ? i[3] ? t(i[1], i[2], i[3].replace(":", ""), i[4]) : i[1] > 59 ? t(i[1], i[2], 0, i[4]) : t(0, i[1], i[2], i[4]) : null } function o() { this.values = r(null) } function u(e, t, i, n) { var r = n ? e.split(n) : [e]; for (var a in r) if ("string" == typeof r[a]) { var s = r[a].split(i); if (2 === s.length) t(s[0], s[1]) } } function l(e, t, i) { var n = e; function r() { var t = s(e); if (null === t) throw new a(a.Errors.BadTimeStamp, "Malformed timestamp: " + n); return e = e.replace(/^[^\sa-zA-Z-]+/, ""), t } function l() { e = e.replace(/^\s+/, "") } if (l(), t.startTime = r(), l(), "--\x3e" !== e.substr(0, 3)) throw new a(a.Errors.BadTimeStamp, "Malformed time stamp (time stamps must be separated by '--\x3e'): " + n); e = e.substr(3), l(), t.endTime = r(), l(), function (e, t) { var n = new o; u(e, (function (e, t) { switch (e) { case "region": for (var r = i.length - 1; r >= 0; r--)if (i[r].id === t) { n.set(e, i[r].region); break } break; case "vertical": n.alt(e, t, ["rl", "lr"]); break; case "line": var a = t.split(","), s = a[0]; n.integer(e, s), n.percent(e, s) && n.set("snapToLines", !1), n.alt(e, s, ["auto"]), 2 === a.length && n.alt("lineAlign", a[1], ["start", "center", "end"]); break; case "position": a = t.split(","), n.percent(e, a[0]), 2 === a.length && n.alt("positionAlign", a[1], ["start", "center", "end"]); break; case "size": n.percent(e, t); break; case "align": n.alt(e, t, ["start", "center", "end", "left", "right"]) } }), /:/, /\s/), t.region = n.get("region", null), t.vertical = n.get("vertical", ""); try { t.line = n.get("line", "auto") } catch (e) { } t.lineAlign = n.get("lineAlign", "start"), t.snapToLines = n.get("snapToLines", !0), t.size = n.get("size", 100); try { t.align = n.get("align", "center") } catch (e) { t.align = n.get("align", "middle") } try { t.position = n.get("position", "auto") } catch (e) { t.position = n.get("position", { start: 0, left: 0, center: 50, middle: 50, end: 100, right: 100 }, t.align) } t.positionAlign = n.get("positionAlign", { start: "start", left: "start", center: "center", middle: "center", end: "end", right: "end" }, t.align) }(e, t) } a.prototype = r(Error.prototype), a.prototype.constructor = a, a.Errors = { BadSignature: { code: 0, message: "Malformed WebVTT signature." }, BadTimeStamp: { code: 1, message: "Malformed time stamp." } }, o.prototype = { set: function (e, t) { this.get(e) || "" === t || (this.values[e] = t) }, get: function (e, t, i) { return i ? this.has(e) ? this.values[e] : t[i] : this.has(e) ? this.values[e] : t }, has: function (e) { return e in this.values }, alt: function (e, t, i) { for (var n = 0; n < i.length; ++n)if (t === i[n]) { this.set(e, t); break } }, integer: function (e, t) { /^-?\d+$/.test(t) && this.set(e, parseInt(t, 10)) }, percent: function (e, t) { return !!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/) && (t = parseFloat(t)) >= 0 && t <= 100) && (this.set(e, t), !0) } }; var c = n.createElement && n.createElement("textarea"), d = { c: "span", i: "i", b: "b", u: "u", ruby: "ruby", rt: "rt", v: "span", lang: "span" }, h = { white: "rgba(255,255,255,1)", lime: "rgba(0,255,0,1)", cyan: "rgba(0,255,255,1)", red: "rgba(255,0,0,1)", yellow: "rgba(255,255,0,1)", magenta: "rgba(255,0,255,1)", blue: "rgba(0,0,255,1)", black: "rgba(0,0,0,1)" }, p = { v: "title", lang: "lang" }, f = { rt: "ruby" }; function m(e, t) { function i() { if (!t) return null; var e, i = t.match(/^([^<]*)(<[^>]*>?)?/); return e = i[1] ? i[1] : i[2], t = t.substr(e.length), e } function n(e, t) { return !f[t.localName] || f[t.localName] === e.localName } function r(t, i) { var n = d[t]; if (!n) return null; var r = e.document.createElement(n), a = p[t]; return a && i && (r[a] = i.trim()), r } for (var a, o, u = e.document.createElement("div"), l = u, m = []; null !== (a = i());)if ("<" !== a[0]) l.appendChild(e.document.createTextNode((o = a, c.innerHTML = o, o = c.textContent, c.textContent = "", o))); else { if ("/" === a[1]) { m.length && m[m.length - 1] === a.substr(2).replace(">", "") && (m.pop(), l = l.parentNode); continue } var g, A = s(a.substr(1, a.length - 2)); if (A) { g = e.document.createProcessingInstruction("timestamp", A), l.appendChild(g); continue } var v = a.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/); if (!v) continue; if (!(g = r(v[1], v[3]))) continue; if (!n(l, g)) continue; if (v[2]) { var y = v[2].split("."); y.forEach((function (e) { var t = /^bg_/.test(e), i = t ? e.slice(3) : e; if (h.hasOwnProperty(i)) { var n = t ? "background-color" : "color", r = h[i]; g.style[n] = r } })), g.className = y.join(" ") } m.push(v[1]), l.appendChild(g), l = g } return u } var g = [[1470, 1470], [1472, 1472], [1475, 1475], [1478, 1478], [1488, 1514], [1520, 1524], [1544, 1544], [1547, 1547], [1549, 1549], [1563, 1563], [1566, 1610], [1645, 1647], [1649, 1749], [1765, 1766], [1774, 1775], [1786, 1805], [1807, 1808], [1810, 1839], [1869, 1957], [1969, 1969], [1984, 2026], [2036, 2037], [2042, 2042], [2048, 2069], [2074, 2074], [2084, 2084], [2088, 2088], [2096, 2110], [2112, 2136], [2142, 2142], [2208, 2208], [2210, 2220], [8207, 8207], [64285, 64285], [64287, 64296], [64298, 64310], [64312, 64316], [64318, 64318], [64320, 64321], [64323, 64324], [64326, 64449], [64467, 64829], [64848, 64911], [64914, 64967], [65008, 65020], [65136, 65140], [65142, 65276], [67584, 67589], [67592, 67592], [67594, 67637], [67639, 67640], [67644, 67644], [67647, 67669], [67671, 67679], [67840, 67867], [67872, 67897], [67903, 67903], [67968, 68023], [68030, 68031], [68096, 68096], [68112, 68115], [68117, 68119], [68121, 68147], [68160, 68167], [68176, 68184], [68192, 68223], [68352, 68405], [68416, 68437], [68440, 68466], [68472, 68479], [68608, 68680], [126464, 126467], [126469, 126495], [126497, 126498], [126500, 126500], [126503, 126503], [126505, 126514], [126516, 126519], [126521, 126521], [126523, 126523], [126530, 126530], [126535, 126535], [126537, 126537], [126539, 126539], [126541, 126543], [126545, 126546], [126548, 126548], [126551, 126551], [126553, 126553], [126555, 126555], [126557, 126557], [126559, 126559], [126561, 126562], [126564, 126564], [126567, 126570], [126572, 126578], [126580, 126583], [126585, 126588], [126590, 126590], [126592, 126601], [126603, 126619], [126625, 126627], [126629, 126633], [126635, 126651], [1114109, 1114109]]; function A(e) { for (var t = 0; t < g.length; t++) { var i = g[t]; if (e >= i[0] && e <= i[1]) return !0 } return !1 } function v(e) { var t = [], i = ""; if (!e || !e.childNodes) return "ltr"; function n(e, t) { for (var i = t.childNodes.length - 1; i >= 0; i--)e.push(t.childNodes[i]) } function r(e) { if (!e || !e.length) return null; var t = e.pop(), i = t.textContent || t.innerText; if (i) { var a = i.match(/^.*(\n|\r)/); return a ? (e.length = 0, a[0]) : i } return "ruby" === t.tagName ? r(e) : t.childNodes ? (n(e, t), r(e)) : void 0 } for (n(t, e); i = r(t);)for (var a = 0; a < i.length; a++)if (A(i.charCodeAt(a))) return "rtl"; return "ltr" } function y() { } function _(e, t, i) { y.call(this), this.cue = t, this.cueDiv = m(e, t.text); var n = { color: "rgba(255, 255, 255, 1)", backgroundColor: "rgba(0, 0, 0, 0.8)", position: "relative", left: 0, right: 0, top: 0, bottom: 0, display: "inline", writingMode: "" === t.vertical ? "horizontal-tb" : "lr" === t.vertical ? "vertical-lr" : "vertical-rl", unicodeBidi: "plaintext" }; this.applyStyles(n, this.cueDiv), this.div = e.document.createElement("div"), n = { direction: v(this.cueDiv), writingMode: "" === t.vertical ? "horizontal-tb" : "lr" === t.vertical ? "vertical-lr" : "vertical-rl", unicodeBidi: "plaintext", textAlign: "middle" === t.align ? "center" : t.align, font: i.font, whiteSpace: "pre-line", position: "absolute" }, this.applyStyles(n), this.div.appendChild(this.cueDiv); var r = 0; switch (t.positionAlign) { case "start": r = t.position; break; case "center": r = t.position - t.size / 2; break; case "end": r = t.position - t.size }"" === t.vertical ? this.applyStyles({ left: this.formatStyle(r, "%"), width: this.formatStyle(t.size, "%") }) : this.applyStyles({ top: this.formatStyle(r, "%"), height: this.formatStyle(t.size, "%") }), this.move = function (e) { this.applyStyles({ top: this.formatStyle(e.top, "px"), bottom: this.formatStyle(e.bottom, "px"), left: this.formatStyle(e.left, "px"), right: this.formatStyle(e.right, "px"), height: this.formatStyle(e.height, "px"), width: this.formatStyle(e.width, "px") }) } } function b(e) { var t, i, n, r; if (e.div) { i = e.div.offsetHeight, n = e.div.offsetWidth, r = e.div.offsetTop; var a = (a = e.div.childNodes) && (a = a[0]) && a.getClientRects && a.getClientRects(); e = e.div.getBoundingClientRect(), t = a ? Math.max(a[0] && a[0].height || 0, e.height / a.length) : 0 } this.left = e.left, this.right = e.right, this.top = e.top || r, this.height = e.height || i, this.bottom = e.bottom || r + (e.height || i), this.width = e.width || n, this.lineHeight = void 0 !== t ? t : e.lineHeight } function T(e, t, i, n) { var r = new b(t), a = t.cue, s = function (e) { if ("number" == typeof e.line && (e.snapToLines || e.line >= 0 && e.line <= 100)) return e.line; if (!e.track || !e.track.textTrackList || !e.track.textTrackList.mediaElement) return -1; for (var t = e.track, i = t.textTrackList, n = 0, r = 0; r < i.length && i[r] !== t; r++)"showing" === i[r].mode && n++; return -1 * ++n }(a), o = []; if (a.snapToLines) { var u; switch (a.vertical) { case "": o = ["+y", "-y"], u = "height"; break; case "rl": o = ["+x", "-x"], u = "width"; break; case "lr": o = ["-x", "+x"], u = "width" }var l = r.lineHeight, c = l * Math.round(s), d = i[u] + l, h = o[0]; Math.abs(c) > d && (c = c < 0 ? -1 : 1, c *= Math.ceil(d / l) * l), s < 0 && (c += "" === a.vertical ? i.height : i.width, o = o.reverse()), r.move(h, c) } else { var p = r.lineHeight / i.height * 100; switch (a.lineAlign) { case "center": s -= p / 2; break; case "end": s -= p }switch (a.vertical) { case "": t.applyStyles({ top: t.formatStyle(s, "%") }); break; case "rl": t.applyStyles({ left: t.formatStyle(s, "%") }); break; case "lr": t.applyStyles({ right: t.formatStyle(s, "%") }) }o = ["+y", "-x", "+x", "-y"], r = new b(t) } var f = function (e, t) { for (var r, a = new b(e), s = 1, o = 0; o < t.length; o++) { for (; e.overlapsOppositeAxis(i, t[o]) || e.within(i) && e.overlapsAny(n);)e.move(t[o]); if (e.within(i)) return e; var u = e.intersectPercentage(i); s > u && (r = new b(e), s = u), e = new b(a) } return r || a }(r, o); t.move(f.toCSSCompatValues(i)) } function x() { } y.prototype.applyStyles = function (e, t) { for (var i in t = t || this.div, e) e.hasOwnProperty(i) && (t.style[i] = e[i]) }, y.prototype.formatStyle = function (e, t) { return 0 === e ? 0 : e + t }, _.prototype = r(y.prototype), _.prototype.constructor = _, b.prototype.move = function (e, t) { switch (t = void 0 !== t ? t : this.lineHeight, e) { case "+x": this.left += t, this.right += t; break; case "-x": this.left -= t, this.right -= t; break; case "+y": this.top += t, this.bottom += t; break; case "-y": this.top -= t, this.bottom -= t } }, b.prototype.overlaps = function (e) { return this.left < e.right && this.right > e.left && this.top < e.bottom && this.bottom > e.top }, b.prototype.overlapsAny = function (e) { for (var t = 0; t < e.length; t++)if (this.overlaps(e[t])) return !0; return !1 }, b.prototype.within = function (e) { return this.top >= e.top && this.bottom <= e.bottom && this.left >= e.left && this.right <= e.right }, b.prototype.overlapsOppositeAxis = function (e, t) { switch (t) { case "+x": return this.left < e.left; case "-x": return this.right > e.right; case "+y": return this.top < e.top; case "-y": return this.bottom > e.bottom } }, b.prototype.intersectPercentage = function (e) { return Math.max(0, Math.min(this.right, e.right) - Math.max(this.left, e.left)) * Math.max(0, Math.min(this.bottom, e.bottom) - Math.max(this.top, e.top)) / (this.height * this.width) }, b.prototype.toCSSCompatValues = function (e) { return { top: this.top - e.top, bottom: e.bottom - this.bottom, left: this.left - e.left, right: e.right - this.right, height: this.height, width: this.width } }, b.getSimpleBoxPosition = function (e) { var t = e.div ? e.div.offsetHeight : e.tagName ? e.offsetHeight : 0, i = e.div ? e.div.offsetWidth : e.tagName ? e.offsetWidth : 0, n = e.div ? e.div.offsetTop : e.tagName ? e.offsetTop : 0; return { left: (e = e.div ? e.div.getBoundingClientRect() : e.tagName ? e.getBoundingClientRect() : e).left, right: e.right, top: e.top || n, height: e.height || t, bottom: e.bottom || n + (e.height || t), width: e.width || i } }, x.StringDecoder = function () { return { decode: function (e) { if (!e) return ""; if ("string" != typeof e) throw new Error("Error - expected string data."); return decodeURIComponent(encodeURIComponent(e)) } } }, x.convertCueToDOMTree = function (e, t) { return e && t ? m(e, t) : null }; x.processCues = function (e, t, i) { if (!e || !t || !i) return null; for (; i.firstChild;)i.removeChild(i.firstChild); var n = e.document.createElement("div"); if (n.style.position = "absolute", n.style.left = "0", n.style.right = "0", n.style.top = "0", n.style.bottom = "0", n.style.margin = "1.5%", i.appendChild(n), function (e) { for (var t = 0; t < e.length; t++)if (e[t].hasBeenReset || !e[t].displayState) return !0; return !1 }(t)) { var r = [], a = b.getSimpleBoxPosition(n), s = { font: Math.round(.05 * a.height * 100) / 100 + "px sans-serif" }; !function () { for (var i, o, u = 0; u < t.length; u++)o = t[u], i = new _(e, o, s), n.appendChild(i.div), T(0, i, a, r), o.displayState = i.div, r.push(b.getSimpleBoxPosition(i)) }() } else for (var o = 0; o < t.length; o++)n.appendChild(t[o].displayState) }, x.Parser = function (e, t, i) { i || (i = t, t = {}), t || (t = {}), this.window = e, this.vttjs = t, this.state = "INITIAL", this.buffer = "", this.decoder = i || new TextDecoder("utf8"), this.regionList = [] }, x.Parser.prototype = { reportOrThrowError: function (e) { if (!(e instanceof a)) throw e; this.onparsingerror && this.onparsingerror(e) }, parse: function (e) { var t = this; function i() { for (var e = t.buffer, i = 0; i < e.length && "\r" !== e[i] && "\n" !== e[i];)++i; var n = e.substr(0, i); return "\r" === e[i] && ++i, "\n" === e[i] && ++i, t.buffer = e.substr(i), n } function n(e) { e.match(/X-TIMESTAMP-MAP/) ? u(e, (function (e, i) { if ("X-TIMESTAMP-MAP" === e) !function (e) { var i = new o; u(e, (function (e, t) { switch (e) { case "MPEGT": i.integer(e + "S", t); break; case "LOCA": i.set(e + "L", s(t)) } }), /[^\d]:/, /,/), t.ontimestampmap && t.ontimestampmap({ MPEGTS: i.get("MPEGTS"), LOCAL: i.get("LOCAL") }) }(i) }), /=/) : u(e, (function (e, i) { if ("Region" === e) !function (e) { var i = new o; if (u(e, (function (e, t) { switch (e) { case "id": i.set(e, t); break; case "width": i.percent(e, t); break; case "lines": i.integer(e, t); break; case "regionanchor": case "viewportanchor": var n = t.split(","); if (2 !== n.length) break; var r = new o; if (r.percent("x", n[0]), r.percent("y", n[1]), !r.has("x") || !r.has("y")) break; i.set(e + "X", r.get("x")), i.set(e + "Y", r.get("y")); break; case "scroll": i.alt(e, t, ["up"]) } }), /=/, /\s/), i.has("id")) { var n = new (t.vttjs.VTTRegion || t.window.VTTRegion); n.width = i.get("width", 100), n.lines = i.get("lines", 3), n.regionAnchorX = i.get("regionanchorX", 0), n.regionAnchorY = i.get("regionanchorY", 100), n.viewportAnchorX = i.get("viewportanchorX", 0), n.viewportAnchorY = i.get("viewportanchorY", 100), n.scroll = i.get("scroll", ""), t.onregion && t.onregion(n), t.regionList.push({ id: i.get("id"), region: n }) } }(i) }), /:/) } e && (t.buffer += t.decoder.decode(e, { stream: !0 })); try { var r; if ("INITIAL" === t.state) { if (!/\r\n|\n/.test(t.buffer)) return this; var c = (r = i()).match(/^WEBVTT([ \t].*)?$/); if (!c || !c[0]) throw new a(a.Errors.BadSignature); t.state = "HEADER" } for (var d = !1; t.buffer;) { if (!/\r\n|\n/.test(t.buffer)) return this; switch (d ? d = !1 : r = i(), t.state) { case "HEADER": /:/.test(r) ? n(r) : r || (t.state = "ID"); continue; case "NOTE": r || (t.state = "ID"); continue; case "ID": if (/^NOTE($|[ \t])/.test(r)) { t.state = "NOTE"; break } if (!r) continue; t.cue = new (t.vttjs.VTTCue || t.window.VTTCue)(0, 0, ""); try { t.cue.align = "center" } catch (e) { t.cue.align = "middle" } if (t.state = "CUE", -1 === r.indexOf("--\x3e")) { t.cue.id = r; continue } case "CUE": try { l(r, t.cue, t.regionList) } catch (e) { t.reportOrThrowError(e), t.cue = null, t.state = "BADCUE"; continue } t.state = "CUETEXT"; continue; case "CUETEXT": var h = -1 !== r.indexOf("--\x3e"); if (!r || h && (d = !0)) { t.oncue && t.oncue(t.cue), t.cue = null, t.state = "ID"; continue } t.cue.text && (t.cue.text += "\n"), t.cue.text += r.replace(/\u2028/g, "\n").replace(/u2029/g, "\n"); continue; case "BADCUE": r || (t.state = "ID"); continue } } } catch (e) { t.reportOrThrowError(e), "CUETEXT" === t.state && t.cue && t.oncue && t.oncue(t.cue), t.cue = null, t.state = "INITIAL" === t.state ? "BADWEBVTT" : "BADCUE" } return this }, flush: function () { var e = this; try { if (e.buffer += e.decoder.decode(), (e.cue || "HEADER" === e.state) && (e.buffer += "\n\n", e.parse()), "INITIAL" === e.state) throw new a(a.Errors.BadSignature) } catch (t) { e.reportOrThrowError(t) } return e.onflush && e.onflush(), this } }, e.exports = x }, 22230: e => { var t = { "": 1, lr: 1, rl: 1 }, i = { start: 1, center: 1, end: 1, left: 1, right: 1, auto: 1, "line-left": 1, "line-right": 1 }; function n(e) { return "string" == typeof e && (!!i[e.toLowerCase()] && e.toLowerCase()) } function r(e, i, r) { this.hasBeenReset = !1; var a = "", s = !1, o = e, u = i, l = r, c = null, d = "", h = !0, p = "auto", f = "start", m = "auto", g = "auto", A = 100, v = "center"; Object.defineProperties(this, { id: { enumerable: !0, get: function () { return a }, set: function (e) { a = "" + e } }, pauseOnExit: { enumerable: !0, get: function () { return s }, set: function (e) { s = !!e } }, startTime: { enumerable: !0, get: function () { return o }, set: function (e) { if ("number" != typeof e) throw new TypeError("Start time must be set to a number."); o = e, this.hasBeenReset = !0 } }, endTime: { enumerable: !0, get: function () { return u }, set: function (e) { if ("number" != typeof e) throw new TypeError("End time must be set to a number."); u = e, this.hasBeenReset = !0 } }, text: { enumerable: !0, get: function () { return l }, set: function (e) { l = "" + e, this.hasBeenReset = !0 } }, region: { enumerable: !0, get: function () { return c }, set: function (e) { c = e, this.hasBeenReset = !0 } }, vertical: { enumerable: !0, get: function () { return d }, set: function (e) { var i = function (e) { return "string" == typeof e && !!t[e.toLowerCase()] && e.toLowerCase() }(e); if (!1 === i) throw new SyntaxError("Vertical: an invalid or illegal direction string was specified."); d = i, this.hasBeenReset = !0 } }, snapToLines: { enumerable: !0, get: function () { return h }, set: function (e) { h = !!e, this.hasBeenReset = !0 } }, line: { enumerable: !0, get: function () { return p }, set: function (e) { if ("number" != typeof e && "auto" !== e) throw new SyntaxError("Line: an invalid number or illegal string was specified."); p = e, this.hasBeenReset = !0 } }, lineAlign: { enumerable: !0, get: function () { return f }, set: function (e) { var t = n(e); t ? (f = t, this.hasBeenReset = !0) : console.warn("lineAlign: an invalid or illegal string was specified.") } }, position: { enumerable: !0, get: function () { return m }, set: function (e) { if (e < 0 || e > 100) throw new Error("Position must be between 0 and 100."); m = e, this.hasBeenReset = !0 } }, positionAlign: { enumerable: !0, get: function () { return g }, set: function (e) { var t = n(e); t ? (g = t, this.hasBeenReset = !0) : console.warn("positionAlign: an invalid or illegal string was specified.") } }, size: { enumerable: !0, get: function () { return A }, set: function (e) { if (e < 0 || e > 100) throw new Error("Size must be between 0 and 100."); A = e, this.hasBeenReset = !0 } }, align: { enumerable: !0, get: function () { return v }, set: function (e) { var t = n(e); if (!t) throw new SyntaxError("align: an invalid or illegal alignment string was specified."); v = t, this.hasBeenReset = !0 } } }), this.displayState = void 0 } r.prototype.getCueAsHTML = function () { return WebVTT.convertCueToDOMTree(window, this.text) }, e.exports = r }, 13710: e => { var t = { "": !0, up: !0 }; function i(e) { return "number" == typeof e && e >= 0 && e <= 100 } e.exports = function () { var e = 100, n = 3, r = 0, a = 100, s = 0, o = 100, u = ""; Object.defineProperties(this, { width: { enumerable: !0, get: function () { return e }, set: function (t) { if (!i(t)) throw new Error("Width must be between 0 and 100."); e = t } }, lines: { enumerable: !0, get: function () { return n }, set: function (e) { if ("number" != typeof e) throw new TypeError("Lines must be set to a number."); n = e } }, regionAnchorY: { enumerable: !0, get: function () { return a }, set: function (e) { if (!i(e)) throw new Error("RegionAnchorX must be between 0 and 100."); a = e } }, regionAnchorX: { enumerable: !0, get: function () { return r }, set: function (e) { if (!i(e)) throw new Error("RegionAnchorY must be between 0 and 100."); r = e } }, viewportAnchorY: { enumerable: !0, get: function () { return o }, set: function (e) { if (!i(e)) throw new Error("ViewportAnchorY must be between 0 and 100."); o = e } }, viewportAnchorX: { enumerable: !0, get: function () { return s }, set: function (e) { if (!i(e)) throw new Error("ViewportAnchorX must be between 0 and 100."); s = e } }, scroll: { enumerable: !0, get: function () { return u }, set: function (e) { var i = function (e) { return "string" == typeof e && !!t[e.toLowerCase()] && e.toLowerCase() }(e); !1 === i ? console.warn("Scroll: an invalid or illegal string was specified.") : u = i } } }) } }, 65311: e => { "use strict"; e.exports = jQuery }, 25893: () => { } }, __webpack_module_cache__ = {}; function __webpack_require__(e) { var t = __webpack_module_cache__[e]; if (void 0 !== t) return t.exports; var i = __webpack_module_cache__[e] = { exports: {} }; return __webpack_modules__[e].call(i.exports, i, i.exports, __webpack_require__), i.exports } __webpack_require__.n = e => { var t = e && e.__esModule ? () => e.default : () => e; return __webpack_require__.d(t, { a: t }), t }, __webpack_require__.d = (e, t) => { for (var i in t) __webpack_require__.o(t, i) && !__webpack_require__.o(e, i) && Object.defineProperty(e, i, { enumerable: !0, get: t[i] }) }, __webpack_require__.g = function () { if ("object" == typeof globalThis) return globalThis; try { return this || new Function("return this")() } catch (e) { if ("object" == typeof window) return window } }(), __webpack_require__.o = (e, t) => Object.prototype.hasOwnProperty.call(e, t), __webpack_require__.r = e => { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }; var __webpack_exports__ = {}; (() => { "use strict"; var e = __webpack_require__(65311), t = __webpack_require__.n(e), i = __webpack_require__(97019), n = __webpack_require__.n(i), r = __webpack_require__(37210), a = __webpack_require__.n(r); function s(e, t) { var i = "undefined" != typeof Symbol && e[Symbol.iterator] || e["@@iterator"]; if (!i) { if (Array.isArray(e) || (i = function (e, t) { if (!e) return; if ("string" == typeof e) return o(e, t); var i = Object.prototype.toString.call(e).slice(8, -1); "Object" === i && e.constructor && (i = e.constructor.name); if ("Map" === i || "Set" === i) return Array.from(e); if ("Arguments" === i || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)) return o(e, t) }(e)) || t && e && "number" == typeof e.length) { i && (e = i); var n = 0, r = function () { }; return { s: r, n: function () { return n >= e.length ? { done: !0 } : { done: !1, value: e[n++] } }, e: function (e) { throw e }, f: r } } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") } var a, s = !0, u = !1; return { s: function () { i = i.call(e) }, n: function () { var e = i.next(); return s = e.done, e }, e: function (e) { u = !0, a = e }, f: function () { try { s || null == i.return || i.return() } finally { if (u) throw a } } } } function o(e, t) { (null == t || t > e.length) && (t = e.length); for (var i = 0, n = new Array(t); i < t; i++)n[i] = e[i]; return n } function u(e) { return u = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e }, u(e) } !function (e, t, i) { if ("function" != typeof t) return console.error("nette.ajax.js: jQuery is missing, load it please"); t.nette = new (t.extend((function () { var n = { self: this, initialized: !1, contexts: {}, on: { init: {}, load: {}, prepare: {}, before: {}, start: {}, success: {}, complete: {}, error: {} }, fire: function () { var e = !0, r = Array.prototype.slice.call(arguments), a = r.shift(), s = "string" == typeof a ? a : a.name, o = "object" === u(a) && a.off || {}; return r.push(n.self), t.each(n.on[s], (function (a, s) { if (s === i || -1 !== t.inArray(a, o)) return !0; var u = s.apply(n.contexts[a], r); return e = u === i || u })), e }, requestHandler: function (e) { var t = n.self.ajax({}, this, e); if (t && t._returnFalse) return !1 }, ext: function (e, r, a) { for (; !a;)a = "ext_" + Math.random(), n.contexts[a] && (a = i); t.each(e, (function (e, t) { n.on[e][a] = t })), n.contexts[a] = t.extend(r || {}, { name: function () { return a }, ext: function (e, t) { var i = n.contexts[e]; if (!i && t) throw "Extension '" + this.name() + "' depends on disabled extension '" + e + "'."; return i } }) } }; this.ext = function (e, r, a) { if ("object" === u(e)) n.ext(e, r); else { if (r === i) return n.contexts[e]; if (r) { if ("string" == typeof e && n.contexts[e] !== i) throw "Cannot override already registered nette-ajax extension '" + e + "'."; n.ext(r, a, e) } else t.each(["init", "load", "prepare", "before", "start", "success", "complete", "error"], (function (t, r) { n.on[r][e] = i })), n.contexts[e] = i } return this }, this.init = function (e, t) { if (n.initialized) throw "Cannot initialize nette-ajax twice."; if ("function" == typeof e) this.ext("init", null), this.ext("init", { load: e }, t); else if ("object" === u(e)) this.ext("init", null), this.ext("init", e, t); else if (e !== i) throw "Argument of init() can be function or function-hash only."; return n.initialized = !0, n.fire("init"), this.load(), this }, this.load = function () { return n.fire("load", n.requestHandler), this }, this.ajax = function (r, a, s) { if ("string" === t.type(r) && (r = { url: r }), !r.nette && a && s) { var o, u = t(a), l = r.nette = { e: s, ui: a, el: u, isForm: u.is("form"), isSubmit: u.is("input[type=submit]") || u.is("button[type=submit]"), isImage: u.is("input[type=image]"), form: null }; if (l.isSubmit || l.isImage ? l.form = l.el.closest("form") : l.isForm && (l.form = l.el), r.url || (r.url = l.form ? l.form.attr("action") || e.location.pathname + e.location.search : a.href), r.type || (r.type = l.form ? l.form.attr("method") : "get"), u.is("[data-ajax-off]")) { var c = u.attr("data-ajax-off"); 0 === c.indexOf("[") ? r.off = u.data("ajaxOff") : -1 !== c.indexOf(",") ? r.off = c.split(",") : -1 !== c.indexOf(" ") ? r.off = c.split(" ") : r.off = c, "string" == typeof r.off && (r.off = [r.off]), r.off = t.grep(t.each(r.off, (function (e) { return t.trim(e) })), (function (e) { return e.length })) } } return n.fire({ name: "prepare", off: r.off || {} }, r), r.prepare && r.prepare(r), o = r.beforeSend, r.beforeSend = function (e, t) { var r = n.fire({ name: "before", off: t.off || {} }, e, t); return (r || r === i) && o && (r = o(e, t)), r }, this.handleXHR(t.ajax(r), r) }, this.handleXHR = function (e, t) { return t = t || {}, !e || void 0 !== e.statusText && "canceled" === e.statusText || (e.done((function (e, i, r) { n.fire({ name: "success", off: t.off || {} }, e, i, r, t) })).fail((function (e, i, r) { n.fire({ name: "error", off: t.off || {} }, e, i, r, t) })).always((function (e, i) { n.fire({ name: "complete", off: t.off || {} }, e, i, t) })), n.fire({ name: "start", off: t.off || {} }, e, t), t.start && t.start(e, t)), e } }), t.nette ? t.nette : {})), t.fn.netteAjax = function (e, i) { return t.nette.ajax(i || {}, this[0], e) }, t.fn.netteAjaxOff = function () { return this.off(".nette") }, t.nette.ext("validation", { before: function (e, n) { if (!n.nette) return !0; var r = n.nette, a = r.e, s = t.extend(this.defaults, n.validate || function () { if (r.el.is("[data-ajax-validate]")) { var e = r.el.data("ajaxValidate"); return !1 === e ? { keys: !1, url: !1, form: !1 } : "object" === u(e) ? e : void 0 } }() || {}), o = !1; if (r.el.attr("data-ajax-pass") !== i && (o = "bool" != typeof (o = r.el.data("ajaxPass")) || o), s.keys) { var l = a.button || a.ctrlKey || a.shiftKey || a.altKey || a.metaKey; if (r.form) { if (l && r.isSubmit) return this.explicitNoAjax = !0, !1; if (r.isForm && this.explicitNoAjax) return this.explicitNoAjax = !1, !1 } else if (l) return !1 } if (s.form && r.form) { var c; if ((r.isSubmit || r.isImage) && (r.form.get(0)["nette-submittedBy"] = r.el.get(0)), void 0 === Nette.version || "2.3" == Nette.version) { var d = this.ie(); c = r.form.get(0).onsubmit && !1 === r.form.get(0).onsubmit(void 0 !== d && d < 9 ? i : a) } else c = !1 === (r.form.get(0).onsubmit ? r.form.triggerHandler("submit") : Nette.validateForm(r.form.get(0))); if (c) return a.stopImmediatePropagation(), a.preventDefault(), !1 } if (s.url) { var h = r.form ? n.url : r.el.attr("href"); if (/(?:^[a-z][a-z0-9+.-]*:|\/\/)/.test(h)) { var p = new URL(h); if (/:|^#/.test(p.pathname + p.search + p.hash)) return !1 } else if (/:|^#/.test(h)) return !1 } return o || (a.stopPropagation(), a.preventDefault(), e._returnFalse = !0), !0 } }, { defaults: { keys: !0, url: !0, form: !0 }, explicitNoAjax: !1, ie: function (e) { for (var t = 3, i = document.createElement("div"), n = i.getElementsByTagName("i"); i.innerHTML = "\x3c!--[if gt IE " + ++t + "]><i></i><![endif]--\x3e", n[0];); return t > 4 ? t : e } }), t.nette.ext("forms", { init: function () { var t; e.Nette && (t = this.ext("snippets")) && t.after((function (t) { t.find("form").each((function () { e.Nette.initForm(this) })) })) }, prepare: function (i) { var n = i.nette; if (n && n.form) { var r = n.e, a = i.data || {}, o = {}; if (n.isSubmit) o[n.el.attr("name")] = n.el.val() || ""; else if (n.isImage) { var u = n.el.offset(), l = n.el.attr("name"), c = [Math.max(0, r.pageX - u.left), Math.max(0, r.pageY - u.top)]; -1 !== l.indexOf("[", 0) ? o[l] = c : (o[l + ".x"] = c[0], o[l + ".y"] = c[1]) } var d = n.form.attr("method"); if (d && "post" === d.toLowerCase() && "FormData" in e) { var h = new FormData(n.form[0]); for (var p in o) h.append(p, o[p]); if ("string" != typeof a) for (var p in a) h.append(p, a[p]); if (h.entries && navigator.userAgent.match(/version\/11(\.[0-9]+)* safari/i)) { var f, m = s(h.entries()); try { for (m.s(); !(f = m.n()).done;) { var g = f.value; g[1] instanceof File && "" === g[1].name && 0 === g[1].size && h.delete(g[0]) } } catch (e) { m.e(e) } finally { m.f() } } i.data = h, i.processData = !1, i.contentType = !1 } else "string" != typeof a && (a = t.param(a)), o = t.param(o), i.data = n.form.serialize() + (o ? "&" + o : "") + "&" + a } } }), t.nette.ext("snippets", { success: function (e) { e.snippets && this.updateSnippets(e.snippets) } }, { beforeQueue: t.Callbacks(), afterQueue: t.Callbacks(), completeQueue: t.Callbacks(), before: function (e) { this.beforeQueue.add(e) }, after: function (e) { this.afterQueue.add(e) }, complete: function (e) { this.completeQueue.add(e) }, updateSnippets: function (e, i) { var n = this, r = []; for (var a in e) { var s = this.getElement(a); s.get(0) && r.push(s.get(0)), this.updateSnippet(s, e[a], i) } t(r).promise().done((function () { n.completeQueue.fire() })) }, updateSnippet: function (e, t, i) { e.is("title") ? document.title = t : (this.beforeQueue.fire(e), this.applySnippet(e, t, i), this.afterQueue.fire(e)) }, getElement: function (e) { return t("#" + this.escapeSelector(e)) }, applySnippet: function (e, t, i) { !i && e.is("[data-ajax-append]") ? e.append(t) : !i && e.is("[data-ajax-prepend]") ? e.prepend(t) : (e.html() != t || /<[^>]*script/.test(t)) && e.html(t) }, escapeSelector: function (e) { return e.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g, "\\$&") } }), t.nette.ext("redirect", { success: function (t) { if (t.redirect) return e.location.href = t.redirect, !1 } }), t.nette.ext("state", { success: function (e) { e.state && (this.state = e.state) } }, { state: null }), t.nette.ext("unique", { start: function (e) { this.xhr && this.xhr.abort(), this.xhr = e }, complete: function () { this.xhr = null } }, { xhr: null }), t.nette.ext("abort", { init: function () { t("body").keydown(t.proxy((function (e) { this.xhr && e.keyCode && "27" === e.keyCode.toString() && !(e.ctrlKey || e.shiftKey || e.altKey || e.metaKey) && this.xhr.abort() }), this)) }, start: function (e) { this.xhr = e }, complete: function () { this.xhr = null } }, { xhr: null }), t.nette.ext("load", { success: function () { t.nette.load() } }), t.nette.ext("init", { load: function (e) { t(this.linkSelector).off("click.nette", e).on("click.nette", e), t(this.formSelector).off("submit.nette", e).on("submit.nette", e).off("click.nette", ":image", e).on("click.nette", ":image", e).off("click.nette", ":submit", e).on("click.nette", ":submit", e), t(this.buttonSelector).closest("form").off("click.nette", this.buttonSelector, e).on("click.nette", this.buttonSelector, e) } }, { linkSelector: "a.ajax", formSelector: "form.ajax", buttonSelector: 'input.ajax[type="submit"], button.ajax[type="submit"], input.ajax[type="image"]' }) }(window, t()), t()(document).ready((function (e) { var i = { headerShadow: !1, scrollTop: !1 }, n = t()(".scrollToTop"); document.addEventListener("scroll", (function () { t()(window).scrollTop() > 20 && !i.headerShadow ? (i.headerShadow = !0, t()("header").addClass("scrolled")) : t()(window).scrollTop() <= 20 && i.headerShadow && (i.headerShadow = !1, t()("header").removeClass("scrolled")), t()(window).scrollTop() > 600 && !i.scrollTop ? (i.scrollTop = !0, t()("#react-page").length || n.show()) : t()(window).scrollTop() <= 600 && i.scrollTop && (i.scrollTop = !1, n.hide()) }), { passive: !0 }), n.on("click", (function () { return t()("html, body").animate({ scrollTop: 0 }, 800), !1 })), t()("ul.tabs li, .tabs ul li").on("click", (function (e) { e.preventDefault(), t()(this).addClass("active"), t()(this).siblings().removeClass("active"); var i = t()(this).attr("data-link"); t()(".tab-content").not(i).css("display", "none"), t()(i).fadeIn() })), t()("#notice").click((function (e) { e.preventDefault(), t()(this).parent().siblings().removeClass("active"), t()(".menu-window").fadeOut(300), t()(this).parent().toggleClass("active"), t()(this).parent().hasClass("active") ? t()("#notice-content").fadeIn(300) : t()("#notice-content").fadeOut(300) })), t()("#message").click((function (e) { e.preventDefault(), t()(this).parent().siblings().removeClass("active"), t()(".menu-window").fadeOut(300), t()(this).parent().toggleClass("active"), t()(this).parent().hasClass("active") ? t()("#message-content").fadeIn(300) : t()("#message-content").fadeOut(300) })), t()(window).width() > 768 && t()(".menu-window .special-scroll, .menu-window .content.higher").on("mousewheel DOMMouseScroll", (function (e) { var t = e.originalEvent, i = t.wheelDelta || -t.detail; this.scrollTop += 30 * (i < 0 ? 1 : -1), e.preventDefault() })), t()(window).width() > 1024 && document.addEventListener("scroll", (function (e) { var i = t()(".menu"); t()(window).scrollTop() >= 40 ? i.addClass("fixed") : i.removeClass("fixed") }), { passive: !0 }), t()(".number-input-spin").on("click", (function (e) { t()(this).parent().toggleClass("open"), e.stopPropagation(), t()("nav").click((function (e) { e.stopPropagation() })); var i = t()("nav"); i.toggleClass("isIn"); var n = i.hasClass("isIn"); i.animate({ left: n ? "0" : "-300px" }, 300) })), t()(".number-input-master input").change((function () { t()(this).is(":checked") ? t()("html, body").addClass("overflowhidden") : t()("html, body").removeClass("overflowhidden") })), t()("#snippet--photos").each((function () { t()(".popisek-dne", this).each((function () { t()(this).height() > 140 && t()(this).find("button").closest(".cist-dale").addClass("vissible") })) })), t()(".cist-dale").on("click", (function (e) { e.preventDefault(), t()(this).removeClass("vissible"), t()(this).parent("div").addClass("open"), e.stopPropagation(), t()(".popisek-dne").click((function (e) { e.stopPropagation() })) })), t()(".buttons-on-left .show-comments-detail").click((function () { t()("html,body").animate({ scrollTop: t()(".komenty-o-detailu-tripu").offset().top }, "slow") })) })), t()((function () { var e, i, n, r, a; window.fbAsyncInit = function () { FB.init({ appId: "423212225080206", autoLogAppEvents: !0, xfbml: !0, version: "v3.2" }) }, e = document, i = "script", n = "facebook-jssdk", a = e.getElementsByTagName(i)[0], e.getElementById(n) || ((r = e.createElement(i)).id = n, r.src = "https://connect.facebook.net/en_US/sdk.js", a.parentNode.insertBefore(r, a)), t()(document).on("click", ".fb-trip-share", (function () { var e = t()(this).attr("data-link"); FB.ui({ method: "feed", link: e }, (function (e) { })) })), t()(".gallery-modal-content").on("click", ".fb-photo-share", (function () { var e = t()(this).attr("data-link"); FB.ui({ method: "feed", link: e }, (function (e) { })) })), t().nette.init(), t().nette.ext("hidePhotoCommentsSpinner", { success: function (e) { 1 == e.hidePhotoCommentsSpinner && t()(".load-number-input").hide() } }), t().nette.ext("deletePhoto", { success: function (e) { if (1 == e.deletePhoto) { var i = e.photoId; t()("#old-photo-" + i).remove() } } }), t().nette.ext("deleteVideo", { success: function (e) { if (1 == e.deleteVideo) { var i = e.videoId; t()("#old-video-" + i).remove() } } }), t().nette.ext("uploadPhotos", { success: function (e) { 1 == e.upload && (t()("#progressbar").attr("data-url", e.redirectUrl), t()("#progressbar").attr("data-edit-url", e.editUrl), uploadTripPhotos(e.tripId, 0)) } }), t().nette.ext("photoLikes", { success: function (e) { if (1 == e.photoLikes) { var i = e.icoId; t()("#" + i).toggleClass("liked"); var n = e.countId, r = e.likeCount; r > 0 ? t()("#" + n).text(r) : t()("#" + n).text("") } } }), t()(document).on("focus", ".autocomplete-off", (function () { t()(this).attr("autocomplete", "off") })), window.getCommentsHtml = function (e, i, n, r) { for (var a = "", s = function (e) { if (e.autor_id === r.myId) { if (e.trip_komentar_id) return ' | <button class="remove-comment" data-trip-comment-delete="' + r.deleteLink + '" data-comment-id="' + e.trip_komentar_id + '">' + r.deleteText + "</button>"; if (e.photo_komentar_id) return ' | <button class="remove-comment" data-photo-comment-delete="' + r.deleteLink + '" data-comment-id="' + e.photo_komentar_id + '">' + r.deleteText + "</button>"; throw "Unknown comment type." } return "" }, o = 0; o < e.length; o++) { var u = e[o], l = -1 === u.profilova_fotka.indexOf("http") ? n + "/" + u.profilova_fotka : u.profilova_fotka; 0 === l.indexOf("//") && (l = l.substr(1)); var c = '<div class="chat-person"><div class="chat-image ' + (u.is_premium ? "premium-user" : "") + '"><img src="' + l + '" alt="osoba" /><div class="star"></div></div><div class="chat-description"><p class="name-user">' + t()("<div />").text(u.jmeno_prezdivka).html() + '<i class="date">' + u.ajax_date + '</i></p><p class="chat-content">' + u.obsah + "</p>", d = '<div class="comment-buttons"><a class="odpovedet trip-odpovedet" ajax-val="' + u.trip_komentar_id + '" href="#">' + r.answerText + "</a>" + s(u) + "</div>", h = "</div>"; a += '<hr class="special">', i && (a += '<div class="content-answer">'), a += c, r.logged && (a += d), a += h, a += h, i && (a += h), 0 !== u.answers.length && (a += getCommentsHtml(u.answers, !0, n, r)) } return a }, showWholeRouteButton && showWholeRouteButton(), t()("html").click((function () { })), t()(document).keyup((function (e) { 27 === e.keyCode && t()(".notifikace").fadeOut(300) })), t()(document).ready((function (e) { t()("sem dej button po kterem se ti zobrazi notifikace").on("click", (function (e) { e.stopPropagation(), e.preventDefault(), t()(".notifikace-content").click((function (e) { e.stopPropagation() })), t()(".notifikace").css("display", "flex").animate({ opacity: 1 }, 300) })), t()(".notifikace a").on("click", (function (e) { e.stopPropagation(), e.preventDefault(), t()(".notifikace").fadeOut(300) })) })), t()(document).on("click", ".dalsi", (function () { setUsersModalContent(t()(this)), event.stopPropagation(), event.preventDefault(), t()(".lide-content").click((function (e) { e.stopPropagation() })), t()(".lide-modal").css("display", "flex").animate({ opacity: 1 }, 300), t()("html").addClass("overflowhidden"), t()(".overlay").fadeIn(200) })), t()(".dalsi").on("click", (function (e) { })), t()(".lide-modal .close").on("click", (function (e) { e.preventDefault(), t()(".lide-modal").fadeOut("300"), t()("html").removeClass("overflowhidden"), t()(".overlay").fadeOut(200) })), t()("html").click((function () { try { closeGallery(), closeVideoGallery() } catch (e) { } t()(".notifikace").fadeOut(300), t()(".lide-modal").fadeOut("300"), t()(".selectOptions").fadeOut(300), t()(".modal-nejnastevovanejsi-zeme").fadeOut(300), t()("aside.nejnastevovanejsi-zeme .button-bordered").removeClass("open"), t()(".custom-select.open, .selectBox.open").removeClass("open"), t()(".overlay").fadeOut(), t()("html, body").removeClass("overflowhidden") })), t()(document).keyup((function (e) { 27 === e.keyCode && (t()(".lide-modal").fadeOut("300"), t()(".selectOptions").fadeOut(300), t()(".overlay").fadeOut(), t()("html").removeClass("overflowhidden"), t()(".custom-select.open, .selectBox.open").removeClass("open"), t()(".modal-nejnastevovanejsi-zeme").fadeOut(300), t()("aside.nejnastevovanejsi-zeme .button-bordered").removeClass("open")) })), window.setUsersModalContent = function (e) { var i = e.closest(".user-post").find(".lide-body").clone(); i.removeClass("none"); var n = t()(".lide-modal .lide-content"); n.find(".lide-body").remove(), n.append(i) }, window.location.hash && setTimeout((function () { }), 1) })), window.showWholeRouteButton = function () { t()(".post-description").each((function () { var e = t()(this).find(".place"), i = e.find(".cela-trasa"); if (i.length) { var n = e.find("p")[0]; n.scrollHeight > n.offsetHeight && i.show() } })) }, window.getComponentNameFromURL = function (e) { var t = e.substr(e.indexOf("do=") + 3); return t = -1 !== t.indexOf("-") ? t.substr(0, t.indexOf("-") + 1) : "" }, window.isElementOnScreen = function (e) { var i = t()(document).scrollTop(), n = window.innerHeight; return e.position().top < i + n }, window.getWindowBottomOffset = function () { var e = t()(document), i = e.scrollTop(), n = e.height(); return i + window.innerHeight - n }; var l = __webpack_require__(62918), c = __webpack_require__.n(l); window.$ = t(), window.jQuery = t(), window.Nette = n(), window.NoSleep = a(), __webpack_require__(54753), __webpack_require__(81294), __webpack_require__(94951), __webpack_require__(6512), __webpack_require__(93649), window.EXIF = c() })() })();